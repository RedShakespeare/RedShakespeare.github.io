/*! For license information please see renderer_bundle.js.LICENSE.txt */
(()=>{var t={6048:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(7191),s=i(9743),a=i(7373);n.DisplayObject.mixin(a.accessibleTarget);class o{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(r.utils.isMobile.tablet||r.utils.isMobile.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.zIndex=2..toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",(()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()})),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let t=0;t<e.length;t++)this.updateAccessibleObjects(e[t])}update(){const t=performance.now();if(r.utils.isMobile.android.device&&t<this.androidUpdateCount)return;if(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen)return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:i,width:n,height:s}=this.renderer.view.getBoundingClientRect(),{width:a,height:o,resolution:l}=this.renderer,h=n/a*l,u=s/o*l;let c=this.div;c.style.left=`${e}px`,c.style.top=`${i}px`,c.style.width=`${a}px`,c.style.height=`${o}px`;for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.renderId!==this.renderId)e._accessibleActive=!1,r.utils.removeItems(this.children,t,1),this.div.removeChild(e._accessibleDiv),this.pool.push(e._accessibleDiv),e._accessibleDiv=null,t--;else{c=e._accessibleDiv;let t=e.hitArea;const i=e.worldTransform;e.hitArea?(c.style.left=(i.tx+t.x*i.a)*h+"px",c.style.top=(i.ty+t.y*i.d)*u+"px",c.style.width=t.width*i.a*h+"px",c.style.height=t.height*i.d*u+"px"):(t=e.getBounds(),this.capHitArea(t),c.style.left=t.x*h+"px",c.style.top=t.y*u+"px",c.style.width=t.width*h+"px",c.style.height=t.height*u+"px",c.title!==e.accessibleTitle&&null!==e.accessibleTitle&&(c.title=e.accessibleTitle),c.getAttribute("aria-label")!==e.accessibleHint&&null!==e.accessibleHint&&c.setAttribute("aria-label",e.accessibleHint)),e.accessibleTitle===c.title&&e.tabIndex===c.tabIndex||(c.title=e.accessibleTitle,c.tabIndex=e.tabIndex,this.debug&&this.updateDebugHTML(c))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:i}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>i&&(t.height=i-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:i}=t.target,r=this.renderer.events.rootBoundary,n=Object.assign(new s.FederatedEvent(r),{target:i});r.rootTarget=this.renderer.lastObjectRendered,e.forEach((t=>r.dispatchEvent(n,t)))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){9===t.keyCode&&this.activate()}_onMouseMove(t){0===t.movementX&&0===t.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}o.extension={name:"accessibility",type:[r.ExtensionType.RendererPlugin,r.ExtensionType.CanvasRendererPlugin]},r.extensions.add(o),e.AccessibilityManager=o},7373:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.accessibleTarget={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1}},5649:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7373),n=i(6048);e.accessibleTarget=r.accessibleTarget,e.AccessibilityManager=n.AccessibilityManager},7450:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(7191);const s=class{constructor(t){this.stage=new n.Container,t=Object.assign({forceCanvas:!1},t),this.renderer=r.autoDetectRenderer(t),s._plugins.forEach((e=>{e.init.call(this,t)}))}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(t,e){const i=s._plugins.slice(0);i.reverse(),i.forEach((t=>{t.destroy.call(this)})),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};let a=s;a._plugins=[],r.extensions.handleByList(r.ExtensionType.Application,a._plugins),e.Application=a},5581:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);class n{static init(t){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame((()=>this.resize())))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let t,e;if(this.cancelResize(),this._resizeTo===globalThis.window)t=globalThis.innerWidth,e=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:r}=this._resizeTo;t=i,e=r}this.renderer.resize(t,e),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}n.extension=r.ExtensionType.Application,r.extensions.add(n),e.ResizePlugin=n},1827:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7450),n=i(5581);e.Application=r.Application,e.ResizePlugin=n.ResizePlugin},3238:(t,e,i)=>{"use strict";var r=i(8742);const n={loader:r.ExtensionType.LoadParser,resolver:r.ExtensionType.ResolveParser,cache:r.ExtensionType.CacheParser,detection:r.ExtensionType.DetectionParser};r.extensions.handle(r.ExtensionType.Asset,(t=>{const e=t.ref;Object.entries(n).filter((([t])=>!!e[t])).forEach((([t,i])=>r.extensions.add(Object.assign(e[t],{extension:e[t].extension??i}))))}),(t=>{const e=t.ref;Object.keys(n).filter((t=>!!e[t])).forEach((t=>r.extensions.remove(e[t])))}))},2961:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(6845),s=i(241),a=i(6480),o=i(7847),l=i(1331),h=i(1114);class u{constructor(){this._detections=[],this._initialized=!1,this.resolver=new o.Resolver,this.loader=new a.Loader,this.cache=s.Cache,this._backgroundLoader=new n.BackgroundLoader(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized)return;if(this._initialized=!0,t.basePath&&(this.resolver.basePath=t.basePath),t.manifest){let e=t.manifest;"string"==typeof e&&(e=await this.load(e)),this.resolver.addManifest(e)}const e=t.texturePreference?.resolution??1,i="number"==typeof e?[e]:e;let r=[];if(t.texturePreference?.format){const e=t.texturePreference?.format;r="string"==typeof e?[e]:e;for(const t of this._detections)await t.test()||(r=await t.remove(r))}else for(const t of this._detections)await t.test()&&(r=await t.add(r));this.resolver.prefer({params:{format:r,resolution:i}})}add(t,e,i){this.resolver.add(t,e,i)}async load(t,e){this._initialized||await this.init();const i=h.isSingleItem(t),r=l.convertToList(t).map((t=>"string"!=typeof t?(this.resolver.add(t.src,t),t.src):t)),n=this.resolver.resolve(r),s=await this._mapLoadToResolve(n,e);return i?s[r[0]]:s}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;"string"==typeof t&&(i=!0,t=[t]);const r=this.resolver.resolveBundle(t),n={},s=Object.keys(r);let a=0,o=0;const l=()=>{e?.(++a/o)},h=s.map((t=>{const e=r[t];return o+=Object.keys(e).length,this._mapLoadToResolve(e,l).then((e=>{n[t]=e}))}));return await Promise.all(h),i?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach((t=>{this._backgroundLoader.add(Object.values(t))}))}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if("string"==typeof t)return s.Cache.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=s.Cache.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(i,e);this._backgroundLoader.active=!0;const a={};return i.forEach(((t,e)=>{const i=n[t.src],o=[t.src];t.alias&&o.push(...t.alias),a[r[e]]=i,s.Cache.set(o,i)})),a}async unload(t){this._initialized||await this.init();const e=l.convertToList(t).map((t=>"string"!=typeof t?t.src:t)),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=l.convertToList(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map((t=>this._unloadFromResolved(e[t])));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach((t=>{s.Cache.remove(t.src)})),await this.loader.unload(e)}get detections(){return this._detections}}const c=new u;r.extensions.handleByList(r.ExtensionType.LoadParser,c.loader.parsers).handleByList(r.ExtensionType.ResolveParser,c.resolver.parsers).handleByList(r.ExtensionType.CacheParser,c.cache.parsers).handleByList(r.ExtensionType.DetectionParser,c.detections),e.Assets=c,e.AssetsClass=u},6845:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BackgroundLoader=class{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach((t=>{this._assetList.push(t)})),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}},241:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);i(9973);var n=i(1331);const s=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){return this._cache.get(t)}set(t,e){const i=n.convertToList(t);let s;for(let t=0;t<this.parsers.length;t++){const r=this.parsers[t];if(r.test(e)){s=r.getCacheableAssets(i,e);break}}s||(s={},i.forEach((t=>{s[t]=e})));const a=Object.keys(s),o={cacheKeys:a,keys:i};if(i.forEach((t=>{this._cacheMap.set(t,o)})),a.forEach((t=>{this._cache.has(t)&&this._cache.get(t),this._cache.set(t,s[t])})),e instanceof r.Texture){const t=e;i.forEach((e=>{t.baseTexture!==r.Texture.EMPTY.baseTexture&&r.BaseTexture.addToCache(t.baseTexture,e),r.Texture.addToCache(t,e)}))}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t))return;const e=this._cacheMap.get(t);e.cacheKeys.forEach((t=>{this._cache.delete(t)})),e.keys.forEach((t=>{this._cacheMap.delete(t)}))}get parsers(){return this._parsers}};e.Cache=s},8799:()=>{},8570:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(241);i(7911),i(8799),e.Cache=r.Cache},7880:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);const n={extension:r.ExtensionType.CacheParser,test:t=>Array.isArray(t)&&t.every((t=>t instanceof r.Texture)),getCacheableAssets:(t,e)=>{const i={};return t.forEach((t=>{e.forEach(((e,r)=>{i[t+(0===r?"":r+1)]=e}))})),i}};r.extensions.add(n),e.cacheTextureArray=n},7911:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7880);e.cacheTextureArray=r.cacheTextureArray},6158:(t,e,i)=>{"use strict";i(8001)},9231:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);const n={extension:{type:r.ExtensionType.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const t=await r.settings.ADAPTER.fetch("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=").then((t=>t.blob()));return createImageBitmap(t).then((()=>!0),(()=>!1))},add:async t=>[...t,"avif"],remove:async t=>t.filter((t=>"avif"!==t))};r.extensions.add(n),e.detectAvif=n},4041:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);const n=["png","jpg","jpeg"],s={extension:{type:r.ExtensionType.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...n],remove:async t=>t.filter((t=>!n.includes(t)))};r.extensions.add(s),e.detectDefaults=s},1133:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);const n={extension:{type:r.ExtensionType.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const t=await r.settings.ADAPTER.fetch("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=").then((t=>t.blob()));return createImageBitmap(t).then((()=>!0),(()=>!1))},add:async t=>[...t,"webp"],remove:async t=>t.filter((t=>"webp"!==t))};r.extensions.add(n),e.detectWebp=n},8001:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9231),n=i(1133),s=i(4041);e.detectAvif=r.detectAvif,e.detectWebp=n.detectWebp,e.detectDefaults=s.detectDefaults},8415:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2961);i(3238),i(9973),i(8570),i(807),i(9076),i(6158);var n=i(1331),s=i(4878),a=i(1114),o=i(241),l=i(7880),h=i(4265),u=i(4176),c=i(4899),d=i(2321),p=i(9568),f=i(6785),m=i(1719),g=i(1002),_=i(819),y=i(9231),v=i(1133),x=i(4041);e.Assets=r.Assets,e.AssetsClass=r.AssetsClass,e.convertToList=n.convertToList,e.createStringVariations=s.createStringVariations,e.isSingleItem=a.isSingleItem,e.Cache=o.Cache,e.cacheTextureArray=l.cacheTextureArray,e.LoaderParserPriority=h.LoaderParserPriority,e.loadJson=u.loadJson,e.loadTxt=c.loadTxt,e.getFontFamilyName=d.getFontFamilyName,e.loadWebFont=d.loadWebFont,e.loadSVG=p.loadSVG,e.loadImageBitmap=f.loadImageBitmap,e.loadTextures=f.loadTextures,e.checkExtension=m.checkExtension,e.createTexture=g.createTexture,e.resolveTextureUrl=_.resolveTextureUrl,e.detectAvif=y.detectAvif,e.detectWebp=v.detectWebp,e.detectDefaults=x.detectDefaults},6480:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);i(9973);var n=i(1114),s=i(1331);e.Loader=class{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{let r=null;for(let n=0;n<this.parsers.length;n++){const s=this.parsers[n];if(s.load&&s.test?.(t,e,this)){r=await s.load(t,e,this),i.parser=s;break}}if(!i.parser)return null;for(let t=0;t<this.parsers.length;t++){const n=this.parsers[t];n.parse&&n.parse&&await(n.testParse?.(r,e,this))&&(r=await n.parse(r,e,this)||r,i.parser=n)}return r})(),i}async load(t,e){let i=0;const a={},o=n.isSingleItem(t),l=s.convertToList(t,(t=>({src:t}))),h=l.length,u=l.map((async t=>{const n=r.utils.path.toAbsolute(t.src);if(!a[t.src])try{this.promiseCache[n]||(this.promiseCache[n]=this._getLoadPromiseAndParser(n,t)),a[t.src]=await this.promiseCache[n].promise,e&&e(++i/h)}catch(e){throw delete this.promiseCache[n],delete a[t.src],new Error(`[Loader.load] Failed to load ${n}.\n${e}`)}}));return await Promise.all(u),o?a[l[0].src]:a}async unload(t){const e=s.convertToList(t,(t=>({src:t}))).map((async t=>{const e=r.utils.path.toAbsolute(t.src),i=this.promiseCache[e];if(i){const r=await i.promise;i.parser?.unload?.(r,t,this),delete this.promiseCache[e]}}));await Promise.all(e)}get parsers(){return this._parsers}}},807:(t,e,i)=>{"use strict";i(530),i(4498)},4265:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(i||{});e.LoaderParserPriority=i},6585:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});let i,r=0;const n="\n    async function checkImageBitmap()\n    {\n        try\n        {\n            if (typeof createImageBitmap !== 'function') return false;\n\n            const response = await fetch('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=');\n            const imageBlob =  await response.blob();\n            const imageBitmap = await createImageBitmap(imageBlob);\n\n            return imageBitmap.width === 1 && imageBitmap.height === 1;\n        }\n        catch (e)\n        {\n            return false;\n        }\n    }\n    checkImageBitmap().then((result) => { self.postMessage(result); });\n    ",s="\n    async function loadImageBitmap(url)\n    {\n        const response = await fetch(url);\n\n        if (!response.ok)\n        {\n            throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: `\n                + `${response.status} ${response.statusText}`);\n        }\n\n        const imageBlob =  await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n\n        return imageBitmap;\n    }\n    self.onmessage = async (event) =>\n    {\n        try\n        {\n            const imageBitmap = await loadImageBitmap(event.data.data[0]);\n\n            self.postMessage({\n                data: imageBitmap,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            }, [imageBitmap]);\n        }\n        catch(e)\n        {\n            self.postMessage({\n                error: e,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            });\n        }\n    };";let a;const o=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise((t=>{const e=URL.createObjectURL(new Blob([n],{type:"application/javascript"})),i=new Worker(e);i.addEventListener("message",(r=>{i.terminate(),URL.revokeObjectURL(e),t(r.data)}))}))),this._isImageBitmapSupported}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){void 0===i&&(i=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<i&&(a||(a=URL.createObjectURL(new Blob([s],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(a),t.addEventListener("message",(t=>{this.complete(t.data),this.returnWorker(t.target),this.next()}))),t}returnWorker(t){this.workerPool.push(t)}complete(t){void 0!==t.error?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise(((i,r)=>{this.queue.push({id:t,arguments:e,resolve:i,reject:r})}));return this.next(),i}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),i=e.id;this.resolveHash[r]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:r++,id:i})}};e.WorkerManager=o},4498:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4265),n=i(4176),s=i(4899),a=i(2321);i(6577),e.LoaderParserPriority=r.LoaderParserPriority,e.loadJson=n.loadJson,e.loadTxt=s.loadTxt,e.getFontFamilyName=a.getFontFamilyName,e.loadWebFont=a.loadWebFont},4176:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(4265);const s={extension:{type:r.ExtensionType.LoadParser,priority:n.LoaderParserPriority.Low},test:t=>r.utils.path.extname(t).includes(".json"),async load(t){const e=await r.settings.ADAPTER.fetch(t);return await e.json()}};r.extensions.add(s),e.loadJson=s},4899:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(4265);const s={extension:{type:r.ExtensionType.LoadParser,priority:n.LoaderParserPriority.Low},test:t=>r.utils.path.extname(t).includes(".txt"),async load(t){const e=await r.settings.ADAPTER.fetch(t);return await e.text()}};r.extensions.add(s),e.loadTxt=s},2321:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(4265);const s=["normal","bold","100","200","300","400","500","600","700","800","900"],a=["woff","woff2","ttf","otf"];function o(t){const e=r.utils.path.extname(t);return r.utils.path.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map((t=>t.charAt(0).toUpperCase()+t.slice(1))).join(" ")}const l={extension:{type:r.ExtensionType.LoadParser,priority:n.LoaderParserPriority.Low},test(t){const e=t.split("?")[0].split(".").pop();return a.includes(e)},async load(t,e){if(!globalThis.navigator.onLine)throw new Error("[loadWebFont] Cannot load font - navigator is offline");const i=r.settings.ADAPTER.getFontFaceSet();if(i){const r=[],n=e.data?.family??o(t),a=e.data?.weights?.filter((t=>s.includes(t)))??["normal"],l=e.data??{};for(let e=0;e<a.length;e++){const s=a[e],o=new FontFace(n,`url(${t})`,{...l,weight:s});await o.load(),i.add(o),r.push(o)}return 1===r.length?r[0]:r}return null},unload(t){(Array.isArray(t)?t:[t]).forEach((t=>r.settings.ADAPTER.getFontFaceSet().delete(t)))}};r.extensions.add(l),e.getFontFamilyName=o,e.loadWebFont=l},6577:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9568),n=i(6785);i(6602),e.loadSVG=r.loadSVG,e.loadImageBitmap=n.loadImageBitmap,e.loadTextures=n.loadTextures},9568:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(4265),s=i(6785),a=i(1002);const o={extension:{type:r.ExtensionType.LoadParser,priority:n.LoaderParserPriority.High},test:t=>r.utils.path.extname(t).includes(".svg"),testParse:async t=>r.SVGResource.test(t),async parse(t,e,i){const n=new r.SVGResource(t,e?.data?.resourceOptions),s=new r.BaseTexture(n,{resolution:r.utils.getResolutionOfUrl(t),...e?.data});s.resource.src=t;const o=a.createTexture(s,i,t);return e?.data?.resourceOptions?.autoLoad||await n.load(),o},load:async(t,e)=>(await r.settings.ADAPTER.fetch(t)).text(),unload:s.loadTextures.unload};e.loadSVG=o},6785:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(4265),s=i(6585),a=i(1719),o=i(1002);const l=[".jpg",".png",".jpeg",".avif",".webp"];async function h(t){const e=await r.settings.ADAPTER.fetch(t);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${e.status} ${e.statusText}`);const i=await e.blob();return await createImageBitmap(i)}const u={extension:{type:r.ExtensionType.LoadParser,priority:n.LoaderParserPriority.High},config:{preferWorkers:!0},test(t){let e=!1;for(let i=0;i<l.length;i++)if(t.startsWith(`data:image/${l[i].slice(1)}`)){e=!0;break}return e||a.checkExtension(t,l)},async load(t,e,i){let n=null;n=globalThis.createImageBitmap?this.config.preferWorkers&&await s.WorkerManager.isImageBitmapSupported()?await s.WorkerManager.loadImageBitmap(t):await h(t):await new Promise((e=>{n=new Image,n.crossOrigin="anonymous",n.src=t,n.complete?e(n):n.onload=()=>{e(n)}}));const a=new r.BaseTexture(n,{resolution:r.utils.getResolutionOfUrl(t),...e.data});return a.resource.src=t,o.createTexture(a,i,t)},unload(t){t.destroy(!0)}};r.extensions.add(u),e.loadImageBitmap=h,e.loadTextures=u},1719:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);e.checkExtension=function(t,e){const i=t.split("?")[0],n=r.utils.path.extname(i).toLowerCase();return Array.isArray(e)?e.includes(n.toLowerCase()):n.toLowerCase()===e}},1002:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);e.createTexture=function(t,e,i){const n=new r.Texture(t);return n.baseTexture.on("dispose",(()=>{delete e.promiseCache[i]})),n}},6602:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1719),n=i(1002);e.checkExtension=r.checkExtension,e.createTexture=n.createTexture},530:()=>{},7847:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(1331),s=i(4878),a=i(1114);e.Resolver=class{constructor(){this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}prefer(...t){t.forEach((t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))})),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this._preferredOrder=[],this._resolverHash={},this._assetMap={},this._rootPath=null,this._basePath=null,this._manifest=null}addManifest(t){this._manifest,this._manifest=t,t.bundles.forEach((t=>{this.addBundle(t.name,t.assets)}))}addBundle(t,e){const i=[];Array.isArray(e)?e.forEach((t=>{"string"==typeof t.name?i.push(t.name):i.push(...t.name),this.add(t.name,t.srcs)})):Object.keys(e).forEach((t=>{i.push(t),this.add(t,e[t])})),this._bundles[t]=i}add(t,e,i){const a=n.convertToList(t);a.forEach((t=>{this._assetMap[t]})),Array.isArray(e)||(e="string"==typeof e?s.createStringVariations(e):[e]);const o=e.map((t=>{let e=t;if("string"==typeof t){let i=!1;for(let r=0;r<this._parsers.length;r++){const n=this._parsers[r];if(n.test(t)){e=n.parse(t),i=!0;break}}i||(e={src:t})}return e.format||(e.format=e.src.split(".").pop()),e.alias||(e.alias=a),(this._basePath||this._rootPath)&&(e.src=r.utils.path.toAbsolute(e.src,this._basePath,this._rootPath)),e.data=e.data??i,e}));a.forEach((t=>{this._assetMap[t]=o}))}resolveBundle(t){const e=a.isSingleItem(t);t=n.convertToList(t);const i={};return t.forEach((t=>{const e=this._bundles[t];e&&(i[t]=this.resolve(e))})),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if("string"!=typeof t){const t={};for(const i in e)t[i]=e[i].src;return t}return e.src}resolve(t){const e=a.isSingleItem(t);t=n.convertToList(t);const i={};return t.forEach((t=>{if(!this._resolverHash[t])if(this._assetMap[t]){let e=this._assetMap[t];const i=this._getPreferredOrder(e),r=e[0];i?.priority.forEach((t=>{i.params[t].forEach((i=>{const r=e.filter((e=>!!e[t]&&e[t]===i));r.length&&(e=r)}))})),this._resolverHash[t]=e[0]??r}else{let e=t;(this._basePath||this._rootPath)&&(e=r.utils.path.toAbsolute(e,this._basePath,this._rootPath)),this._resolverHash[t]={src:e}}i[t]=this._resolverHash[t]})),e?i[t[0]]:i}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const e=t[0],i=this._preferredOrder.find((t=>t.params.format.includes(e.format)));if(i)return i}return this._preferredOrder[0]}}},9076:(t,e,i)=>{"use strict";i(1998),i(8404)},8404:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(819);e.resolveTextureUrl=r.resolveTextureUrl},819:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);i(807);var n=i(6785);const s={extension:r.ExtensionType.ResolveParser,test:n.loadTextures.test,parse:t=>({resolution:parseFloat(r.settings.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})};r.extensions.add(s),e.resolveTextureUrl=s},1998:()=>{},1331:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.convertToList=(t,e)=>(Array.isArray(t)||(t=[t]),e?t.map((t=>"string"==typeof t?e(t):t)):t)},4878:(t,e)=>{"use strict";function i(t,e,r,n,s){const a=e[r];for(let o=0;o<a.length;o++){const l=a[o];r<e.length-1?i(t.replace(n[r],l),e,r+1,n,s):s.push(t.replace(n[r],l))}}Object.defineProperty(e,"__esModule",{value:!0}),e.createStringVariations=function(t){const e=t.match(/\{(.*?)\}/g),r=[];if(e){const n=[];e.forEach((t=>{const e=t.substring(1,t.length-1).split(",");n.push(e)})),i(t,n,0,e,r)}else r.push(t);return r}},9973:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1331),n=i(4878),s=i(1114);e.convertToList=r.convertToList,e.createStringVariations=n.createStringVariations,e.isSingleItem=s.isSingleItem},1114:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isSingleItem=t=>!Array.isArray(t)},9133:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(t=>(t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t))(i||{});e.INTERNAL_FORMATS=i,e.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1}},3438:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9133);i(5534),i(7424),i(1807);var n=i(1788),s=i(9947),a=i(2005),o=i(869),l=i(5192),h=i(3291),u=i(1620),c=i(2581);e.INTERNAL_FORMATS=r.INTERNAL_FORMATS,e.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL=r.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL,e.BlobResource=n.BlobResource,e.CompressedTextureResource=s.CompressedTextureResource,e.detectCompressedTextures=a.detectCompressedTextures,e.loadDDS=o.loadDDS,e.loadKTX=l.loadKTX,e.resolveCompressedTextureUrl=h.resolveCompressedTextureUrl,e.parseDDS=u.parseDDS,e.FORMATS_TO_COMPONENTS=c.FORMATS_TO_COMPONENTS,e.TYPES_TO_BYTES_PER_COMPONENT=c.TYPES_TO_BYTES_PER_COMPONENT,e.TYPES_TO_BYTES_PER_PIXEL=c.TYPES_TO_BYTES_PER_PIXEL,e.parseKTX=c.parseKTX},8256:()=>{},2005:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);let n,s;function a(){s={s3tc:n.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:n.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:n.getExtension("WEBGL_compressed_texture_etc"),etc1:n.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:n.getExtension("WEBGL_compressed_texture_atc"),astc:n.getExtension("WEBGL_compressed_texture_astc")}}const o={extension:{type:r.ExtensionType.DetectionParser,priority:2},test:async()=>{const t=r.settings.ADAPTER.createCanvas().getContext("webgl");return!!t&&(n=t,!0)},add:async t=>{s||a();const e=[];for(const t in s)s[t]&&e.push(t);return[...e,...t]},remove:async t=>(s||a(),t.filter((t=>!(t in s))))};r.extensions.add(o),e.detectCompressedTextures=o},7424:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2005),n=i(869),s=i(5192);i(8256);var a=i(3291);e.detectCompressedTextures=r.detectCompressedTextures,e.loadDDS=n.loadDDS,e.loadKTX=s.loadKTX,e.resolveCompressedTextureUrl=a.resolveCompressedTextureUrl},869:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(8415);i(1807);var s=i(1620);const a={extension:{type:r.ExtensionType.LoadParser,priority:n.LoaderParserPriority.High},test:t=>n.checkExtension(t,".dds"),async load(t,e,i){const a=await r.settings.ADAPTER.fetch(t),o=await a.arrayBuffer(),l=s.parseDDS(o).map((s=>{const a=new r.BaseTexture(s,{mipmap:r.MIPMAP_MODES.OFF,alphaMode:r.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:r.utils.getResolutionOfUrl(t),...e.data});return n.createTexture(a,i,t)}));return 1===l.length?l[0]:l},unload(t){Array.isArray(t)?t.forEach((t=>t.destroy(!0))):t.destroy(!0)}};r.extensions.add(a),e.loadDDS=a},5192:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(8415);i(1807);var s=i(2581);const a={extension:{type:r.ExtensionType.LoadParser,priority:n.LoaderParserPriority.High},test:t=>n.checkExtension(t,".ktx"),async load(t,e,i){const a=await r.settings.ADAPTER.fetch(t),o=await a.arrayBuffer(),{compressed:l,uncompressed:h,kvData:u}=s.parseKTX(t,o),c=l??h,d={mipmap:r.MIPMAP_MODES.OFF,alphaMode:r.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:r.utils.getResolutionOfUrl(t),...e.data},p=c.map((e=>{c===h&&Object.assign(d,{type:e.type,format:e.format});const s=new r.BaseTexture(e,d);return s.ktxKeyValueData=u,n.createTexture(s,i,t)}));return 1===p.length?p[0]:p},unload(t){Array.isArray(t)?t.forEach((t=>t.destroy(!0))):t.destroy(!0)}};r.extensions.add(a),e.loadKTX=a},3291:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);const n={extension:r.ExtensionType.ResolveParser,test:t=>{const e=t.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(e)},parse:t=>{if("ktx"===t.split("?")[0].split(".").pop()){const e=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(e.some((e=>t.endsWith(e))))return{resolution:parseFloat(r.settings.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e.find((e=>t.endsWith(e))),src:t}}return{resolution:parseFloat(r.settings.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t}}};r.extensions.add(n),e.resolveCompressedTextureUrl=n},1807:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1620),n=i(2581);e.parseDDS=r.parseDDS,e.FORMATS_TO_COMPONENTS=n.FORMATS_TO_COMPONENTS,e.TYPES_TO_BYTES_PER_COMPONENT=n.TYPES_TO_BYTES_PER_COMPONENT,e.TYPES_TO_BYTES_PER_PIXEL=n.TYPES_TO_BYTES_PER_PIXEL,e.parseKTX=n.parseKTX},1620:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(5534);var r=i(9133),n=i(9947);const s={827611204:r.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,861165636:r.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,894720068:r.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT},a={70:r.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:r.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:r.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:r.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:r.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:r.INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:r.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:r.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:r.INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};e.parseDDS=function(t){const e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");const i=new Uint32Array(t,0,124/Uint32Array.BYTES_PER_ELEMENT),o=i[3],l=i[4],h=i[7],u=new Uint32Array(t,19*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),c=u[1];if(4&c){const i=u[2];if(808540228!==i){const e=s[i],r=new Uint8Array(t,128);return[new n.CompressedTextureResource(r,{format:e,width:l,height:o,levels:h})]}const c=128,d=new Uint32Array(e.buffer,c,20/Uint32Array.BYTES_PER_ELEMENT),p=d[0],f=d[1],m=d[2],g=d[3],_=a[p];if(void 0===_)throw new Error(`DDSParser cannot parse texture data with DXGI format ${p}`);if(4===m)throw new Error("DDSParser does not support cubemap textures");if(6===f)throw new Error("DDSParser does not supported 3D texture data");const y=new Array,v=148;if(1===g)y.push(new Uint8Array(t,v));else{const e=r.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[_];let i=0,n=l,s=o;for(let t=0;t<h;t++)i+=Math.max(1,n+3&-4)*Math.max(1,s+3&-4)*e,n>>>=1,s>>>=1;let a=v;for(let e=0;e<g;e++)y.push(new Uint8Array(t,a,i)),a+=i}return y.map((t=>new n.CompressedTextureResource(t,{format:_,width:l,height:o,levels:h})))}if(64&c)throw new Error("DDSParser does not support uncompressed texture data.");if(512&c)throw new Error("DDSParser does not supported YUV uncompressed texture data.");if(131072&c)throw new Error("DDSParser does not support single-channel (lumninance) texture data!");if(2&c)throw new Error("DDSParser does not support single-channel (alpha) texture data!");throw new Error("DDSParser failed to load a texture file due to an unknown reason!")}},2581:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(9133);i(5534);var s=i(9947);const a=[171,75,84,88,32,49,49,187,13,10,26,10],o={[r.TYPES.UNSIGNED_BYTE]:1,[r.TYPES.UNSIGNED_SHORT]:2,[r.TYPES.INT]:4,[r.TYPES.UNSIGNED_INT]:4,[r.TYPES.FLOAT]:4,[r.TYPES.HALF_FLOAT]:8},l={[r.FORMATS.RGBA]:4,[r.FORMATS.RGB]:3,[r.FORMATS.RG]:2,[r.FORMATS.RED]:1,[r.FORMATS.LUMINANCE]:1,[r.FORMATS.LUMINANCE_ALPHA]:2,[r.FORMATS.ALPHA]:1},h={[r.TYPES.UNSIGNED_SHORT_4_4_4_4]:2,[r.TYPES.UNSIGNED_SHORT_5_5_5_1]:2,[r.TYPES.UNSIGNED_SHORT_5_6_5]:2};function u(t){switch(t){case r.FORMATS.RGBA:return r.FORMATS.RGBA_INTEGER;case r.FORMATS.RGB:return r.FORMATS.RGB_INTEGER;case r.FORMATS.RG:return r.FORMATS.RG_INTEGER;case r.FORMATS.RED:return r.FORMATS.RED_INTEGER;default:return t}}e.FORMATS_TO_COMPONENTS=l,e.TYPES_TO_BYTES_PER_COMPONENT=o,e.TYPES_TO_BYTES_PER_PIXEL=h,e.parseKTX=function(t,e,i=!1){const c=new DataView(e);if(!function(t,e){for(let t=0;t<a.length;t++)if(e.getUint8(t)!==a[t])return!1;return!0}(0,c))return null;const d=67305985===c.getUint32(12,!0),p=c.getUint32(16,d),f=c.getUint32(24,d),m=c.getUint32(28,d),g=c.getUint32(36,d),_=c.getUint32(40,d)||1,y=c.getUint32(44,d)||1,v=c.getUint32(48,d)||1,x=c.getUint32(52,d),b=c.getUint32(56,d),E=c.getUint32(60,d);if(0===_||1!==y)throw new Error("Only 2D textures are supported");if(1!==x)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==v)throw new Error("WebGL does not support array textures");const T=g+3&-4,S=_+3&-4,w=new Array(v);let A,I=g*_;if(0===p&&(I=T*S),A=0!==p?o[p]?o[p]*l[f]:h[p]:n.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[m],void 0===A)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const R=i?function(t,e,i){const r=new Map;let n=0;for(;n<e;){const s=t.getUint32(64+n,i),a=64+n+4,o=3-(s+3)%4;if(0===s||s>e-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&0!==t.getUint8(a+l);l++);if(-1===l){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const h=(new TextDecoder).decode(new Uint8Array(t.buffer,a,l)),u=new DataView(t.buffer,a+l+1,s-l-1);r.set(h,u),n+=4+s+o}return r}(c,E,d):null;let C=I*A,M=g,O=_,P=T,k=S,D=64+E;for(let t=0;t<b;t++){const i=c.getUint32(D,d);let r=D+4;for(let i=0;i<v;i++){let n=w[i];n||(n=w[i]=new Array(b)),n[t]={levelID:t,levelWidth:b>1||0!==p?M:P,levelHeight:b>1||0!==p?O:k,levelBuffer:new Uint8Array(e,r,C)},r+=C}D+=i+4,D=D%4!=0?D+4-D%4:D,M=M>>1||1,O=O>>1||1,P=M+4-1&-4,k=O+4-1&-4,C=P*k*A}return 0!==p?{uncompressed:w.map((t=>{let e=t[0].levelBuffer,i=!1;return p===r.TYPES.FLOAT?e=new Float32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4):p===r.TYPES.UNSIGNED_INT?(i=!0,e=new Uint32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)):p===r.TYPES.INT&&(i=!0,e=new Int32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)),{resource:new r.BufferResource(e,{width:t[0].levelWidth,height:t[0].levelHeight}),type:p,format:i?u(f):f}})),kvData:R}:{compressed:w.map((t=>new s.CompressedTextureResource(null,{format:m,width:g,height:_,levels:b,levelBuffers:t}))),kvData:R}}},1788:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);class n extends r.BufferResource{constructor(t,e={width:1,height:1,autoLoad:!0}){let i,n;"string"==typeof t?(i=t,n=new Uint8Array):(i=null,n=t),super(n,e),this.origin=i,this.buffer=n?new r.ViewableBuffer(n):null,this.origin&&!1!==e.autoLoad&&this.load(),n?.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}async load(){const t=await fetch(this.origin),e=await t.blob(),i=await e.arrayBuffer();return this.data=new Uint32Array(i),this.buffer=new r.ViewableBuffer(i),this.loaded=!0,this.onBlobLoaded(i),this.update(),this}}e.BlobResource=n},9947:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1788),n=i(9133);class s extends r.BlobResource{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=s._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||s._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,i){const r=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let t=0,e=this.levels;t<e;t++){const{levelID:e,levelWidth:i,levelHeight:n,levelBuffer:s}=this._levelBuffers[t];r.compressedTexImage2D(r.TEXTURE_2D,e,this.format,i,n,0,s)}return!0}onBlobLoaded(){this._levelBuffers=s._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,i,r,s,a,o){const l=new Array(i);let h=t.byteOffset,u=a,c=o,d=u+r-1&~(r-1),p=c+s-1&~(s-1),f=d*p*n.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[e];for(let a=0;a<i;a++)l[a]={levelID:a,levelWidth:i>1?u:d,levelHeight:i>1?c:p,levelBuffer:new Uint8Array(t.buffer,h,f)},h+=f,u=u>>1||1,c=c>>1||1,d=u+r-1&~(r-1),p=c+s-1&~(s-1),f=d*p*n.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[e];return l}}e.CompressedTextureResource=s},5534:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1788),n=i(9947);e.BlobResource=r.BlobResource,e.CompressedTextureResource=n.CompressedTextureResource},7616:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(t=>(t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t))(i||{}),r=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS",t))(r||{}),n=(t=>(t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t))(n||{}),s=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t))(s||{}),a=(t=>(t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t))(a||{}),o=(t=>(t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t))(o||{}),l=(t=>(t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t))(l||{}),h=(t=>(t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t))(h||{}),u=(t=>(t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t))(u||{}),c=(t=>(t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t))(c||{}),d=(t=>(t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t))(d||{}),p=(t=>(t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t))(p||{}),f=(t=>(t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t))(f||{}),m=(t=>(t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t))(m||{}),g=(t=>(t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t))(g||{}),_=(t=>(t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t))(_||{}),y=(t=>(t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t))(y||{}),v=(t=>(t[t.RED=1]="RED",t[t.GREEN=2]="GREEN",t[t.BLUE=4]="BLUE",t[t.ALPHA=8]="ALPHA",t))(v||{}),x=(t=>(t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t))(x||{}),b=(t=>(t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t))(b||{});e.ALPHA_MODES=f,e.BLEND_MODES=s,e.BUFFER_BITS=n,e.BUFFER_TYPE=b,e.CLEAR_MODES=m,e.COLOR_MASK_BITS=v,e.DRAW_MODES=a,e.ENV=i,e.FORMATS=o,e.GC_MODES=g,e.MASK_TYPES=y,e.MIPMAP_MODES=p,e.MSAA_QUALITY=x,e.PRECISION=_,e.RENDERER_TYPE=r,e.SAMPLER_TYPES=u,e.SCALE_MODES=c,e.TARGETS=l,e.TYPES=h,e.WRAP_MODES=d},4665:()=>{},7032:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2191),n=i(4240),s=i(435),a=i(1648),o=i(2101),l=i(8065);const h=class extends l.SystemManager{constructor(t){super(),t=Object.assign({},o.settings.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new n.UniformGroup({projectionMatrix:new s.Matrix},!0);const e={runners:["init","destroy","contextChange","reset","update","postrender","prerender","resize"],systems:h.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e);const i={hello:t.hello,_plugin:h.__plugins,background:{alpha:t.backgroundAlpha,color:t.background??t.backgroundColor,clearBeforeRender:t.clearBeforeRender},_view:{height:t.height,width:t.width,autoDensity:t.autoDensity,resolution:t.resolution,view:t.view},context:{antialias:t.antialias,context:t.context,powerPreference:t.powerPreference,premultipliedAlpha:t.premultipliedAlpha??(t.useContextAlpha&&"notMultiplied"!==t.useContextAlpha),preserveDrawingBuffer:t.preserveDrawingBuffer}};this.startup.run(i)}static test(t){return!t?.forceCanvas&&r.isWebGLSupported()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return this.background.clearBeforeRender}get useContextAlpha(){return this.context.useContextAlpha}get preserveDrawingBuffer(){return this.context.preserveDrawingBuffer}get backgroundColor(){return this.background.color}set backgroundColor(t){this.background.color=t}get backgroundAlpha(){return this.background.color}set backgroundAlpha(t){this.background.alpha=t}get powerPreference(){return this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};let u=h;u.extension={type:a.ExtensionType.Renderer,priority:1},u.__plugins={},u.__systems={},a.extensions.handleByMap(a.ExtensionType.RendererPlugin,u.__plugins),a.extensions.handleByMap(a.ExtensionType.RendererSystem,u.__systems),a.extensions.add(u),e.Renderer=u},3947:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1648);const n=[];r.extensions.handleByList(r.ExtensionType.Renderer,n),e.autoDetectRenderer=function(t){for(const e of n)if(e.test(t))return new e(t);throw new Error("Unable to auto-detect a suitable renderer.")}},1110:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2191),n=i(1648);class s{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender,t.color&&(this.color="string"==typeof t.color?r.string2hex(t.color):t.color),this.alpha=t.alpha}get color(){return this._backgroundColor}set color(t){this._backgroundColor=t,this._backgroundColorString=r.hex2string(t),r.hex2rgb(t,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(t){this._backgroundColorRgba[3]=t}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}}s.extension={type:[n.ExtensionType.RendererSystem,n.ExtensionType.CanvasRendererSystem],name:"background"},n.extensions.add(s),e.BackgroundSystem=s},9731:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616);e.BatchDrawCall=class{constructor(){this.texArray=null,this.blend=0,this.type=r.DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null}}},1197:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(2736),s=i(4518);class a extends n.Geometry{constructor(t=!1){super(),this._buffer=new s.Buffer(null,t,!1),this._indexBuffer=new s.Buffer(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,r.TYPES.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,r.TYPES.FLOAT).addAttribute("aColor",this._buffer,4,!0,r.TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,r.TYPES.FLOAT).addIndex(this._indexBuffer)}}e.BatchGeometry=a},8615:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9731),n=i(6512),s=i(3396),a=i(619),o=i(7387),l=i(403),h=i(4616),u=i(7863),c=i(2101),d=i(2191),p=i(7616),f=i(1197),m=i(3873),g=i(2525),_=i(1648);const y=class extends a.ObjectRenderer{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=f.BatchGeometry,this.vertexSize=6,this.state=o.State.for2d(),this.size=4*c.settings.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultVertexSrc(){return m.default}static get defaultFragmentTemplate(){return g.default}setShaderGenerator({vertex:t=y.defaultVertexSrc,fragment:e=y.defaultFragmentTemplate}={}){this.shaderGenerator=new h.BatchShaderGenerator(t,e)}contextChange(){const t=this.renderer.gl;c.settings.PREFER_ENV===p.ENV.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),c.settings.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=u.checkMaxIfStatementsInShader(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=y,i=this.size/4,s=Math.floor(i/this.MAX_TEXTURES)+1;for(;t.length<i;)t.push(new r.BatchDrawCall);for(;e.length<s;)e.push(new n.BatchTextureArray);for(let t=0;t<this.MAX_TEXTURES;t++)this._tempBoundTextures[t]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,MAX_TEXTURES:e}=this,i=y._textureArrayPool,r=this.renderer.batch,n=this._tempBoundTextures,a=this.renderer.textureGC.count;let o=++s.BaseTexture._globalBatch,l=0,h=i[0],u=0;r.copyBoundTextures(n,e);for(let s=0;s<this._bufferSize;++s){const c=t[s];t[s]=null,c._batchEnabled!==o&&(h.count>=e&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,s),u=s,h=i[++l],++o),c._batchEnabled=o,c.touched=a,h.elements[h.count++]=c)}h.count>0&&(r.boundArray(h,n,o,e),this.buildDrawCalls(h,u,this._bufferSize),++l,++o);for(let t=0;t<n.length;t++)n[t]=null;s.BaseTexture._globalBatch=o}buildDrawCalls(t,e,i){const{_bufferedElements:r,_attributeBuffer:n,_indexBuffer:s,vertexSize:a}=this,o=y._drawCallPool;let l=this._dcIndex,h=this._aIndex,u=this._iIndex,c=o[l];c.start=this._iIndex,c.texArray=t;for(let p=e;p<i;++p){const i=r[p],f=i._texture.baseTexture,m=d.premultiplyBlendMode[f.alphaMode?1:0][i.blendMode];r[p]=null,e<p&&c.blend!==m&&(c.size=u-c.start,e=p,c=o[++l],c.texArray=t,c.start=u),this.packInterleavedGeometry(i,n,s,h,u),h+=i.vertexData.length/2*a,u+=i.indices.length,c.blend=m}e<i&&(c.size=u-c.start,++l),this._dcIndex=l,this._aIndex=h,this._iIndex=u}bindAndClearTexArray(t){const e=this.renderer.texture;for(let i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:i}=this;c.settings.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:i}=this.renderer,r=y._drawCallPool;let n=null;for(let s=0;s<t;s++){const{texArray:t,type:a,size:o,start:l,blend:h}=r[s];n!==t&&(n=t,this.bindAndClearTexArray(t)),this.state.blendMode=h,i.set(this.state),e.drawElements(a,o,e.UNSIGNED_SHORT,2*l)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),c.settings.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=d.nextPow2(Math.ceil(t/8)),i=d.log2(e),r=8*e;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let n=this._aBuffers[r];return n||(this._aBuffers[r]=n=new l.ViewableBuffer(r*this.vertexSize*4)),n}getIndexBuffer(t){const e=d.nextPow2(Math.ceil(t/12)),i=d.log2(e),r=12*e;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(r)),n}packInterleavedGeometry(t,e,i,r,n){const{uint32View:s,float32View:a}=e,o=r/this.vertexSize,l=t.uvs,h=t.indices,u=t.vertexData,c=t._texture.baseTexture._batchLocation,p=Math.min(t.worldAlpha,1),f=p<1&&t._texture.baseTexture.alphaMode?d.premultiplyTint(t._tintRGB,p):t._tintRGB+(255*p<<24);for(let t=0;t<u.length;t+=2)a[r++]=u[t],a[r++]=u[t+1],a[r++]=l[t],a[r++]=l[t+1],s[r++]=f,a[r++]=c;for(let t=0;t<h.length;t++)i[n++]=o+h[t]}};let v=y;v.extension={name:"batch",type:_.ExtensionType.RendererPlugin},v._drawCallPool=[],v._textureArrayPool=[],_.extensions.add(v),e.BatchRenderer=v},4616:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7398),n=i(9906),s=i(4240),a=i(435);e.BatchShaderGenerator=class{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const e=new Int32Array(t);for(let i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=s.UniformGroup.from({uSamplers:e},!0);let i=this.fragTemplate;i=i.replace(/%count%/gi,`${t}`),i=i.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new n.Program(this.vertexSrc,i)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new a.Matrix,default:this.defaultGroupCache[t]};return new r.Shader(this.programCache[t],e)}generateSampleSrc(t){let e="";e+="\n",e+="\n";for(let i=0;i<t;i++)i>0&&(e+="\nelse "),i<t-1&&(e+=`if(vTextureId < ${i}.5)`),e+="\n{",e+=`\n\tcolor = texture2D(uSamplers[${i}], vTextureCoord);`,e+="\n}";return e+="\n",e+="\n",e}}},5309:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(619),n=i(1648);class s{constructor(t){this.renderer=t,this.emptyRenderer=new r.ObjectRenderer(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:i}=this.renderer.texture;for(let r=e-1;r>=0;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,e,i,r){const{elements:n,ids:s,count:a}=t;let o=0;for(let t=0;t<a;t++){const a=n[t],l=a._batchLocation;if(l>=0&&l<r&&e[l]===a)s[t]=l;else for(;o<r;){const r=e[o];if(!r||r._batchEnabled!==i||r._batchLocation!==o){s[t]=o,a._batchLocation=o,e[o]=a;break}o++}}}destroy(){this.renderer=null}}s.extension={type:n.ExtensionType.RendererSystem,name:"batch"},n.extensions.add(s),e.BatchSystem=s},6512:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BatchTextureArray=class{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}},619:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectRenderer=class{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}},3873:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"},2525:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n"},1673:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(1648);i(1970);var s=i(2101);let a=0;class o{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=a++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,i=t.premultipliedAlpha??!0;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=a++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;void 0!==e.addEventListener&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let i;if(s.settings.PREFER_ENV>=r.ENV.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault()}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,void 0!==t.removeEventListener&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}o.extension={type:n.ExtensionType.RendererSystem,name:"context"},n.extensions.add(o),e.ContextSystem=o},1316:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2101),n=i(9906),s=i(7398),a=i(7387),o=i(9400),l=i(459);class h extends s.Shader{constructor(t,e,i){super(n.Program.from(t||h.defaultVertexSrc,e||h.defaultFragmentSrc),i),this.padding=0,this.resolution=r.settings.FILTER_RESOLUTION,this.multisample=r.settings.FILTER_MULTISAMPLE,this.enabled=!0,this.autoFit=!0,this.state=new a.State}apply(t,e,i,r,n){t.applyFilter(this,e,i,r)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return l.default}static get defaultFragmentSrc(){return o.default}}e.Filter=h},3092:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(435),n=i(7616);e.FilterState=class{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=n.MSAA_QUALITY.NONE,this.sourceFrame=new r.Rectangle,this.destinationFrame=new r.Rectangle,this.bindingSourceFrame=new r.Rectangle,this.bindingDestinationFrame=new r.Rectangle,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}},8994:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6516),n=i(342),s=i(2953),a=i(435),o=i(4240),l=i(7616),h=i(3092),u=i(1648);const c=[new a.Point,new a.Point,new a.Point,new a.Point],d=new a.Matrix;class p{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new r.RenderTexturePool,this.statePool=[],this.quad=new n.Quad,this.quadUv=new s.QuadUv,this.tempRect=new a.Rectangle,this.activeState={},this.globalUniforms=new o.UniformGroup({outputFrame:new a.Rectangle,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new h.FilterState,s=this.renderer.renderTexture;let a=e[0].resolution,o=e[0].multisample,l=e[0].padding,u=e[0].autoFit,c=e[0].legacy??!0;for(let t=1;t<e.length;t++){const i=e[t];a=Math.min(a,i.resolution),o=Math.min(o,i.multisample),l=this.useMaxPadding?Math.max(l,i.padding):l+i.padding,u=u&&i.autoFit,c=c||(i.legacy??!0)}1===r.length&&(this.defaultFilterStack[0].renderTexture=s.current),r.push(n),n.resolution=a,n.multisample=o,n.legacy=c,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(l);const p=this.tempRect.copyFrom(s.sourceFrame);i.projection.transform&&this.transformAABB(d.copyFrom(i.projection.transform).invert(),p),u?(n.sourceFrame.fit(p),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(p)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,a,o),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const f=this.tempRect;f.x=0,f.y=0,f.width=n.sourceFrame.width,f.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(s.sourceFrame),n.bindingDestinationFrame.copyFrom(s.destinationFrame),n.transform=i.projection.transform,i.projection.transform=null,s.bind(n.renderTexture,n.sourceFrame,f),i.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;const r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;const n=r.inputSize,s=r.inputPixel,a=r.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=Math.round(n[0]*e.resolution),s[1]=Math.round(n[1]*e.resolution),s[2]=1/s[0],s[3]=1/s[1],a[0]=.5*s[2],a[1]=.5*s[3],a[2]=e.sourceFrame.width*n[2]-.5*s[2],a[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){const t=r.filterArea;t[0]=e.destinationFrame.width,t[1]=e.destinationFrame.height,t[2]=e.sourceFrame.x,t[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const o=t[t.length-1];if(this.renderer.framebuffer.blit(),1===i.length)i[0].apply(this,e.renderTexture,o.renderTexture,l.CLEAR_MODES.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let t=e.renderTexture,r=this.getOptimalFilterTexture(t.width,t.height,e.resolution);r.filterFrame=t.filterFrame;let n=0;for(n=0;n<i.length-1;++n){1===n&&e.multisample>1&&(r=this.getOptimalFilterTexture(t.width,t.height,e.resolution),r.filterFrame=t.filterFrame),i[n].apply(this,t,r,l.CLEAR_MODES.CLEAR,e);const s=t;t=r,r=s}i[n].apply(this,t,o.renderTexture,l.CLEAR_MODES.BLEND,e),n>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(t),this.returnFilterTexture(r)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=l.CLEAR_MODES.CLEAR){const{renderTexture:i,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t?.filterFrame){const e=this.tempRect;e.x=0,e.y=0,e.width=t.filterFrame.width,e.height=t.filterFrame.height,i.bind(t,t.filterFrame,e)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=1&r.stateId||this.forceClear;(e===l.CLEAR_MODES.CLEAR||e===l.CLEAR_MODES.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,i,r){const n=this.renderer;n.state.set(t.state),this.bindAndClear(i,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(l.DRAW_MODES.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(l.DRAW_MODES.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:i,destinationFrame:r}=this.activeState,{orig:n}=e._texture,s=t.set(r.width,0,0,r.height,i.x,i.y),o=e.worldTransform.copyTo(a.Matrix.TEMP_MATRIX);return o.invert(),s.prepend(o),s.scale(1/n.width,1/n.height),s.translate(e.anchor.x,e.anchor.y),s}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,i=1,r=l.MSAA_QUALITY.NONE){return this.texturePool.getOptimalTexture(t,e,i,r)}getFilterTexture(t,e,i){if("number"==typeof t){const i=t;t=e,e=i}t=t||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,i||l.MSAA_QUALITY.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const i=c[0],r=c[1],n=c[2],s=c[3];i.set(e.left,e.top),r.set(e.left,e.bottom),n.set(e.right,e.top),s.set(e.right,e.bottom),t.apply(i,i),t.apply(r,r),t.apply(n,n),t.apply(s,s);const a=Math.min(i.x,r.x,n.x,s.x),o=Math.min(i.y,r.y,n.y,s.y),l=Math.max(i.x,r.x,n.x,s.x),h=Math.max(i.y,r.y,n.y,s.y);e.x=a,e.y=o,e.width=l-a,e.height=h-o}roundFrame(t,e,i,r,n){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(n){const{a:t,b:e,c:i,d:r}=n;if((Math.abs(e)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(r)>1e-4))return}(n=n?d.copyFrom(n):d.identity()).translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}}p.extension={type:u.ExtensionType.RendererSystem,name:"filter"},u.extensions.add(p),e.FilterSystem=p},1975:()=>{},9400:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},459:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},8977:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1316),n=i(435),s=i(9058),a=i(7231),o=i(7772);class l extends r.Filter{constructor(t,e,i){let r=null;"string"!=typeof t&&void 0===e&&void 0===i&&(r=t,t=void 0,e=void 0,i=void 0),super(t||s.default,e||a.default,i),this.maskSprite=r,this.maskMatrix=new n.Matrix}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,i,r){const n=this._maskSprite,s=n._texture;s.valid&&(s.uvMatrix||(s.uvMatrix=new o.TextureMatrix(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,t.applyFilter(this,e,i,r))}}e.SpriteMaskFilter=l},9058:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n"},7231:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"},979:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}"},3412:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},1517:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(979),n=i(3412);const s=r.default,a=n.default;e.defaultFilterVertex=a,e.defaultVertex=s},6268:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2156),n=i(3396),s=i(911),a=i(7616);e.Framebuffer=class{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new r.Runner("disposeFramebuffer"),this.multisample=a.MSAA_QUALITY.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new n.BaseTexture(null,{scaleMode:a.SCALE_MODES.NEAREST,resolution:1,mipmap:a.MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new n.BaseTexture(new s.DepthResource(null,{width:this.width,height:this.height}),{scaleMode:a.SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:a.MIPMAP_MODES.OFF,format:a.FORMATS.DEPTH_COMPONENT,type:a.TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}},6548:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(435),n=i(7616);i(1970);var s=i(6268),a=i(5465),o=i(1648),l=i(2101);const h=new r.Rectangle;class u{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new s.Framebuffer(10,10),this.msaaSamples=null}contextChange(){const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new r.Rectangle,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){let e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;l.settings.PREFER_ENV===n.ENV.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=t=>e.drawBuffersWEBGL(t):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,i=0){const{gl:r}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=i),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let e=0;e<t.colorTextures.length;e++){const i=t.colorTextures[e];this.renderer.texture.unbind(i.parentTextureArray||i)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const t=e.width>>i,r=e.height>>i,n=t/e.width;this.setViewport(e.x*n,e.y*n,t,r)}else{const e=t.width>>i,r=t.height>>i;this.setViewport(0,0,e,r)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,i,r){const n=this.viewport;t=Math.round(t),e=Math.round(e),i=Math.round(i),r=Math.round(r),n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,i,r,s=n.BUFFER_BITS.COLOR|n.BUFFER_BITS.DEPTH){const{gl:a}=this;a.clearColor(t,e,i,r),a.clear(s)}initFramebuffer(t){const{gl:e}=this,i=new a.GLFramebuffer(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){const{gl:e}=this,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),i.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const r=t.colorTextures;let n=r.length;e.drawBuffers||(n=Math.min(n,1));for(let s=0;s<n;s++){const n=r[s],a=n.parentTextureArray||n;this.renderer.texture.bind(a,0),0===s&&i.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,a._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:i}=this,r=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let s=n.length;i.drawBuffers||(s=Math.min(s,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||i.createRenderbuffer():r.msaaBuffer&&(i.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const a=[];for(let o=0;o<s;o++){const s=n[o],l=s.parentTextureArray||s;this.renderer.texture.bind(l,0),0===o&&r.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,r.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,r.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+o,s.target,l._glTextures[this.CONTEXT_UID].texture,e),a.push(i.COLOR_ATTACHMENT0+o))}if(a.length>1&&i.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const r=t.depthTexture;this.renderer.texture.bind(r,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,r._glTextures[this.CONTEXT_UID].texture,e)}!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?r.stencil&&(i.deleteRenderbuffer(r.stencil),r.stencil=null):(r.stencil=r.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,r.stencil),r.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,r.stencil))}canMultisampleFramebuffer(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let i=n.MSAA_QUALITY.NONE;if(t<=1||null===e)return i;for(let r=0;r<e.length;r++)if(e[r]<=t){i=e[r];break}return 1===i&&(i=n.MSAA_QUALITY.NONE),i}blit(t,e,i){const{current:r,renderer:n,gl:a,CONTEXT_UID:o}=this;if(2!==n.context.webGLVersion)return;if(!r)return;const l=r.glFramebuffers[o];if(!l)return;if(!t){if(!l.msaaBuffer)return;const e=r.colorTextures[0];if(!e)return;l.blitFramebuffer||(l.blitFramebuffer=new s.Framebuffer(r.width,r.height),l.blitFramebuffer.addColorTexture(0,e)),(t=l.blitFramebuffer).colorTextures[0]!==e&&(t.colorTextures[0]=e,t.dirtyId++,t.dirtyFormat++),t.width===r.width&&t.height===r.height||(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||((e=h).width=r.width,e.height=r.height),i||(i=e);const u=e.width===i.width&&e.height===i.height;this.bind(t),a.bindFramebuffer(a.READ_FRAMEBUFFER,l.framebuffer),a.blitFramebuffer(e.left,e.top,e.right,e.bottom,i.left,i.top,i.right,i.bottom,a.COLOR_BUFFER_BIT,u?a.NEAREST:a.LINEAR)}disposeFramebuffer(t,e){const i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&r.deleteRenderbuffer(i.msaaBuffer),i.stencil&&r.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&i.blitFramebuffer.dispose()}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const i=t.width,r=t.height,n=this.gl,s=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,s),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,n.DEPTH24_STENCIL8,i,r):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=s,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s)}reset(){this.current=this.unknownFramebuffer,this.viewport=new r.Rectangle}destroy(){this.renderer=null}}u.extension={type:o.ExtensionType.RendererSystem,name:"framebuffer"},o.extensions.add(u),e.FramebufferSystem=u},5465:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616);e.GLFramebuffer=class{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=r.MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}},2124:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(1648);class s{constructor(t){this.renderer=t}contextChange(t){let e;if(1===this.renderer.context.webGLVersion){const i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{const i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}e>=r.MSAA_QUALITY.HIGH?this.multisample=r.MSAA_QUALITY.HIGH:e>=r.MSAA_QUALITY.MEDIUM?this.multisample=r.MSAA_QUALITY.MEDIUM:e>=r.MSAA_QUALITY.LOW?this.multisample=r.MSAA_QUALITY.LOW:this.multisample=r.MSAA_QUALITY.NONE}destroy(){}}s.extension={type:n.ExtensionType.RendererSystem,name:"_multisample"},n.extensions.add(s),e.MultisampleSystem=s},8069:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616);class n{constructor(t,e=0,i=!1,n=r.TYPES.FLOAT,s,a,o){this.buffer=t,this.size=e,this.normalized=i,this.type=n,this.stride=s,this.start=a,this.instance=o}destroy(){this.buffer=null}static from(t,e,i,r,s){return new n(t,e,i,r,s)}}e.Attribute=n},4518:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(2156);let s=0;class a{constructor(t,e=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=s++,this.disposeRunner=new n.Runner("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?r.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER:r.BUFFER_TYPE.ARRAY_BUFFER}get index(){return this.type===r.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new a(t)}}e.Buffer=a},3313:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1204),n=i(1648);class s{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,r=t._glBuffers[i]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:i,CONTEXT_UID:r}=this;if(this.boundBufferBases[e]!==t){const n=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,i){const{gl:r,CONTEXT_UID:n}=this;i=i||0;const s=t._glBuffers[n]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,s.buffer,256*i,256)}update(t){const{gl:e,CONTEXT_UID:i}=this,r=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const i=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,i)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let i=0;i<e.length;i++)this.dispose(this.managedBuffers[e[i]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:i}=this;return t._glBuffers[e]=new r.GLBuffer(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}s.extension={type:n.ExtensionType.RendererSystem,name:"buffer"},n.extensions.add(s),e.BufferSystem=s},1204:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GLBuffer=class{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}},2736:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8069),n=i(4518),s=i(2281),a=i(2191),o=i(2156),l=i(7616);const h={5126:4,5123:2,5121:1};let u=0;const c={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class d{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=u++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new o.Runner("disposeGeometry"),this.refCount=0}addAttribute(t,e,i=0,s=!1,a,o,l,h=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof n.Buffer||(e instanceof Array&&(e=new Float32Array(e)),e=new n.Buffer(e));const u=t.split("|");if(u.length>1){for(let t=0;t<u.length;t++)this.addAttribute(u[t],e,i,s,a);return this}let c=this.buffers.indexOf(e);return-1===c&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new r.Attribute(c,i,s,a,o,l,h),this.instanced=this.instanced||h,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof n.Buffer||(t instanceof Array&&(t=new Uint16Array(t)),t=new n.Buffer(t)),t.type=l.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;const t=[],e=[],i=new n.Buffer;let r;for(r in this.attributes){const i=this.attributes[r],n=this.buffers[i.buffer];t.push(n.data),e.push(i.size*h[i.type]/4),i.buffer=0}for(i.data=s.interleaveTypedArrays(t,e),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new d;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new n.Buffer(this.buffers[e].data.slice(0));for(const e in this.attributes){const i=this.attributes[e];t.attributes[e]=new r.Attribute(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=l.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new d,i=[],r=[],s=[];let o;for(let e=0;e<t.length;e++){o=t[e];for(let t=0;t<o.buffers.length;t++)r[t]=r[t]||0,r[t]+=o.buffers[t].data.length,s[t]=0}for(let t=0;t<o.buffers.length;t++)i[t]=new(c[a.getBufferType(o.buffers[t].data)])(r[t]),e.buffers[t]=new n.Buffer(i[t]);for(let e=0;e<t.length;e++){o=t[e];for(let t=0;t<o.buffers.length;t++)i[t].set(o.buffers[t].data,s[t]),s[t]+=o.buffers[t].data.length}if(e.attributes=o.attributes,o.indexBuffer){e.indexBuffer=e.buffers[o.buffers.indexOf(o.indexBuffer)],e.indexBuffer.type=l.BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;let i=0,r=0,n=0,s=0;for(let t=0;t<o.buffers.length;t++)if(o.buffers[t]!==o.indexBuffer){s=t;break}for(const t in o.attributes){const e=o.attributes[t];(0|e.buffer)===s&&(r+=e.size*h[e.type]/4)}for(let a=0;a<t.length;a++){const o=t[a].indexBuffer.data;for(let t=0;t<o.length;t++)e.indexBuffer.data[t+n]+=i;i+=t[a].buffers[s].data.length/r,n+=o.length}}return e}}e.Geometry=d},8911:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616);i(1970);var n=i(1648),s=i(2101);const a={5126:4,5123:2,5121:1};class o{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion){let e=this.renderer.context.extensions.vertexArrayObject;s.settings.PREFER_ENV===r.ENV.WEBGL_LEGACY&&(e=null),e?(t.createVertexArray=()=>e.createVertexArrayOES(),t.bindVertexArray=t=>e.bindVertexArrayOES(t),t.deleteVertexArray=t=>e.deleteVertexArrayOES(t)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(2!==e.webGLVersion){const e=t.getExtension("ANGLE_instanced_arrays");e?(t.vertexAttribDivisor=(t,i)=>e.vertexAttribDivisorANGLE(t,i),t.drawElementsInstanced=(t,i,r,n,s)=>e.drawElementsInstancedANGLE(t,i,r,n,s),t.drawArraysInstanced=(t,i,r,n)=>e.drawArraysInstancedANGLE(t,i,r,n)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:i}=this;let r=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},n=!0);const s=r[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==s&&(this._activeVao=s,this.hasVao?i.bindVertexArray(s):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){const r=t.buffers[i];e.update(r)}}checkCompatibility(t,e){const i=t.attributes,r=e.attributeData;for(const t in r)if(!i[t])throw new Error(`shader and geometry incompatible, geometry missing the "${t}" attribute`)}getSignature(t,e){const i=t.attributes,r=e.attributeData,n=["g",t.id];for(const t in i)r[t]&&n.push(t,r[t].location);return n.join("-")}initGeometryVao(t,e,i=!0){const n=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,l=e.program;l.glPrograms[s]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,l);const h=this.getSignature(t,l),u=t.glVertexArrayObjects[this.CONTEXT_UID];let c=u[h];if(c)return u[l.id]=c,c;const d=t.buffers,p=t.attributes,f={},m={};for(const t in d)f[t]=0,m[t]=0;for(const t in p)!p[t].size&&l.attributeData[t]?p[t].size=l.attributeData[t].size:p[t].size||console.warn(`PIXI Geometry attribute '${t}' size cannot be determined (likely the bound shader does not have the attribute)`),f[p[t].buffer]+=p[t].size*a[p[t].type];for(const t in p){const e=p[t],i=e.size;void 0===e.stride&&(f[e.buffer]===i*a[e.type]?e.stride=0:e.stride=f[e.buffer]),void 0===e.start&&(e.start=m[e.buffer],m[e.buffer]+=i*a[e.type])}c=n.createVertexArray(),n.bindVertexArray(c);for(let t=0;t<d.length;t++){const e=d[t];o.bind(e),i&&e._glBuffers[s].refCount++}return this.activateVao(t,l),u[l.id]=c,u[h]=c,n.bindVertexArray(null),o.unbind(r.BUFFER_TYPE.ARRAY_BUFFER),c}disposeGeometry(t,e){if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers,s=this.renderer?.buffer;if(t.disposeRunner.remove(this),i){if(s)for(let t=0;t<n.length;t++){const i=n[t]._glBuffers[this.CONTEXT_UID];i&&(i.refCount--,0!==i.refCount||e||s.dispose(n[t],e))}if(!e)for(const t in i)if("g"===t[0]){const e=i[t];this._activeVao===e&&this.unbind(),r.deleteVertexArray(e)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t)}activateVao(t,e){const i=this.gl,r=this.CONTEXT_UID,n=this.renderer.buffer,s=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let o=null;for(const t in a){const l=a[t],h=s[l.buffer],u=h._glBuffers[r];if(e.attributeData[t]){o!==u&&(n.bind(h),o=u);const r=e.attributeData[t].location;if(i.enableVertexAttribArray(r),i.vertexAttribPointer(r,l.size,l.type||i.FLOAT,l.normalized,l.stride,l.start),l.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(r,1)}}}}draw(t,e,i,r){const{gl:n}=this,s=this._activeGeometry;if(s.indexBuffer){const a=s.indexBuffer.data.BYTES_PER_ELEMENT,o=2===a?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===a||4===a&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,o,(i||0)*a,r||1):n.drawElements(t,e||s.indexBuffer.data.length,o,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}o.extension={type:n.ExtensionType.RendererSystem,name:"geometry"},n.extensions.add(o),e.GeometrySystem=o},403:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ViewableBuffer=class{constructor(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}},2281:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2191);const n={Float32Array,Uint32Array,Int32Array,Uint8Array};e.interleaveTypedArrays=function(t,e){let i=0,s=0;const a={};for(let r=0;r<t.length;r++)s+=e[r],i+=t[r].length;const o=new ArrayBuffer(4*i);let l=null,h=0;for(let i=0;i<t.length;i++){const u=e[i],c=t[i],d=r.getBufferType(c);a[d]||(a[d]=new n[d](o)),l=a[d];for(let t=0;t<c.length;t++)l[(t/u|0)*s+h+t%u]=c[t];h+=u}return new Float32Array(o)}},8742:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(1970);var r=i(7616),n=i(1648),s=i(435),a=i(2156),o=i(2101),l=i(6082),h=i(2191);i(4535),i(9774),i(4665);var u=i(3947),c=i(1517);i(4807);var d=i(4800),p=i(7032),f=i(6268),m=i(5465),g=i(5453),_=i(3396),y=i(701),v=i(7772),x=i(1020),b=i(6516),E=i(8399),T=i(6487),S=i(7387),w=i(619),A=i(8615),I=i(4616),R=i(1197),C=i(9731),M=i(6512),O=i(342),P=i(2953),k=i(7863),D=i(9145),N=i(9124),L=i(7465),F=i(1366),B=i(7398),U=i(9906),G=i(3784),W=i(4240),j=i(6676),Y=i(8977),z=i(1316),H=i(3092);i(1975);var X=i(8069),V=i(4518),q=i(2736),K=i(403),$=i(3574),Z=i(3839),Q=i(5782),J=i(9832),tt=i(8994),et=i(6548),it=i(2109),rt=i(1546),nt=i(4910),st=i(8389),at=i(8911),ot=i(9535),lt=i(1673),ht=i(5309),ut=i(1811),ct=i(3313),dt=i(2124),pt=i(4914),ft=i(1110),mt=i(5711),gt=i(4353),_t=i(3382),yt=i(8228),vt=i(9421),xt=i(3748),bt=i(1105),Et=i(4627),Tt=i(2696),St=i(5737),wt=i(544),At=i(73),It=i(9137),Rt=i(3868),Ct=i(1540),Mt=i(1638),Ot=i(8065);function Pt(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(i){if("default"!==i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}})),e.default=t,e}var kt=Pt(h);e.utils=kt,e.autoDetectRenderer=u.autoDetectRenderer,e.defaultFilterVertex=c.defaultFilterVertex,e.defaultVertex=c.defaultVertex,e.PluginSystem=d.PluginSystem,e.Renderer=p.Renderer,e.Framebuffer=f.Framebuffer,e.GLFramebuffer=m.GLFramebuffer,e.Texture=g.Texture,e.BaseTexture=_.BaseTexture,e.GLTexture=y.GLTexture,e.TextureMatrix=v.TextureMatrix,e.RenderTexture=x.RenderTexture,e.RenderTexturePool=b.RenderTexturePool,e.BaseRenderTexture=E.BaseRenderTexture,e.TextureUvs=T.TextureUvs,e.State=S.State,e.ObjectRenderer=w.ObjectRenderer,e.BatchRenderer=A.BatchRenderer,e.BatchShaderGenerator=I.BatchShaderGenerator,e.BatchGeometry=R.BatchGeometry,e.BatchDrawCall=C.BatchDrawCall,e.BatchTextureArray=M.BatchTextureArray,e.Quad=O.Quad,e.QuadUv=P.QuadUv,e.checkMaxIfStatementsInShader=k.checkMaxIfStatementsInShader,e.uniformParsers=D.uniformParsers,e.createUBOElements=N.createUBOElements,e.generateUniformBufferSync=N.generateUniformBufferSync,e.getUBOData=N.getUBOData,e.getTestContext=L.getTestContext,e.generateProgram=F.generateProgram,e.Shader=B.Shader,e.Program=U.Program,e.GLProgram=G.GLProgram,e.IGLUniformData=G.IGLUniformData,e.UniformGroup=W.UniformGroup,e.MaskData=j.MaskData,e.SpriteMaskFilter=Y.SpriteMaskFilter,e.Filter=z.Filter,e.FilterState=H.FilterState,e.Attribute=X.Attribute,e.Buffer=V.Buffer,e.Geometry=q.Geometry,e.ViewableBuffer=K.ViewableBuffer,e.TransformFeedback=$.TransformFeedback,e.MaskSystem=Z.MaskSystem,e.StencilSystem=Q.StencilSystem,e.ScissorSystem=J.ScissorSystem,e.FilterSystem=tt.FilterSystem,e.FramebufferSystem=et.FramebufferSystem,e.RenderTextureSystem=it.RenderTextureSystem,e.TextureSystem=rt.TextureSystem,e.ProjectionSystem=nt.ProjectionSystem,e.StateSystem=st.StateSystem,e.GeometrySystem=at.GeometrySystem,e.ShaderSystem=ot.ShaderSystem,e.ContextSystem=lt.ContextSystem,e.BatchSystem=ht.BatchSystem,e.TextureGCSystem=ut.TextureGCSystem,e.BufferSystem=ct.BufferSystem,e.MultisampleSystem=dt.MultisampleSystem,e.GenerateTextureSystem=pt.GenerateTextureSystem,e.BackgroundSystem=ft.BackgroundSystem,e.ViewSystem=mt.ViewSystem,e.ObjectRendererSystem=gt.ObjectRendererSystem,e.StartupSystem=_t.StartupSystem,e.TransformFeedbackSystem=yt.TransformFeedbackSystem,e.Resource=vt.Resource,e.BaseImageResource=xt.BaseImageResource,e.INSTALLED=bt.INSTALLED,e.autoDetectResource=bt.autoDetectResource,e.AbstractMultiResource=Et.AbstractMultiResource,e.ArrayResource=Tt.ArrayResource,e.BufferResource=St.BufferResource,e.CanvasResource=wt.CanvasResource,e.CubeResource=At.CubeResource,e.ImageResource=It.ImageResource,e.SVGResource=Rt.SVGResource,e.VideoResource=Ct.VideoResource,e.ImageBitmapResource=Mt.ImageBitmapResource,e.SystemManager=Ot.SystemManager,e.VERSION="7.0.4",Object.keys(r).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[t]}})})),Object.keys(n).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return n[t]}})})),Object.keys(s).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return s[t]}})})),Object.keys(a).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return a[t]}})})),Object.keys(o).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}})})),Object.keys(l).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return l[t]}})}))},6510:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractMaskSystem=class{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,i=this.getStackLength();this.maskStack=t;const r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}},6676:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(2101);e.MaskData=class{constructor(t=null){this.type=r.MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=n.settings.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=r.MASK_TYPES.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}},3839:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6676),n=i(8977),s=i(7616),a=i(1648);class o{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let i=e;if(!i.isMaskData){const t=this.maskDataPool.pop()||new r.MaskData;t.pooled=!0,t.maskObject=e,i=t}const n=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(n),i._colorMask=n?n._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==s.MASK_TYPES.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case s.MASK_TYPES.SCISSOR:this.renderer.scissor.push(i);break;case s.MASK_TYPES.STENCIL:this.renderer.stencil.push(i);break;case s.MASK_TYPES.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case s.MASK_TYPES.COLOR:this.pushColorMask(i)}i.type===s.MASK_TYPES.SPRITE&&this.maskStack.push(i)}pop(t){const e=this.maskStack.pop();if(e&&e._target===t){if(e.enabled)switch(e.type){case s.MASK_TYPES.SCISSOR:this.renderer.scissor.pop(e);break;case s.MASK_TYPES.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case s.MASK_TYPES.SPRITE:this.popSpriteMask(e);break;case s.MASK_TYPES.COLOR:this.popColorMask(e)}if(e.reset(),e.pooled&&this.maskDataPool.push(e),0!==this.maskStack.length){const t=this.maskStack[this.maskStack.length-1];t.type===s.MASK_TYPES.SPRITE&&t._filters&&(t._filters[0].maskSprite=t.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=s.MASK_TYPES.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=s.MASK_TYPES.SCISSOR:t.type=s.MASK_TYPES.STENCIL:t.type=s.MASK_TYPES.COLOR}pushSpriteMask(t){const{maskObject:e}=t,i=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new n.SpriteMaskFilter]));const s=this.renderer,a=s.renderTexture;let o,l;if(a.current){const e=a.current;o=t.resolution||e.resolution,l=t.multisample??e.multisample}else o=t.resolution||s.resolution,l=t.multisample??s.multisample;r[0].resolution=o,r[0].multisample=l,r[0].maskSprite=e;const h=i.filterArea;i.filterArea=e.getBounds(!0),s.filter.push(i,r),i.filterArea=h,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,i=t._colorMask=e&t.colorMask;i!==e&&this.renderer.gl.colorMask(0!=(1&i),0!=(2&i),0!=(4&i),0!=(8&i))}popColorMask(t){const e=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==e&&this.renderer.gl.colorMask(0!=(1&i),0!=(2&i),0!=(4&i),0!=(8&i))}destroy(){this.renderer=null}}o.extension={type:a.ExtensionType.RendererSystem,name:"mask"},a.extensions.add(o),e.MaskSystem=o},9832:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6510),n=i(435),s=i(1648),a=i(2101);const o=new n.Matrix,l=[],h=class extends r.AbstractMaskSystem{constructor(t){super(t),this.glConst=a.settings.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:i}=t,{renderer:r}=this,s=r.renderTexture,a=i.getBounds(!0,l.pop()??new n.Rectangle);this.roundFrameToPixels(a,s.current?s.current.resolution:r.resolution,s.sourceFrame,s.destinationFrame,r.projection.transform),e&&a.fit(e),t._scissorRectLocal=a}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:i,c:r,d:n}=t;return(Math.abs(i)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect())return!1;if(h.isMatrixRotated(e.worldTransform))return!1;if(h.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const i=t._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(t,e,i,r,n){h.isMatrixRotated(n)||((n=n?o.copyFrom(n):o.identity()).translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.renderer.filter.transformAABB(n,t),t.fit(r),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&l.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;e=this.renderer.renderTexture.current?t.y:this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};let u=h;u.extension={type:s.ExtensionType.RendererSystem,name:"scissor"},s.extensions.add(u),e.ScissorSystem=u},5782:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6510),n=i(1648),s=i(2101);class a extends r.AbstractMaskSystem{constructor(t){super(t),this.glConst=s.settings.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:i}=this.renderer,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;0!==n&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,r,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==n&&(t._colorMask=n,i.colorMask(0!=(1&n),0!=(2&n),0!=(4&n),0!=(8&n))),this._useCurrent()}pop(t){const e=this.renderer.gl;if(0===this.getStackLength())e.disable(e.STENCIL_TEST);else{const i=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,r=i?i._colorMask:15;0!==r&&(i._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==r&&(i._colorMask=r,e.colorMask(0!=(1&r),0!=(2&r),0!=(4&r),0!=(8&r))),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}a.extension={type:n.ExtensionType.RendererSystem,name:"stencil"},n.extensions.add(a),e.StencilSystem=a},4800:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1648);class n{constructor(t){this.renderer=t,this.plugins={}}init(t){for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}n.extension={type:[r.ExtensionType.RendererSystem,r.ExtensionType.CanvasRendererSystem],name:"_plugin"},r.extensions.add(n),e.PluginSystem=n},4910:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(435),n=i(1648);class s{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new r.Matrix,this.transform=null}update(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,i,r){const n=this.projectionMatrix,s=r?-1:1;n.identity(),n.a=1/e.width*2,n.d=s*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-s-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}}s.extension={type:n.ExtensionType.RendererSystem,name:"projection"},n.extensions.add(s),e.ProjectionSystem=s},8399:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(3396),n=i(6268),s=i(7616);class a extends r.BaseTexture{constructor(t={}){"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=s.MSAA_QUALITY.NONE),super(null,t),this.mipmap=s.MIPMAP_MODES.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new n.Framebuffer(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}e.BaseRenderTexture=a},4914:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(435),n=i(1648),s=i(1020);const a=new r.Transform;class o{constructor(t){this.renderer=t,this._tempMatrix=new r.Matrix}generateTexture(t,e){const{region:i,...r}=e||{},n=i||t.getLocalBounds(null,!0);0===n.width&&(n.width=1),0===n.height&&(n.height=1);const o=s.RenderTexture.create({width:n.width,height:n.height,...r});this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const l=t.transform;return t.transform=a,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=l,o}destroy(){}}o.extension={type:[n.ExtensionType.RendererSystem,n.ExtensionType.CanvasRendererSystem],name:"textureGenerator"},n.extensions.add(o),e.GenerateTextureSystem=o},1020:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8399),n=i(5453);class s extends n.Texture{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,i=!0){const r=this.baseTexture.resolution,n=Math.round(t*r)/r,s=Math.round(e*r)/r;this.valid=n>0&&s>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=s,i&&this.baseTexture.resize(n,s),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new s(new r.BaseRenderTexture(t))}}e.RenderTexture=s},6516:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1020),n=i(8399),s=i(2191),a=i(7616);class o{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,i=a.MSAA_QUALITY.NONE){const s=new n.BaseRenderTexture(Object.assign({width:t,height:e,resolution:1,multisample:i},this.textureOptions));return new r.RenderTexture(s)}getOptimalTexture(t,e,i=1,r=a.MSAA_QUALITY.NONE){let n;t=Math.ceil(t*i-1e-6),e=Math.ceil(e*i-1e-6),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?n=r>1?-r:-1:(n=((65535&(t=s.nextPow2(t)))<<16|65535&(e=s.nextPow2(e)))>>>0,r>1&&(n+=4294967296*r)),this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(t,e,r)),o.filterPoolKey=n,o.setResolution(i),o}getFilterTexture(t,e,i){const r=this.getOptimalTexture(t.width,t.height,e||t.resolution,i||a.MSAA_QUALITY.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=!1!==t)for(const t in this.texturePool){const e=this.texturePool[t];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0)}this.texturePool={}}setScreenSize(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){this.enableFullScreen=t.width>0&&t.height>0;for(const t in this.texturePool){if(!(Number(t)<0))continue;const e=this.texturePool[t];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}o.SCREEN_KEY=-1,e.RenderTexturePool=o},2109:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(435),n=i(1648);const s=new r.Rectangle,a=new r.Rectangle;class o{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new r.Rectangle,this.destinationFrame=new r.Rectangle,this.viewportFrame=new r.Rectangle}bind(t=null,e,i){const r=this.renderer;let n,o,l;this.current=t,t?(n=t.baseTexture,l=n.resolution,e||(s.width=t.frame.width,s.height=t.frame.height,e=s),i||(a.x=t.frame.x,a.y=t.frame.y,a.width=e.width,a.height=e.height,i=a),o=n.framebuffer):(l=r.resolution,e||(s.width=r._view.screen.width,s.height=r._view.screen.height,e=s),i||((i=s).width=e.width,i.height=e.height));const h=this.viewportFrame;h.x=i.x*l,h.y=i.y*l,h.width=i.width*l,h.height=i.height*l,t||(h.y=r.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(o,h),this.renderer.projection.update(i,e,l,!o),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)}clear(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.renderer.background.colorRgba;const i=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer._view.screen,n=i.width!==r.width||i.height!==r.height;if(n){let{x:t,y:e,width:i,height:r}=this.viewportFrame;t=Math.round(t),e=Math.round(e),i=Math.round(i),r=Math.round(r),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(t,e,i,r)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),n&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}o.extension={type:n.ExtensionType.RendererSystem,name:"renderTexture"},n.extensions.add(o),e.RenderTextureSystem=o},4353:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1648);class n{constructor(t){this.renderer=t}render(t,e){const i=this.renderer;let r,n,s,a;if(e&&(r=e.renderTexture,n=e.clear,s=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!r,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=s,!i.context.isLost){if(r||(this.lastObjectRendered=t),!a){const e=t.enableTempParent();t.updateTransform(),t.disableTempParent(e)}i.renderTexture.bind(r),i.batch.currentRenderer.start(),(n??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),r&&(e.blit&&i.framebuffer.blit(),r.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}n.extension={type:r.ExtensionType.RendererSystem,name:"objectRenderer"},r.extensions.add(n),e.ObjectRendererSystem=n},1970:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2101),n=i(7616);r.settings.PREFER_ENV=n.ENV.WEBGL2,r.settings.STRICT_TEXTURE_CACHE=!1,Object.defineProperty(e,"settings",{enumerable:!0,get:function(){return r.settings}})},3784:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GLProgram=class{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}},e.IGLUniformData=class{}},9906:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(4956);var r=i(2191),n=i(5928),s=i(5705),a=i(2101),o=i(7616),l=i(4400),h=i(1565);let u=0;const c={};class d{constructor(t,e,i="pixi-shader",r={}){this.extra={},this.id=u++,this.vertexSrc=t||d.defaultVertexSrc,this.fragmentSrc=e||d.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=r,"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),c[i]?(c[i]++,i+=`-${c[i]}`):c[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}\n${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}\n${this.fragmentSrc}`,this.vertexSrc=l.setPrecision(this.vertexSrc,a.settings.PRECISION_VERTEX,o.PRECISION.HIGH),this.fragmentSrc=l.setPrecision(this.fragmentSrc,a.settings.PRECISION_FRAGMENT,h.getMaxFragmentPrecision())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return s.default}static get defaultFragmentSrc(){return n.default}static from(t,e,i){const n=t+e;let s=r.ProgramCache[n];return s||(r.ProgramCache[n]=s=new d(t,e,i)),s}}e.Program=d},7398:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9906),n=i(4240),s=i(2156);class a{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof n.UniformGroup?this.uniformGroup=e:this.uniformGroup=new n.UniformGroup(e):this.uniformGroup=new n.UniformGroup({}),this.disposeRunner=new s.Runner("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const i in e.uniforms){const r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,i){const n=r.Program.from(t,e);return new a(n,i)}}e.Shader=a},9535:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(4956);var r=i(9124),n=i(1366),s=i(1648),a=i(4652),o=i(3738);let l=0;const h={textureCount:0,uboCount:0};class u{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=l++}systemCheck(){if(!a.unsafeEvalSupported())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),e||(h.textureCount=0,h.uboCount=0,this.syncUniformGroup(t.uniformGroup,h)),r}setUniforms(t){const e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,e){const i=this.getGlProgram();t.static&&t.dirtyId===i.uniformDirtyGroups[t.id]||(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))}syncUniforms(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=o.generateUniformsSync(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const i=this.getGlProgram();if(!t.static||0!==t.dirtyId||!i.uniformGroups[t.id]){t.dirtyId=0;const r=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,e);t.buffer.update(),r(i.uniformData,t.uniforms,this.renderer,h,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[e])}createSyncBufferGroup(t,e,i){const{gl:n}=this.renderer;this.renderer.buffer.bind(t.buffer);const s=this.gl.getUniformBlockIndex(e.program,i);e.uniformBufferBindings[i]=this.shader.uniformBindCount,n.uniformBlockBinding(e.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const a=this.getSignature(t,this.shader.program.uniformData,"ubo");let o=this._uboCache[a];if(o||(o=this._uboCache[a]=r.generateUniformBufferSync(t,this.shader.program.uniformData)),t.autoManage){const e=new Float32Array(o.size/4);t.buffer.update(e)}return e.uniformGroups[t.id]=o.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,i){const r=t.uniforms,n=[`${i}-`];for(const t in r)n.push(t),e[t]&&n.push(e[t].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,i=t.program,r=n.generateProgram(e,i);return i.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}u.extension={type:s.ExtensionType.RendererSystem,name:"shader"},s.extensions.add(u),e.ShaderSystem=u},4240:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(4518);let s=0;class a{constructor(t,e,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=s++,this.static=!!e,this.ubo=!!i,t instanceof n.Buffer?(this.buffer=t,this.buffer.type=r.BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new n.Buffer(new Float32Array(1)),this.buffer.type=r.BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,i){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[t]=new a(e,i)}static from(t,e,i){return new a(t,e,i)}static uboFrom(t,e){return new a(t,e??!0,!0)}}e.UniformGroup=a},5928:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},5705:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},7863:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function r(t){let e="";for(let i=0;i<t;++i)i>0&&(e+="\nelse "),i<t-1&&(e+=`if(test == ${i}.0){}`);return e}e.checkMaxIfStatementsInShader=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const n=e.createShader(e.FRAGMENT_SHADER);for(;;){const s=i.replace(/%forloop%/gi,r(t));if(e.shaderSource(n,s),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}},2896:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.compileShader=function(t,e,i){const r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),r}},8663:(t,e)=>{"use strict";function i(t){const e=new Array(t);for(let t=0;t<e.length;t++)e[t]=!1;return e}Object.defineProperty(e,"__esModule",{value:!0}),e.defaultValue=function(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return i(2*e);case"bvec3":return i(3*e);case"bvec4":return i(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}},1366:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(3784),n=i(2896),s=i(8663),a=i(8828),o=i(7153),l=i(1652);e.generateProgram=function(t,e){const i=n.compileShader(t,t.VERTEX_SHADER,e.vertexSrc),h=n.compileShader(t,t.FRAGMENT_SHADER,e.fragmentSrc),u=t.createProgram();t.attachShader(u,i),t.attachShader(u,h);const c=e.extra?.transformFeedbackVaryings;if(c&&("function"!=typeof t.transformFeedbackVaryings||t.transformFeedbackVaryings(u,c.names,"separate"===c.bufferMode?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(u),t.getProgramParameter(u,t.LINK_STATUS)||l.logProgramError(t,u,i,h),e.attributeData=a.getAttributeData(u,t),e.uniformData=o.getUniformData(u,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){const i=Object.keys(e.attributeData);i.sort(((t,e)=>t>e?1:-1));for(let r=0;r<i.length;r++)e.attributeData[i[r]].location=r,t.bindAttribLocation(u,r,i[r]);t.linkProgram(u)}t.deleteShader(i),t.deleteShader(h);const d={};for(const i in e.uniformData){const r=e.uniformData[i];d[i]={location:t.getUniformLocation(u,i),value:s.defaultValue(r.type,r.size)}}return new r.GLProgram(u,d)}},9124:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(4956);var r=i(9145),n=i(4442);function s(t,e,i,r,n){i.buffer.update(n)}const a={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},o={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function l(t){const e=t.map((t=>({data:t,offset:0,dataLen:0,dirty:0})));let i=0,r=0,n=0;for(let t=0;t<e.length;t++){const s=e[t];if(i=o[s.data.type],s.data.size>1&&(i=Math.max(i,16)*s.data.size),s.dataLen=i,r%i!=0&&r<16){const t=r%i%16;r+=t,n+=t}r+i>16?(n=16*Math.ceil(n/16),s.offset=n,n+=i,r=i):(s.offset=n,r+=i,n+=i)}return n=16*Math.ceil(n/16),{uboElements:e,size:n}}function h(t,e){const i=[];for(const r in t)e[r]&&i.push(e[r]);return i.sort(((t,e)=>t.index-e.index)),i}e.createUBOElements=l,e.generateUniformBufferSync=function(t,e){if(!t.autoManage)return{size:0,syncFunc:s};const i=h(t.uniforms,e),{uboElements:u,size:c}=l(i),d=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "];for(let e=0;e<u.length;e++){const i=u[e],s=t.uniforms[i.data.name],l=i.data.name;let h=!1;for(let t=0;t<r.uniformParsers.length;t++){const e=r.uniformParsers[t];if(e.codeUbo&&e.test(i.data,s)){d.push(`offset = ${i.offset/4};`,r.uniformParsers[t].codeUbo(i.data.name,s)),h=!0;break}}if(!h)if(i.data.size>1){const t=n.mapSize(i.data.type),e=Math.max(o[i.data.type]/16,1),r=t/e,s=(4-r%4)%4;d.push(`\n                cv = ud.${l}.value;\n                v = uv.${l};\n                offset = ${i.offset/4};\n\n                t = 0;\n\n                for(var i=0; i < ${i.data.size*e}; i++)\n                {\n                    for(var j = 0; j < ${r}; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ${s};\n                }\n\n                `)}else{const t=a[i.data.type];d.push(`\n                cv = ud.${l}.value;\n                v = uv.${l};\n                offset = ${i.offset/4};\n                ${t};\n                `)}}return d.push("\n       renderer.buffer.update(buffer);\n    "),{size:c,syncFunc:new Function("ud","uv","renderer","syncData","buffer",d.join("\n"))}},e.getUBOData=h},3738:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9145);const n={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},s={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};e.generateUniformsSync=function(t,e){const i=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(const a in t.uniforms){const o=e[a];if(!o){t.uniforms[a]?.group&&(t.uniforms[a].ubo?i.push(`\n                        renderer.shader.syncUniformBufferGroup(uv.${a}, '${a}');\n                    `):i.push(`\n                        renderer.shader.syncUniformGroup(uv.${a}, syncData);\n                    `));continue}const l=t.uniforms[a];let h=!1;for(let t=0;t<r.uniformParsers.length;t++)if(r.uniformParsers[t].test(o,l)){i.push(r.uniformParsers[t].code(a,l)),h=!0;break}if(!h){const t=(1!==o.size||o.isArray?s:n)[o.type].replace("location",`ud["${a}"].location`);i.push(`\n            cu = ud["${a}"];\n            cv = cu.value;\n            v = uv["${a}"];\n            ${t};`)}}return new Function("ud","uv","renderer","syncData",i.join("\n"))}},8828:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4442),n=i(190);e.getAttributeData=function(t,e){const i={},s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let a=0;a<s;a++){const s=e.getActiveAttrib(t,a);if(s.name.startsWith("gl_"))continue;const o=n.mapType(e,s.type),l={type:o,name:s.name,size:r.mapSize(o),location:e.getAttribLocation(t,s.name)};i[s.name]=l}return i}},1565:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7465),n=i(7616);let s;e.getMaxFragmentPrecision=function(){if(!s){s=n.PRECISION.MEDIUM;const t=r.getTestContext();if(t&&t.getShaderPrecisionFormat){const e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);s=e.precision?n.PRECISION.HIGH:n.PRECISION.MEDIUM}}return s}},7465:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(1970);var r=i(7616),n=i(2101);const s={};let a=s;e.getTestContext=function(){if(a===s||a?.isContextLost()){const t=n.settings.ADAPTER.createCanvas();let e;n.settings.PREFER_ENV>=r.ENV.WEBGL2&&(e=t.getContext("webgl2",{})),e||(e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}),e?e.getExtension("WEBGL_draw_buffers"):e=null),a=e}return a}},7153:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8663),n=i(190);e.getUniformData=function(t,e){const i={},s=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<s;a++){const s=e.getActiveUniform(t,a),o=s.name.replace(/\[.*?\]$/,""),l=!!s.name.match(/\[.*?\]$/),h=n.mapType(e,s.type);i[o]={name:o,index:a,type:h,size:s.size,isArray:l,value:r.defaultValue(h,s.size)}}return i}},4956:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2896),n=i(1652),s=i(8663),a=i(1565),o=i(4400),l=i(4442),h=i(190),u=i(3738),c=i(9145),d=i(7465),p=i(7863),f=i(4652);e.compileShader=r.compileShader,e.logProgramError=n.logProgramError,e.defaultValue=s.defaultValue,e.getMaxFragmentPrecision=a.getMaxFragmentPrecision,e.setPrecision=o.setPrecision,e.mapSize=l.mapSize,e.mapType=h.mapType,e.generateUniformsSync=u.generateUniformsSync,e.uniformParsers=c.uniformParsers,e.getTestContext=d.getTestContext,e.checkMaxIfStatementsInShader=p.checkMaxIfStatementsInShader,e.unsafeEvalSupported=f.unsafeEvalSupported},1652:(t,e)=>{"use strict";function i(t,e){const i=t.getShaderSource(e).split("\n").map(((t,e)=>`${e}: ${t}`)),r=t.getShaderInfoLog(e),n=r.split("\n"),s={},a=n.map((t=>parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1")))).filter((t=>!(!t||s[t]||(s[t]=!0,0)))),o=[""];a.forEach((t=>{i[t-1]=`%c${i[t-1]}%c`,o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));const l=i.join("\n");o[0]=l,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...o),console.groupEnd()}Object.defineProperty(e,"__esModule",{value:!0}),e.logProgramError=function(t,e,r,n){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(r,t.COMPILE_STATUS)||i(t,r),t.getShaderParameter(n,t.COMPILE_STATUS)||i(t,n),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}},4442:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};e.mapSize=function(t){return i[t]}},190:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});let i=null;const r={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};e.mapType=function(t,e){if(!i){const e=Object.keys(r);i={};for(let n=0;n<e.length;++n){const s=e[n];i[t[s]]=r[s]}}return i[e]}},4400:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616);e.setPrecision=function(t,e,i){if("precision"!==t.substring(0,9)){let n=e;return e===r.PRECISION.HIGH&&i!==r.PRECISION.HIGH&&(n=r.PRECISION.MEDIUM),`precision ${n} float;\n${t}`}return i!==r.PRECISION.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}},9145:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.uniformParsers=[{test:t=>"float"===t.type&&1===t.size&&!t.isArray,code:t=>`\n            if(uv["${t}"] !== ud["${t}"].value)\n            {\n                ud["${t}"].value = uv["${t}"]\n                gl.uniform1f(ud["${t}"].location, uv["${t}"])\n            }\n            `},{test:(t,e)=>!("sampler2D"!==t.type&&"samplerCube"!==t.type&&"sampler2DArray"!==t.type||1!==t.size||t.isArray||null!=e&&void 0===e.castToBaseTexture),code:t=>`t = syncData.textureCount++;\n\n            renderer.texture.bind(uv["${t}"], t);\n\n            if(ud["${t}"].value !== t)\n            {\n                ud["${t}"].value = t;\n                gl.uniform1i(ud["${t}"].location, t);\n; // eslint-disable-line max-len\n            }`},{test:(t,e)=>"mat3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.a,code:t=>`\n            gl.uniformMatrix3fv(ud["${t}"].location, false, uv["${t}"].toArray(true));\n            `,codeUbo:t=>`\n                var ${t}_matrix = uv.${t}.toArray(true);\n\n                data[offset] = ${t}_matrix[0];\n                data[offset+1] = ${t}_matrix[1];\n                data[offset+2] = ${t}_matrix[2];\n        \n                data[offset + 4] = ${t}_matrix[3];\n                data[offset + 5] = ${t}_matrix[4];\n                data[offset + 6] = ${t}_matrix[5];\n        \n                data[offset + 8] = ${t}_matrix[6];\n                data[offset + 9] = ${t}_matrix[7];\n                data[offset + 10] = ${t}_matrix[8];\n            `},{test:(t,e)=>"vec2"===t.type&&1===t.size&&!t.isArray&&void 0!==e.x,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["${t}"].location, v.x, v.y);\n                }`,codeUbo:t=>`\n                v = uv.${t};\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            `},{test:t=>"vec2"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["${t}"].location, v[0], v[1]);\n                }\n            `},{test:(t,e)=>"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.width,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["${t}"].location, v.x, v.y, v.width, v.height)\n                }`,codeUbo:t=>`\n                    v = uv.${t};\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                `},{test:t=>"vec4"===t.type&&1===t.size&&!t.isArray,code:t=>`\n                cv = ud["${t}"].value;\n                v = uv["${t}"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["${t}"].location, v[0], v[1], v[2], v[3])\n                }`}]},4652:(t,e)=>{"use strict";let i;Object.defineProperty(e,"__esModule",{value:!0}),e.unsafeEvalSupported=function(){if("boolean"==typeof i)return i;try{const t=new Function("param1","param2","param3","return param1[param2] === param3;");i=!0===t({a:"b"},"a","b")}catch(t){i=!1}return i}},3382:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1648);class n{constructor(t){this.renderer=t}run(t){const e=this.renderer;e.emitWithCustomOptions(e.runners.init,t),t.hello&&console.log(`PixiJS 7.0.4 - ${e.rendererLogId} - https://pixijs.com`),e.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}}n.extension={type:[r.ExtensionType.RendererSystem,r.ExtensionType.CanvasRendererSystem],name:"startup"},r.extensions.add(n),e.StartupSystem=n},7387:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616);class n{constructor(){this.data=0,this.blendMode=r.BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(t){!!(1&this.data)!==t&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(t){!!(2&this.data)!==t&&(this.data^=2)}get culling(){return!!(4&this.data)}set culling(t){!!(4&this.data)!==t&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(t){!!(8&this.data)!==t&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(t){!!(32&this.data)!==t&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(t){!!(16&this.data)!==t&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==r.BLEND_MODES.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){const t=new n;return t.depthTest=!1,t.blend=!0,t}}e.State=n},8389:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8568),n=i(7387),s=i(7616),a=i(1648);const o=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=s.BLEND_MODES.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new n.State,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=r.mapWebGLBlendModesToPixi(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,i=0;for(;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(o.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(o.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(i,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};let l=o;l.extension={type:a.ExtensionType.RendererSystem,name:"state"},a.extensions.add(l),e.StateSystem=l},8568:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616);e.mapWebGLBlendModesToPixi=function(t,e=[]){return e[r.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.ADD]=[t.ONE,t.ONE],e[r.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.NONE]=[0,0],e[r.BLEND_MODES.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[r.BLEND_MODES.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[r.BLEND_MODES.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[r.BLEND_MODES.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[r.BLEND_MODES.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[r.BLEND_MODES.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[r.BLEND_MODES.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}},4807:()=>{},8065:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2156),n=i(2191);class s extends n.EventEmitter{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter((e=>t.systems[e])),i=[...e,...Object.keys(t.systems).filter((t=>!e.includes(t)))];for(const e of i)this.addSystem(t.systems[e],e)}addRunners(...t){t.forEach((t=>{this.runners[t]=new r.Runner(t)}))}addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const t in this.runners)this.runners[t].add(i);return this}emitWithCustomOptions(t,e){const i=Object.keys(this._systemsHash);t.items.forEach((r=>{const n=i.find((t=>this._systemsHash[t]===r));r[t.name](e[n])}))}destroy(){Object.values(this.runners).forEach((t=>{t.destroy()})),this._systemsHash={}}}e.SystemManager=s},9774:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8994),n=i(5309),s=i(1673),a=i(6548),o=i(8911),l=i(3839),h=i(9832),u=i(5782),c=i(4910),d=i(2109),p=i(9535),f=i(8389),m=i(1811),g=i(1546),_=i(4914),y=i(1110),v=i(5711),x=i(4800),b=i(8065),E=i(3382),T=i(8228);e.FilterSystem=r.FilterSystem,e.BatchSystem=n.BatchSystem,e.ContextSystem=s.ContextSystem,e.FramebufferSystem=a.FramebufferSystem,e.GeometrySystem=o.GeometrySystem,e.MaskSystem=l.MaskSystem,e.ScissorSystem=h.ScissorSystem,e.StencilSystem=u.StencilSystem,e.ProjectionSystem=c.ProjectionSystem,e.RenderTextureSystem=d.RenderTextureSystem,e.ShaderSystem=p.ShaderSystem,e.StateSystem=f.StateSystem,e.TextureGCSystem=m.TextureGCSystem,e.TextureSystem=g.TextureSystem,e.GenerateTextureSystem=_.GenerateTextureSystem,e.BackgroundSystem=y.BackgroundSystem,e.ViewSystem=v.ViewSystem,e.PluginSystem=x.PluginSystem,e.SystemManager=b.SystemManager,e.StartupSystem=E.StartupSystem,e.TransformFeedbackSystem=T.TransformFeedbackSystem},3396:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2191),n=i(7616),s=i(9421),a=i(5737),o=i(1105),l=i(2101);const h={scaleMode:n.SCALE_MODES.NEAREST,format:n.FORMATS.RGBA,alphaMode:n.ALPHA_MODES.NPM},u=class extends r.EventEmitter{constructor(t=null,e=null){super(),e=e||{};const{alphaMode:i,mipmap:a,anisotropicLevel:h,scaleMode:u,width:c,height:d,wrapMode:p,format:f,type:m,target:g,resolution:_,resourceOptions:y}=e;!t||t instanceof s.Resource||((t=o.autoDetectResource(t,y)).internal=!0),this.resolution=_||l.settings.RESOLUTION,this.width=Math.round((c||0)*this.resolution)/this.resolution,this.height=Math.round((d||0)*this.resolution)/this.resolution,this._mipmap=a??l.settings.MIPMAP_TEXTURES,this.anisotropicLevel=h??l.settings.ANISOTROPIC_LEVEL,this._wrapMode=p||l.settings.WRAP_MODE,this._scaleMode=u??l.settings.SCALE_MODE,this.format=f||n.FORMATS.RGBA,this.type=m||n.TYPES.UNSIGNED_BYTE,this.target=g||n.TARGETS.TEXTURE_2D,this.alphaMode=i??n.ALPHA_MODES.UNPACK,this.uid=r.uid(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=c>0&&d>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let i;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this}setSize(t,e,i){return i=i||this.resolution,this.setRealSize(t*i,e*i,i)}setRealSize(t,e,i){return this.resolution=i||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=r.isPow2(this.realWidth)&&r.isPow2(this.realHeight)}setResolution(t){const e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete r.BaseTextureCache[this.cacheId],delete r.TextureCache[this.cacheId],this.cacheId=null),this.dispose(),u.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,i=l.settings.STRICT_TEXTURE_CACHE){const n="string"==typeof t;let s=null;if(n)s=t;else{if(!t._pixiId){const i=e?.pixiIdPrefix||"pixiid";t._pixiId=`${i}_${r.uid()}`}s=t._pixiId}let a=r.BaseTextureCache[s];if(n&&i&&!a)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return a||(a=new u(t,e),a.cacheId=s,u.addToCache(a,s)),a}static fromBuffer(t,e,i,r){t=t||new Float32Array(e*i*4);const s=new a.BufferResource(t,{width:e,height:i}),o=t instanceof Float32Array?n.TYPES.FLOAT:n.TYPES.UNSIGNED_BYTE;return new u(s,Object.assign({},h,r||{width:e,height:i,type:o}))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),r.BaseTextureCache[e]&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),r.BaseTextureCache[e]=t)}static removeFromCache(t){if("string"==typeof t){const e=r.BaseTextureCache[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete r.BaseTextureCache[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete r.BaseTextureCache[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};let c=u;c._globalBatch=0,e.BaseTexture=c},701:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616);e.GLTexture=class{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=r.TYPES.UNSIGNED_BYTE,this.internalFormat=r.FORMATS.RGBA,this.samplerType=0}}},5453:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(435),n=i(2101),s=i(2191),a=i(9137),o=i(3396),l=i(6487);const h=new l.TextureUvs;function u(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}class c extends s.EventEmitter{constructor(t,e,i,n,s,a){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new r.Rectangle(0,0,1,1)),t instanceof c&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=n,this.valid=!1,this._uvs=h,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(s||0),!0===s)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new r.Point(a.x,a.y):new r.Point(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:t}=this.baseTexture;t?.url&&s.TextureCache[t.url]&&c.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,c.removeFromCache(this),this.textureCacheIds=null}clone(){const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),i=new c(this.baseTexture,!this.noFrame&&t,e,this.trim?.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===h&&(this._uvs=new l.TextureUvs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},i=n.settings.STRICT_TEXTURE_CACHE){const r="string"==typeof t;let a=null;if(r)a=t;else if(t instanceof o.BaseTexture){if(!t.cacheId){const i=e?.pixiIdPrefix||"pixiid";t.cacheId=`${i}-${s.uid()}`,o.BaseTexture.addToCache(t,t.cacheId)}a=t.cacheId}else{if(!t._pixiId){const i=e?.pixiIdPrefix||"pixiid";t._pixiId=`${i}_${s.uid()}`}a=t._pixiId}let l=s.TextureCache[a];if(r&&i&&!l)throw new Error(`The cacheId "${a}" does not exist in TextureCache.`);return l||t instanceof o.BaseTexture?!l&&t instanceof o.BaseTexture&&(l=new c(t),c.addToCache(l,a)):(e.resolution||(e.resolution=s.getResolutionOfUrl(t)),l=new c(new o.BaseTexture(t,e)),l.baseTexture.cacheId=a,o.BaseTexture.addToCache(l.baseTexture,a),c.addToCache(l,a)),l}static fromURL(t,e){const i=Object.assign({autoLoad:!1},e?.resourceOptions),r=c.from(t,Object.assign({resourceOptions:i},e),!1),n=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):n.load().then((()=>Promise.resolve(r)))}static fromBuffer(t,e,i,r){return new c(o.BaseTexture.fromBuffer(t,e,i,r))}static fromLoader(t,e,i,r){const l=new o.BaseTexture(t,Object.assign({scaleMode:n.settings.SCALE_MODE,resolution:s.getResolutionOfUrl(e)},r)),{resource:h}=l;h instanceof a.ImageResource&&(h.url=e);const u=new c(l);return i||(i=e),o.BaseTexture.addToCache(u.baseTexture,i),c.addToCache(u,i),i!==e&&(o.BaseTexture.addToCache(u.baseTexture,e),c.addToCache(u,e)),u.baseTexture.valid?Promise.resolve(u):new Promise((t=>{u.baseTexture.once("loaded",(()=>t(u)))}))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),s.TextureCache[e]&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),s.TextureCache[e]=t)}static removeFromCache(t){if("string"==typeof t){const e=s.TextureCache[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete s.TextureCache[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)s.TextureCache[t.textureCacheIds[e]]===t&&delete s.TextureCache[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:i,width:r,height:n}=t,s=e+r>this.baseTexture.width,a=i+n>this.baseTexture.height;if(s||a){const t=s&&a?"and":"or",o=`X: ${e} + ${r} = ${e+r} > ${this.baseTexture.width}`,l=`Y: ${i} + ${n} = ${i+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${o} ${t} ${l}`)}this.valid=r&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return c._EMPTY||(c._EMPTY=new c(new o.BaseTexture),u(c._EMPTY),u(c._EMPTY.baseTexture)),c._EMPTY}static get WHITE(){if(!c._WHITE){const t=n.settings.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),c._WHITE=new c(o.BaseTexture.from(t)),u(c._WHITE),u(c._WHITE.baseTexture)}return c._WHITE}}e.Texture=c},1811:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(2101),s=i(1648);class a{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=n.settings.GC_MAX_IDLE,this.checkCountMax=n.settings.GC_MAX_CHECK_COUNT,this.mode=n.settings.GC_MODE}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==r.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let i=!1;for(let r=0;r<e.length;r++){const n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[r]=null,i=!0)}if(i){let t=0;for(let i=0;i<e.length;i++)null!==e[i]&&(e[t++]=e[i]);e.length=t}}unload(t){const e=this.renderer.texture,i=t._texture;i&&!i.framebuffer&&e.destroyTexture(i);for(let e=t.children.length-1;e>=0;e--)this.unload(t.children[e])}destroy(){this.renderer=null}}a.extension={type:s.ExtensionType.RendererSystem,name:"textureGC"},s.extensions.add(a),e.TextureGCSystem=a},7772:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(435);const n=new r.Matrix;e.TextureMatrix=class{constructor(t,e){this._texture=t,this.mapCoord=new r.Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){void 0===e&&(e=t);const i=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e}update(t){const e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const r=e.orig,s=e.trim;s&&(n.set(r.width/s.width,0,0,r.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(n));const a=e.baseTexture,o=this.uClampFrame,l=this.clampMargin/a.resolution,h=this.clampOffset;return o[0]=(e._frame.x+l+h)/a.width,o[1]=(e._frame.y+l+h)/a.height,o[2]=(e._frame.x+e._frame.width-l+h)/a.width,o[3]=(e._frame.y+e._frame.height-l+h)/a.height,this.uClampOffset[0]=h/a.realWidth,this.uClampOffset[1]=h/a.realHeight,this.isSimple=e._frame.width===a.width&&e._frame.height===a.height&&0===e.rotate,!0}}},1546:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9476),n=i(3396),s=i(701),a=i(2191),o=i(7616),l=i(1648);class h{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new n.BaseTexture,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=r.mapTypeAndFormatToInternalFormat(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let t=0;t<e;t++)this.boundTextures[t]=null;this.emptyTextures={};const i=new s.GLTexture(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new s.GLTexture(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let e=0;e<6;e++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let t=0;t<this.boundTextures.length;t++)this.bind(null,t)}bind(t,e=0){const{gl:i}=this;if(t=t?.castToBaseTexture(),t?.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let t=0;t<i.length;t++)i[t]===this.unknownTexture&&this.bind(null,t)}for(let r=0;r<i.length;r++)i[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),i[r]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:i,CONTEXT_UID:r}=this;if(i)for(let i=t-1;i>=0;--i){const t=e[i];t&&t._glTextures[r].samplerType!==o.SAMPLER_TYPES.FLOAT&&this.renderer.texture.unbind(t)}}initTexture(t){const e=new s.GLTexture(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){e.internalFormat=this.internalFormats[t.type]?.[t.format]??t.format,2===this.webGLVersion&&t.type===o.TYPES.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const i=this.renderer;if(this.initTextureType(t,e),t.resource?.upload(i,t,e))e.samplerType!==o.SAMPLER_TYPES.FLOAT&&(this.hasIntegerTextures=!0);else{const r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,e.internalFormat,r,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:i}=this;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const e=this.managedTextures.indexOf(t);-1!==e&&a.removeItems(this.managedTextures,e,1)}}updateTextureStyle(t){const e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==o.MIPMAP_MODES.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=o.WRAP_MODES.CLAMP,t.resource?.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const i=this.gl;if(e.mipmap&&t.mipmap!==o.MIPMAP_MODES.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===o.SCALE_MODES.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const e=this.renderer.context.extensions.anisotropicFiltering;if(e&&t.anisotropicLevel>0&&t.scaleMode===o.SCALE_MODES.LINEAR){const r=Math.min(t.anisotropicLevel,i.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,e.TEXTURE_MAX_ANISOTROPY_EXT,r)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===o.SCALE_MODES.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===o.SCALE_MODES.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}h.extension={type:l.ExtensionType.RendererSystem,name:"texture"},l.extensions.add(h),e.TextureSystem=h},6487:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(435);e.TextureUvs=class{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,i){const n=e.width,s=e.height;if(i){const e=t.width/2/n,a=t.height/2/s,o=t.x/n+e,l=t.y/s+a;i=r.groupD8.add(i,r.groupD8.NW),this.x0=o+e*r.groupD8.uX(i),this.y0=l+a*r.groupD8.uY(i),i=r.groupD8.add(i,2),this.x1=o+e*r.groupD8.uX(i),this.y1=l+a*r.groupD8.uY(i),i=r.groupD8.add(i,2),this.x2=o+e*r.groupD8.uX(i),this.y2=l+a*r.groupD8.uY(i),i=r.groupD8.add(i,2),this.x3=o+e*r.groupD8.uX(i),this.y3=l+a*r.groupD8.uY(i)}else this.x0=t.x/n,this.y0=t.y/s,this.x1=(t.x+t.width)/n,this.y1=t.y/s,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/s,this.x3=t.x/n,this.y3=(t.y+t.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}},4627:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9421),n=i(3396),s=i(1105);class a extends r.Resource{constructor(t,e){const{width:i,height:r}=e||{};super(i,r),this.items=[],this.itemDirtyIds=[];for(let e=0;e<t;e++){const t=new n.BaseTexture;this.items.push(t),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof r.Resource?this.addResourceAt(t[i],i):this.addResourceAt(s.autoDetectResource(t[i],e),i))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map((t=>t.resource)).filter((t=>t)).map((t=>t.load()));return this._load=Promise.all(t).then((()=>{const{realWidth:t,realHeight:e}=this.items[0];return this.resize(t,e),Promise.resolve(this)})),this._load}}e.AbstractMultiResource=a},2696:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(4627);class s extends n.AbstractMultiResource{constructor(t,e){const{width:i,height:r}=e||{};let n,s;Array.isArray(t)?(n=t,s=t.length):s=t,super(s,{width:i,height:r}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this}bind(t){super.bind(t),t.target=r.TARGETS.TEXTURE_2D_ARRAY}upload(t,e,i){const{length:r,itemDirtyIds:n,items:s}=this,{gl:a}=t;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,r,0,e.format,i.type,null);for(let t=0;t<r;t++){const r=s[t];n[t]<r.dirtyId&&(n[t]=r.dirtyId,r.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,t,r.resource.width,r.resource.height,1,e.format,i.type,r.resource.source))}return!0}}e.ArrayResource=s},3748:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(2191),s=i(9421);class a extends s.Resource{constructor(t){const e=t;super(e.naturalWidth||e.videoWidth||e.width,e.naturalHeight||e.videoHeight||e.height),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,i){void 0!==i||e.startsWith("data:")?!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous"):t.crossOrigin=n.determineCrossOrigin(e)}upload(t,e,i,n){const s=t.gl,a=e.realWidth,o=e.realHeight;if(n=n||this.source,"undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement){if(!n.complete||0===n.naturalWidth)return!1}else if("undefined"!=typeof HTMLVideoElement&&n instanceof HTMLVideoElement&&n.readyState<=1&&0===n.buffered.length)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===r.ALPHA_MODES.UNPACK),this.noSubImage||e.target!==s.TEXTURE_2D||i.width!==a||i.height!==o?(i.width=a,i.height=o,s.texImage2D(e.target,0,i.internalFormat,e.format,i.type,n)):s.texSubImage2D(s.TEXTURE_2D,0,0,0,e.format,i.type,n),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(e,i),super.update()}dispose(){this.source=null}}e.BaseImageResource=a},5737:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9421),n=i(7616);class s extends r.Resource{constructor(t,e){const{width:i,height:r}=e||{};if(!i||!r)throw new Error("BufferResource width or height invalid");super(i,r),this.data=t}upload(t,e,i){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===n.ALPHA_MODES.UNPACK);const s=e.realWidth,a=e.realHeight;return i.width===s&&i.height===a?r.texSubImage2D(e.target,0,0,0,s,a,e.format,i.type,this.data):(i.width=s,i.height=a,r.texImage2D(e.target,0,i.internalFormat,s,a,0,e.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}e.BufferResource=s},544:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(3748);class n extends r.BaseImageResource{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return!!(e&&t instanceof e)||globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}e.CanvasResource=n},73:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4627),n=i(7616);const s=class extends r.AbstractMultiResource{constructor(t,e){const{width:i,height:r,autoLoad:a,linkBaseTexture:o}=e||{};if(t&&t.length!==s.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:i,height:r});for(let t=0;t<s.SIDES;t++)this.items[t].target=n.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+t;this.linkBaseTexture=!1!==o,t&&this.initFromArray(t,e),!1!==a&&this.load()}bind(t){super.bind(t),t.target=n.TARGETS.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,i){if(void 0===i&&(i=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=n.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,i){const r=this.itemDirtyIds;for(let n=0;n<s.SIDES;n++){const s=this.items[n];(r[n]<s.dirtyId||i.dirtyId<e.dirtyId)&&(s.valid&&s.resource?(s.resource.upload(t,s,i),r[n]=s.dirtyId):r[n]<-1&&(t.gl.texImage2D(s.target,0,i.internalFormat,e.realWidth,e.realHeight,0,e.format,i.type,null),r[n]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===s.SIDES}};let a=s;a.SIDES=6,e.CubeResource=a},911:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(5737);class s extends n.BufferResource{upload(t,e,i){const n=t.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===r.ALPHA_MODES.UNPACK);const s=e.realWidth,a=e.realHeight;return i.width===s&&i.height===a?n.texSubImage2D(e.target,0,0,0,s,a,e.format,i.type,this.data):(i.width=s,i.height=a,n.texImage2D(e.target,0,i.internalFormat,s,a,0,e.format,i.type,this.data)),!0}}e.DepthResource=s},1638:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(2101),s=i(3748);class a extends s.BaseImageResource{constructor(t,e){var i=(...t)=>{super(...t)};e=e||{},"string"==typeof t?(i(a.EMPTY),this.url=t):(i(t),this.url=null),this.crossOrigin=e.crossOrigin??!0,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,this._load=null,!1!==e.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((async(t,e)=>{if(null!==this.url)try{const e=await n.settings.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const i=await e.blob();if(this.destroyed)return;const s=await createImageBitmap(i,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===r.ALPHA_MODES.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=s,this.update(),t(this)}catch(t){if(this.destroyed)return;e(t),this.onError.emit(t)}else t(this)}))),this._load}upload(t,e,i){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),super.upload(t,e,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&"undefined"!=typeof ImageBitmap&&("string"==typeof t||t instanceof ImageBitmap)}static get EMPTY(){return a._EMPTY=a._EMPTY??n.settings.ADAPTER.createCanvas(0,0),a._EMPTY}}e.ImageBitmapResource=a},9137:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(2101),s=i(3748);class a extends s.BaseImageResource{constructor(t,e){if(e=e||{},"string"==typeof t){const i=new Image;s.BaseImageResource.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??n.settings.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof e.alphaMode?e.alphaMode:null,this.bitmap=null,this._load=null,!1!==e.autoLoad&&this.load()}load(t){return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise(((t,e)=>{const i=this.source;this.url=i.src;const r=()=>{this.destroyed||(i.onload=null,i.onerror=null,this.resize(i.width,i.height),this._load=null,this.createBitmap?t(this.process()):t(this))};i.complete&&i.src?r():(i.onload=r,i.onerror=t=>{e(t),this.onError.emit(t)})}))),this._load}process(){const t=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,i=!t.crossOrigin||"anonymous"===t.crossOrigin;return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then((t=>t.blob())).then((i=>e(i,0,0,t.width,t.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===r.ALPHA_MODES.UNPACK?"premultiply":"none"}))).then((t=>this.destroyed?Promise.reject():(this.bitmap=t,this.update(),this._process=null,Promise.resolve(this)))),this._process}upload(t,e,i){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,i,this.bitmap),!this.preserveBitmap){let t=!0;const r=e._glTextures;for(const n in r){const s=r[n];if(s!==i&&s.dirtyId!==e.dirtyId){t=!1;break}}t&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return"undefined"!=typeof HTMLImageElement&&("string"==typeof t||t instanceof HTMLImageElement)}}e.ImageResource=a},9421:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2156);e.Resource=class{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new r.Runner("setRealSize"),this.onUpdate=new r.Runner("update"),this.onError=new r.Runner("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}},3868:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2191),n=i(3748),s=i(2101);const a=class extends n.BaseImageResource{constructor(t,e){e=e||{},super(s.settings.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,!1!==e.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise((t=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),t(this)},a.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}))),this._load}_loadSvg(){const t=new Image;n.BaseImageResource.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,i=t.height;if(!e||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let n=e*this.scale,s=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(n=this._overrideWidth||this._overrideHeight/i*e,s=this._overrideHeight||this._overrideWidth/e*i),n=Math.round(n),s=Math.round(s);const a=this.source;a.width=n,a.height=s,a._pixiId=`canvas_${r.uid()}`,a.getContext("2d").drawImage(t,0,0,e,i,0,0,n,s),this._resolve(),this._resolve=null}}static getSize(t){const e=a.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return"svg"===e||"string"==typeof t&&t.startsWith("data:image/svg+xml")||"string"==typeof t&&a.SVG_XML.test(t)}};let o=a;o.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,o.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e.SVGResource=o},1540:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(3748),n=i(6082);const s=class extends r.BaseImageResource{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const i=document.createElement("video");i.setAttribute("preload","auto"),i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]);const n=t[0].src||t[0];r.BaseImageResource.crossOrigin(i,n,e.crossorigin);for(let e=0;e<t.length;++e){const r=document.createElement("source");let{src:n,mime:a}=t[e];n=n||t[e];const o=n.split("?").shift().toLowerCase(),l=o.slice(o.lastIndexOf(".")+1);a=a||s.MIME_TYPES[l]||`video/${l}`,r.src=n,r.type=a,i.appendChild(r)}t=i}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==e.autoLoad&&this.load()}update(t=0){if(!this.destroyed){const t=n.Ticker.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e=>{this.valid?e(this):(this._resolve=e,t.load())})),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(n.Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(n.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._isConnectedToTicker&&(n.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1);const t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(n.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(n.Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t)}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||s.TYPES.includes(e)}};let a=s;a.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],a.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e.VideoResource=a},1105:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=[];e.INSTALLED=i,e.autoDetectResource=function(t,e){if(!t)return null;let r="";if("string"==typeof t){const e=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);e&&(r=e[1].toLowerCase())}for(let n=i.length-1;n>=0;--n){const s=i[n];if(s.test&&s.test(t,r))return new s(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}},4535:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1105),n=i(2696),s=i(5737),a=i(544),o=i(73),l=i(9137),h=i(3868),u=i(1540),c=i(1638),d=i(9421),p=i(3748),f=i(4627);r.INSTALLED.push(c.ImageBitmapResource,l.ImageResource,a.CanvasResource,u.VideoResource,h.SVGResource,s.BufferResource,o.CubeResource,n.ArrayResource),e.INSTALLED=r.INSTALLED,e.autoDetectResource=r.autoDetectResource,e.ArrayResource=n.ArrayResource,e.BufferResource=s.BufferResource,e.CanvasResource=a.CanvasResource,e.CubeResource=o.CubeResource,e.ImageResource=l.ImageResource,e.SVGResource=h.SVGResource,e.VideoResource=u.VideoResource,e.ImageBitmapResource=c.ImageBitmapResource,e.Resource=d.Resource,e.BaseImageResource=p.BaseImageResource,e.AbstractMultiResource=f.AbstractMultiResource},9476:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616);e.mapTypeAndFormatToInternalFormat=function(t){let e;return e="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?{[r.TYPES.UNSIGNED_BYTE]:{[r.FORMATS.RGBA]:t.RGBA8,[r.FORMATS.RGB]:t.RGB8,[r.FORMATS.RG]:t.RG8,[r.FORMATS.RED]:t.R8,[r.FORMATS.RGBA_INTEGER]:t.RGBA8UI,[r.FORMATS.RGB_INTEGER]:t.RGB8UI,[r.FORMATS.RG_INTEGER]:t.RG8UI,[r.FORMATS.RED_INTEGER]:t.R8UI,[r.FORMATS.ALPHA]:t.ALPHA,[r.FORMATS.LUMINANCE]:t.LUMINANCE,[r.FORMATS.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[r.TYPES.BYTE]:{[r.FORMATS.RGBA]:t.RGBA8_SNORM,[r.FORMATS.RGB]:t.RGB8_SNORM,[r.FORMATS.RG]:t.RG8_SNORM,[r.FORMATS.RED]:t.R8_SNORM,[r.FORMATS.RGBA_INTEGER]:t.RGBA8I,[r.FORMATS.RGB_INTEGER]:t.RGB8I,[r.FORMATS.RG_INTEGER]:t.RG8I,[r.FORMATS.RED_INTEGER]:t.R8I},[r.TYPES.UNSIGNED_SHORT]:{[r.FORMATS.RGBA_INTEGER]:t.RGBA16UI,[r.FORMATS.RGB_INTEGER]:t.RGB16UI,[r.FORMATS.RG_INTEGER]:t.RG16UI,[r.FORMATS.RED_INTEGER]:t.R16UI,[r.FORMATS.DEPTH_COMPONENT]:t.DEPTH_COMPONENT16},[r.TYPES.SHORT]:{[r.FORMATS.RGBA_INTEGER]:t.RGBA16I,[r.FORMATS.RGB_INTEGER]:t.RGB16I,[r.FORMATS.RG_INTEGER]:t.RG16I,[r.FORMATS.RED_INTEGER]:t.R16I},[r.TYPES.UNSIGNED_INT]:{[r.FORMATS.RGBA_INTEGER]:t.RGBA32UI,[r.FORMATS.RGB_INTEGER]:t.RGB32UI,[r.FORMATS.RG_INTEGER]:t.RG32UI,[r.FORMATS.RED_INTEGER]:t.R32UI,[r.FORMATS.DEPTH_COMPONENT]:t.DEPTH_COMPONENT24},[r.TYPES.INT]:{[r.FORMATS.RGBA_INTEGER]:t.RGBA32I,[r.FORMATS.RGB_INTEGER]:t.RGB32I,[r.FORMATS.RG_INTEGER]:t.RG32I,[r.FORMATS.RED_INTEGER]:t.R32I},[r.TYPES.FLOAT]:{[r.FORMATS.RGBA]:t.RGBA32F,[r.FORMATS.RGB]:t.RGB32F,[r.FORMATS.RG]:t.RG32F,[r.FORMATS.RED]:t.R32F,[r.FORMATS.DEPTH_COMPONENT]:t.DEPTH_COMPONENT32F},[r.TYPES.HALF_FLOAT]:{[r.FORMATS.RGBA]:t.RGBA16F,[r.FORMATS.RGB]:t.RGB16F,[r.FORMATS.RG]:t.RG16F,[r.FORMATS.RED]:t.R16F},[r.TYPES.UNSIGNED_SHORT_5_6_5]:{[r.FORMATS.RGB]:t.RGB565},[r.TYPES.UNSIGNED_SHORT_4_4_4_4]:{[r.FORMATS.RGBA]:t.RGBA4},[r.TYPES.UNSIGNED_SHORT_5_5_5_1]:{[r.FORMATS.RGBA]:t.RGB5_A1},[r.TYPES.UNSIGNED_INT_2_10_10_10_REV]:{[r.FORMATS.RGBA]:t.RGB10_A2,[r.FORMATS.RGBA_INTEGER]:t.RGB10_A2UI},[r.TYPES.UNSIGNED_INT_10F_11F_11F_REV]:{[r.FORMATS.RGB]:t.R11F_G11F_B10F},[r.TYPES.UNSIGNED_INT_5_9_9_9_REV]:{[r.FORMATS.RGB]:t.RGB9_E5},[r.TYPES.UNSIGNED_INT_24_8]:{[r.FORMATS.DEPTH_STENCIL]:t.DEPTH24_STENCIL8},[r.TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[r.FORMATS.DEPTH_STENCIL]:t.DEPTH32F_STENCIL8}}:{[r.TYPES.UNSIGNED_BYTE]:{[r.FORMATS.RGBA]:t.RGBA,[r.FORMATS.RGB]:t.RGB,[r.FORMATS.ALPHA]:t.ALPHA,[r.FORMATS.LUMINANCE]:t.LUMINANCE,[r.FORMATS.LUMINANCE_ALPHA]:t.LUMINANCE_ALPHA},[r.TYPES.UNSIGNED_SHORT_5_6_5]:{[r.FORMATS.RGB]:t.RGB},[r.TYPES.UNSIGNED_SHORT_4_4_4_4]:{[r.FORMATS.RGBA]:t.RGBA},[r.TYPES.UNSIGNED_SHORT_5_5_5_1]:{[r.FORMATS.RGBA]:t.RGBA}},e}},3574:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2156);e.TransformFeedback=class{constructor(){this._glTransformFeedbacks={},this.buffers=[],this.disposeRunner=new r.Runner("disposeTransformFeedback")}bindBuffer(t,e){this.buffers[t]=e}destroy(){this.disposeRunner.emit(this,!1)}}},8228:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1648);class n{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,r=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:i,renderer:r}=this;e&&r.shader.bind(e),i.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:i,CONTEXT_UID:r}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[r]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let n=0;n<t.buffers.length;n++){const s=t.buffers[n];s&&(i.buffer.update(s),s._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,n,s._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){const i=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let i=0;i<t.buffers.length;i++){const r=t.buffers[i];if(!r)continue;const s=r._glBuffers[this.CONTEXT_UID];s&&(s.refCount--,0!==s.refCount||e||n.dispose(r,e))}i&&(e||r.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}n.extension={type:r.ExtensionType.RendererSystem,name:"transformFeedback"},r.extensions.add(n),e.TransformFeedbackSystem=n},342:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2736);class n extends r.Geometry{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}e.Quad=n},2953:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2736),n=i(4518);class s extends r.Geometry{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new n.Buffer(this.vertices),this.uvBuffer=new n.Buffer(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}e.QuadUv=s},5711:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1648),n=i(435),s=i(2101);class a{constructor(t){this.renderer=t}init(t){this.screen=new n.Rectangle(0,0,t.width,t.height),this.element=t.view||s.settings.ADAPTER.createCanvas(),this.resolution=t.resolution||s.settings.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const i=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=i,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",i,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){t&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}a.extension={type:[r.ExtensionType.RendererSystem,r.ExtensionType.CanvasRendererSystem],name:"_view"},r.extensions.add(a),e.ViewSystem=a},7966:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);e.Bounds=class{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?r.Rectangle.EMPTY:((t=t||new r.Rectangle(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:i,b:r,c:n,d:s,tx:a,ty:o}=t,l=i*e.x+n*e.y+a,h=r*e.x+s*e.y+o;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,h),this.maxY=Math.max(this.maxY,h)}addQuad(t){let e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],a=t[1];e=s<e?s:e,i=a<i?a:i,r=s>r?s:r,n=a>n?a:n,s=t[2],a=t[3],e=s<e?s:e,i=a<i?a:i,r=s>r?s:r,n=a>n?a:n,s=t[4],a=t[5],e=s<e?s:e,i=a<i?a:i,r=s>r?s:r,n=a>n?a:n,s=t[6],a=t[7],e=s<e?s:e,i=a<i?a:i,r=s>r?s:r,n=a>n?a:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n}addFrame(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)}addFrameMatrix(t,e,i,r,n){const s=t.a,a=t.b,o=t.c,l=t.d,h=t.tx,u=t.ty;let c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,m=s*e+o*i+h,g=a*e+l*i+u;c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,m=s*r+o*i+h,g=a*r+l*i+u,c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,m=s*e+o*n+h,g=a*e+l*n+u,c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,m=s*r+o*n+h,g=a*r+l*n+u,c=m<c?m:c,d=g<d?g:d,p=m>p?m:p,f=g>f?g:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f}addVertexData(t,e,i){let r=this.minX,n=this.minY,s=this.maxX,a=this.maxY;for(let o=e;o<i;o+=2){const e=t[o],i=t[o+1];r=e<r?e:r,n=i<n?i:n,s=e>s?e:s,a=i>a?i:a}this.minX=r,this.minY=n,this.maxX=s,this.maxY=a}addVertices(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)}addVerticesMatrix(t,e,i,r,n=0,s=n){const a=t.a,o=t.b,l=t.c,h=t.d,u=t.tx,c=t.ty;let d=this.minX,p=this.minY,f=this.maxX,m=this.maxY;for(let t=i;t<r;t+=2){const i=e[t],r=e[t+1],g=a*i+l*r+u,_=h*r+o*i+c;d=Math.min(d,g-n),f=Math.max(f,g+n),p=Math.min(p,_-s),m=Math.max(m,_+s)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m}addBounds(t){const e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,e){const i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){const t=this.minX,e=this.minY,a=this.maxX,o=this.maxY;this.minX=i<t?i:t,this.minY=r<e?r:e,this.maxX=n>a?n:a,this.maxY=s>o?s:o}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){const t=this.minX,e=this.minY,a=this.maxX,o=this.maxY;this.minX=i<t?i:t,this.minY=r<e?r:e,this.maxX=n>a?n:a,this.maxY=s>o?s:o}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,i,r,n,s){t-=n,e-=s,i+=n,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r}}},7155:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(263);function s(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}class a extends n.DisplayObject{constructor(){super(),this.children=[],this.sortableChildren=r.settings.SORTABLE_CHILDREN,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}getChildIndex(t){const e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(t);r.utils.removeItems(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],i=this.children.indexOf(e);if(-1===i)return null;e.parent=null,e.transform._parentID=-1,r.utils.removeItems(this.children,i,1),this._boundsID++,this.onChildrenChange(i),e.emit("removed",this),this.emit("childRemoved",e,this,i)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,r.utils.removeItems(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const i=t,r=e-i;let n;if(r>0&&r<=e){n=this.children.splice(i,r);for(let t=0;t<n.length;++t)n[t].parent=null,n[t].transform&&(n[t].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let t=0;t<n.length;++t)n[t].emit("removed",this),this.emit("childRemoved",n[t],this,t);return n}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,i=this.children.length;e<i;++e){const i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(s),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const e=this.children[t];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){const t=e._mask.isMaskData?e._mask.maskObject:e._mask;t?(t.calculateBounds(),this._bounds.addBoundsMask(e._bounds,t._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const i=super.getLocalBounds(t);if(!e)for(let t=0,e=this.children.length;t<e;++t){const e=this.children[t];e.visible&&e.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let i,r;if(this.cullArea?(i=this.cullArea,r=this.worldTransform):this._render!==a.prototype._render&&(i=this.getBounds(!0)),i&&e.intersects(i,r))this._render(t);else if(this.cullArea)return;for(let e=0,i=this.children.length;e<i;++e){const i=this.children[e],r=i.cullable;i.cullable=r||!this.cullArea,i.render(t),i.cullable=r}}render(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters?.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}}renderAdvanced(t){const e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let t=0;t<e.length;t++)e[t].enabled&&this._enabledFilters.push(e[t])}const n=e&&this._enabledFilters?.length||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==r.MASK_TYPES.NONE));if(n&&t.batch.flush(),e&&this._enabledFilters?.length&&t.filter.push(this,this._enabledFilters),i&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}n&&t.batch.flush(),i&&t.mask.pop(this),e&&this._enabledFilters?.length&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e="boolean"==typeof t?t:t?.children,i=this.removeChildren(0,this.children.length);if(e)for(let e=0;e<i.length;++e)i[e].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}a.prototype.containerUpdateTransform=a.prototype.updateTransform,e.Container=a},263:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(7966);class s extends r.utils.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new r.Transform,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new n.Bounds,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let i=0;i<e.length;++i){const r=e[i];Object.defineProperty(s.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new r.Rectangle),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new r.Rectangle),t=this._localBoundsRect),this._localBounds||(this._localBounds=new n.Bounds);const e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const s=this._bounds,a=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,t);return this.parent=i,this.transform=e,this._bounds=s,this._bounds.updateID+=this._boundsID-a,o}toGlobal(t,e,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){this.parent?.removeChild(this)}setTransform(t=0,e=0,i=1,r=1,n=0,s=0,a=0,o=0,l=0){return this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=a,this.pivot.x=o,this.pivot.y=l,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new a),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*r.RAD_TO_DEG}set angle(t){this.transform.rotation=t*r.DEG_TO_RAD}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(t._maskRefCount--,0===t._maskRefCount&&(t.renderable=!0,t.isMask=!1))}if(this._mask=t,this._mask){const t=this._mask.isMaskData?this._mask.maskObject:this._mask;t&&(0===t._maskRefCount&&(t.renderable=!1,t.isMask=!0),t._maskRefCount++)}}}}class a extends s{constructor(){super(...arguments),this.sortDirty=null}}s.prototype.displayObjectUpdateTransform=s.prototype.updateTransform,e.DisplayObject=s,e.TemporaryDisplayObject=a},7191:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(3428);var r=i(7966),n=i(263),s=i(7155);e.Bounds=r.Bounds,e.DisplayObject=n.DisplayObject,e.TemporaryDisplayObject=n.TemporaryDisplayObject,e.Container=s.Container},3428:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);r.settings.SORTABLE_CHILDREN=!1,Object.defineProperty(e,"settings",{enumerable:!0,get:function(){return r.settings}})},9099:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9564),n=i(7058),s=i(3009),a=i(8742);const o=new a.Point,l=new a.Point;e.EventBoundary=class{constructor(t){this.dispatch=new a.utils.EventEmitter,this.moveOnAll=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(((t,e)=>t.priority-e.priority))}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let i=0,r=e.length;i<r;i++)e[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){const i=this.hitTestRecursive(this.rootTarget,this.rootTarget.interactive,o.set(t,e),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(t,e){if(!t.target)return;const i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,n=i.length-1;r<n;r++)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let r=i.length-2;r>=0;r--)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,i=this.rootTarget){t.eventPhase=t.BUBBLING_PHASE;const r=i.children;if(r)for(let i=0;i<r.length;i++)this.all(t,e,r[i]);t.currentTarget=i,this.notifyTarget(t,e)}propagationPath(t){const e=[t];for(let i=0;i<2048&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestRecursive(t,e,i,r,n){if(!t||!t.visible)return null;if(n(t,i))return null;if(t.interactiveChildren&&t.children){const s=t.children;for(let a=s.length-1;a>=0;a--){const o=s[a],l=this.hitTestRecursive(o,e||o.interactive,i,r,n);if(l){if(l.length>0&&!l[l.length-1].parent)continue;return(l.length>0||t.interactive)&&l.push(t),l}}}return e&&r(t,i)?t.interactive?[t]:[]:null}hitPruneFn(t,e){if(t.hitArea&&(t.worldTransform.applyInverse(e,l),!t.hitArea.contains(l.x,l.y)))return!0;if(t._mask){const i=t._mask.isMaskData?t._mask.maskObject:t._mask;if(i&&!i.containsPoint?.(e))return!0}return!1}hitTestFn(t,e){return!!t.hitArea||!!t.containsPoint&&t.containsPoint(e)}notifyTarget(t,e){e=e??t.type;const i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof n.FederatedPointerEvent))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)this.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){const t=2===e.button;this.dispatchEvent(e,t?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){if(!(t instanceof n.FederatedPointerEvent))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.createPointerEvent(t),i="mouse"===e.pointerType||"pen"===e.pointerType,r=this.trackingData(t.pointerId),s=this.findMountedTarget(r.overTargets);if(r.overTargets&&s!==e.target){const r="mousemove"===t.type?"mouseout":"pointerout",n=this.createPointerEvent(t,r,s);if(this.dispatchEvent(n,"pointerout"),i&&this.dispatchEvent(n,"mouseout"),!e.composedPath().includes(s)){const r=this.createPointerEvent(t,"pointerleave",s);for(r.eventPhase=r.AT_TARGET;r.target&&!e.composedPath().includes(r.target);)r.currentTarget=r.target,this.notifyTarget(r),i&&this.notifyTarget(r,"mouseleave"),r.target=r.target.parent;this.freeEvent(r)}this.freeEvent(n)}if(s!==e.target){const r="mousemove"===t.type?"mouseover":"pointerover",n=this.clonePointerEvent(e,r);this.dispatchEvent(n,"pointerover"),i&&this.dispatchEvent(n,"mouseover");let a=s?.parent;for(;a&&a!==this.rootTarget.parent&&a!==e.target;)a=a.parent;if(!a||a===this.rootTarget.parent){const t=this.clonePointerEvent(e,"pointerenter");for(t.eventPhase=t.AT_TARGET;t.target&&t.target!==s&&t.target!==this.rootTarget.parent;)t.currentTarget=t.target,this.notifyTarget(t),i&&this.notifyTarget(t,"mouseenter"),t.target=t.target.parent;this.freeEvent(t)}this.freeEvent(n)}const a=this.moveOnAll?"all":"dispatchEvent";this[a](e,"pointermove"),"touch"===e.pointerType&&this[a](e,"touchmove"),i&&(this[a](e,"mousemove"),this.cursor=e.target?.cursor),r.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){if(!(t instanceof n.FederatedPointerEvent))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId),i=this.createPointerEvent(t),r="mouse"===i.pointerType||"pen"===i.pointerType;this.dispatchEvent(i,"pointerover"),r&&this.dispatchEvent(i,"mouseover"),"mouse"===i.pointerType&&(this.cursor=i.target?.cursor);const s=this.clonePointerEvent(i,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),r&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;e.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(s)}mapPointerOut(t){if(!(t instanceof n.FederatedPointerEvent))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId);if(e.overTargets){const i="mouse"===t.pointerType||"pen"===t.pointerType,r=this.findMountedTarget(e.overTargets),n=this.createPointerEvent(t,"pointerout",r);this.dispatchEvent(n),i&&this.dispatchEvent(n,"mouseout");const s=this.createPointerEvent(t,"pointerleave",r);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseleave"),s.target=s.target.parent;e.overTargets=null,this.freeEvent(n),this.freeEvent(s)}this.cursor=null}mapPointerUp(t){if(!(t instanceof n.FederatedPointerEvent))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),"touch"===i.pointerType)this.dispatchEvent(i,"touchend");else if("mouse"===i.pointerType||"pen"===i.pointerType){const t=2===i.button;this.dispatchEvent(i,t?"rightup":"mouseup")}const r=this.trackingData(t.pointerId),s=this.findMountedTarget(r.pressTargetsByButton[t.button]);let a=s;if(s&&!i.composedPath().includes(s)){let e=s;for(;e&&!i.composedPath().includes(e);){if(i.currentTarget=e,this.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType)this.notifyTarget(i,"touchendoutside");else if("mouse"===i.pointerType||"pen"===i.pointerType){const t=2===i.button;this.notifyTarget(i,t?"rightupoutside":"mouseupoutside")}e=e.parent}delete r.pressTargetsByButton[t.button],a=e}if(a){const n=this.clonePointerEvent(i,"click");n.target=a,n.path=null,r.clicksByButton[t.button]||(r.clicksByButton[t.button]={clickCount:0,target:n.target,timeStamp:e});const s=r.clicksByButton[t.button];s.target===n.target&&e-s.timeStamp<200?++s.clickCount:s.clickCount=1,s.target=n.target,s.timeStamp=e,n.detail=s.clickCount,"mouse"===n.pointerType?this.dispatchEvent(n,"click"):"touch"===n.pointerType&&this.dispatchEvent(n,"tap"),this.dispatchEvent(n,"pointertap"),this.freeEvent(n)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof n.FederatedPointerEvent))return void console.warn("EventBoundary cannot map a non-pointer event as a pointer event");const e=this.trackingData(t.pointerId),i=this.findMountedTarget(e.pressTargetsByButton[t.button]),r=this.createPointerEvent(t);if(i){let n=i;for(;n;)r.currentTarget=n,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType?this.notifyTarget(r,"touchendoutside"):"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.notifyTarget(r,2===r.button?"rightupoutside":"mouseupoutside"),n=n.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(r)}mapWheel(t){if(!(t instanceof s.FederatedWheelEvent))return void console.warn("EventBoundary cannot map a non-wheel event as a wheel event");const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){const r=this.allocateEvent(n.FederatedPointerEvent);return this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=i??this.hitTest(r.global.x,r.global.y),"string"==typeof e&&(r.type=e),r}createWheelEvent(t){const e=this.allocateEvent(s.FederatedWheelEvent);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const i=this.allocateEvent(n.FederatedPointerEvent);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=e??i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof n.FederatedPointerEvent&&e instanceof n.FederatedPointerEvent&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof r.FederatedMouseEvent&&e instanceof r.FederatedMouseEvent&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const i=t.currentTarget._events[e];if(i)if("fn"in i)i.fn.call(i.context,t);else for(let e=0,r=i.length;e<r&&!t.propagationImmediatelyStopped;e++)i[e].fn.call(i[e].context,t)}}},8265:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9099),n=i(7058),s=i(3009),a=i(8742);const o={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class l{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new r.EventBoundary(null),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new n.FederatedPointerEvent(null),this.rootWheelEvent=new s.FederatedWheelEvent(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}init(){const{view:t,resolution:e}=this.renderer;this.setTargetElement(t),this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const i=this.cursorStyles[t];if(i)switch(typeof i){case"string":e&&(this.domElement.style.cursor=i);break;case"function":i(t);break;case"object":e&&Object.assign(this.domElement.style,i)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}onPointerDown(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType)return;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let t=0,i=e.length;t<i;t++){const i=e[t],r=this.bootstrapEvent(this.rootPointerEvent,i);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType)return;const e=this.normalizeToPointerData(t);for(let t=0,i=e.length;t<i;t++){const i=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType)return;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const i=e!==this.domElement?"outside":"",r=this.normalizeToPointerData(t);for(let t=0,e=r.length;t<e;t++){const e=this.bootstrapEvent(this.rootPointerEvent,r[t]);e.type+=i,this.rootBoundary.mapEvent(e)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&"touch"===t.pointerType)return;const e=this.normalizeToPointerData(t);for(let t=0,i=e.length;t<i;t++){const i=this.bootstrapEvent(this.rootPointerEvent,e[t]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,i){let r;r=this.domElement.parentElement?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const n=1/this.resolution;t.x=(e-r.left)*(this.domElement.width/r.width)*n,t.y=(i-r.top)*(this.domElement.height/r.height)*n}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let i=0,r=t.changedTouches.length;i<r;i++){const r=t.changedTouches[i];void 0===r.button&&(r.button=0),void 0===r.buttons&&(r.buttons=1),void 0===r.isPrimary&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===r.width&&(r.width=r.radiusX||1),void 0===r.height&&(r.height=r.radiusY||1),void 0===r.tiltX&&(r.tiltX=0),void 0===r.tiltY&&(r.tiltY=0),void 0===r.pointerType&&(r.pointerType="touch"),void 0===r.pointerId&&(r.pointerId=r.identifier||0),void 0===r.pressure&&(r.pressure=r.force||.5),void 0===r.twist&&(r.twist=0),void 0===r.tangentialPressure&&(r.tangentialPressure=0),void 0===r.layerX&&(r.layerX=r.offsetX=r.clientX),void 0===r.layerY&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof globalThis.PointerEvent)){const i=t;void 0===i.isPrimary&&(i.isPrimary=!0),void 0===i.width&&(i.width=1),void 0===i.height&&(i.height=1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="mouse"),void 0===i.pointerId&&(i.pointerId=1),void 0===i.pressure&&(i.pressure=.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),i.isNormalized=!0,e.push(i)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=o[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}}l.extension={name:"events",type:[a.ExtensionType.RendererSystem,a.ExtensionType.CanvasRendererSystem]},a.extensions.add(l),e.EventSystem=l},6419:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);class n{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=n.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new r.Point,this.page=new r.Point,this.AT_TARGET=1,this.BUBBLING_PHASE=2,this.CAPTURING_PHASE=3,this.NONE=0,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,i,r,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}e.FederatedEvent=n},2386:()=>{},7645:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7191),n=i(6419);const s={interactive:!1,interactiveChildren:!0,hitArea:null,addEventListener(t,e,i){const r="function"==typeof e?void 0:e;t="boolean"==typeof i&&i||"object"==typeof i&&i.capture?`${t}capture`:t,e="function"==typeof e?e:e.handleEvent,this.on(t,e,r)},removeEventListener(t,e,i){const r="function"==typeof e?void 0:e;t="boolean"==typeof i&&i||"object"==typeof i&&i.capture?`${t}capture`:t,e="function"==typeof e?e:e.handleEvent,this.off(t,e,r)},dispatchEvent(t){if(!(t instanceof n.FederatedEvent))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};r.DisplayObject.mixin(s),e.FederatedDisplayObject=s},9564:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6419),n=i(8742);class s extends r.FederatedEvent{constructor(){super(...arguments),this.client=new n.Point,this.movement=new n.Point,this.offset=new n.Point,this.global=new n.Point,this.screen=new n.Point}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,r,n,s,a,o,l,h,u,c,d,p,f){throw new Error("Method not implemented.")}}e.FederatedMouseEvent=s},7058:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9564);class n extends r.FederatedMouseEvent{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}e.FederatedPointerEvent=n},3009:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9564);class n extends r.FederatedMouseEvent{constructor(){super(...arguments),this.DOM_DELTA_LINE=0,this.DOM_DELTA_PAGE=1,this.DOM_DELTA_PIXEL=2}}e.FederatedWheelEvent=n},9743:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9099),n=i(8265),s=i(6419);i(2386);var a=i(7645),o=i(9564),l=i(7058),h=i(3009);e.EventBoundary=r.EventBoundary,e.EventSystem=n.EventSystem,e.FederatedEvent=s.FederatedEvent,e.FederatedDisplayObject=a.FederatedDisplayObject,e.FederatedMouseEvent=o.FederatedMouseEvent,e.FederatedPointerEvent=l.FederatedPointerEvent,e.FederatedWheelEvent=h.FederatedWheelEvent},1648:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(t=>(t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t))(i||{});const r=t=>{if(("function"==typeof t||"object"==typeof t&&t.extension)&&(t={..."object"!=typeof t.extension?{type:t.extension}:t.extension,ref:t}),"object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t={...t}).type&&(t.type=[t.type]),t},n={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(r).forEach((t=>{t.type.forEach((e=>this._removeHandlers[e]?.(t)))})),this},add(...t){return t.map(r).forEach((t=>{t.type.forEach((e=>{const i=this._addHandlers,r=this._queue;i[e]?i[e](t):(r[e]=r[e]||[],r[e].push(t))}))})),this},handle(t,e,i){const r=this._addHandlers,n=this._removeHandlers;r[t]=e,n[t]=i;const s=this._queue;return s[t]&&(s[t].forEach((t=>e(t))),delete s[t]),this},handleByMap(t,e){return this.handle(t,(t=>{e[t.name]=t.ref}),(t=>{delete e[t.name]}))},handleByList(t,e){return this.handle(t,(t=>{e.includes(t.ref)||(e.push(t.ref),e.sort(((t,e)=>(e.priority??-1)-(t.priority??-1))))}),(t=>{const i=e.indexOf(t.ref);-1!==i&&e.splice(i,1)}))}};e.ExtensionType=i,e.extensions=n},7743:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);const n=new r.Rectangle,s=class{constructor(t){this.renderer=t}async image(t,e,i){const r=new Image;return r.src=await this.base64(t,e,i),r}async base64(t,e,i){const r=this.canvas(t);if(void 0!==r.toDataURL)return r.toDataURL(e,i);if(void 0!==r.convertToBlob){const t=await r.convertToBlob({type:e,quality:i});return await new Promise((e=>{const i=new FileReader;i.onload=()=>e(i.result),i.readAsDataURL(t)}))}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(t,e){const i=this.renderer;let a,o,l=!1,h=!1;t&&(t instanceof r.RenderTexture?o=t:(o=this.renderer.generateTexture(t),h=!0)),o?(a=o.baseTexture.resolution,e=e??o.frame,l=!1,i.renderTexture.bind(o)):(a=i.resolution,e||((e=n).width=i.width,e.height=i.height),l=!0,i.renderTexture.bind(null));const u=Math.round(e.width*a),c=Math.round(e.height*a);let d=new r.utils.CanvasRenderTarget(u,c,1);const p=new Uint8Array(4*u*c),f=i.gl;f.readPixels(Math.round(e.x*a),Math.round(e.y*a),u,c,f.RGBA,f.UNSIGNED_BYTE,p);const m=d.context.getImageData(0,0,u,c);if(s.arrayPostDivide(p,m.data),d.context.putImageData(m,0,0),l){const t=new r.utils.CanvasRenderTarget(d.width,d.height,1);t.context.scale(1,-1),t.context.drawImage(d.canvas,0,-c),d.destroy(),d=t}return h&&o.destroy(!0),d.canvas}pixels(t,e){const i=this.renderer;let a,o,l=!1;t&&(t instanceof r.RenderTexture?o=t:(o=this.renderer.generateTexture(t),l=!0)),o?(a=o.baseTexture.resolution,e=e??o.frame,i.renderTexture.bind(o)):(a=i.resolution,e||((e=n).width=i.width,e.height=i.height),i.renderTexture.bind(null));const h=Math.round(e.width*a),u=Math.round(e.height*a),c=new Uint8Array(4*h*u),d=i.gl;return d.readPixels(Math.round(e.x*a),Math.round(e.y*a),h,u,d.RGBA,d.UNSIGNED_BYTE,c),l&&o.destroy(!0),s.arrayPostDivide(c,c),c}destroy(){this.renderer=null}static arrayPostDivide(t,e){for(let i=0;i<t.length;i+=4){const r=e[i+3]=t[i+3];0!==r?(e[i]=Math.round(Math.min(255*t[i]/r,255)),e[i+1]=Math.round(Math.min(255*t[i+1]/r,255)),e[i+2]=Math.round(Math.min(255*t[i+2]/r,255))):(e[i]=t[i],e[i+1]=t[i+1],e[i+2]=t[i+2])}}};let a=s;a.extension={name:"extract",type:r.ExtensionType.RendererSystem},r.extensions.add(a),e.Extract=a},6899:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7743);e.Extract=r.Extract},2778:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(9469);class s extends r.Filter{constructor(t=1){super(r.defaultVertex,n.default,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}e.AlphaFilter=s},9469:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n"},370:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2778);e.AlphaFilter=r.AlphaFilter},6536:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(5339);class s extends r.Filter{constructor(t=8,e=4,i=r.settings.FILTER_RESOLUTION,s=5){super(),this.blurXFilter=new n.BlurFilterPass(!0,t,e,i,s),this.blurYFilter=new n.BlurFilterPass(!1,t,e,i,s),this.resolution=i,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,i,n){const s=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(s&&a){const s=t.getFilterTexture();this.blurXFilter.apply(t,e,s,r.CLEAR_MODES.CLEAR),this.blurYFilter.apply(t,s,i,n),t.returnFilterTexture(s)}else a?this.blurYFilter.apply(t,e,i,n):this.blurXFilter.apply(t,e,i,n)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}e.BlurFilter=s},5339:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(399),s=i(1786);class a extends r.Filter{constructor(t,e=8,i=4,a=r.settings.FILTER_RESOLUTION,o=5){super(n.generateBlurVertSource(o,t),s.generateBlurFragSource(o)),this.horizontal=t,this.resolution=a,this._quality=0,this.quality=i,this.blur=e}apply(t,e,i,n){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/e.width):this.uniforms.strength=1/i.height*(i.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,n);else{const s=t.getFilterTexture(),a=t.renderer;let o=e,l=s;this.state.blend=!1,t.applyFilter(this,o,l,r.CLEAR_MODES.CLEAR);for(let e=1;e<this.passes-1;e++){t.bindAndClear(o,r.CLEAR_MODES.BLIT),this.uniforms.uSampler=l;const e=l;l=o,o=e,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,l,i,n),t.returnFilterTexture(s)}}get blur(){return this.strength}set blur(t){this.padding=1+2*Math.abs(t),this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}e.BlurFilterPass=a},1786:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},r=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");e.generateBlurFragSource=function(t){const e=i[t],n=e.length;let s,a=r,o="";for(let i=0;i<t;i++){let r="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",i.toString());s=i,i>=n&&(s=t-i-1),r=r.replace("%value%",e[s].toString()),o+=r,o+="\n"}return a=a.replace("%blur%",o),a=a.replace("%size%",t.toString()),a}},399:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.generateBlurVertSource=function(t,e){const i=Math.ceil(t/2);let r,n="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",s="";r=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let e=0;e<t;e++){let t=r.replace("%index%",e.toString());t=t.replace("%sampleIndex%",e-(i-1)+".0"),s+=t,s+="\n"}return n=n.replace("%blur%",s),n=n.replace("%size%",t.toString()),n}},3410:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6536),n=i(5339);e.BlurFilter=r.BlurFilter,e.BlurFilterPass=n.BlurFilterPass},4578:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(3419);class s extends r.Filter{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(r.defaultFilterVertex,n.default,t),this.alpha=1}_loadMatrix(t,e=!1){let i=t;e&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}tint(t,e){const i=[(t>>16&255)/255,0,0,0,0,0,(t>>8&255)/255,0,0,0,0,0,(255&t)/255,0,0,0,0,0,1,0];this._loadMatrix(i,e)}greyscale(t,e){const i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}blackAndWhite(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)}hue(t,e){t=(t||0)/180*Math.PI;const i=Math.cos(t),r=Math.sin(t),n=1/3,s=(0,Math.sqrt)(n),a=[i+(1-i)*n,n*(1-i)-s*r,n*(1-i)+s*r,0,0,n*(1-i)+s*r,i+n*(1-i),n*(1-i)-s*r,0,0,n*(1-i)-s*r,n*(1-i)+s*r,i+n*(1-i),0,0,0,0,0,1,0];this._loadMatrix(a,e)}contrast(t,e){const i=(t||0)+1,r=-.5*(i-1),n=[i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0];this._loadMatrix(n,e)}saturate(t=0,e){const i=2*t/3+1,r=-.5*(i-1),n=[i,r,r,0,0,r,i,r,0,0,r,r,i,0,0,0,0,0,1,0];this._loadMatrix(n,e)}desaturate(){this.saturate(-1)}negative(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)}sepia(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)}technicolor(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)}polaroid(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)}toBGR(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)}kodachrome(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)}browni(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)}vintage(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)}colorTone(t,e,i,r,n){const s=((i=i||16770432)>>16&255)/255,a=(i>>8&255)/255,o=(255&i)/255,l=((r=r||3375104)>>16&255)/255,h=(r>>8&255)/255,u=(255&r)/255,c=[.3,.59,.11,0,0,s,a,o,t=t||.2,0,l,h,u,e=e||.15,0,s-l,a-h,o-u,0,0];this._loadMatrix(c,n)}night(t,e){const i=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}predator(t,e){const i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)}lsd(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}s.prototype.grayscale=s.prototype.greyscale,e.ColorMatrixFilter=s},3419:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n"},4920:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4578);e.ColorMatrixFilter=r.ColorMatrixFilter},1538:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(6175),s=i(8962);class a extends r.Filter{constructor(t,e){const i=new r.Matrix;t.renderable=!1,super(s.default,n.default,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,null==e&&(e=20),this.scale=new r.Point(e,e)}apply(t,e,i,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const n=this.maskSprite.worldTransform,s=Math.sqrt(n.a*n.a+n.b*n.b),a=Math.sqrt(n.c*n.c+n.d*n.d);0!==s&&0!==a&&(this.uniforms.rotation[0]=n.a/s,this.uniforms.rotation[1]=n.b/s,this.uniforms.rotation[2]=n.c/a,this.uniforms.rotation[3]=n.d/a),t.applyFilter(this,e,i,r)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}e.DisplacementFilter=a},6175:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n"},8962:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n"},1203:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1538);e.DisplacementFilter=r.DisplacementFilter},6517:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(9860),s=i(7607);class a extends r.Filter{constructor(){super(n.default,s.default)}}e.FXAAFilter=a},9860:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n"},7607:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default='varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'},6194:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6517);e.FXAAFilter=r.FXAAFilter},463:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(5239);class s extends r.Filter{constructor(t=.5,e=Math.random()){super(r.defaultFilterVertex,n.default,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}e.NoiseFilter=s},8116:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(463);e.NoiseFilter=r.NoiseFilter},5239:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n"},888:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);i(6125);var n=i(2268),s=i(4624),a=i(681),o=i(7191),l=i(6335),h=i(8746),u=i(3910),c=i(672);const d=new Float32Array(3),p={},f=class extends o.Container{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new s.FillStyle,this._lineStyle=new a.LineStyle,this._matrix=null,this._holeMode=!1,this.state=r.State.for2d(),this._geometry=t||new n.GraphicsGeometry,this._geometry.refCount++,this._transformID=-1,this.tint=16777215,this.blendMode=r.BLEND_MODES.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new f(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(t){this._tint=t}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,i=1,r=.5,n=!1){return"number"==typeof t&&(t={width:t,color:e,alpha:i,alignment:r,native:n}),this.lineTextureStyle(t)}lineTextureStyle(t){t=Object.assign({width:0,texture:r.Texture.WHITE,color:t?.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:l.LINE_CAP.BUTT,join:l.LINE_JOIN.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();const e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new r.Polygon,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new r.Polygon,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,r=i[i.length-2],n=i[i.length-1];return r===t&&n===e||i.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,i,r){this._initCurve();const n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),h.QuadraticUtils.curveTo(t,e,i,r,n),this}bezierCurveTo(t,e,i,r,n,s){return this._initCurve(),u.BezierUtils.curveTo(t,e,i,r,n,s,this.currentPath.points),this}arcTo(t,e,i,r,n){this._initCurve(t,e);const s=this.currentPath.points,a=c.ArcUtils.curveTo(t,e,i,r,n,s);if(a){const{cx:t,cy:e,radius:i,startAngle:r,endAngle:n,anticlockwise:s}=a;this.arc(t,e,i,r,n,s)}return this}arc(t,e,i,n,s,a=!1){if(n===s)return this;if(!a&&s<=n?s+=r.PI_2:a&&n<=s&&(n+=r.PI_2),0==s-n)return this;const o=t+Math.cos(n)*i,l=e+Math.sin(n)*i,h=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const t=Math.abs(u[u.length-2]-o),e=Math.abs(u[u.length-1]-l);t<h&&e<h||u.push(o,l)}else this.moveTo(o,l),u=this.currentPath.points;return c.ArcUtils.arc(o,l,t,e,i,n,s,a,u),this}beginFill(t=0,e=1){return this.beginTextureFill({texture:r.Texture.WHITE,color:t,alpha:e})}beginTextureFill(t){t=Object.assign({texture:r.Texture.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();const e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,i,n){return this.drawShape(new r.Rectangle(t,e,i,n))}drawRoundedRect(t,e,i,n,s){return this.drawShape(new r.RoundedRectangle(t,e,i,n,s))}drawCircle(t,e,i){return this.drawShape(new r.Circle(t,e,i))}drawEllipse(t,e,i,n){return this.drawShape(new r.Ellipse(t,e,i,n))}drawPolygon(...t){let e,i=!0;const n=t[0];n.points?(i=n.closeStroke,e=n.points):e=Array.isArray(t[0])?t[0]:t;const s=new r.Polygon(e);return s.closeStroke=i,this.drawShape(s),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==r.SHAPES.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(let n=0;n<i;n++){const i=t.batches[n],s=i.style.color,a=new Float32Array(this.vertexData.buffer,4*i.attribStart*2,2*i.attribSize),o=new Float32Array(t.uvsFloat32.buffer,4*i.attribStart*2,2*i.attribSize),l={vertexData:a,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*i.start,i.size),uvs:o,_batchRGB:r.utils.hex2rgb(s),_tintRGB:s,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[n]=l}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,i=this.batches.length;e<i;e++){const i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}}_renderDirect(t){const e=this._resolveDirectShader(t),i=this._geometry,r=this.tint,n=this.worldAlpha,s=e.uniforms,a=i.drawCalls;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(r>>16&255)/255*n,s.tint[1]=(r>>8&255)/255*n,s.tint[2]=(255&r)/255*n,s.tint[3]=n,t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(let e=0,r=a.length;e<r;e++)this._renderDrawCallDirect(t,i.drawCalls[e])}_renderDrawCallDirect(t,e){const{texArray:i,type:r,size:n,start:s}=e,a=i.count;for(let e=0;e<a;e++)t.texture.bind(i.elements[e],e);t.geometry.draw(r,n,s)}_resolveDirectShader(t){let e=this.shader;const i=this.pluginName;if(!e){if(!p[i]){const{MAX_TEXTURES:e}=t.plugins[i],n=new Int32Array(e);for(let t=0;t<e;t++)n[t]=t;const s={tint:new Float32Array([1,1,1,1]),translationMatrix:new r.Matrix,default:r.UniformGroup.from({uSamplers:n},!0)},a=t.plugins[i]._shader.program;p[i]=new r.Shader(a,s)}e=p[i]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:i,maxX:r,maxY:n}=t.bounds;this._bounds.addFrame(this.transform,e,i,r,n)}containsPoint(t){return this.worldTransform.applyInverse(t,f._TEMP_POINT),this._geometry.containsPoint(f._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const t=r.utils.hex2rgb(this.tint,d);for(let e=0;e<this.batches.length;e++){const i=this.batches[e],r=i._batchRGB,n=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);i._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,s=e.d,a=e.tx,o=e.ty,l=this._geometry.points,h=this.vertexData;let u=0;for(let t=0;t<l.length;t+=2){const e=l[t],c=l[t+1];h[u++]=i*e+n*c+a,h[u++]=s*c+r*e+o}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};let m=f;m._TEMP_POINT=new r.Point,e.Graphics=m},9189:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t,e=null,i=null,r=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=r,this.type=t.type}clone(){return new i(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}e.GraphicsData=i},2268:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6125),n=i(8742),s=i(9189),a=i(7191),o=i(881),l=i(9938),h=i(5615);const u=new n.Point,c=class extends n.BatchGeometry{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new a.Bounds,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),r.DRAW_CALL_POOL.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),r.BATCH_POOL.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,i=null,r=null){const n=new s.GraphicsData(t,e,i,r);return this.graphicsData.push(n),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const i=new s.GraphicsData(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let i=0;i<e.length;++i){const r=e[i];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(t,u):u.copyFrom(t),r.shape.contains(u.x,u.y))){let t=!1;if(r.holes)for(let e=0;e<r.holes.length;e++)if(r.holes[e].shape.contains(u.x,u.y)){t=!0;break}if(!t)return!0}}return!1}updateBatches(){if(!this.graphicsData.length)return void(this.batchable=!0);if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let i=null,s=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],s=i.style);for(let a=this.shapeIndex;a<e.length;a++){this.shapeIndex++;const l=e[a],h=l.fillStyle,u=l.lineStyle;r.FILL_COMMANDS[l.type].build(l),l.matrix&&this.transformPoints(l.points,l.matrix),(h.visible||u.visible)&&this.processHoles(l.holes);for(let e=0;e<2;e++){const a=0===e?h:u;if(!a.visible)continue;const c=a.texture.baseTexture,d=this.indices.length,p=this.points.length/2;c.wrapMode=n.WRAP_MODES.REPEAT,0===e?this.processFill(l):this.processLine(l);const f=this.points.length/2-p;0!==f&&(i&&!this._compareStyles(s,a)&&(i.end(d,p),i=null),i||(i=r.BATCH_POOL.pop()||new o.BatchPart,i.begin(a,d,p),this.batches.push(i),s=a),this.addUvs(this.points,t,a.texture,p,f,a.matrix))}}const a=this.indices.length,l=this.points.length/2;if(i&&i.end(a,l),0===this.batches.length)return void(this.batchable=!0);const h=l>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&h===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=h?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e)&&t.texture.baseTexture===e.texture.baseTexture&&t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const e=this.graphicsData[t],i=e.fillStyle,r=e.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,i=t.length;e<i;e++){const i=t[e];for(let t=0;t<i.size;t++){const e=i.start+t;this.indicesUint16[e]=this.indicesUint16[e]-i.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*c.BATCHABLE_SIZE}buildDrawCalls(){let t=++n.BaseTexture._globalBatch;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),r.DRAW_CALL_POOL.push(this.drawCalls[t]);this.drawCalls.length=0;const e=this.colors,i=this.textureIds;let s=r.DRAW_CALL_POOL.pop();s||(s=new n.BatchDrawCall,s.texArray=new n.BatchTextureArray),s.texArray.count=0,s.start=0,s.size=0,s.type=n.DRAW_MODES.TRIANGLES;let a=0,o=null,l=0,h=!1,u=n.DRAW_MODES.TRIANGLES,c=0;this.drawCalls.push(s);for(let d=0;d<this.batches.length;d++){const p=this.batches[d],f=8,m=p.style,g=m.texture.baseTexture;h!==!!m.native&&(h=!!m.native,u=h?n.DRAW_MODES.LINES:n.DRAW_MODES.TRIANGLES,o=null,a=f,t++),o!==g&&(o=g,g._batchEnabled!==t&&(a===f&&(t++,a=0,s.size>0&&(s=r.DRAW_CALL_POOL.pop(),s||(s=new n.BatchDrawCall,s.texArray=new n.BatchTextureArray),this.drawCalls.push(s)),s.start=c,s.size=0,s.texArray.count=0,s.type=u),g.touched=1,g._batchEnabled=t,g._batchLocation=a,g.wrapMode=n.WRAP_MODES.REPEAT,s.texArray.elements[s.texArray.count++]=g,a++)),s.size+=p.size,c+=p.size,l=g._batchLocation,this.addColors(e,m.color,m.alpha,p.attribSize,p.attribStart),this.addTextureIds(i,l,p.attribSize,p.attribStart)}n.BaseTexture._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,i=this.colors,r=this.textureIds,n=new ArrayBuffer(3*t.length*4),s=new Float32Array(n),a=new Uint32Array(n);let o=0;for(let n=0;n<t.length/2;n++)s[o++]=t[2*n],s[o++]=t[2*n+1],s[o++]=e[2*n],s[o++]=e[2*n+1],a[o++]=i[n],s[o++]=r[n];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?l.buildPoly.triangulate(t,this):r.FILL_COMMANDS[t.type].triangulate(t,this)}processLine(t){h.buildLine(t,this);for(let e=0;e<t.holes.length;e++)h.buildLine(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const i=t[e];r.FILL_COMMANDS[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let i=0;i<t.length/2;i++){const r=t[2*i],n=t[2*i+1];t[2*i]=e.a*r+e.c*n+e.tx,t[2*i+1]=e.b*r+e.d*n+e.ty}}addColors(t,e,i,r,s=0){const a=(e>>16)+(65280&e)+((255&e)<<16),o=n.utils.premultiplyTint(a,i);t.length=Math.max(t.length,s+r);for(let e=0;e<r;e++)t[s+e]=o}addTextureIds(t,e,i,r=0){t.length=Math.max(t.length,r+i);for(let n=0;n<i;n++)t[r+n]=e}addUvs(t,e,i,r,n,s=null){let a=0;const o=e.length,l=i.frame;for(;a<n;){let i=t[2*(r+a)],n=t[2*(r+a)+1];if(s){const t=s.a*i+s.c*n+s.tx;n=s.b*i+s.d*n+s.ty,i=t}a++,e.push(i/l.width,n/l.height)}const h=i.baseTexture;(l.width<h.width||l.height<h.height)&&this.adjustUvs(e,i,o,n)}adjustUvs(t,e,i,r){const n=e.baseTexture,s=1e-6,a=i+2*r,o=e.frame,l=o.width/n.width,h=o.height/n.height;let u=o.x/o.width,c=o.y/o.height,d=Math.floor(t[i]+s),p=Math.floor(t[i+1]+s);for(let e=i+2;e<a;e+=2)d=Math.min(d,Math.floor(t[e]+s)),p=Math.min(p,Math.floor(t[e+1]+s));u-=d,c-=p;for(let e=i;e<a;e+=2)t[e]=(t[e]+u)*l,t[e+1]=(t[e+1]+c)*h}};let d=c;d.BATCHABLE_SIZE=100,e.GraphicsGeometry=d},6335:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(t=>(t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t))(i||{}),r=(t=>(t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t))(r||{});const n={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(t,e=20){if(!this.adaptive||!t||isNaN(t))return e;let i=Math.ceil(t/this.maxLength);return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}};e.GRAPHICS_CURVES=n,e.LINE_CAP=r,e.LINE_JOIN=i},9296:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6335),n=i(4624),s=i(888),a=i(9189),o=i(2268),l=i(681),h=i(6125),u=i(9938),c=i(703),d=i(2285),p=i(3447),f=i(5615),m=i(672),g=i(3910),_=i(8746),y=i(881);const v={buildPoly:u.buildPoly,buildCircle:c.buildCircle,buildRectangle:d.buildRectangle,buildRoundedRectangle:p.buildRoundedRectangle,buildLine:f.buildLine,ArcUtils:m.ArcUtils,BezierUtils:g.BezierUtils,QuadraticUtils:_.QuadraticUtils,BatchPart:y.BatchPart,FILL_COMMANDS:h.FILL_COMMANDS,BATCH_POOL:h.BATCH_POOL,DRAW_CALL_POOL:h.DRAW_CALL_POOL};e.GRAPHICS_CURVES=r.GRAPHICS_CURVES,e.LINE_CAP=r.LINE_CAP,e.LINE_JOIN=r.LINE_JOIN,e.FillStyle=n.FillStyle,e.Graphics=s.Graphics,e.GraphicsData=a.GraphicsData,e.GraphicsGeometry=o.GraphicsGeometry,e.LineStyle=l.LineStyle,e.graphicsUtils=v},4624:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);class n{constructor(){this.color=16777215,this.alpha=1,this.texture=r.Texture.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new n;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=r.Texture.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}e.FillStyle=n},681:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4624),n=i(6335);class s extends r.FillStyle{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=n.LINE_CAP.BUTT,this.join=n.LINE_JOIN.MITER,this.miterLimit=10}clone(){const t=new s;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}e.LineStyle=s},672:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6335),n=i(8742);e.ArcUtils=class{static curveTo(t,e,i,r,n,s){const a=s[s.length-2],o=s[s.length-1]-e,l=a-t,h=r-e,u=i-t,c=Math.abs(o*u-l*h);if(c<1e-8||0===n)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;const d=o*o+l*l,p=h*h+u*u,f=o*h+l*u,m=n*Math.sqrt(d)/c,g=n*Math.sqrt(p)/c,_=m*f/d,y=g*f/p,v=m*u+g*l,x=m*h+g*o,b=l*(g+_),E=o*(g+_),T=u*(m+y),S=h*(m+y);return{cx:v+t,cy:x+e,radius:n,startAngle:Math.atan2(E-x,b-v),endAngle:Math.atan2(S-x,T-v),anticlockwise:l*h>u*o}}static arc(t,e,i,s,a,o,l,h,u){const c=l-o,d=r.GRAPHICS_CURVES._segmentsCount(Math.abs(c)*a,40*Math.ceil(Math.abs(c)/n.PI_2)),p=c/(2*d),f=2*p,m=Math.cos(p),g=Math.sin(p),_=d-1,y=_%1/_;for(let t=0;t<=_;++t){const e=p+o+f*(t+y*t),r=Math.cos(e),n=-Math.sin(e);u.push((m*r+g*n)*a+i,(m*-n+g*r)*a+s)}}}},881:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BatchPart=class{constructor(){this.reset()}begin(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}},3910:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6335);class n{static curveLength(t,e,i,r,n,s,a,o){let l=0,h=0,u=0,c=0,d=0,p=0,f=0,m=0,g=0,_=0,y=0,v=t,x=e;for(let b=1;b<=10;++b)h=b/10,u=h*h,c=u*h,d=1-h,p=d*d,f=p*d,m=f*t+3*p*h*i+3*d*u*n+c*a,g=f*e+3*p*h*r+3*d*u*s+c*o,_=v-m,y=x-g,v=m,x=g,l+=Math.sqrt(_*_+y*y);return l}static curveTo(t,e,i,s,a,o,l){const h=l[l.length-2],u=l[l.length-1];l.length-=2;const c=r.GRAPHICS_CURVES._segmentsCount(n.curveLength(h,u,t,e,i,s,a,o));let d=0,p=0,f=0,m=0,g=0;l.push(h,u);for(let r=1,n=0;r<=c;++r)n=r/c,d=1-n,p=d*d,f=p*d,m=n*n,g=m*n,l.push(f*h+3*p*n*t+3*d*m*i+g*a,f*u+3*p*n*e+3*d*m*s+g*o)}}e.BezierUtils=n},8746:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6335);class n{static curveLength(t,e,i,r,n,s){const a=t-2*i+n,o=e-2*r+s,l=2*i-2*t,h=2*r-2*e,u=4*(a*a+o*o),c=4*(a*l+o*h),d=l*l+h*h,p=2*Math.sqrt(u+c+d),f=Math.sqrt(u),m=2*u*f,g=2*Math.sqrt(d),_=c/f;return(m*p+f*c*(p-g)+(4*d*u-c*c)*Math.log((2*f+_+p)/(_+g)))/(4*m)}static curveTo(t,e,i,s,a){const o=a[a.length-2],l=a[a.length-1],h=r.GRAPHICS_CURVES._segmentsCount(n.curveLength(o,l,t,e,i,s));let u=0,c=0;for(let r=1;r<=h;++r){const n=r/h;u=o+(t-o)*n,c=l+(e-l)*n,a.push(u+(t+(i-t)*n-u)*n,c+(e+(s-e)*n-c)*n)}}}e.QuadraticUtils=n},703:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);const n={build(t){const e=t.points;let i,n,s,a,o,l;if(t.type===r.SHAPES.CIRC){const e=t.shape;i=e.x,n=e.y,o=l=e.radius,s=a=0}else if(t.type===r.SHAPES.ELIP){const e=t.shape;i=e.x,n=e.y,o=e.width,l=e.height,s=a=0}else{const e=t.shape,r=e.width/2,h=e.height/2;i=e.x+r,n=e.y+h,o=l=Math.max(0,Math.min(e.radius,Math.min(r,h))),s=r-o,a=h-l}if(!(o>=0&&l>=0&&s>=0&&a>=0))return void(e.length=0);const h=Math.ceil(2.3*Math.sqrt(o+l)),u=8*h+(s?4:0)+(a?4:0);if(e.length=u,0===u)return;if(0===h)return e.length=8,e[0]=e[6]=i+s,e[1]=e[3]=n+a,e[2]=e[4]=i-s,void(e[5]=e[7]=n-a);let c=0,d=4*h+(s?2:0)+2,p=d,f=u;{const t=s+o,r=a,l=i+t,h=i-t,u=n+r;if(e[c++]=l,e[c++]=u,e[--d]=u,e[--d]=h,a){const t=n-r;e[p++]=h,e[p++]=t,e[--f]=t,e[--f]=l}}for(let t=1;t<h;t++){const r=Math.PI/2*(t/h),u=s+Math.cos(r)*o,m=a+Math.sin(r)*l,g=i+u,_=i-u,y=n+m,v=n-m;e[c++]=g,e[c++]=y,e[--d]=y,e[--d]=_,e[p++]=_,e[p++]=v,e[--f]=v,e[--f]=g}{const t=a+l,r=i+s,o=i-s,h=n+t,u=n-t;e[c++]=r,e[c++]=h,e[--f]=u,e[--f]=r,s&&(e[c++]=o,e[c++]=h,e[--f]=u,e[--f]=o)}},triangulate(t,e){const i=t.points,n=e.points,s=e.indices;if(0===i.length)return;let a=n.length/2;const o=a;let l,h;if(t.type!==r.SHAPES.RREC){const e=t.shape;l=e.x,h=e.y}else{const e=t.shape;l=e.x+e.width/2,h=e.y+e.height/2}const u=t.matrix;n.push(t.matrix?u.a*l+u.c*h+u.tx:l,t.matrix?u.b*l+u.d*h+u.ty:h),a++,n.push(i[0],i[1]);for(let t=2;t<i.length;t+=2)n.push(i[t],i[t+1]),s.push(a++,o,a);s.push(o+1,o,a)}};e.buildCircle=n},5615:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(6335);function s(t,e,i,r,n,s,a,o){let l,h;a?(l=r,h=-i):(l=-r,h=i);const u=t-i*n+l,c=e-r*n+h,d=t+i*s+l,p=e+r*s+h;return o.push(u,c),o.push(d,p),2}function a(t,e,i,r,n,s,a,o){const l=i-t,h=r-e;let u=Math.atan2(l,h),c=Math.atan2(n-t,s-e);o&&u<c?u+=2*Math.PI:!o&&u>c&&(c+=2*Math.PI);let d=u;const p=c-u,f=Math.abs(p),m=Math.sqrt(l*l+h*h),g=1+(15*f*Math.sqrt(m)/Math.PI>>0),_=p/g;if(d+=_,o){a.push(t,e),a.push(i,r);for(let i=1,r=d;i<g;i++,r+=_)a.push(t,e),a.push(t+Math.sin(r)*m,e+Math.cos(r)*m);a.push(t,e),a.push(n,s)}else{a.push(i,r),a.push(t,e);for(let i=1,r=d;i<g;i++,r+=_)a.push(t+Math.sin(r)*m,e+Math.cos(r)*m),a.push(t,e);a.push(n,s),a.push(t,e)}return 2*g}e.buildLine=function(t,e){t.lineStyle.native?function(t,e){let i=0;const n=t.shape,s=t.points||n.points,a=n.type!==r.SHAPES.POLY||n.closeStroke;if(0===s.length)return;const o=e.points,l=e.indices,h=s.length/2,u=o.length/2;let c=u;for(o.push(s[0],s[1]),i=1;i<h;i++)o.push(s[2*i],s[2*i+1]),l.push(c,c+1),c++;a&&l.push(c,u)}(t,e):function(t,e){const i=t.shape;let o=t.points||i.points.slice();const l=e.closePointEps;if(0===o.length)return;const h=t.lineStyle,u=new r.Point(o[0],o[1]),c=new r.Point(o[o.length-2],o[o.length-1]),d=i.type!==r.SHAPES.POLY||i.closeStroke,p=Math.abs(u.x-c.x)<l&&Math.abs(u.y-c.y)<l;if(d){o=o.slice(),p&&(o.pop(),o.pop(),c.set(o[o.length-2],o[o.length-1]));const t=.5*(u.x+c.x),e=.5*(c.y+u.y);o.unshift(t,e),o.push(t,e)}const f=e.points,m=o.length/2;let g=o.length;const _=f.length/2,y=h.width/2,v=y*y,x=h.miterLimit*h.miterLimit;let b=o[0],E=o[1],T=o[2],S=o[3],w=0,A=0,I=-(E-S),R=b-T,C=0,M=0,O=Math.sqrt(I*I+R*R);I/=O,R/=O,I*=y,R*=y;const P=h.alignment,k=2*(1-P),D=2*P;d||(h.cap===n.LINE_CAP.ROUND?g+=a(b-I*(k-D)*.5,E-R*(k-D)*.5,b-I*k,E-R*k,b+I*D,E+R*D,f,!0)+2:h.cap===n.LINE_CAP.SQUARE&&(g+=s(b,E,I,R,k,D,!0,f))),f.push(b-I*k,E-R*k),f.push(b+I*D,E+R*D);for(let t=1;t<m-1;++t){b=o[2*(t-1)],E=o[2*(t-1)+1],T=o[2*t],S=o[2*t+1],w=o[2*(t+1)],A=o[2*(t+1)+1],I=-(E-S),R=b-T,O=Math.sqrt(I*I+R*R),I/=O,R/=O,I*=y,R*=y,C=-(S-A),M=T-w,O=Math.sqrt(C*C+M*M),C/=O,M/=O,C*=y,M*=y;const e=T-b,i=E-S,r=T-w,s=A-S,l=e*r+i*s,u=i*r-s*e,c=u<0;if(Math.abs(u)<.001*Math.abs(l)){f.push(T-I*k,S-R*k),f.push(T+I*D,S+R*D),l>=0&&(h.join===n.LINE_JOIN.ROUND?g+=a(T,S,T-I*k,S-R*k,T-C*k,S-M*k,f,!1)+4:g+=2,f.push(T-C*D,S-M*D),f.push(T+C*k,S+M*k));continue}const d=(-I+b)*(-R+S)-(-I+T)*(-R+E),p=(-C+w)*(-M+S)-(-C+T)*(-M+A),m=(e*p-r*d)/u,_=(s*d-i*p)/u,P=(m-T)*(m-T)+(_-S)*(_-S),N=T+(m-T)*k,L=S+(_-S)*k,F=T-(m-T)*D,B=S-(_-S)*D,U=c?k:D;P<=Math.min(e*e+i*i,r*r+s*s)+U*U*v?h.join===n.LINE_JOIN.BEVEL||P/v>x?(c?(f.push(N,L),f.push(T+I*D,S+R*D),f.push(N,L),f.push(T+C*D,S+M*D)):(f.push(T-I*k,S-R*k),f.push(F,B),f.push(T-C*k,S-M*k),f.push(F,B)),g+=2):h.join===n.LINE_JOIN.ROUND?c?(f.push(N,L),f.push(T+I*D,S+R*D),g+=a(T,S,T+I*D,S+R*D,T+C*D,S+M*D,f,!0)+4,f.push(N,L),f.push(T+C*D,S+M*D)):(f.push(T-I*k,S-R*k),f.push(F,B),g+=a(T,S,T-I*k,S-R*k,T-C*k,S-M*k,f,!1)+4,f.push(T-C*k,S-M*k),f.push(F,B)):(f.push(N,L),f.push(F,B)):(f.push(T-I*k,S-R*k),f.push(T+I*D,S+R*D),h.join===n.LINE_JOIN.ROUND?g+=c?a(T,S,T+I*D,S+R*D,T+C*D,S+M*D,f,!0)+2:a(T,S,T-I*k,S-R*k,T-C*k,S-M*k,f,!1)+2:h.join===n.LINE_JOIN.MITER&&P/v<=x&&(c?(f.push(F,B),f.push(F,B)):(f.push(N,L),f.push(N,L)),g+=2),f.push(T-C*k,S-M*k),f.push(T+C*D,S+M*D),g+=2)}b=o[2*(m-2)],E=o[2*(m-2)+1],T=o[2*(m-1)],S=o[2*(m-1)+1],I=-(E-S),R=b-T,O=Math.sqrt(I*I+R*R),I/=O,R/=O,I*=y,R*=y,f.push(T-I*k,S-R*k),f.push(T+I*D,S+R*D),d||(h.cap===n.LINE_CAP.ROUND?g+=a(T-I*(k-D)*.5,S-R*(k-D)*.5,T-I*k,S-R*k,T+I*D,S+R*D,f,!1)+2:h.cap===n.LINE_CAP.SQUARE&&(g+=s(T,S,I,R,k,D,!1,f)));const N=e.indices,L=n.GRAPHICS_CURVES.epsilon*n.GRAPHICS_CURVES.epsilon;for(let t=_;t<g+_-2;++t)b=f[2*t],E=f[2*t+1],T=f[2*(t+1)],S=f[2*(t+1)+1],w=f[2*(t+2)],A=f[2*(t+2)+1],Math.abs(b*(S-A)+T*(A-E)+w*(E-S))<L||N.push(t,t+1,t+2)}(t,e)}},9938:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);function n(t,e=!1){const i=t.length;if(i<6)return;let r=0;for(let e=0,n=t[i-2],s=t[i-1];e<i;e+=2){const i=t[e],a=t[e+1];r+=(i-n)*(a+s),n=i,s=a}if(!e&&r>0||e&&r<=0){const e=i/2;for(let r=e+e%2;r<i;r+=2){const e=i-r-2,n=i-r-1,s=r,a=r+1;[t[e],t[s]]=[t[s],t[e]],[t[n],t[a]]=[t[a],t[n]]}}}const s={build(t){t.points=t.shape.points.slice()},triangulate(t,e){let i=t.points;const s=t.holes,a=e.points,o=e.indices;if(i.length>=6){n(i,!1);const t=[];for(let e=0;e<s.length;e++){const r=s[e];n(r.points,!0),t.push(i.length/2),i=i.concat(r.points)}const e=r.utils.earcut(i,t,2);if(!e)return;const l=a.length/2;for(let t=0;t<e.length;t+=3)o.push(e[t]+l),o.push(e[t+1]+l),o.push(e[t+2]+l);for(let t=0;t<i.length;t++)a.push(i[t])}}};e.buildPoly=s},2285:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i={build(t){const e=t.shape,i=e.x,r=e.y,n=e.width,s=e.height,a=t.points;a.length=0,n>=0&&s>=0&&a.push(i,r,i+n,r,i+n,r+s,i,r+s)},triangulate(t,e){const i=t.points,r=e.points;if(0===i.length)return;const n=r.length/2;r.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}};e.buildRectangle=i},3447:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(703);const n={build(t){r.buildCircle.build(t)},triangulate(t,e){r.buildCircle.triangulate(t,e)}};e.buildRoundedRectangle=n},6125:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9938),n=i(703),s=i(2285),a=i(3447),o=i(5615),l=i(672),h=i(3910),u=i(8746),c=i(881),d=i(8742);const p={[d.SHAPES.POLY]:r.buildPoly,[d.SHAPES.CIRC]:n.buildCircle,[d.SHAPES.ELIP]:n.buildCircle,[d.SHAPES.RECT]:s.buildRectangle,[d.SHAPES.RREC]:a.buildRoundedRectangle};e.buildPoly=r.buildPoly,e.buildCircle=n.buildCircle,e.buildRectangle=s.buildRectangle,e.buildRoundedRectangle=a.buildRoundedRectangle,e.buildLine=o.buildLine,e.ArcUtils=l.ArcUtils,e.BezierUtils=h.BezierUtils,e.QuadraticUtils=u.QuadraticUtils,e.BatchPart=c.BatchPart,e.BATCH_POOL=[],e.DRAW_CALL_POOL=[],e.FILL_COMMANDS=p},1759:()=>{},3187:()=>{},9663:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8884),n=i(1965);class s{constructor(t=1,e=0,i=0,r=1,n=0,s=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new r.Point;const i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e}applyInverse(t,e){e=e||new r.Point;const i=1/(this.a*this.d+this.c*-this.b),n=t.x,s=t.y;return e.x=this.d*i*n+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*s+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this}append(t){const e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}setTransform(t,e,i,r,n,s,a,o,l){return this.a=Math.cos(a+l)*n,this.b=Math.sin(a+l)*n,this.c=-Math.sin(a-o)*s,this.d=Math.cos(a-o)*s,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this}prepend(t){const e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){const e=this.a,i=this.c;this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,r=this.c,s=this.d,a=t.pivot,o=-Math.atan2(-r,s),l=Math.atan2(i,e),h=Math.abs(o+l);return h<1e-5||Math.abs(n.PI_2-h)<1e-5?(t.rotation=l,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=l),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+s*s),t.position.x=this.tx+(a.x*e+a.y*r),t.position.y=this.ty+(a.x*i+a.y*s),t}invert(){const t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new s;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new s}static get TEMP_MATRIX(){return new s}}e.Matrix=s},6388:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t,e,i=0,r=0){this._x=i,this._y=r,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new i(t,e,this._x,this._y)}set(t=0,e=t){return this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}e.ObservablePoint=i},8884:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new i(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}}e.Point=i},969:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6388),n=i(9663);const s=class{constructor(){this.worldTransform=new n.Matrix,this.localTransform=new n.Matrix,this.position=new r.ObservablePoint(this.onChange,this,0,0),this.scale=new r.ObservablePoint(this.onChange,this,1,1),this.pivot=new r.ObservablePoint(this.onChange,this,0,0),this.skew=new r.ObservablePoint(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(t){const e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){const i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}}setFromMatrix(t){t.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}};let a=s;a.IDENTITY=new s,e.Transform=a},1965:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=2*Math.PI,r=180/Math.PI,n=Math.PI/180;var s=(t=>(t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t))(s||{});e.DEG_TO_RAD=n,e.PI_2=i,e.RAD_TO_DEG=r,e.SHAPES=s},5154:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9663);const n=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],s=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],a=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],o=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],l=[],h=[],u=Math.sign;!function(){for(let t=0;t<16;t++){const e=[];l.push(e);for(let i=0;i<16;i++){const r=u(n[t]*n[i]+a[t]*s[i]),l=u(s[t]*n[i]+o[t]*s[i]),h=u(n[t]*a[i]+a[t]*o[i]),c=u(s[t]*a[i]+o[t]*o[i]);for(let t=0;t<16;t++)if(n[t]===r&&s[t]===l&&a[t]===h&&o[t]===c){e.push(t);break}}}for(let t=0;t<16;t++){const e=new r.Matrix;e.set(n[t],s[t],a[t],o[t],0,0),h.push(e)}}();const c={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>n[t],uY:t=>s[t],vX:t=>a[t],vY:t=>o[t],inv:t=>8&t?15&t:7&-t,add:(t,e)=>l[t][e],sub:(t,e)=>l[t][c.inv(e)],rotate180:t=>4^t,isVertical:t=>2==(3&t),byDirection:(t,e)=>2*Math.abs(t)<=Math.abs(e)?e>=0?c.S:c.N:2*Math.abs(e)<=Math.abs(t)?t>0?c.E:c.W:e>0?t>0?c.SE:c.SW:t>0?c.NE:c.NW,matrixAppendRotationInv:(t,e,i=0,r=0)=>{const n=h[c.inv(e)];n.tx=i,n.ty=r,t.append(n)}};e.groupD8=c},435:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7944),n=i(2006),s=i(5272),a=i(9617),o=i(499);i(3187),i(1759);var l=i(8884),h=i(6388),u=i(9663),c=i(5154),d=i(969),p=i(1965);e.Circle=r.Circle,e.Ellipse=n.Ellipse,e.Polygon=s.Polygon,e.Rectangle=a.Rectangle,e.RoundedRectangle=o.RoundedRectangle,e.Point=l.Point,e.ObservablePoint=h.ObservablePoint,e.Matrix=u.Matrix,e.groupD8=c.groupD8,e.Transform=d.Transform,e.DEG_TO_RAD=p.DEG_TO_RAD,e.PI_2=p.PI_2,e.RAD_TO_DEG=p.RAD_TO_DEG,e.SHAPES=p.SHAPES},7944:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1965),n=i(9617);class s{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.radius=i,this.type=r.SHAPES.CIRC}clone(){return new s(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let r=this.x-t,n=this.y-e;return r*=r,n*=n,r+n<=i}getBounds(){return new n.Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}e.Circle=s},2006:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9617),n=i(1965);class s{constructor(t=0,e=0,i=0,r=0){this.x=t,this.y=e,this.width=i,this.height=r,this.type=n.SHAPES.ELIP}clone(){return new s(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,r=(e-this.y)/this.height;return i*=i,r*=r,i+r<=1}getBounds(){return new r.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)}}e.Ellipse=s},5272:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1965);class n{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if("number"!=typeof e[0]){const t=[];for(let i=0,r=e.length;i<r;i++)t.push(e[i].x,e[i].y);e=t}this.points=e,this.type=r.SHAPES.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new n(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let i=!1;const r=this.points.length/2;for(let n=0,s=r-1;n<r;s=n++){const r=this.points[2*n],a=this.points[2*n+1],o=this.points[2*s],l=this.points[2*s+1];a>e!=l>e&&t<(e-a)/(l-a)*(o-r)+r&&(i=!i)}return i}}e.Polygon=n},9617:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1965),n=i(8884);const s=[new n.Point,new n.Point,new n.Point,new n.Point];class a{constructor(t=0,e=0,i=0,n=0){this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(n),this.type=r.SHAPES.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new a(0,0,0,0)}clone(){return new a(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const e=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=e)return!1;const i=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>i}const i=this.left,r=this.right,n=this.top,a=this.bottom;if(r<=i||a<=n)return!1;const o=s[0].set(t.left,t.top),l=s[1].set(t.left,t.bottom),h=s[2].set(t.right,t.top),u=s[3].set(t.right,t.bottom);if(h.x<=o.x||l.y<=o.y)return!1;const c=Math.sign(e.a*e.d-e.b*e.c);if(0===c)return!1;if(e.apply(o,o),e.apply(l,l),e.apply(h,h),e.apply(u,u),Math.max(o.x,l.x,h.x,u.x)<=i||Math.min(o.x,l.x,h.x,u.x)>=r||Math.max(o.y,l.y,h.y,u.y)<=n||Math.min(o.y,l.y,h.y,u.y)>=a)return!1;const d=c*(l.y-o.y),p=c*(o.x-l.x),f=d*i+p*n,m=d*r+p*n,g=d*i+p*a,_=d*r+p*a;if(Math.max(f,m,g,_)<=d*o.x+p*o.y||Math.min(f,m,g,_)>=d*u.x+p*u.y)return!1;const y=c*(o.y-h.y),v=c*(h.x-o.x),x=y*i+v*n,b=y*r+v*n,E=y*i+v*a,T=y*r+v*a;return!(Math.max(x,b,E,T)<=y*o.x+v*o.y||Math.min(x,b,E,T)>=y*u.x+v*u.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this}}e.Rectangle=a},499:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1965);class n{constructor(t=0,e=0,i=0,n=0,s=20){this.x=t,this.y=e,this.width=i,this.height=n,this.radius=s,this.type=r.SHAPES.RREC}clone(){return new n(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let r=t-(this.x+i),n=e-(this.y+i);const s=i*i;if(r*r+n*n<=s)return!0;if(r=t-(this.x+this.width-i),r*r+n*n<=s)return!0;if(n=e-(this.y+this.height-i),r*r+n*n<=s)return!0;if(r=t-(this.x+i),r*r+n*n<=s)return!0}return!1}}e.RoundedRectangle=n},3024:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(1162);class s extends n.SimplePlane{constructor(t,e=10,i=10,n=10,s=10){super(r.Texture.WHITE,4,4),this._origWidth=t.orig.width,this._origHeight=t.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=e,this._rightWidth=n,this._topHeight=i,this._bottomHeight=s,this.texture=t}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}updateHorizontalVertices(){const t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height}updateVerticalVertices(){const t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width}_getMinScale(){const t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,i=this._topHeight+this._bottomHeight,r=this._height>i?1:this._height/i;return Math.min(e,r)}get width(){return this._width}set width(t){this._width=t,this._refresh()}get height(){return this._height}set height(t){this._height=t,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this._refresh()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this._refresh()}_refresh(){const t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;const i=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=i*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-i*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}e.NineSlicePlane=s},197:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1770),n=i(8742);class s extends r.Mesh{constructor(t=n.Texture.EMPTY,e,i,s,a){const o=new r.MeshGeometry(e,i,s);o.getBuffer("aVertexPosition").static=!1,super(o,new r.MeshMaterial(t),null,a),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}}e.SimpleMesh=s},1162:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(1770),s=i(2183);class a extends n.Mesh{constructor(t,e,i){super(new s.PlaneGeometry(t.width,t.height,e,i),new n.MeshMaterial(r.Texture.WHITE)),this.texture=t,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;const t=this.geometry,{width:e,height:i}=this.shader.texture;!this.autoResize||t.width===e&&t.height===i||(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())}set texture(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(t)}destroy(t){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(t)}}e.SimplePlane=a},2126:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1770),n=i(8742),s=i(3903);class a extends r.Mesh{constructor(t,e,i=0){const a=new s.RopeGeometry(t.height,e,i),o=new r.MeshMaterial(t);i>0&&(t.baseTexture.wrapMode=n.WRAP_MODES.REPEAT),super(a,o),this.autoUpdate=!0}_render(t){const e=this.geometry;(this.autoUpdate||e._width!==this.shader.texture.height)&&(e._width=this.shader.texture.height,e.update()),super._render(t)}}e.SimpleRope=a},2183:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1770);class n extends r.MeshGeometry{constructor(t=100,e=100,i=10,r=10){super(),this.segWidth=i,this.segHeight=r,this.width=t,this.height=e,this.build()}build(){const t=this.segWidth*this.segHeight,e=[],i=[],r=[],n=this.segWidth-1,s=this.segHeight-1,a=this.width/n,o=this.height/s;for(let r=0;r<t;r++){const t=r%this.segWidth,l=r/this.segWidth|0;e.push(t*a,l*o),i.push(t/n,l/s)}const l=n*s;for(let t=0;t<l;t++){const e=t%n,i=t/n|0,s=i*this.segWidth+e,a=i*this.segWidth+e+1,o=(i+1)*this.segWidth+e,l=(i+1)*this.segWidth+e+1;r.push(s,a,o,a,l,o)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}e.PlaneGeometry=n},3903:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1770);class n extends r.MeshGeometry{constructor(t=200,e,i=0){super(new Float32Array(4*e.length),new Float32Array(4*e.length),new Uint16Array(6*(e.length-1))),this.points=e,this._width=t,this.textureScale=i,this.build()}get width(){return this._width}build(){const t=this.points;if(!t)return;const e=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),r=this.getIndex();if(t.length<1)return;e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),i.data=new Float32Array(4*t.length),r.data=new Uint16Array(6*(t.length-1)));const n=i.data,s=r.data;n[0]=0,n[1]=0,n[2]=0,n[3]=1;let a=0,o=t[0];const l=this._width*this.textureScale,h=t.length;for(let e=0;e<h;e++){const i=4*e;if(this.textureScale>0){const i=o.x-t[e].x,r=o.y-t[e].y,n=Math.sqrt(i*i+r*r);o=t[e],a+=n/l}else a=e/(h-1);n[i]=a,n[i+1]=0,n[i+2]=a,n[i+3]=1}let u=0;for(let t=0;t<h-1;t++){const e=2*t;s[u++]=e,s[u++]=e+1,s[u++]=e+2,s[u++]=e+2,s[u++]=e+1,s[u++]=e+3}i.update(),r.update(),this.updateVertices()}updateVertices(){const t=this.points;if(t.length<1)return;let e,i=t[0],r=0,n=0;const s=this.buffers[0].data,a=t.length;for(let o=0;o<a;o++){const l=t[o],h=4*o;e=o<t.length-1?t[o+1]:l,n=-(e.x-i.x),r=e.y-i.y;let u=10*(1-o/(a-1));u>1&&(u=1);const c=Math.sqrt(r*r+n*n),d=this.textureScale>0?this.textureScale*this._width/2:this._width/2;r/=c,n/=c,r*=d,n*=d,s[h]=l.x+r,s[h+1]=l.y+n,s[h+2]=l.x-r,s[h+3]=l.y-n,i=l}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}e.RopeGeometry=n},261:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2183),n=i(3903),s=i(2126),a=i(1162),o=i(197),l=i(3024);e.PlaneGeometry=r.PlaneGeometry,e.RopeGeometry=n.RopeGeometry,e.SimpleRope=s.SimpleRope,e.SimplePlane=a.SimplePlane,e.SimpleMesh=o.SimpleMesh,e.NineSlicePlane=l.NineSlicePlane},9056:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(7191),s=i(4018);const a=new r.Point,o=new r.Polygon,l=class extends n.Container{constructor(t,e,i,n=r.DRAW_MODES.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=i||r.State.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=r.settings.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===r.DRAW_MODES.TRIANGLES&&e.length<2*l.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const n=this.transform.worldTransform,s=n.a,a=n.b,o=n.c,l=n.d,h=n.tx,u=n.ty,c=this.vertexData;for(let t=0;t<c.length/2;t++){const i=e[2*t],r=e[2*t+1];c[2*t]=s*i+o*r+h,c[2*t+1]=a*i+l*r+u}if(this._roundPixels){const t=r.settings.RESOLUTION;for(let e=0;e<c.length;++e)c[e]=Math.round(c[e]*t)/t}this.vertexDirty=i}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new s.MeshBatchUvs(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,a);const e=this.geometry.getBuffer("aVertexPosition").data,i=o.points,r=this.geometry.getIndex().data,n=r.length,s=4===this.drawMode?3:1;for(let t=0;t+2<n;t+=s){const n=2*r[t],s=2*r[t+1],l=2*r[t+2];if(i[0]=e[n],i[1]=e[n+1],i[2]=e[s],i[3]=e[s+1],i[4]=e[l],i[5]=e[l+1],o.contains(a.x,a.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let h=l;h.BATCHABLE_SIZE=100,e.Mesh=h},4018:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeshBatchUvs=class{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}},4528:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);class n extends r.Geometry{constructor(t,e,i){super();const n=new r.Buffer(t),s=new r.Buffer(e,!0),a=new r.Buffer(i,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,r.TYPES.FLOAT).addAttribute("aTextureCoord",s,2,!1,r.TYPES.FLOAT).addIndex(a),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}e.MeshGeometry=n},1705:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(1678),s=i(8549);class a extends r.Shader{constructor(t,e){const i={uSampler:t,alpha:1,uTextureMatrix:r.Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};(e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e)).uniforms&&Object.assign(i,e.uniforms),super(e.program||r.Program.from(s.default,n.default),i),this._colorDirty=!1,this.uvMatrix=new r.TextureMatrix(t),this.batchable=void 0===e.program,this.pluginName=e.pluginName,this.tint=e.tint,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)}get tint(){return this._tint}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture;r.utils.premultiplyTintToRgba(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}e.MeshMaterial=a},1770:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9056),n=i(4018),s=i(1705),a=i(4528);e.Mesh=r.Mesh,e.MeshBatchUvs=n.MeshBatchUvs,e.MeshMaterial=s.MeshMaterial,e.MeshGeometry=a.MeshGeometry},1678:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"},8549:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n"},8096:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(6903),s=i(7191);const a=new r.Matrix;s.DisplayObject.prototype._cacheAsBitmap=!1,s.DisplayObject.prototype._cacheData=null,s.DisplayObject.prototype._cacheAsBitmapResolution=null,s.DisplayObject.prototype._cacheAsBitmapMultisample=null;class o{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(s.DisplayObject.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap===t)return;let e;this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new o),e=this._cacheData,e.originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}),s.DisplayObject.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},s.DisplayObject.prototype._initCachedDisplayObject=function(t){if(this._cacheData?.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const i=this.getLocalBounds(null,!0).clone();if(this.filters?.length){const t=this.filters[0].padding;i.pad(t)}i.ceil(r.settings.RESOLUTION);const s=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),l=t.renderTexture.destinationFrame.clone(),h=t.projection.transform,u=r.RenderTexture.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),c=`cacheAsBitmap_${r.utils.uid()}`;this._cacheData.textureCacheId=c,r.BaseTexture.addToCache(u.baseTexture,c),r.Texture.addToCache(u,c);const d=this.transform.localTransform.copyTo(a).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:u,clear:!0,transform:d,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=h,t.renderTexture.bind(s,o,l),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const p=new n.Sprite(u);p.transform.worldTransform=this.transform.worldTransform,p.anchor.x=-i.x/i.width,p.anchor.y=-i.y/i.height,p.alpha=e,p._bounds=this._bounds,this._cacheData.sprite=p,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=p.containsPoint.bind(p)},s.DisplayObject.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},s.DisplayObject.prototype._initCachedDisplayObjectCanvas=function(t){if(this._cacheData?.sprite)return;const e=this.getLocalBounds(null,!0),i=this.alpha;this.alpha=1;const s=t.canvasContext.activeContext,o=t._projTransform;e.ceil(r.settings.RESOLUTION);const l=r.RenderTexture.create({width:e.width,height:e.height}),h=`cacheAsBitmap_${r.utils.uid()}`;this._cacheData.textureCacheId=h,r.BaseTexture.addToCache(l.baseTexture,h),r.Texture.addToCache(l,h);const u=a;this.transform.localTransform.copyTo(u),u.invert(),u.tx-=e.x,u.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:l,clear:!0,transform:u,skipUpdateTransform:!1}),t.canvasContext.activeContext=s,t._projTransform=o,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;const c=new n.Sprite(l);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-e.x/e.width,c.anchor.y=-e.y/e.height,c.alpha=i,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=c.containsPoint.bind(c)},s.DisplayObject.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},s.DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},s.DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,r.BaseTexture.removeFromCache(this._cacheData.textureCacheId),r.Texture.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},s.DisplayObject.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},e.CacheData=o},1939:(t,e,i)=>{"use strict";var r=i(7191);r.DisplayObject.prototype.name=null,r.Container.prototype.getChildByName=function(t,e){for(let e=0,i=this.children.length;e<i;e++)if(this.children[e].name===t)return this.children[e];if(e)for(let e=0,i=this.children.length;e<i;e++){const i=this.children[e];if(!i.getChildByName)continue;const r=i.getChildByName(t,!0);if(r)return r}return null}},5713:(t,e,i)=>{"use strict";var r=i(7191),n=i(8742);r.DisplayObject.prototype.getGlobalPosition=function(t=new n.Point,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t}},5858:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);e.ParticleBuffer=class{constructor(t,e,i){this.geometry=new r.Geometry,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let i=0;i<t.length;++i){let n=t[i];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||r.TYPES.FLOAT,offset:n.offset},e[i]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new r.Buffer(r.utils.createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let t=0;t<this.dynamicProperties.length;++t){const i=this.dynamicProperties[t];i.offset=e,e+=i.size,this.dynamicStride+=i.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new r.Buffer(this.dynamicData,!1,!1);let n=0;this.staticStride=0;for(let t=0;t<this.staticProperties.length;++t){const e=this.staticProperties[t];e.offset=n,n+=e.size,this.staticStride+=e.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new r.Buffer(this.staticData,!0,!1);for(let e=0;e<this.dynamicProperties.length;++e){const i=this.dynamicProperties[e];t.addAttribute(i.attributeName,this.dynamicBuffer,0,i.type===r.TYPES.UNSIGNED_BYTE,i.type,4*this.dynamicStride,4*i.offset)}for(let e=0;e<this.staticProperties.length;++e){const i=this.staticProperties[e];t.addAttribute(i.attributeName,this.staticBuffer,0,i.type===r.TYPES.UNSIGNED_BYTE,i.type,4*this.staticStride,4*i.offset)}}uploadDynamic(t,e,i){for(let n=0;n<this.dynamicProperties.length;n++){const s=this.dynamicProperties[n];s.uploadFunction(t,e,i,s.type===r.TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,i){for(let n=0;n<this.staticProperties.length;n++){const s=this.staticProperties[n];s.uploadFunction(t,e,i,s.type===r.TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}},9281:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(7191);class s extends n.Container{constructor(t=1500,e,i=16384,n=!1){super(),i>16384&&(i=16384),this._properties=[!1,!0,!1,!1,!1],this._maxSize=t,this._batchSize=i,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=r.BLEND_MODES.NORMAL,this.autoResize=n,this.roundPixels=!0,this.baseTexture=null,this.setProperties(e),this._tint=0,this.tintRgb=new Float32Array(4),this.tint=16777215}setProperties(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tint}set tint(t){this._tint=t,r.utils.hex2rgb(t,this.tintRgb)}render(t){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(()=>this.onChildrenChange(0)))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))}onChildrenChange(t){const e=Math.floor(t/this._batchSize);for(;this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID}dispose(){if(this._buffers){for(let t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}}destroy(t){super.destroy(t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}e.ParticleContainer=s},587:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(5858),s=i(7086),a=i(6972);class o extends r.ObjectRenderer{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new r.Matrix,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:r.TYPES.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=r.Shader.from(a.default,s.default,{}),this.state=r.State.for2d()}render(t){const e=t.children,i=t._maxSize,n=t._batchSize,s=this.renderer;let a=e.length;if(0===a)return;a>i&&!t.autoResize&&(a=i);let o=t._buffers;o||(o=t._buffers=this.generateBuffers(t));const l=e[0]._texture.baseTexture,h=l.alphaMode>0;this.state.blendMode=r.utils.correctBlendMode(t.blendMode,h),s.state.set(this.state);const u=s.gl,c=t.worldTransform.copyTo(this.tempMatrix);c.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=c.toArray(!0),this.shader.uniforms.uColor=r.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,h),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let d=!1;for(let i=0,r=0;i<a;i+=n,r+=1){let l=a-i;l>n&&(l=n),r>=o.length&&o.push(this._generateOneMoreBuffer(t));const h=o[r];h.uploadDynamic(e,i,l);const c=t._bufferUpdateIDs[r]||0;d=d||h._updateID<c,d&&(h._updateID=t._updateID,h.uploadStatic(e,i,l)),s.geometry.bind(h.geometry),u.drawElements(u.TRIANGLES,6*l,u.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],i=t._maxSize,r=t._batchSize,s=t._properties;for(let t=0;t<i;t+=r)e.push(new n.ParticleBuffer(this.properties,s,r));return e}_generateOneMoreBuffer(t){const e=t._batchSize,i=t._properties;return new n.ParticleBuffer(this.properties,i,e)}uploadVertices(t,e,i,r,n,s){let a=0,o=0,l=0,h=0;for(let u=0;u<i;++u){const i=t[e+u],c=i._texture,d=i.scale.x,p=i.scale.y,f=c.trim,m=c.orig;f?(o=f.x-i.anchor.x*m.width,a=o+f.width,h=f.y-i.anchor.y*m.height,l=h+f.height):(a=m.width*(1-i.anchor.x),o=m.width*-i.anchor.x,l=m.height*(1-i.anchor.y),h=m.height*-i.anchor.y),r[s]=o*d,r[s+1]=h*p,r[s+n]=a*d,r[s+n+1]=h*p,r[s+2*n]=a*d,r[s+2*n+1]=l*p,r[s+3*n]=o*d,r[s+3*n+1]=l*p,s+=4*n}}uploadPosition(t,e,i,r,n,s){for(let a=0;a<i;a++){const i=t[e+a].position;r[s]=i.x,r[s+1]=i.y,r[s+n]=i.x,r[s+n+1]=i.y,r[s+2*n]=i.x,r[s+2*n+1]=i.y,r[s+3*n]=i.x,r[s+3*n+1]=i.y,s+=4*n}}uploadRotation(t,e,i,r,n,s){for(let a=0;a<i;a++){const i=t[e+a].rotation;r[s]=i,r[s+n]=i,r[s+2*n]=i,r[s+3*n]=i,s+=4*n}}uploadUvs(t,e,i,r,n,s){for(let a=0;a<i;++a){const i=t[e+a]._texture._uvs;i?(r[s]=i.x0,r[s+1]=i.y0,r[s+n]=i.x1,r[s+n+1]=i.y1,r[s+2*n]=i.x2,r[s+2*n+1]=i.y2,r[s+3*n]=i.x3,r[s+3*n+1]=i.y3,s+=4*n):(r[s]=0,r[s+1]=0,r[s+n]=0,r[s+n+1]=0,r[s+2*n]=0,r[s+2*n+1]=0,r[s+3*n]=0,r[s+3*n+1]=0,s+=4*n)}}uploadTint(t,e,i,n,s,a){for(let o=0;o<i;++o){const i=t[e+o],l=i._texture.baseTexture.alphaMode>0,h=i.alpha,u=h<1&&l?r.utils.premultiplyTint(i._tintRGB,h):i._tintRGB+(255*h<<24);n[a]=u,n[a+s]=u,n[a+2*s]=u,n[a+3*s]=u,a+=4*s}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}o.extension={name:"particle",type:r.ExtensionType.RendererPlugin},r.extensions.add(o),e.ParticleRenderer=o},6661:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9281),n=i(587);e.ParticleContainer=r.ParticleContainer,e.ParticleRenderer=n.ParticleRenderer},7086:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}"},6972:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n"},550:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(7191),s=i(6338),a=i(4797);function o(t,e){let i=!1;if(t?._textures?.length)for(let n=0;n<t._textures.length;n++)if(t._textures[n]instanceof r.Texture){const r=t._textures[n].baseTexture;e.includes(r)||(e.push(r),i=!0)}return i}function l(t,e){if(t.baseTexture instanceof r.BaseTexture){const i=t.baseTexture;return e.includes(i)||e.push(i),!0}return!1}function h(t,e){if(t._texture&&t._texture instanceof r.Texture){const i=t._texture.baseTexture;return e.includes(i)||e.push(i),!0}return!1}function u(t,e){return e instanceof s.Text&&(e.updateText(!0),!0)}function c(t,e){if(e instanceof s.TextStyle){const t=e.toFontString();return s.TextMetrics.measureFont(t),!0}return!1}function d(t,e){if(t instanceof s.Text){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);const i=t._texture.baseTexture;return e.includes(i)||e.push(i),!0}return!1}function p(t,e){return t instanceof s.TextStyle&&(e.includes(t)||e.push(t),!0)}e.BasePrepare=class{constructor(t){this.limiter=new a.CountLimiter(r.settings.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(d),this.registerFindHook(p),this.registerFindHook(o),this.registerFindHook(l),this.registerFindHook(h),this.registerUploadHook(u),this.registerUploadHook(c)}upload(t){return new Promise((e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,r.Ticker.system.addOnce(this.tick,this,r.UPDATE_PRIORITY.UTILITY))):e()}))}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed)for(let i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)r.Ticker.system.addOnce(this.tick,this,r.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,i=t.length;e<i;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof n.Container)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&r.Ticker.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}}},4797:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CountLimiter=class{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}},5169:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(9296),s=i(550);function a(t,e){return e instanceof r.BaseTexture&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function o(t,e){if(!(e instanceof n.Graphics))return!1;const{geometry:i}=e;e.finishPoly(),i.updateBatches();const{batches:r}=i;for(let e=0;e<r.length;e++){const{texture:i}=r[e].style;i&&a(t,i.baseTexture)}return i.batchable||t.geometry.bind(i,e._resolveDirectShader(t)),!0}function l(t,e){return t instanceof n.Graphics&&(e.push(t),!0)}class h extends s.BasePrepare{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(l),this.registerUploadHook(a),this.registerUploadHook(o)}}h.extension={name:"prepare",type:r.ExtensionType.RendererSystem},r.extensions.add(h),e.Prepare=h},827:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TimeLimiter=class{constructor(t){this.maxMilliseconds=t,this.frameStart=0}beginFrame(){this.frameStart=Date.now()}allowedToUpload(){return Date.now()-this.frameStart<this.maxMilliseconds}}},2785:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(1932);var r=i(5169),n=i(550),s=i(4797),a=i(827);e.Prepare=r.Prepare,e.BasePrepare=n.BasePrepare,e.CountLimiter=s.CountLimiter,e.TimeLimiter=a.TimeLimiter},1932:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);r.settings.UPLOADS_PER_FRAME=4,Object.defineProperty(e,"settings",{enumerable:!0,get:function(){return r.settings}})},8791:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,i,r,n,s,a,o){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:h}=this;this._aliasCount++;for(let u=0,c=h.length;u<c;u++)h[u][l](t,e,i,r,n,s,a,o);return h===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return 0===this.items.length}get name(){return this._name}}Object.defineProperties(i.prototype,{dispatch:{value:i.prototype.emit},run:{value:i.prototype.emit}}),e.Runner=i},2156:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8791);e.Runner=r.Runner},7916:()=>{},8538:()=>{},8718:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i={createCanvas:(t,e)=>{const i=document.createElement("canvas");return i.width=t,i.height=e,i},getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e)};e.BrowserAdapter=i},2709:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6122);e.default=r.default},6122:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=/iPhone/i,r=/iPod/i,n=/iPad/i,s=/\biOS-universal(?:.+)Mac\b/i,a=/\bAndroid(?:.+)Mobile\b/i,o=/Android/i,l=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,h=/Silk/i,u=/Windows Phone/i,c=/\bWindows(?:.+)ARM\b/i,d=/BlackBerry/i,p=/BB10/i,f=/Opera Mini/i,m=/\b(CriOS|Chrome)(?:.+)Mobile/i,g=/Mobile(?:.+)Firefox\b/i,_=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};e.default=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var y=e.userAgent,v=y.split("[FBAN");void 0!==v[1]&&(y=v[0]),void 0!==(v=y.split("Twitter"))[1]&&(y=v[0]);var x=function(t){return function(e){return e.test(t)}}(y),b={apple:{phone:x(i)&&!x(u),ipod:x(r),tablet:!x(i)&&(x(n)||_(e))&&!x(u),universal:x(s),device:(x(i)||x(r)||x(n)||x(s)||_(e))&&!x(u)},amazon:{phone:x(l),tablet:!x(l)&&x(h),device:x(l)||x(h)},android:{phone:!x(u)&&x(l)||!x(u)&&x(a),tablet:!x(u)&&!x(l)&&!x(a)&&(x(h)||x(o)),device:!x(u)&&(x(l)||x(h)||x(a)||x(o))||x(/\bokhttp\b/i)},windows:{phone:x(u),tablet:x(c),device:x(u)||x(c)},other:{blackberry:x(d),blackberry10:x(p),opera:x(f),firefox:x(g),chrome:x(m),device:x(d)||x(p)||x(f)||x(g)||x(m)},any:!1,phone:!1,tablet:!1};return b.any=b.apple.device||b.android.device||b.windows.device||b.other.device,b.phone=b.apple.phone||b.android.phone||b.windows.phone,b.tablet=b.apple.tablet||b.android.tablet||b.windows.tablet,b}},2101:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7878),n=i(4658),s=i(8718);i(7916),i(8538),e.settings=r.settings,e.isMobile=n.isMobile,e.BrowserAdapter=s.BrowserAdapter},7878:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616),n=i(8718),s=i(7557),a=i(4658),o=i(4217);const l={ADAPTER:n.BrowserAdapter,MIPMAP_TEXTURES:r.MIPMAP_MODES.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:r.MSAA_QUALITY.NONE,SPRITE_MAX_TEXTURES:o.maxRecommendedTextures(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1,hello:!1},GC_MODE:r.GC_MODES.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:r.WRAP_MODES.CLAMP,SCALE_MODE:r.SCALE_MODES.LINEAR,PRECISION_VERTEX:r.PRECISION.HIGH,PRECISION_FRAGMENT:a.isMobile.apple.device?r.PRECISION.HIGH:r.PRECISION.MEDIUM,CAN_UPLOAD_SAME_BUFFER:s.canUploadSameBuffer(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};e.settings=l},7557:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4658);e.canUploadSameBuffer=function(){return!r.isMobile.apple.device}},4658:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(2709);const r=i(6122).default(globalThis.navigator);e.isMobile=r},4217:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4658);e.maxRecommendedTextures=function(t){let e=!0;if(r.isMobile.tablet||r.isMobile.phone){if(r.isMobile.apple.device){const t=navigator.userAgent.match(/OS (\d+)_(\d+)?/);t&&parseInt(t[1],10)<11&&(e=!1)}if(r.isMobile.android.device){const t=navigator.userAgent.match(/Android\s([0-9.]*)/);t&&parseInt(t[1],10)<7&&(e=!1)}}return e?t:4}},7596:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6903),n=i(8742);class s extends r.Sprite{constructor(t,e=!0){super(t[0]instanceof n.Texture?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=e,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(n.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(n.Ticker.shared.add(this.update,this,n.UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=this.animationSpeed*t,i=this.currentFrame;if(null!==this._durations){let i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];const r=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*r,this._currentTime+=r;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this.updateTexture())}updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let i=0;i<t.length;++i)e.push(n.Texture.from(t[i]));return new s(e)}static fromImages(t){const e=[];for(let i=0;i<t.length;++i)e.push(n.Texture.from(t[i]));return new s(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof n.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(n.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(n.Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))}}e.AnimatedSprite=s},2693:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7596);e.AnimatedSprite=r.AnimatedSprite},568:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(6903);const s=new r.Point;class a extends n.Sprite{constructor(t,e=100,i=100){super(t),this.tileTransform=new r.Transform,this._width=e,this._height=i,this.uvMatrix=this.texture.uvMatrix||new r.TextureMatrix(t),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(t){this.tileTransform.scale.copyFrom(t)}get tilePosition(){return this.tileTransform.position}set tilePosition(t){this.tileTransform.position.copyFrom(t)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(t){const e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))}_calculateBounds(){const t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,i,r)}getLocalBounds(t){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new r.Rectangle),t=this._localBoundsRect),this._bounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,s);const e=this._width,i=this._height,r=-e*this.anchor._x;if(s.x>=r&&s.x<r+e){const t=-i*this.anchor._y;if(s.y>=t&&s.y<t+i)return!0}return!1}destroy(t){super.destroy(t),this.tileTransform=null,this.uvMatrix=null}static from(t,e){const i=t instanceof r.Texture?t:r.Texture.from(t,e);return new a(i,e.width,e.height)}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}}e.TilingSprite=a},2097:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(5985),s=i(8063),a=i(2355),o=i(6642),l=i(5262);const h=new r.Matrix;class u extends r.ObjectRenderer{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new r.QuadUv,this.state=r.State.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=r.Shader.from(s.default,n.default,e),this.shader=t.context.webGLVersion>1?r.Shader.from(o.default,l.default,e):r.Shader.from(s.default,a.default,e)}render(t){const e=this.renderer,i=this.quad;let n=i.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y);const s=t.uvRespectAnchor?t.anchor.x:0,a=t.uvRespectAnchor?t.anchor.y:0;n=i.uvs,n[0]=n[6]=-s,n[1]=n[3]=-a,n[2]=n[4]=1-s,n[5]=n[7]=1-a,i.invalidate();const o=t._texture,l=o.baseTexture,u=l.alphaMode>0,c=t.tileTransform.localTransform,d=t.uvMatrix;let p=l.isPowerOfTwo&&o.frame.width===l.width&&o.frame.height===l.height;p&&(l._glTextures[e.CONTEXT_UID]?p=l.wrapMode!==r.WRAP_MODES.CLAMP:l.wrapMode===r.WRAP_MODES.CLAMP&&(l.wrapMode=r.WRAP_MODES.REPEAT));const f=p?this.simpleShader:this.shader,m=o.width,g=o.height,_=t._width,y=t._height;h.set(c.a*m/_,c.b*m/y,c.c*g/_,c.d*g/y,c.tx/_,c.ty/y),h.invert(),p?h.prepend(d.mapCoord):(f.uniforms.uMapCoord=d.mapCoord.toArray(!0),f.uniforms.uClampFrame=d.uClampFrame,f.uniforms.uClampOffset=d.uClampOffset),f.uniforms.uTransform=h.toArray(!0),f.uniforms.uColor=r.utils.premultiplyTintToRgba(t.tint,t.worldAlpha,f.uniforms.uColor,u),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=o,e.shader.bind(f),e.geometry.bind(i),this.state.blendMode=r.utils.correctBlendMode(t.blendMode,u),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}u.extension={name:"tilingSprite",type:r.ExtensionType.RendererPlugin},r.extensions.add(u),e.TilingSpriteRenderer=u},4258:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(568),n=i(2097);e.TilingSprite=r.TilingSprite,e.TilingSpriteRenderer=n.TilingSpriteRenderer},8063:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n"},2355:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n"},5985:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n"},6642:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n"},5262:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n"},8268:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(7191);const s=new r.Point,a=new Uint16Array([0,1,2,0,2,3]);class o extends n.Container{constructor(t){super(),this._anchor=new r.ObservablePoint(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=r.BLEND_MODES.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||r.Texture.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=a,this.pluginName="batch",this.isSprite=!0,this._roundPixels=r.settings.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=r.utils.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=r.utils.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,i=e.a,n=e.b,s=e.c,a=e.d,o=e.tx,l=e.ty,h=this.vertexData,u=t.trim,c=t.orig,d=this._anchor;let p=0,f=0,m=0,g=0;if(u?(f=u.x-d._x*c.width,p=f+u.width,g=u.y-d._y*c.height,m=g+u.height):(f=-d._x*c.width,p=f+c.width,g=-d._y*c.height,m=g+c.height),h[0]=i*f+s*g+o,h[1]=a*g+n*f+l,h[2]=i*p+s*g+o,h[3]=a*g+n*p+l,h[4]=i*p+s*m+o,h[5]=a*m+n*p+l,h[6]=i*f+s*m+o,h[7]=a*m+n*f+l,this._roundPixels){const t=r.settings.RESOLUTION;for(let e=0;e<h.length;++e)h[e]=Math.round(h[e]*t)/t}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,i=t.orig,r=this._anchor,n=this.transform.worldTransform,s=n.a,a=n.b,o=n.c,l=n.d,h=n.tx,u=n.ty,c=-r._x*i.width,d=c+i.width,p=-r._y*i.height,f=p+i.height;e[0]=s*c+o*p+h,e[1]=l*p+a*c+u,e[2]=s*d+o*p+h,e[3]=l*p+a*d+u,e[4]=s*d+o*f+h,e[5]=l*f+a*d+u,e[6]=s*c+o*f+h,e[7]=l*f+a*c+u}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return 0===this.children.length?(this._localBounds||(this._localBounds=new n.Bounds),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new r.Rectangle),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,s);const e=this._texture.orig.width,i=this._texture.orig.height,r=-e*this.anchor.x;let n=0;return s.x>=r&&s.x<r+e&&(n=-i*this.anchor.y,s.y>=n&&s.y<n+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof t?t:t?.texture){const e="boolean"==typeof t?t:t?.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const i=t instanceof r.Texture?t:r.Texture.from(t,e);return new o(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=r.utils.sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=r.utils.sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tint}set tint(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||r.Texture.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}e.Sprite=o},6903:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8268);e.Sprite=r.Sprite},5031:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);const n=class{constructor(t,e,i=null){this.linkedSheets=[],this._texture=t instanceof r.Texture?t:null,this.baseTexture=t instanceof r.BaseTexture?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;const n=this.baseTexture.resource;this.resolution=this._updateResolution(i||(n?n.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let i=r.utils.getResolutionOfUrl(t,null);return null===i&&(i=parseFloat(e??"1")),1!==i&&this.baseTexture.setResolution(i),i}parse(){return new Promise((t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=n.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()}))}_processFrames(t){let e=t;const i=n.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){const t=this._frameKeys[e],i=this._frames[t],n=i.frame;if(n){let e=null,s=null;const a=!1!==i.trimmed&&i.sourceSize?i.sourceSize:i.frame,o=new r.Rectangle(0,0,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution);e=i.rotated?new r.Rectangle(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.h)/this.resolution,Math.floor(n.w)/this.resolution):new r.Rectangle(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution),!1!==i.trimmed&&i.spriteSourceSize&&(s=new r.Rectangle(Math.floor(i.spriteSourceSize.x)/this.resolution,Math.floor(i.spriteSourceSize.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution)),this.textures[t]=new r.Texture(this.baseTexture,e,o,s,i.rotated?2:0,i.anchor),r.Texture.addToCache(this.textures[t],t)}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const r=t[e][i];this.animations[e].push(this.textures[r])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*n.BATCH_SIZE),this._batchIndex++,setTimeout((()=>{this._batchIndex*n.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())}),0)}destroy(t=!1){for(const t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let s=n;s.BATCH_SIZE=1e3,e.Spritesheet=s},9432:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(5031),n=i(2650);e.Spritesheet=r.Spritesheet,e.spritesheetAsset=n.spritesheetAsset},2650:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(8415),s=i(5031);const a=["jpg","png","jpeg","avif","webp"];function o(t,e,i){const n={};if(t.forEach((t=>{n[t]=e})),Object.keys(e.textures).forEach((t=>{n[t]=e.textures[t]})),!i){const i=r.utils.path.dirname(t[0]);e.linkedSheets.forEach(((t,r)=>{const s=o([`${i}/${e.data.meta.related_multi_packs[r]}`],t,!0);Object.assign(n,s)}))}return n}const l={extension:r.ExtensionType.Asset,cache:{test:t=>t instanceof s.Spritesheet,getCacheableAssets:(t,e)=>o(t,e,!1)},resolver:{test:t=>{const e=t.split("?")[0].split("."),i=e.pop(),r=e.pop();return"json"===i&&a.includes(r)},parse:t=>{const e=t.split(".");return{resolution:parseFloat(r.settings.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{extension:{type:r.ExtensionType.LoadParser,priority:n.LoaderParserPriority.Normal},testParse:async(t,e)=>r.utils.path.extname(e.src).includes(".json")&&!!t.frames,async parse(t,e,i){let n=r.utils.path.dirname(e.src);n&&n.lastIndexOf("/")!==n.length-1&&(n+="/");const a=n+t.meta.image,o=(await i.load([a]))[a],l=new s.Spritesheet(o.baseTexture,t,e.src);await l.parse();const h=t?.meta?.related_multi_packs;if(Array.isArray(h)){const t=[];for(const r of h){if("string"!=typeof r)continue;const s=n+r;e.data?.ignoreMultiPack||t.push(i.load({src:s,data:{ignoreMultiPack:!0}}))}const r=await Promise.all(t);l.linkedSheets=r,r.forEach((t=>{t.linkedSheets=[l].concat(l.linkedSheets.filter((e=>e!==t)))}))}return l},unload(t){t.destroy(!0)}}};r.extensions.add(l),e.spritesheetAsset=l},6362:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(6338),s=i(4772),a=i(9238);i(9307);var o=i(1717),l=i(5375),h=i(171);const u=class{constructor(t,e,i){const[n]=t.info,[s]=t.common,[a]=t.page,[o]=t.distanceField,l=r.utils.getResolutionOfUrl(a.file),h={};this._ownsTextures=i,this.font=n.face,this.size=n.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=h;for(let i=0;i<t.page.length;i++){const{id:n,file:s}=t.page[i];h[n]=e instanceof Array?e[i]:e[s],o?.fieldType&&"none"!==o.fieldType&&(h[n].baseTexture.alphaMode=r.ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,h[n].baseTexture.mipmap=r.MIPMAP_MODES.OFF)}for(let e=0;e<t.char.length;e++){const{id:i,page:n}=t.char[e];let{x:s,y:a,width:o,height:u,xoffset:c,yoffset:d,xadvance:p}=t.char[e];s/=l,a/=l,o/=l,u/=l,c/=l,d/=l,p/=l;const f=new r.Rectangle(s+h[n].frame.x/l,a+h[n].frame.y/l,o,u);this.chars[i]={xOffset:c,yOffset:d,xAdvance:p,kerning:{},texture:new r.Texture(h[n].baseTexture,f),page:n}}for(let e=0;e<t.kerning.length;e++){let{first:i,second:r,amount:n}=t.kerning[e];i/=l,r/=l,n/=l,this.chars[r]&&(this.chars[r].kerning[i]=n)}this.distanceFieldRange=o?.distanceRange,this.distanceFieldType=o?.fieldType?.toLowerCase()??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,i){let n;if(t instanceof a.BitmapFontData)n=t;else{const e=s.autoDetectFormat(t);if(!e)throw new Error("Unrecognized data format for font.");n=e.parse(t)}e instanceof r.Texture&&(e=[e]);const o=new u(n,e,i);return u.available[o.font]=o,o}static uninstall(t){const e=u.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete u.available[t]}static from(t,e,i){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:s,padding:c,resolution:d,textureWidth:p,textureHeight:f,...m}=Object.assign({},u.defaultOptions,i),g=o.resolveCharacters(s),_=e instanceof n.TextStyle?e:new n.TextStyle(e),y=p,v=new a.BitmapFontData;v.info[0]={face:_.fontFamily,size:_.fontSize},v.common[0]={lineHeight:_.fontSize};let x,b,E,T=0,S=0,w=0;const A=[],I=[];for(let t=0;t<g.length;t++){x||(x=r.settings.ADAPTER.createCanvas(),x.width=p,x.height=f,b=x.getContext("2d"),E=new r.BaseTexture(x,{resolution:d,...m}),A.push(E),I.push(new r.Texture(E)),v.page.push({id:I.length-1,file:""}));const e=g[t],i=n.TextMetrics.measureText(e,_,!1,x),s=i.width,a=Math.ceil(i.height),o=Math.ceil(("italic"===_.fontStyle?2:1)*s);if(S>=f-a*d){if(0===S)throw new Error(`[BitmapFont] textureHeight ${f}px is too small (fontFamily: '${_.fontFamily}', fontSize: ${_.fontSize}px, char: '${e}')`);--t,x=null,b=null,E=null,S=0,T=0,w=0;continue}if(w=Math.max(a+i.fontProperties.descent,w),o*d+T>=y){if(0===T)throw new Error(`[BitmapFont] textureWidth ${p}px is too small (fontFamily: '${_.fontFamily}', fontSize: ${_.fontSize}px, char: '${e}')`);--t,S+=w*d,S=Math.ceil(S),T=0,w=0;continue}l.drawGlyph(x,b,i,T,S,d,_);const u=h.extractCharCode(i.text);v.char.push({id:u,page:I.length-1,x:T/d,y:S/d,width:o,height:a,xoffset:0,yoffset:0,xadvance:Math.ceil(s-(_.dropShadow?_.dropShadowDistance:0)-(_.stroke?_.strokeThickness:0))}),T+=(o+2*c)*d,T=Math.ceil(T)}for(let t=0,e=g.length;t<e;t++){const i=g[t];for(let t=0;t<e;t++){const e=g[t],r=b.measureText(i).width,n=b.measureText(e).width,s=b.measureText(i+e).width-(r+n);s&&v.kerning.push({first:h.extractCharCode(i),second:h.extractCharCode(e),amount:s})}}const R=new u(v,I,!0);return void 0!==u.available[t]&&u.uninstall(t),u.available[t]=R,R}};let c=u;c.ALPHA=[["a","z"],["A","Z"]," "],c.NUMERIC=[["0","9"]],c.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],c.ASCII=[[" ","~"]],c.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:u.ALPHANUMERIC},c.available={},e.BitmapFont=c},9238:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFontData=class{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}},8236:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1770),n=i(6362);i(9307);var s=i(7088),a=i(6670),o=i(8742),l=i(7191),h=i(4937),u=i(171);const c=[],d=[],p=[],f=class extends l.Container{constructor(t,e={}){super(),this._tint=16777215;const{align:i,tint:r,maxWidth:s,letterSpacing:a,fontName:l,fontSize:h}=Object.assign({},f.styleDefaults,e);if(!n.BitmapFont.available[l])throw new Error(`Missing BitmapFont "${l}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tint=r,this._font=void 0,this._fontName=l,this._fontSize=h,this.text=t,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=a,this._anchor=new o.ObservablePoint((()=>{this.dirty=!0}),this,0,0),this._roundPixels=o.settings.ROUND_PIXELS,this.dirty=!0,this._resolution=o.settings.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){const t=n.BitmapFont.available[this._fontName],e=this.fontSize,i=e/t.size,l=new o.Point,f=[],m=[],g=[],_=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",y=h.splitTextToCharacters(_),v=this._maxWidth*t.size/e,x="none"===t.distanceFieldType?c:d;let b=null,E=0,T=0,S=0,w=-1,A=0,I=0,R=0,C=0;for(let e=0;e<y.length;e++){const i=y[e],r=u.extractCharCode(i);if(/(?:\s)/.test(i)&&(w=e,A=E,C++),"\r"===i||"\n"===i){m.push(E),g.push(-1),T=Math.max(T,E),++S,++I,l.x=0,l.y+=t.lineHeight,b=null,C=0;continue}const n=t.chars[r];if(!n)continue;b&&n.kerning[b]&&(l.x+=n.kerning[b]);const s=p.pop()||{texture:o.Texture.EMPTY,line:0,charCode:0,prevSpaces:0,position:new o.Point};s.texture=n.texture,s.line=S,s.charCode=r,s.position.x=l.x+n.xOffset+this._letterSpacing/2,s.position.y=l.y+n.yOffset,s.prevSpaces=C,f.push(s),E=s.position.x+Math.max(n.xAdvance-n.xOffset,n.texture.orig.width),l.x+=n.xAdvance+this._letterSpacing,R=Math.max(R,n.yOffset+n.texture.height),b=r,-1!==w&&v>0&&l.x>v&&(++I,o.utils.removeItems(f,1+w-I,1+e-w),e=w,w=-1,m.push(A),g.push(f.length>0?f[f.length-1].prevSpaces:0),T=Math.max(T,A),S++,l.x=0,l.y+=t.lineHeight,b=null,C=0)}const M=y[y.length-1];"\r"!==M&&"\n"!==M&&(/(?:\s)/.test(M)&&(E=A),m.push(E),T=Math.max(T,E),g.push(-1));const O=[];for(let t=0;t<=S;t++){let e=0;"right"===this._align?e=T-m[t]:"center"===this._align?e=(T-m[t])/2:"justify"===this._align&&(e=g[t]<0?0:(T-m[t])/g[t]),O.push(e)}const P=f.length,k={},D=[],N=this._activePagesMeshData;x.push(...N);for(let e=0;e<P;e++){const i=f[e].texture,n=i.baseTexture.uid;if(!k[n]){let e=x.pop();if(!e){const i=new r.MeshGeometry;let n,l;"none"===t.distanceFieldType?(n=new r.MeshMaterial(o.Texture.EMPTY),l=o.BLEND_MODES.NORMAL):(n=new r.MeshMaterial(o.Texture.EMPTY,{program:o.Program.from(a.default,s.default),uniforms:{uFWidth:0}}),l=o.BLEND_MODES.NORMAL_NPM);const h=new r.Mesh(i,n);h.blendMode=l,e={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:h,vertices:null,uvs:null,indices:null}}e.index=0,e.indexCount=0,e.vertexCount=0,e.uvsCount=0,e.total=0;const{_textureCache:l}=this;l[n]=l[n]||new o.Texture(i.baseTexture),e.mesh.texture=l[n],e.mesh.tint=this._tint,D.push(e),k[n]=e}k[n].total++}for(let t=0;t<N.length;t++)D.includes(N[t])||this.removeChild(N[t].mesh);for(let t=0;t<D.length;t++)D[t].mesh.parent!==this&&this.addChild(D[t].mesh);this._activePagesMeshData=D;for(const t in k){const e=k[t],i=e.total;if(!(e.indices?.length>6*i)||e.vertices.length<2*r.Mesh.BATCHABLE_SIZE)e.vertices=new Float32Array(8*i),e.uvs=new Float32Array(8*i),e.indices=new Uint16Array(6*i);else{const t=e.total,i=e.vertices;for(let e=4*t*2;e<i.length;e++)i[e]=0}e.mesh.size=6*i}for(let t=0;t<P;t++){const e=f[t];let r=e.position.x+O[e.line]*("justify"===this._align?e.prevSpaces:1);this._roundPixels&&(r=Math.round(r));const n=r*i,s=e.position.y*i,a=e.texture,o=k[a.baseTexture.uid],l=a.frame,h=a._uvs,u=o.index++;o.indices[6*u+0]=0+4*u,o.indices[6*u+1]=1+4*u,o.indices[6*u+2]=2+4*u,o.indices[6*u+3]=0+4*u,o.indices[6*u+4]=2+4*u,o.indices[6*u+5]=3+4*u,o.vertices[8*u+0]=n,o.vertices[8*u+1]=s,o.vertices[8*u+2]=n+l.width*i,o.vertices[8*u+3]=s,o.vertices[8*u+4]=n+l.width*i,o.vertices[8*u+5]=s+l.height*i,o.vertices[8*u+6]=n,o.vertices[8*u+7]=s+l.height*i,o.uvs[8*u+0]=h.x0,o.uvs[8*u+1]=h.y0,o.uvs[8*u+2]=h.x1,o.uvs[8*u+3]=h.y1,o.uvs[8*u+4]=h.x2,o.uvs[8*u+5]=h.y2,o.uvs[8*u+6]=h.x3,o.uvs[8*u+7]=h.y3}this._textWidth=T*i,this._textHeight=(l.y+t.lineHeight)*i;for(const t in k){const e=k[t];if(0!==this.anchor.x||0!==this.anchor.y){let t=0;const i=this._textWidth*this.anchor.x,r=this._textHeight*this.anchor.y;for(let n=0;n<e.total;n++)e.vertices[t++]-=i,e.vertices[t++]-=r,e.vertices[t++]-=i,e.vertices[t++]-=r,e.vertices[t++]-=i,e.vertices[t++]-=r,e.vertices[t++]-=i,e.vertices[t++]-=r}this._maxLineHeight=R*i;const r=e.mesh.geometry.getBuffer("aVertexPosition"),n=e.mesh.geometry.getBuffer("aTextureCoord"),s=e.mesh.geometry.getIndex();r.data=e.vertices,n.data=e.uvs,s.data=e.indices,r.update(),n.update(),s.update()}for(let t=0;t<f.length;t++)p.push(f[t]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:i,size:r}=n.BitmapFont.available[this._fontName];if("none"!==i){const{a:i,b:n,c:s,d:a}=this.worldTransform,o=Math.sqrt(i*i+n*n),l=Math.sqrt(s*s+a*a),h=(Math.abs(o)+Math.abs(l))/2,u=this.fontSize/r,c=t._view.resolution;for(const t of this._activePagesMeshData)t.mesh.shader.uniforms.uFWidth=h*e*u*c}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=n.BitmapFont.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tint}set tint(t){if(this._tint!==t){this._tint=t;for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!n.BitmapFont.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??n.BitmapFont.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,i="none"===n.BitmapFont.available[this._fontName].distanceFieldType?c:d;i.push(...this._activePagesMeshData);for(const t of this._activePagesMeshData)this.removeChild(t.mesh);this._activePagesMeshData=[],i.filter((t=>e[t.mesh.texture.baseTexture.uid])).forEach((t=>{t.mesh.texture=o.Texture.EMPTY}));for(const t in e)e[t].destroy(),delete e[t];this._font=null,this._textureCache=null,super.destroy(t)}};let m=f;m.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},e.BitmapText=m},4289:()=>{},9340:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9238);e.TextFormat=class{static test(t){return"string"==typeof t&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const t in e){const r=e[t].match(/^[a-z]+/gm)[0],n=e[t].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(const t in n){const e=n[t].split("="),i=e[0],r=e[1].replace(/"/gm,""),a=parseFloat(r),o=isNaN(a)?r:a;s[i]=o}i[r].push(s)}const n=new r.BitmapFontData;return i.info.forEach((t=>n.info.push({face:t.face,size:parseInt(t.size,10)}))),i.common.forEach((t=>n.common.push({lineHeight:parseInt(t.lineHeight,10)}))),i.page.forEach((t=>n.page.push({id:parseInt(t.id,10),file:t.file}))),i.char.forEach((t=>n.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)}))),i.kerning.forEach((t=>n.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)}))),i.distanceField.forEach((t=>n.distanceField.push({distanceRange:parseInt(t.distanceRange,10),fieldType:t.fieldType}))),n}}},6257:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9238);e.XMLFormat=class{static test(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")}static parse(t){const e=new r.BitmapFontData,i=t.getElementsByTagName("info"),n=t.getElementsByTagName("common"),s=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning"),l=t.getElementsByTagName("distanceField");for(let t=0;t<i.length;t++)e.info.push({face:i[t].getAttribute("face"),size:parseInt(i[t].getAttribute("size"),10)});for(let t=0;t<n.length;t++)e.common.push({lineHeight:parseInt(n[t].getAttribute("lineHeight"),10)});for(let t=0;t<s.length;t++)e.page.push({id:parseInt(s[t].getAttribute("id"),10)||0,file:s[t].getAttribute("file")});for(let t=0;t<a.length;t++){const i=a[t];e.char.push({id:parseInt(i.getAttribute("id"),10),page:parseInt(i.getAttribute("page"),10)||0,x:parseInt(i.getAttribute("x"),10),y:parseInt(i.getAttribute("y"),10),width:parseInt(i.getAttribute("width"),10),height:parseInt(i.getAttribute("height"),10),xoffset:parseInt(i.getAttribute("xoffset"),10),yoffset:parseInt(i.getAttribute("yoffset"),10),xadvance:parseInt(i.getAttribute("xadvance"),10)})}for(let t=0;t<o.length;t++)e.kerning.push({first:parseInt(o[t].getAttribute("first"),10),second:parseInt(o[t].getAttribute("second"),10),amount:parseInt(o[t].getAttribute("amount"),10)});for(let t=0;t<l.length;t++)e.distanceField.push({fieldType:l[t].getAttribute("fieldType"),distanceRange:parseInt(l[t].getAttribute("distanceRange"),10)});return e}}},4869:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6257);e.XMLStringFormat=class{static test(t){if("string"==typeof t&&t.includes("<font>")){const e=(new globalThis.DOMParser).parseFromString(t,"text/xml");return r.XMLFormat.test(e)}return!1}static parse(t){const e=(new globalThis.DOMParser).parseFromString(t,"text/xml");return r.XMLFormat.parse(e)}}},4772:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9340),n=i(6257),s=i(4869);const a=[r.TextFormat,n.XMLFormat,s.XMLStringFormat];e.TextFormat=r.TextFormat,e.XMLFormat=n.XMLFormat,e.XMLStringFormat=s.XMLStringFormat,e.autoDetectFormat=function(t){for(let e=0;e<a.length;e++)if(a[e].test(t))return a[e];return null}},3485:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6362),n=i(9238),s=i(8236);i(4289);var a=i(4772),o=i(4457),l=i(9340),h=i(6257),u=i(4869);e.BitmapFont=r.BitmapFont,e.BitmapFontData=n.BitmapFontData,e.BitmapText=s.BitmapText,e.autoDetectFormat=a.autoDetectFormat,e.loadBitmapFont=o.loadBitmapFont,e.TextFormat=l.TextFormat,e.XMLFormat=h.XMLFormat,e.XMLStringFormat=u.XMLStringFormat},4457:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742),n=i(8415),s=i(6362);i(4772);var a=i(9340),o=i(4869);const l=[".xml",".fnt"],h={extension:{type:r.ExtensionType.LoadParser,priority:n.LoaderParserPriority.Normal},test:t=>l.includes(r.utils.path.extname(t)),testParse:async t=>a.TextFormat.test(t)||o.XMLStringFormat.test(t),async parse(t,e,i){const n=a.TextFormat.test(t)?a.TextFormat.parse(t):o.XMLStringFormat.parse(t),{src:l}=e,{page:h}=n,u=[];for(let t=0;t<h.length;++t){const e=h[t].file,i=r.utils.path.join(r.utils.path.dirname(l),e);u.push(i)}const c=await i.load(u),d=u.map((t=>c[t]));return s.BitmapFont.install(n,d,!0)},load:async(t,e)=>(await r.settings.ADAPTER.fetch(t)).text(),unload(t){t.destroy()}};r.extensions.add(h),e.loadBitmapFont=h},7088:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r\n\r\n}\r\n"},6670:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n"},5375:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9402),n=i(8742);e.drawGlyph=function(t,e,i,s,a,o,l){const h=i.text,u=i.fontProperties;e.translate(s,a),e.scale(o,o);const c=l.strokeThickness/2,d=-l.strokeThickness/2;if(e.font=l.toFontString(),e.lineWidth=l.strokeThickness,e.textBaseline=l.textBaseline,e.lineJoin=l.lineJoin,e.miterLimit=l.miterLimit,e.fillStyle=r.generateFillStyle(t,e,l,o,[h],i),e.strokeStyle=l.stroke,l.dropShadow){const t=l.dropShadowColor,i=n.utils.hex2rgb("number"==typeof t?t:n.utils.string2hex(t)),r=l.dropShadowBlur*o,s=l.dropShadowDistance*o;e.shadowColor=`rgba(${255*i[0]},${255*i[1]},${255*i[2]},${l.dropShadowAlpha})`,e.shadowBlur=r,e.shadowOffsetX=Math.cos(l.dropShadowAngle)*s,e.shadowOffsetY=Math.sin(l.dropShadowAngle)*s}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;l.stroke&&l.strokeThickness&&e.strokeText(h,c,d+i.lineHeight-u.descent),l.fill&&e.fillText(h,c,d+i.lineHeight-u.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}},171:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.extractCharCode=function(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}},9402:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6338);e.generateFillStyle=function(t,e,i,n,s,a){const o=i.fill;if(!Array.isArray(o))return o;if(1===o.length)return o[0];let l;const h=i.dropShadow?i.dropShadowDistance:0,u=i.padding||0,c=t.width/n-h-2*u,d=t.height/n-h-2*u,p=o.slice(),f=i.fillGradientStops.slice();if(!f.length){const t=p.length+1;for(let e=1;e<t;++e)f.push(e/t)}if(p.unshift(o[0]),f.unshift(0),p.push(o[o.length-1]),f.push(1),i.fillGradientType===r.TEXT_GRADIENT.LINEAR_VERTICAL){l=e.createLinearGradient(c/2,u,c/2,d+u);let t=0;const r=(a.fontProperties.fontSize+i.strokeThickness)/d;for(let e=0;e<s.length;e++){const i=a.lineHeight*e;for(let e=0;e<p.length;e++){let n=0;n="number"==typeof f[e]?f[e]:e/p.length;const s=i/d+n*r;let a=Math.max(t,s);a=Math.min(a,1),l.addColorStop(a,p[e]),t=a}}}else{l=e.createLinearGradient(u,d/2,c+u,d/2);const t=p.length+1;let i=1;for(let e=0;e<p.length;e++){let r;r="number"==typeof f[e]?f[e]:i/t,l.addColorStop(r,p[e]),i++}}return l}},9307:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(5375),n=i(9402),s=i(1717),a=i(171),o=i(4937);e.drawGlyph=r.drawGlyph,e.generateFillStyle=n.generateFillStyle,e.resolveCharacters=s.resolveCharacters,e.extractCharCode=a.extractCharCode,e.splitTextToCharacters=o.splitTextToCharacters},1717:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4937);e.resolveCharacters=function(t){"string"==typeof t&&(t=[t]);const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i];if(Array.isArray(n)){if(2!==n.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);const t=n[0].charCodeAt(0),i=n[1].charCodeAt(0);if(i<t)throw new Error("[BitmapFont]: Invalid character range.");for(let r=t,n=i;r<=n;r++)e.push(String.fromCharCode(r))}else e.push(...r.splitTextToCharacters(n))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}},4937:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.splitTextToCharacters=function(t){return Array.from?Array.from(t):t.split("")}},448:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6903),n=i(8742),s=i(6016),a=i(8774),o=i(5345);const l={texture:!0,children:!1,baseTexture:!0},h=class extends r.Sprite{constructor(t,e,i){let r=!1;i||(i=n.settings.ADAPTER.createCanvas(),r=!0),i.width=3,i.height=3;const s=n.Texture.from(i);s.orig=new n.Rectangle,s.trim=new n.Rectangle,super(s),this._ownCanvas=r,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=n.settings.RESOLUTION,this._autoResolution=!0,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const i=this.context,r=o.TextMetrics.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=r.width,a=r.height,l=r.lines,h=r.lineHeight,u=r.lineWidths,c=r.maxLineWidth,d=r.fontProperties;let p,f;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+2*e.padding)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;const m=e.dropShadow?2:1;for(let t=0;t<m;++t){const s=e.dropShadow&&0===t,o=s?Math.ceil(Math.max(1,a)+2*e.padding):0,m=o*this._resolution;if(s){i.fillStyle="black",i.strokeStyle="black";const t=e.dropShadowColor,r=n.utils.hex2rgb("number"==typeof t?t:n.utils.string2hex(t)),s=e.dropShadowBlur*this._resolution,a=e.dropShadowDistance*this._resolution;i.shadowColor=`rgba(${255*r[0]},${255*r[1]},${255*r[2]},${e.dropShadowAlpha})`,i.shadowBlur=s,i.shadowOffsetX=Math.cos(e.dropShadowAngle)*a,i.shadowOffsetY=Math.sin(e.dropShadowAngle)*a+m}else i.fillStyle=this._generateFillStyle(e,l,r),i.strokeStyle=e.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let g=(h-d.fontSize)/2;h-d.fontSize<0&&(g=0);for(let t=0;t<l.length;t++)p=e.strokeThickness/2,f=e.strokeThickness/2+t*h+d.ascent+g,"right"===e.align?p+=c-u[t]:"center"===e.align&&(p+=(c-u[t])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(l[t],p+e.padding,f+e.padding-o,!0),e.fill&&this.drawLetterSpacing(l[t],p+e.padding,f+e.padding-o)}this.updateTexture()}drawLetterSpacing(t,e,i,r=!1){const n=this._style.letterSpacing,s=h.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(0===n||s)return s&&(this.context.letterSpacing=n,this.context.textLetterSpacing=n),void(r?this.context.strokeText(t,e,i):this.context.fillText(t,e,i));let a=e;const o=Array.from?Array.from(t):t.split("");let l=this.context.measureText(t).width,u=0;for(let t=0;t<o.length;++t){const e=o[t];r?this.context.strokeText(e,a,i):this.context.fillText(e,a,i);let s="";for(let e=t+1;e<o.length;++e)s+=o[e];u=this.context.measureText(s).width,a+=l-u+n,l=u}}updateTexture(){const t=this.canvas;if(this._style.trim){const e=n.utils.trimCanvas(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}const e=this._texture,i=this._style,r=i.trim?0:i.padding,s=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-r,e.trim.y=-r,e.orig.width=e._frame.width-2*r,e.orig.height=e._frame.height-2*r,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),-1===this._textureID&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,i){const r=t.fill;if(!Array.isArray(r))return r;if(1===r.length)return r[0];let n;const a=t.dropShadow?t.dropShadowDistance:0,o=t.padding||0,l=this.canvas.width/this._resolution-a-2*o,h=this.canvas.height/this._resolution-a-2*o,u=r.slice(),c=t.fillGradientStops.slice();if(!c.length){const t=u.length+1;for(let e=1;e<t;++e)c.push(e/t)}if(u.unshift(r[0]),c.unshift(0),u.push(r[r.length-1]),c.push(1),t.fillGradientType===s.TEXT_GRADIENT.LINEAR_VERTICAL){n=this.context.createLinearGradient(l/2,o,l/2,h+o);const r=i.fontProperties.fontSize+t.strokeThickness;for(let t=0;t<e.length;t++){const s=i.lineHeight*(t-1)+r,a=i.lineHeight*t;let o=a;t>0&&s>a&&(o=(a+s)/2);const l=a+r,d=i.lineHeight*(t+1);let p=l;t+1<e.length&&d<l&&(p=(l+d)/2);const f=(p-o)/h;for(let t=0;t<u.length;t++){let e=0;e="number"==typeof c[t]?c[t]:t/u.length;let i=Math.min(1,Math.max(0,o/h+e*f));i=Number(i.toFixed(5)),n.addColorStop(i,u[t])}}}else{n=this.context.createLinearGradient(o,h/2,l+o,h/2);const t=u.length+1;let e=1;for(let i=0;i<u.length;i++){let r;r="number"==typeof c[i]?c[i]:e/t,n.addColorStop(r,u[i]),e++}}return n}destroy(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},l,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=n.utils.sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=n.utils.sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){(t=t||{})instanceof a.TextStyle?this._style=t:this._style=new a.TextStyle(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};let u=h;u.experimentalLetterSpacing=!1,e.Text=u},5345:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8742);const n={willReadFrequently:!0};class s{constructor(t,e,i,r,n,s,a,o,l){this.text=t,this.style=e,this.width=i,this.height=r,this.lines=n,this.lineWidths=s,this.lineHeight=a,this.maxLineWidth=o,this.fontProperties=l}static measureText(t,e,i,r=s._canvas){i=null==i?e.wordWrap:i;const a=e.toFontString(),o=s.measureFont(a);0===o.fontSize&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);const l=r.getContext("2d",n);l.font=a;const h=(i?s.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),u=new Array(h.length);let c=0;for(let t=0;t<h.length;t++){const i=l.measureText(h[t]).width+(h[t].length-1)*e.letterSpacing;u[t]=i,c=Math.max(c,i)}let d=c+e.strokeThickness;e.dropShadow&&(d+=e.dropShadowDistance);const p=e.lineHeight||o.fontSize+e.strokeThickness;let f=Math.max(p,o.fontSize+e.strokeThickness)+(h.length-1)*(p+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new s(t,e,d,f,h,u,p+e.leading,c,o)}static wordWrap(t,e,i=s._canvas){const r=i.getContext("2d",n);let a=0,o="",l="";const h=Object.create(null),{letterSpacing:u,whiteSpace:c}=e,d=s.collapseSpaces(c),p=s.collapseNewlines(c);let f=!d;const m=e.wordWrapWidth+u,g=s.tokenize(t);for(let t=0;t<g.length;t++){let i=g[t];if(s.isNewline(i)){if(!p){l+=s.addLine(o),f=!d,o="",a=0;continue}i=" "}if(d){const t=s.isBreakingSpace(i),e=s.isBreakingSpace(o[o.length-1]);if(t&&e)continue}const n=s.getFromCache(i,u,h,r);if(n>m)if(""!==o&&(l+=s.addLine(o),o="",a=0),s.canBreakWords(i,e.breakWords)){const t=s.wordWrapSplit(i);for(let n=0;n<t.length;n++){let c=t[n],d=1;for(;t[n+d];){const r=t[n+d],a=c[c.length-1];if(s.canBreakChars(a,r,i,n,e.breakWords))break;c+=r,d++}n+=c.length-1;const p=s.getFromCache(c,u,h,r);p+a>m&&(l+=s.addLine(o),f=!1,o="",a=0),o+=c,a+=p}}else{o.length>0&&(l+=s.addLine(o),o="",a=0);const e=t===g.length-1;l+=s.addLine(i,!e),f=!1,o="",a=0}else n+a>m&&(f=!1,l+=s.addLine(o),o="",a=0),(o.length>0||!s.isBreakingSpace(i)||f)&&(o+=i,a+=n)}return l+=s.addLine(o,!1),l}static addLine(t,e=!0){return t=s.trimRight(t),e?`${t}\n`:t}static getFromCache(t,e,i,r){let n=i[t];if("number"!=typeof n){const s=t.length*e;n=r.measureText(t).width+s,i[t]=n}return n}static collapseSpaces(t){return"normal"===t||"pre-line"===t}static collapseNewlines(t){return"normal"===t}static trimRight(t){if("string"!=typeof t)return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!s.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static isNewline(t){return"string"==typeof t&&s._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return"string"==typeof t&&s._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let i="";if("string"!=typeof t)return e;for(let r=0;r<t.length;r++){const n=t[r],a=t[r+1];s.isBreakingSpace(n,a)||s.isNewline(n)?(""!==i&&(e.push(i),i=""),e.push(n)):i+=n}return""!==i&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,r,n){return!0}static wordWrapSplit(t){return t.split("")}static measureFont(t){if(s._fonts[t])return s._fonts[t];const e={ascent:0,descent:0,fontSize:0},i=s._canvas,r=s._context;r.font=t;const n=s.METRICS_STRING+s.BASELINE_SYMBOL,a=Math.ceil(r.measureText(n).width);let o=Math.ceil(r.measureText(s.BASELINE_SYMBOL).width);const l=Math.ceil(s.HEIGHT_MULTIPLIER*o);o=o*s.BASELINE_MULTIPLIER|0,i.width=a,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,a,l),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(n,0,o);const h=r.getImageData(0,0,a,l).data,u=h.length,c=4*a;let d=0,p=0,f=!1;for(d=0;d<o;++d){for(let t=0;t<c;t+=4)if(255!==h[p+t]){f=!0;break}if(f)break;p+=c}for(e.ascent=o-d,p=u-c,f=!1,d=l;d>o;--d){for(let t=0;t<c;t+=4)if(255!==h[p+t]){f=!0;break}if(f)break;p-=c}return e.descent=d-o,e.fontSize=e.ascent+e.descent,s._fonts[t]=e,e}static clearMetrics(t=""){t?delete s._fonts[t]:s._fonts={}}static get _canvas(){if(!s.__canvas){let t;try{const e=new OffscreenCanvas(0,0);if(e.getContext("2d",n)?.measureText)return s.__canvas=e,e;t=r.settings.ADAPTER.createCanvas()}catch(e){t=r.settings.ADAPTER.createCanvas()}t.width=t.height=10,s.__canvas=t}return s.__canvas}static get _context(){return s.__context||(s.__context=s._canvas.getContext("2d",n)),s.__context}}s._fonts={},s.METRICS_STRING="|ÉqÅ",s.BASELINE_SYMBOL="M",s.BASELINE_MULTIPLIER=1.4,s.HEIGHT_MULTIPLIER=2,s._newlines=[10,13],s._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],e.TextMetrics=s},8774:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6016),n=i(8742);const s={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:r.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},a=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];class o{constructor(t){this.styleID=0,this.reset(),u(this,t,t)}clone(){const t={};return u(t,this,s),new o(t)}reset(){u(this,s,s)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=h(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=h(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=h(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t="number"==typeof this.fontSize?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let t=e.length-1;t>=0;t--){let i=e[t].trim();/([\"\'])[^\'\"]+\1/.test(i)||a.includes(i)||(i=`"${i}"`),e[t]=i}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}}function l(t){return"number"==typeof t?n.utils.hex2string(t):("string"==typeof t&&t.startsWith("0x")&&(t=t.replace("0x","#")),t)}function h(t){if(Array.isArray(t)){for(let e=0;e<t.length;++e)t[e]=l(t[e]);return t}return l(t)}function u(t,e,i){for(const r in i)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}e.TextStyle=o},6016:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(t=>(t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t))(i||{});e.TEXT_GRADIENT=i},6338:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(448),n=i(8774),s=i(5345),a=i(6016);e.Text=r.Text,e.TextStyle=n.TextStyle,e.TextMetrics=s.TextMetrics,e.TEXT_GRADIENT=a.TEXT_GRADIENT},1253:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(2819);var r=i(9699),n=i(247),s=i(2101);class a{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new n.TickerListener(null,null,1/0),this.deltaMS=1/s.settings.TARGET_FPMS,this.elapsedMS=1/s.settings.TARGET_FPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=r.UPDATE_PRIORITY.NORMAL){return this._addListener(new n.TickerListener(t,e,i))}addOnce(t,e,i=r.UPDATE_PRIORITY.NORMAL){return this._addListener(new n.TickerListener(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const e=t-this._lastFrame|0;if(e<this._minElapsedMS)return;this._lastFrame=t-e%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*s.settings.TARGET_FPMS;const i=this._head;let r=i.next;for(;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,s.settings.TARGET_FPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(0===t)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!a._shared){const t=a._shared=new a;t.autoStart=!0,t._protected=!0}return a._shared}static get system(){if(!a._system){const t=a._system=new a;t.autoStart=!0,t._protected=!0}return a._system}}e.Ticker=a},247:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TickerListener=class{constructor(t,e=null,i=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}},3019:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1648),n=i(9699),s=i(1253);class a{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,n.UPDATE_PRIORITY.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?s.Ticker.shared:new s.Ticker,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}a.extension=r.ExtensionType.Application,r.extensions.add(a),e.TickerPlugin=a},9699:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(t=>(t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(i||{});e.UPDATE_PRIORITY=i},6082:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(2819);var r=i(1253),n=i(3019),s=i(9699);e.Ticker=r.Ticker,e.TickerPlugin=n.TickerPlugin,e.UPDATE_PRIORITY=s.UPDATE_PRIORITY},2819:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2101);r.settings.TARGET_FPMS=.06,Object.defineProperty(e,"settings",{enumerable:!0,get:function(){return r.settings}})},8944:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sayHello=function(){},e.skipHello=function(){}},6358:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(335);var r=i(2101);let n;e.isWebGLSupported=function(){return void 0===n&&(n=function(){const t={stencil:!0,failIfMajorPerformanceCaveat:r.settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!r.settings.ADAPTER.getWebGLRenderingContext())return!1;const e=r.settings.ADAPTER.createCanvas();let i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);const n=!(!i||!i.getContextAttributes().stencil);if(i){const t=i.getExtension("WEBGL_lose_context");t&&t.loseContext()}return i=null,n}catch(t){return!1}}()),n}},6165:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(3660);e.hex2rgb=function(t,e=[]){return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e},e.hex2string=function(t){let e=t.toString(16);return e="000000".substring(0,6-e.length)+e,`#${e}`},e.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},e.string2hex=function(t){if("string"==typeof t&&("#"===(t=r.default[t.toLowerCase()]||t)[0]&&(t=t.slice(1)),3===t.length)){const[e,i,r]=t;t=e+e+i+i+r+r}return parseInt(t,16)}},1469:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7616);const n=function(){const t=[],e=[];for(let i=0;i<32;i++)t[i]=i,e[i]=i;t[r.BLEND_MODES.NORMAL_NPM]=r.BLEND_MODES.NORMAL,t[r.BLEND_MODES.ADD_NPM]=r.BLEND_MODES.ADD,t[r.BLEND_MODES.SCREEN_NPM]=r.BLEND_MODES.SCREEN,e[r.BLEND_MODES.NORMAL]=r.BLEND_MODES.NORMAL_NPM,e[r.BLEND_MODES.ADD]=r.BLEND_MODES.ADD_NPM,e[r.BLEND_MODES.SCREEN]=r.BLEND_MODES.SCREEN_NPM;const i=[];return i.push(e),i.push(t),i}();e.correctBlendMode=function(t,e){return n[e?1:0][t]},e.premultiplyBlendMode=n,e.premultiplyRgba=function(t,e,i,r){return i=i||new Float32Array(4),r||void 0===r?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e):(i[0]=t[0],i[1]=t[1],i[2]=t[2]),i[3]=e,i},e.premultiplyTint=function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;let i=t>>16&255,r=t>>8&255,n=255&t;return i=i*e+.5|0,r=r*e+.5|0,n=n*e+.5|0,(255*e<<24)+(i<<16)+(r<<8)+n},e.premultiplyTintToRgba=function(t,e,i,r){return(i=i||new Float32Array(4))[0]=(t>>16&255)/255,i[1]=(t>>8&255)/255,i[2]=(255&t)/255,(r||void 0===r)&&(i[0]*=e,i[1]*=e,i[2]*=e),i[3]=e,i}},1988:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i},7154:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createIndicesForQuads=function(t,e=null){const i=6*t;if((e=e||new Uint16Array(i)).length!==i)throw new Error(`Out buffer length is incorrect, got ${e.length} and expected ${i}`);for(let t=0,r=0;t<i;t+=6,r+=4)e[t+0]=r+0,e[t+1]=r+1,e[t+2]=r+2,e[t+3]=r+0,e[t+4]=r+2,e[t+5]=r+3;return e}},5668:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getBufferType=function(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}},9530:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(5668);const n={Float32Array,Uint32Array,Int32Array,Uint8Array};e.interleaveTypedArrays=function(t,e){let i=0,s=0;const a={};for(let r=0;r<t.length;r++)s+=e[r],i+=t[r].length;const o=new ArrayBuffer(4*i);let l=null,h=0;for(let i=0;i<t.length;i++){const u=e[i],c=t[i],d=r.getBufferType(c);a[d]||(a[d]=new n[d](o)),l=a[d];for(let t=0;t<c.length;t++)l[(t/u|0)*s+h+t%u]=c[t];h+=u}return new Float32Array(o)}},5919:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isPow2=function(t){return!(t&t-1||!t)},e.log2=function(t){let e=(t>65535?1:0)<<4,i=((t>>>=e)>255?1:0)<<3;return e|=i,i=((t>>>=i)>15?1:0)<<2,e|=i,i=((t>>>=i)>3?1:0)<<1,e|=i,e|(t>>>=i)>>1},e.nextPow2=function(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)}},3582:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.removeItems=function(t,e,i){const r=t.length;let n;if(e>=r||0===i)return;const s=r-(i=e+i>r?r-e:i);for(n=e;n<s;++n)t[n]=t[n+i];t.length=s}},1815:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sign=function(t){return 0===t?0:t<0?-1:1}},6066:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});let i=0;e.uid=function(){return++i}},3660:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i="#f0f8ff",r="#faebd7",n="#00ffff",s="#7fffd4",a="#f0ffff",o="#f5f5dc",l="#ffe4c4",h="#000000",u="#ffebcd",c="#0000ff",d="#8a2be2",p="#a52a2a",f="#deb887",m="#5f9ea0",g="#7fff00",_="#d2691e",y="#ff7f50",v="#6495ed",x="#fff8dc",b="#dc143c",E="#00ffff",T="#00008b",S="#008b8b",w="#b8860b",A="#a9a9a9",I="#006400",R="#a9a9a9",C="#bdb76b",M="#8b008b",O="#556b2f",P="#ff8c00",k="#9932cc",D="#8b0000",N="#e9967a",L="#8fbc8f",F="#483d8b",B="#2f4f4f",U="#2f4f4f",G="#00ced1",W="#9400d3",j="#ff1493",Y="#00bfff",z="#696969",H="#696969",X="#1e90ff",V="#b22222",q="#fffaf0",K="#228b22",$="#ff00ff",Z="#dcdcdc",Q="#f8f8ff",J="#daa520",tt="#ffd700",et="#808080",it="#008000",rt="#adff2f",nt="#808080",st="#f0fff0",at="#ff69b4",ot="#cd5c5c",lt="#4b0082",ht="#fffff0",ut="#f0e68c",ct="#fff0f5",dt="#e6e6fa",pt="#7cfc00",ft="#fffacd",mt="#add8e6",gt="#f08080",_t="#e0ffff",yt="#fafad2",vt="#d3d3d3",xt="#90ee90",bt="#d3d3d3",Et="#ffb6c1",Tt="#ffa07a",St="#20b2aa",wt="#87cefa",At="#778899",It="#778899",Rt="#b0c4de",Ct="#ffffe0",Mt="#00ff00",Ot="#32cd32",Pt="#faf0e6",kt="#ff00ff",Dt="#800000",Nt="#66cdaa",Lt="#0000cd",Ft="#ba55d3",Bt="#9370db",Ut="#3cb371",Gt="#7b68ee",Wt="#00fa9a",jt="#48d1cc",Yt="#c71585",zt="#191970",Ht="#f5fffa",Xt="#ffe4e1",Vt="#ffe4b5",qt="#ffdead",Kt="#000080",$t="#fdf5e6",Zt="#808000",Qt="#6b8e23",Jt="#ffa500",te="#ff4500",ee="#da70d6",ie="#eee8aa",re="#98fb98",ne="#afeeee",se="#db7093",ae="#ffefd5",oe="#ffdab9",le="#cd853f",he="#ffc0cb",ue="#dda0dd",ce="#b0e0e6",de="#800080",pe="#663399",fe="#ff0000",me="#bc8f8f",ge="#4169e1",_e="#8b4513",ye="#fa8072",ve="#f4a460",xe="#2e8b57",be="#fff5ee",Ee="#a0522d",Te="#c0c0c0",Se="#87ceeb",we="#6a5acd",Ae="#708090",Ie="#708090",Re="#fffafa",Ce="#00ff7f",Me="#4682b4",Oe="#d2b48c",Pe="#008080",ke="#d8bfd8",De="#ff6347",Ne="#40e0d0",Le="#ee82ee",Fe="#f5deb3",Be="#ffffff",Ue="#f5f5f5",Ge="#ffff00",We="#9acd32",je={aliceblue:i,antiquewhite:r,aqua:n,aquamarine:s,azure:a,beige:o,bisque:l,black:h,blanchedalmond:u,blue:c,blueviolet:d,brown:p,burlywood:f,cadetblue:m,chartreuse:g,chocolate:_,coral:y,cornflowerblue:v,cornsilk:x,crimson:b,cyan:E,darkblue:T,darkcyan:S,darkgoldenrod:w,darkgray:A,darkgreen:I,darkgrey:R,darkkhaki:C,darkmagenta:M,darkolivegreen:O,darkorange:P,darkorchid:k,darkred:D,darksalmon:N,darkseagreen:L,darkslateblue:F,darkslategray:B,darkslategrey:U,darkturquoise:G,darkviolet:W,deeppink:j,deepskyblue:Y,dimgray:z,dimgrey:H,dodgerblue:X,firebrick:V,floralwhite:q,forestgreen:K,fuchsia:$,gainsboro:Z,ghostwhite:Q,goldenrod:J,gold:tt,gray:et,green:it,greenyellow:rt,grey:nt,honeydew:st,hotpink:at,indianred:ot,indigo:lt,ivory:ht,khaki:ut,lavenderblush:ct,lavender:dt,lawngreen:pt,lemonchiffon:ft,lightblue:mt,lightcoral:gt,lightcyan:_t,lightgoldenrodyellow:yt,lightgray:vt,lightgreen:xt,lightgrey:bt,lightpink:Et,lightsalmon:Tt,lightseagreen:St,lightskyblue:wt,lightslategray:At,lightslategrey:It,lightsteelblue:Rt,lightyellow:Ct,lime:Mt,limegreen:Ot,linen:Pt,magenta:kt,maroon:Dt,mediumaquamarine:Nt,mediumblue:Lt,mediumorchid:Ft,mediumpurple:Bt,mediumseagreen:Ut,mediumslateblue:Gt,mediumspringgreen:Wt,mediumturquoise:jt,mediumvioletred:Yt,midnightblue:zt,mintcream:Ht,mistyrose:Xt,moccasin:Vt,navajowhite:qt,navy:Kt,oldlace:$t,olive:Zt,olivedrab:Qt,orange:Jt,orangered:te,orchid:ee,palegoldenrod:ie,palegreen:re,paleturquoise:ne,palevioletred:se,papayawhip:ae,peachpuff:oe,peru:le,pink:he,plum:ue,powderblue:ce,purple:de,rebeccapurple:pe,red:fe,rosybrown:me,royalblue:ge,saddlebrown:_e,salmon:ye,sandybrown:ve,seagreen:xe,seashell:be,sienna:Ee,silver:Te,skyblue:Se,slateblue:we,slategray:Ae,slategrey:Ie,snow:Re,springgreen:Ce,steelblue:Me,tan:Oe,teal:Pe,thistle:ke,tomato:De,turquoise:Ne,violet:Le,wheat:Fe,white:Be,whitesmoke:Ue,yellow:Ge,yellowgreen:We};e.aliceblue=i,e.antiquewhite=r,e.aqua=n,e.aquamarine=s,e.azure=a,e.beige=o,e.bisque=l,e.black=h,e.blanchedalmond=u,e.blue=c,e.blueviolet=d,e.brown=p,e.burlywood=f,e.cadetblue=m,e.chartreuse=g,e.chocolate=_,e.coral=y,e.cornflowerblue=v,e.cornsilk=x,e.crimson=b,e.cyan=E,e.darkblue=T,e.darkcyan=S,e.darkgoldenrod=w,e.darkgray=A,e.darkgreen=I,e.darkgrey=R,e.darkkhaki=C,e.darkmagenta=M,e.darkolivegreen=O,e.darkorange=P,e.darkorchid=k,e.darkred=D,e.darksalmon=N,e.darkseagreen=L,e.darkslateblue=F,e.darkslategray=B,e.darkslategrey=U,e.darkturquoise=G,e.darkviolet=W,e.deeppink=j,e.deepskyblue=Y,e.default=je,e.dimgray=z,e.dimgrey=H,e.dodgerblue=X,e.firebrick=V,e.floralwhite=q,e.forestgreen=K,e.fuchsia=$,e.gainsboro=Z,e.ghostwhite=Q,e.gold=tt,e.goldenrod=J,e.gray=et,e.green=it,e.greenyellow=rt,e.grey=nt,e.honeydew=st,e.hotpink=at,e.indianred=ot,e.indigo=lt,e.ivory=ht,e.khaki=ut,e.lavender=dt,e.lavenderblush=ct,e.lawngreen=pt,e.lemonchiffon=ft,e.lightblue=mt,e.lightcoral=gt,e.lightcyan=_t,e.lightgoldenrodyellow=yt,e.lightgray=vt,e.lightgreen=xt,e.lightgrey=bt,e.lightpink=Et,e.lightsalmon=Tt,e.lightseagreen=St,e.lightskyblue=wt,e.lightslategray=At,e.lightslategrey=It,e.lightsteelblue=Rt,e.lightyellow=Ct,e.lime=Mt,e.limegreen=Ot,e.linen=Pt,e.magenta=kt,e.maroon=Dt,e.mediumaquamarine=Nt,e.mediumblue=Lt,e.mediumorchid=Ft,e.mediumpurple=Bt,e.mediumseagreen=Ut,e.mediumslateblue=Gt,e.mediumspringgreen=Wt,e.mediumturquoise=jt,e.mediumvioletred=Yt,e.midnightblue=zt,e.mintcream=Ht,e.mistyrose=Xt,e.moccasin=Vt,e.navajowhite=qt,e.navy=Kt,e.oldlace=$t,e.olive=Zt,e.olivedrab=Qt,e.orange=Jt,e.orangered=te,e.orchid=ee,e.palegoldenrod=ie,e.palegreen=re,e.paleturquoise=ne,e.palevioletred=se,e.papayawhip=ae,e.peachpuff=oe,e.peru=le,e.pink=he,e.plum=ue,e.powderblue=ce,e.purple=de,e.rebeccapurple=pe,e.red=fe,e.rosybrown=me,e.royalblue=ge,e.saddlebrown=_e,e.salmon=ye,e.sandybrown=ve,e.seagreen=xe,e.seashell=be,e.sienna=Ee,e.silver=Te,e.skyblue=Se,e.slateblue=we,e.slategray=Ae,e.slategrey=Ie,e.snow=Re,e.springgreen=Ce,e.steelblue=Me,e.tan=Oe,e.teal=Pe,e.thistle=ke,e.tomato=De,e.turquoise=Ne,e.violet=Le,e.wheat=Fe,e.white=Be,e.whitesmoke=Ue,e.yellow=Ge,e.yellowgreen=We},2191:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2101),n=i(6729),s=i(9187),a=i(1913),o=i(1087);i(335);var l=i(8944),h=i(6358),u=i(6165),c=i(1469),d=i(7154),p=i(5668),f=i(9530),m=i(5919),g=i(3582),_=i(1815),y=i(6066),v=i(8162),x=i(1635),b=i(8260),E=i(3889),T=i(3424),S=i(7570),w=i(5197),A=i(1988);function I(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}i(7090);var R=I(n),C=I(s);Object.defineProperty(e,"isMobile",{enumerable:!0,get:function(){return r.isMobile}}),Object.defineProperty(e,"EventEmitter",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(e,"earcut",{enumerable:!0,get:function(){return C.default}}),e.url=a.url,e.path=o.path,e.sayHello=l.sayHello,e.skipHello=l.skipHello,e.isWebGLSupported=h.isWebGLSupported,e.hex2rgb=u.hex2rgb,e.hex2string=u.hex2string,e.rgb2hex=u.rgb2hex,e.string2hex=u.string2hex,e.correctBlendMode=c.correctBlendMode,e.premultiplyBlendMode=c.premultiplyBlendMode,e.premultiplyRgba=c.premultiplyRgba,e.premultiplyTint=c.premultiplyTint,e.premultiplyTintToRgba=c.premultiplyTintToRgba,e.createIndicesForQuads=d.createIndicesForQuads,e.getBufferType=p.getBufferType,e.interleaveTypedArrays=f.interleaveTypedArrays,e.isPow2=m.isPow2,e.log2=m.log2,e.nextPow2=m.nextPow2,e.removeItems=g.removeItems,e.sign=_.sign,e.uid=y.uid,e.deprecation=v.deprecation,e.BaseTextureCache=x.BaseTextureCache,e.ProgramCache=x.ProgramCache,e.TextureCache=x.TextureCache,e.clearTextureCache=x.clearTextureCache,e.destroyTextureCache=x.destroyTextureCache,e.CanvasRenderTarget=b.CanvasRenderTarget,e.trimCanvas=E.trimCanvas,e.decomposeDataUri=T.decomposeDataUri,e.determineCrossOrigin=S.determineCrossOrigin,e.getResolutionOfUrl=w.getResolutionOfUrl,e.DATA_URI=A.DATA_URI},8162:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i={};e.deprecation=function(t,e,r=3){if(i[e])return;let n=(new Error).stack;void 0===n?console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`):(n=n.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${e}\nDeprecated since v${t}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${e}\nDeprecated since v${t}`),console.warn(n))),i[e]=!0}},8260:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2101);e.CanvasRenderTarget=class{constructor(t,e,i){this.canvas=r.settings.ADAPTER.createCanvas(),this.context=this.canvas.getContext("2d"),this.resolution=i||r.settings.RESOLUTION,this.resize(t,e)}clear(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}resize(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)}destroy(){this.context=null,this.canvas=null}get width(){return this.canvas.width}set width(t){this.canvas.width=Math.round(t)}get height(){return this.canvas.height}set height(t){this.canvas.height=Math.round(t)}}},1635:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=Object.create(null),r=Object.create(null);e.BaseTextureCache=r,e.ProgramCache={},e.TextureCache=i,e.clearTextureCache=function(){let t;for(t in i)delete i[t];for(t in r)delete r[t]},e.destroyTextureCache=function(){let t;for(t in i)i[t].destroy();for(t in r)r[t].destroy()}},3889:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.trimCanvas=function(t){let e=t.width,i=t.height;const r=t.getContext("2d",{willReadFrequently:!0}),n=r.getImageData(0,0,e,i).data,s=n.length,a={top:null,left:null,right:null,bottom:null};let o,l,h,u=null;for(o=0;o<s;o+=4)0!==n[o+3]&&(l=o/4%e,h=~~(o/4/e),null===a.top&&(a.top=h),(null===a.left||l<a.left)&&(a.left=l),(null===a.right||a.right<l)&&(a.right=l+1),(null===a.bottom||a.bottom<h)&&(a.bottom=h));return null!==a.top&&(e=a.right-a.left,i=a.bottom-a.top+1,u=r.getImageData(a.left,a.top,e,i)),{height:i,width:e,data:u}}},3424:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1988);e.decomposeDataUri=function(t){const e=r.DATA_URI.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}},7570:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1913);let n;e.determineCrossOrigin=function(t,e=globalThis.location){if(t.startsWith("data:"))return"";e=e||globalThis.location,n||(n=document.createElement("a")),n.href=t;const i=r.url.parse(n.href),s=!i.port&&""===e.port||i.port===e.port;return i.hostname===e.hostname&&s&&i.protocol===e.protocol?"":"anonymous"}},5197:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(335);var r=i(2101);e.getResolutionOfUrl=function(t,e=1){const i=r.settings.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):e}},1087:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2101);function n(t){if("string"!=typeof t)throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function s(t){return t.split("?")[0].split("#")[0]}const a={toPosix:t=>("\\","/",t.replace(new RegExp("\\".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"/")),isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl:t=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t),hasProtocol(t){return/^[^/:]+:\//.test(this.toPosix(t))},getProtocol(t){n(t),t=this.toPosix(t);let e="";const i=/^file:\/\/\//.exec(t),r=/^[^/:]+:\/\//.exec(t),s=/^[^/:]+:\//.exec(t);if(i||r||s){const n=i?.[0]||r?.[0]||s?.[0];e=n,t=t.slice(n.length)}return e},toAbsolute(t,e,i){if(this.isDataUrl(t))return t;const o=s(this.toPosix(e??r.settings.ADAPTER.getBaseUrl())),l=s(this.toPosix(i??this.rootname(o)));return n(t),(t=this.toPosix(t)).startsWith("/")?a.join(l,t.slice(1)):this.isAbsolute(t)?t:this.join(o,t)},normalize(t){if(n(t=this.toPosix(t)),0===t.length)return".";let e="";const i=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const r=t.endsWith("/");return(t=function(t,e){let i,r="",n=0,s=-1,a=0;for(let e=0;e<=t.length;++e){if(e<t.length)i=t.charCodeAt(e);else{if(47===i)break;i=47}if(47===i){if(s===e-1||1===a);else if(s!==e-1&&2===a){if(r.length<2||2!==n||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){const t=r.lastIndexOf("/");if(t!==r.length-1){-1===t?(r="",n=0):(r=r.slice(0,t),n=r.length-1-r.lastIndexOf("/")),s=e,a=0;continue}}else if(2===r.length||1===r.length){r="",n=0,s=e,a=0;continue}}else r.length>0?r+=`/${t.slice(s+1,e)}`:r=t.slice(s+1,e),n=e-s-1;s=e,a=0}else 46===i&&-1!==a?++a:a=-1}return r}(t)).length>0&&r&&(t+="/"),i?`/${t}`:e+t},isAbsolute(t){return n(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join(...t){if(0===t.length)return".";let e;for(let i=0;i<t.length;++i){const r=t[i];if(n(r),r.length>0)if(void 0===e)e=r;else{const n=t[i-1]??"";this.extname(n)?e+=`/../${r}`:e+=`/${r}`}}return void 0===e?".":this.normalize(e)},dirname(t){if(n(t),0===t.length)return".";let e=(t=this.toPosix(t)).charCodeAt(0);const i=47===e;let r=-1,s=!0;const a=this.getProtocol(t),o=t;for(let i=(t=t.slice(a.length)).length-1;i>=1;--i)if(e=t.charCodeAt(i),47===e){if(!s){r=i;break}}else s=!1;return-1===r?i?"/":this.isUrl(o)?a+t:a:i&&1===r?"//":a+t.slice(0,r)},rootname(t){n(t);let e="";if(e=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){const i=t.indexOf("/",e.length);e=-1!==i?t.slice(0,i):t,e.endsWith("/")||(e+="/")}return e},basename(t,e){n(t),e&&n(e),t=this.toPosix(t);let i,r=0,s=-1,a=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let n=e.length-1,o=-1;for(i=t.length-1;i>=0;--i){const l=t.charCodeAt(i);if(47===l){if(!a){r=i+1;break}}else-1===o&&(a=!1,o=i+1),n>=0&&(l===e.charCodeAt(n)?-1==--n&&(s=i):(n=-1,s=o))}return r===s?s=o:-1===s&&(s=t.length),t.slice(r,s)}for(i=t.length-1;i>=0;--i)if(47===t.charCodeAt(i)){if(!a){r=i+1;break}}else-1===s&&(a=!1,s=i+1);return-1===s?"":t.slice(r,s)},extname(t){n(t);let e=-1,i=0,r=-1,s=!0,a=0;for(let n=(t=this.toPosix(t)).length-1;n>=0;--n){const o=t.charCodeAt(n);if(47!==o)-1===r&&(s=!1,r=n+1),46===o?-1===e?e=n:1!==a&&(a=1):-1!==e&&(a=-1);else if(!s){i=n+1;break}}return-1===e||-1===r||0===a||1===a&&e===r-1&&e===i+1?"":t.slice(e,r)},parse(t){n(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;let i=(t=this.toPosix(t)).charCodeAt(0);const r=this.isAbsolute(t);let s;e.root=this.rootname(t),s=r||this.hasProtocol(t)?1:0;let a=-1,o=0,l=-1,h=!0,u=t.length-1,c=0;for(;u>=s;--u)if(i=t.charCodeAt(u),47!==i)-1===l&&(h=!1,l=u+1),46===i?-1===a?a=u:1!==c&&(c=1):-1!==a&&(c=-1);else if(!h){o=u+1;break}return-1===a||-1===l||0===c||1===c&&a===l-1&&a===o+1?-1!==l&&(e.base=e.name=0===o&&r?t.slice(1,l):t.slice(o,l)):(0===o&&r?(e.name=t.slice(1,a),e.base=t.slice(1,l)):(e.name=t.slice(o,a),e.base=t.slice(o,l)),e.ext=t.slice(a,l)),e.dir=this.dirname(t),e},sep:"/",delimiter:":"};e.path=a},335:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(2101);r.settings.RETINA_PREFIX=/@([0-9\.]+)x/,r.settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1,Object.defineProperty(e,"settings",{enumerable:!0,get:function(){return r.settings}})},7090:()=>{},1913:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8575);const n={parse:r.parse,format:r.format,resolve:r.resolve};e.url=n},858:(t,e,i)=>{"use strict";i.r(e),i.d(e,{Breadcrumbs:()=>pi,BrowserClient:()=>vi,BrowserProfilingIntegration:()=>xo,BrowserTracing:()=>$a,Dedupe:()=>er,FunctionToString:()=>N,GlobalHandlers:()=>Gi,HttpContext:()=>tr,Hub:()=>lt,InboundFilters:()=>K,Integrations:()=>Eo,LinkedErrors:()=>Qi,Replay:()=>xa,SDK_VERSION:()=>ft,Scope:()=>nt,TryCatch:()=>Vi,WINDOW:()=>Ge,addBreadcrumb:()=>vt,addGlobalEventProcessor:()=>at,addTracingExtensions:()=>ce,captureEvent:()=>_t,captureException:()=>mt,captureMessage:()=>gt,captureUserFeedback:()=>gr,chromeStackLineParser:()=>Ii,close:()=>pr,configureScope:()=>yt,createTransport:()=>Pe,createUserFeedbackEnvelope:()=>yi,defaultIntegrations:()=>ar,defaultRequestInstrumentationOptions:()=>Va,defaultStackLineParsers:()=>Fi,defaultStackParser:()=>Bi,eventFromException:()=>ai,eventFromMessage:()=>oi,extractTraceparentData:()=>Ne,flush:()=>dr,forceLoad:()=>ur,geckoStackLineParser:()=>Mi,getActiveTransaction:()=>$t,getCurrentHub:()=>ct,getHubFromCarrier:()=>dt,init:()=>or,instrumentOutgoingRequests:()=>qa,lastEventId:()=>hr,makeBrowserOfflineTransport:()=>ro,makeFetchTransport:()=>bi,makeMain:()=>ut,makeMultiplexedTransport:()=>Be,makeXHRTransport:()=>Ei,onLoad:()=>cr,onProfilingStartRouteTransaction:()=>yo,opera10StackLineParser:()=>Di,opera11StackLineParser:()=>Li,setContext:()=>xt,setExtra:()=>Et,setExtras:()=>bt,setTag:()=>St,setTags:()=>Tt,setUser:()=>wt,showReportDialog:()=>lr,spanStatusfromHttpCode:()=>ee,startTransaction:()=>It,trace:()=>Ue,winjsStackLineParser:()=>Pi,withScope:()=>At,wrap:()=>fr});var r={};i.r(r),i.d(r,{FunctionToString:()=>N,InboundFilters:()=>K});var n={};i.r(n),i.d(n,{Breadcrumbs:()=>pi,Dedupe:()=>er,GlobalHandlers:()=>Gi,HttpContext:()=>tr,LinkedErrors:()=>Qi,TryCatch:()=>Vi});const s=Object.prototype.toString;function a(t){switch(s.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return g(t,Error)}}function o(t,e){return s.call(t)===`[object ${e}]`}function l(t){return o(t,"ErrorEvent")}function h(t){return o(t,"DOMError")}function u(t){return o(t,"String")}function c(t){return null===t||"object"!=typeof t&&"function"!=typeof t}function d(t){return o(t,"Object")}function p(t){return"undefined"!=typeof Event&&g(t,Event)}function f(t){return Boolean(t&&t.then&&"function"==typeof t.then)}function m(t){return"number"==typeof t&&t!=t}function g(t,e){try{return t instanceof e}catch(t){return!1}}var _=i(1235);const y=(0,_.Rf)();function v(t,e={}){try{let i=t;const r=5,n=[];let s=0,a=0;const o=" > ",l=o.length;let h;const u=Array.isArray(e)?e:e.keyAttrs,c=!Array.isArray(e)&&e.maxStringLength||80;for(;i&&s++<r&&(h=x(i,u),!("html"===h||s>1&&a+n.length*l+h.length>=c));)n.push(h),a+=h.length,i=i.parentNode;return n.reverse().join(o)}catch(t){return"<unknown>"}}function x(t,e){const i=t,r=[];let n,s,a,o,l;if(!i||!i.tagName)return"";r.push(i.tagName.toLowerCase());const h=e&&e.length?e.filter((t=>i.getAttribute(t))).map((t=>[t,i.getAttribute(t)])):null;if(h&&h.length)h.forEach((t=>{r.push(`[${t[0]}="${t[1]}"]`)}));else if(i.id&&r.push(`#${i.id}`),n=i.className,n&&u(n))for(s=n.split(/\s+/),l=0;l<s.length;l++)r.push(`.${s[l]}`);const c=["aria-label","type","name","title","alt"];for(l=0;l<c.length;l++)a=c[l],o=i.getAttribute(a),o&&r.push(`[${a}="${o}"]`);return r.join("")}function b(t,e=0){return"string"!=typeof t||0===e||t.length<=e?t:`${t.slice(0,e)}...`}function E(t,e){if(!Array.isArray(t))return"";const i=[];for(let e=0;e<t.length;e++){const r=t[e];try{i.push(String(r))}catch(t){i.push("[value cannot be serialized]")}}return i.join(e)}function T(t,e=[],i=!1){return e.some((e=>function(t,e,i=!1){return!!u(t)&&(o(e,"RegExp")?e.test(t):!!u(e)&&(i?t===e:t.includes(e)))}(t,e,i)))}function S(t,e,i){if(!(e in t))return;const r=t[e],n=i(r);if("function"==typeof n)try{A(n,r)}catch(t){}t[e]=n}function w(t,e,i){Object.defineProperty(t,e,{value:i,writable:!0,configurable:!0})}function A(t,e){const i=e.prototype||{};t.prototype=e.prototype=i,w(t,"__sentry_original__",e)}function I(t){return t.__sentry_original__}function R(t){if(a(t))return{message:t.message,name:t.name,stack:t.stack,...M(t)};if(p(t)){const e={type:t.type,target:C(t.target),currentTarget:C(t.currentTarget),...M(t)};return"undefined"!=typeof CustomEvent&&g(t,CustomEvent)&&(e.detail=t.detail),e}return t}function C(t){try{return"undefined"!=typeof Element&&g(t,Element)?v(t):Object.prototype.toString.call(t)}catch(t){return"<unknown>"}}function M(t){if("object"==typeof t&&null!==t){const e={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}return{}}function O(t,e=40){const i=Object.keys(R(t));if(i.sort(),!i.length)return"[object has no keys]";if(i[0].length>=e)return b(i[0],e);for(let t=i.length;t>0;t--){const r=i.slice(0,t).join(", ");if(!(r.length>e))return t===i.length?r:b(r,e)}return""}function P(t){return k(t,new Map)}function k(t,e){if(d(t)){const i=e.get(t);if(void 0!==i)return i;const r={};e.set(t,r);for(const i of Object.keys(t))void 0!==t[i]&&(r[i]=k(t[i],e));return r}if(Array.isArray(t)){const i=e.get(t);if(void 0!==i)return i;const r=[];return e.set(t,r),t.forEach((t=>{r.push(k(t,e))})),r}return t}let D;class N{constructor(){N.prototype.__init.call(this)}static __initStatic(){this.id="FunctionToString"}__init(){this.name=N.id}setupOnce(){D=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=I(this)||this;return D.apply(e,t)}}catch(t){}}}N.__initStatic();const L=["debug","info","warn","error","log","assert","trace"];function F(t){if(!("console"in _.n2))return t();const e=_.n2.console,i={};L.forEach((t=>{const r=e[t]&&e[t].__sentry_original__;t in e&&r&&(i[t]=e[t],e[t]=r)}));try{return t()}finally{Object.keys(i).forEach((t=>{e[t]=i[t]}))}}function B(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1}};return"undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?L.forEach((i=>{e[i]=(...e)=>{t&&F((()=>{_.n2.console[i](`Sentry Logger [${i}]:`,...e)}))}})):L.forEach((t=>{e[t]=()=>{}})),e}let U;function G(){const t=_.n2,e=t.crypto||t.msCrypto;if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");const i=e&&e.getRandomValues?()=>e.getRandomValues(new Uint8Array(1))[0]:()=>16*Math.random();return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(t=>(t^(15&i())>>t/4).toString(16)))}function W(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function j(t){const{message:e,event_id:i}=t;if(e)return e;const r=W(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||i||"<unknown>":i||"<unknown>"}function Y(t,e,i){const r=t.exception=t.exception||{},n=r.values=r.values||[],s=n[0]=n[0]||{};s.value||(s.value=e||""),s.type||(s.type=i||"Error")}function z(t,e){const i=W(t);if(!i)return;const r=i.mechanism;if(i.mechanism={type:"generic",handled:!0,...r,...e},e&&"data"in e){const t={...r&&r.data,...e.data};i.mechanism.data=t}}function H(t){if(t&&t.__sentry_captured__)return!0;try{w(t,"__sentry_captured__",!0)}catch(t){}return!1}function X(t){return Array.isArray(t)?t:[t]}U="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?(0,_.YO)("logger",B):B();const V=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],q=[/^.*healthcheck.*$/,/^.*healthy.*$/,/^.*live.*$/,/^.*ready.*$/,/^.*heartbeat.*$/,/^.*\/health$/,/^.*\/healthz$/];class K{static __initStatic(){this.id="InboundFilters"}__init(){this.name=K.id}constructor(t={}){this._options=t,K.prototype.__init.call(this)}setupOnce(t,e){const i=t=>{const i=e();if(i){const e=i.getIntegration(K);if(e){const r=i.getClient(),n=r?r.getOptions():{},s=function(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:V],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[],...t.disableTransactionDefaults?[]:q],ignoreInternal:void 0===t.ignoreInternal||t.ignoreInternal}}(e._options,n);return function(t,e){return e.ignoreInternal&&function(t){try{return"SentryError"===t.exception.values[0].type}catch(t){}return!1}(t)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${j(t)}`),!0):function(t,e){return!(t.type||!e||!e.length)&&function(t){if(t.message)return[t.message];if(t.exception){const{values:e}=t.exception;try{const{type:t="",value:i=""}=e&&e[e.length-1]||{};return[`${i}`,`${t}: ${i}`]}catch(e){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error(`Cannot extract message for event ${j(t)}`),[]}}return[]}(t).some((t=>T(t,e)))}(t,e.ignoreErrors)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${j(t)}`),!0):function(t,e){if("transaction"!==t.type||!e||!e.length)return!1;const i=t.transaction;return!!i&&T(i,e)}(t,e.ignoreTransactions)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${j(t)}`),!0):function(t,e){if(!e||!e.length)return!1;const i=$(t);return!!i&&T(i,e)}(t,e.denyUrls)?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${j(t)}.\nUrl: ${$(t)}`),!0):!function(t,e){if(!e||!e.length)return!0;const i=$(t);return!i||T(i,e)}(t,e.allowUrls)&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${j(t)}.\nUrl: ${$(t)}`),!0)}(t,s)?null:t}}return t};i.id=this.name,t(i)}}function $(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch(t){}return e?function(t=[]){for(let e=t.length-1;e>=0;e--){const i=t[e];if(i&&"<anonymous>"!==i.filename&&"[native code]"!==i.filename)return i.filename||null}return null}(e):null}catch(e){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error(`Cannot extract url for event ${j(t)}`),null}}K.__initStatic();var Z=i(1170);const Q="production";var J;function tt(t){return new it((e=>{e(t)}))}function et(t){return new it(((e,i)=>{i(t)}))}!function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"}(J||(J={}));class it{__init(){this._state=J.PENDING}__init2(){this._handlers=[]}constructor(t){it.prototype.__init.call(this),it.prototype.__init2.call(this),it.prototype.__init3.call(this),it.prototype.__init4.call(this),it.prototype.__init5.call(this),it.prototype.__init6.call(this);try{t(this._resolve,this._reject)}catch(t){this._reject(t)}}then(t,e){return new it(((i,r)=>{this._handlers.push([!1,e=>{if(t)try{i(t(e))}catch(t){r(t)}else i(e)},t=>{if(e)try{i(e(t))}catch(t){r(t)}else r(t)}]),this._executeHandlers()}))}catch(t){return this.then((t=>t),t)}finally(t){return new it(((e,i)=>{let r,n;return this.then((e=>{n=!1,r=e,t&&t()}),(e=>{n=!0,r=e,t&&t()})).then((()=>{n?i(r):e(r)}))}))}__init3(){this._resolve=t=>{this._setResult(J.RESOLVED,t)}}__init4(){this._reject=t=>{this._setResult(J.REJECTED,t)}}__init5(){this._setResult=(t,e)=>{this._state===J.PENDING&&(f(e)?e.then(this._resolve,this._reject):(this._state=t,this._value=e,this._executeHandlers()))}}__init6(){this._executeHandlers=()=>{if(this._state===J.PENDING)return;const t=this._handlers.slice();this._handlers=[],t.forEach((t=>{t[0]||(this._state===J.RESOLVED&&t[1](this._value),this._state===J.REJECTED&&t[2](this._value),t[0]=!0)}))}}}function rt(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),t.did||e.did||(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||(0,Z.ph)(),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=32===e.sid.length?e.sid:G()),void 0!==e.init&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),"number"==typeof e.started&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if("number"==typeof e.duration)t.duration=e.duration;else{const e=t.timestamp-t.started;t.duration=e>=0?e:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),"number"==typeof e.errors&&(t.errors=e.errors),e.status&&(t.status=e.status)}class nt{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={}}static clone(t){const e=new nt;return t&&(e._breadcrumbs=[...t._breadcrumbs],e._tags={...t._tags},e._extra={...t._extra},e._contexts={...t._contexts},e._user=t._user,e._level=t._level,e._span=t._span,e._session=t._session,e._transactionName=t._transactionName,e._fingerprint=t._fingerprint,e._eventProcessors=[...t._eventProcessors],e._requestSession=t._requestSession,e._attachments=[...t._attachments],e._sdkProcessingMetadata={...t._sdkProcessingMetadata}),e}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{},this._session&&rt(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(t){return this._requestSession=t,this}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,e){return this._tags={...this._tags,[t]:e},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,e){return this._extra={...this._extra,[t]:e},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,e){return null===e?delete this._contexts[t]:this._contexts[t]=e,this._notifyScopeListeners(),this}setSpan(t){return this._span=t,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const t=this.getSpan();return t&&t.transaction}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;if("function"==typeof t){const e=t(this);return e instanceof nt?e:this}return t instanceof nt?(this._tags={...this._tags,...t._tags},this._extra={...this._extra,...t._extra},this._contexts={...this._contexts,...t._contexts},t._user&&Object.keys(t._user).length&&(this._user=t._user),t._level&&(this._level=t._level),t._fingerprint&&(this._fingerprint=t._fingerprint),t._requestSession&&(this._requestSession=t._requestSession)):d(t)&&(this._tags={...this._tags,...t.tags},this._extra={...this._extra,...t.extra},this._contexts={...this._contexts,...t.contexts},t.user&&(this._user=t.user),t.level&&(this._level=t.level),t.fingerprint&&(this._fingerprint=t.fingerprint),t.requestSession&&(this._requestSession=t.requestSession)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this}addBreadcrumb(t,e){const i="number"==typeof e?e:100;if(i<=0)return this;const r={timestamp:(0,Z.yW)(),...t};return this._breadcrumbs=[...this._breadcrumbs,r].slice(-i),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}getAttachments(){return this._attachments}clearAttachments(){return this._attachments=[],this}applyToEvent(t,e={}){if(this._extra&&Object.keys(this._extra).length&&(t.extra={...this._extra,...t.extra}),this._tags&&Object.keys(this._tags).length&&(t.tags={...this._tags,...t.tags}),this._user&&Object.keys(this._user).length&&(t.user={...this._user,...t.user}),this._contexts&&Object.keys(this._contexts).length&&(t.contexts={...this._contexts,...t.contexts}),this._level&&(t.level=this._level),this._transactionName&&(t.transaction=this._transactionName),this._span){t.contexts={trace:this._span.getTraceContext(),...t.contexts};const e=this._span.transaction;if(e){t.sdkProcessingMetadata={dynamicSamplingContext:e.getDynamicSamplingContext(),...t.sdkProcessingMetadata};const i=e.name;i&&(t.tags={transaction:i,...t.tags})}}return this._applyFingerprint(t),t.breadcrumbs=[...t.breadcrumbs||[],...this._breadcrumbs],t.breadcrumbs=t.breadcrumbs.length>0?t.breadcrumbs:void 0,t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...this._sdkProcessingMetadata},this._notifyEventProcessors([...st(),...this._eventProcessors],t,e)}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...t},this}_notifyEventProcessors(t,e,i,r=0){return new it(((n,s)=>{const a=t[r];if(null===e||"function"!=typeof a)n(e);else{const o=a({...e},i);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&a.id&&null===o&&U.log(`Event processor "${a.id}" dropped event`),f(o)?o.then((e=>this._notifyEventProcessors(t,e,i,r+1).then(n))).then(null,s):this._notifyEventProcessors(t,o,i,r+1).then(n).then(null,s)}}))}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((t=>{t(this)})),this._notifyingListeners=!1)}_applyFingerprint(t){t.fingerprint=t.fingerprint?X(t.fingerprint):[],this._fingerprint&&(t.fingerprint=t.fingerprint.concat(this._fingerprint)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}}function st(){return(0,_.YO)("globalEventProcessors",(()=>[]))}function at(t){st().push(t)}const ot=100;class lt{constructor(t,e=new nt,i=4){this._version=i,this._stack=[{scope:e}],t&&this.bindClient(t)}isOlderThan(t){return this._version<t}bindClient(t){this.getStackTop().client=t,t&&t.setupIntegrations&&t.setupIntegrations()}pushScope(){const t=nt.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:t}),t}popScope(){return!(this.getStack().length<=1||!this.getStack().pop())}withScope(t){const e=this.pushScope();try{t(e)}finally{this.popScope()}}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(t,e){const i=this._lastEventId=e&&e.event_id?e.event_id:G(),r=new Error("Sentry syntheticException");return this._withClient(((n,s)=>{n.captureException(t,{originalException:t,syntheticException:r,...e,event_id:i},s)})),i}captureMessage(t,e,i){const r=this._lastEventId=i&&i.event_id?i.event_id:G(),n=new Error(t);return this._withClient(((s,a)=>{s.captureMessage(t,e,{originalException:t,syntheticException:n,...i,event_id:r},a)})),r}captureEvent(t,e){const i=e&&e.event_id?e.event_id:G();return t.type||(this._lastEventId=i),this._withClient(((r,n)=>{r.captureEvent(t,{...e,event_id:i},n)})),i}lastEventId(){return this._lastEventId}addBreadcrumb(t,e){const{scope:i,client:r}=this.getStackTop();if(!r)return;const{beforeBreadcrumb:n=null,maxBreadcrumbs:s=ot}=r.getOptions&&r.getOptions()||{};if(s<=0)return;const a={timestamp:(0,Z.yW)(),...t},o=n?F((()=>n(a,e))):a;null!==o&&(r.emit&&r.emit("beforeAddBreadcrumb",o,e),i.addBreadcrumb(o,s))}setUser(t){this.getScope().setUser(t)}setTags(t){this.getScope().setTags(t)}setExtras(t){this.getScope().setExtras(t)}setTag(t,e){this.getScope().setTag(t,e)}setExtra(t,e){this.getScope().setExtra(t,e)}setContext(t,e){this.getScope().setContext(t,e)}configureScope(t){const{scope:e,client:i}=this.getStackTop();i&&t(e)}run(t){const e=ut(this);try{t(this)}finally{ut(e)}}getIntegration(t){const e=this.getClient();if(!e)return null;try{return e.getIntegration(t)}catch(e){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`Cannot retrieve integration ${t.id} from the current Hub`),null}}startTransaction(t,e){const i=this._callExtensionMethod("startTransaction",t,e);return"undefined"!=typeof __SENTRY_DEBUG__&&!__SENTRY_DEBUG__||i||console.warn("Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':\nSentry.addTracingExtensions();\nSentry.init({...});\n"),i}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(t=!1){if(t)return this.endSession();this._sendSessionUpdate()}endSession(){const t=this.getStackTop().scope,e=t.getSession();e&&function(t,e){let i={};"ok"===t.status&&(i={status:"exited"}),rt(t,i)}(e),this._sendSessionUpdate(),t.setSession()}startSession(t){const{scope:e,client:i}=this.getStackTop(),{release:r,environment:n=Q}=i&&i.getOptions()||{},{userAgent:s}=_.n2.navigator||{},a=function(t){const e=(0,Z.ph)(),i={sid:G(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(t){return P({sid:`${t.sid}`,init:t.init,started:new Date(1e3*t.started).toISOString(),timestamp:new Date(1e3*t.timestamp).toISOString(),status:t.status,errors:t.errors,did:"number"==typeof t.did||"string"==typeof t.did?`${t.did}`:void 0,duration:t.duration,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}(i)};return t&&rt(i,t),i}({release:r,environment:n,user:e.getUser(),...s&&{userAgent:s},...t}),o=e.getSession&&e.getSession();return o&&"ok"===o.status&&rt(o,{status:"exited"}),this.endSession(),e.setSession(a),a}shouldSendDefaultPii(){const t=this.getClient(),e=t&&t.getOptions();return Boolean(e&&e.sendDefaultPii)}_sendSessionUpdate(){const{scope:t,client:e}=this.getStackTop(),i=t.getSession();i&&e&&e.captureSession&&e.captureSession(i)}_withClient(t){const{scope:e,client:i}=this.getStackTop();i&&t(i,e)}_callExtensionMethod(t,...e){const i=ht().__SENTRY__;if(i&&i.extensions&&"function"==typeof i.extensions[t])return i.extensions[t].apply(this,e);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`Extension method ${t} couldn't be found, doing nothing.`)}}function ht(){return _.n2.__SENTRY__=_.n2.__SENTRY__||{extensions:{},hub:void 0},_.n2}function ut(t){const e=ht(),i=dt(e);return pt(e,t),i}function ct(){const t=ht();if(t.__SENTRY__&&t.__SENTRY__.acs){const e=t.__SENTRY__.acs.getCurrentHub();if(e)return e}return function(t=ht()){return e=t,!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)&&!dt(t).isOlderThan(4)||pt(t,new lt),dt(t);var e}(t)}function dt(t){return(0,_.YO)("hub",(()=>new lt),t)}function pt(t,e){return!!t&&((t.__SENTRY__=t.__SENTRY__||{}).hub=e,!0)}const ft="7.56.0";function mt(t,e){return ct().captureException(t,{captureContext:e})}function gt(t,e){const i="string"==typeof e?e:void 0,r="string"!=typeof e?{captureContext:e}:void 0;return ct().captureMessage(t,i,r)}function _t(t,e){return ct().captureEvent(t,e)}function yt(t){ct().configureScope(t)}function vt(t){ct().addBreadcrumb(t)}function xt(t,e){ct().setContext(t,e)}function bt(t){ct().setExtras(t)}function Et(t,e){ct().setExtra(t,e)}function Tt(t){ct().setTags(t)}function St(t,e){ct().setTag(t,e)}function wt(t){ct().setUser(t)}function At(t){ct().withScope(t)}function It(t,e){return ct().startTransaction({...t},e)}function Rt(t){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const e=ct().getClient(),i=t||e&&e.getOptions();return!!i&&(i.enableTracing||"tracesSampleRate"in i||"tracesSampler"in i)}const Ct=/\(error: (.*)\)/;function Mt(...t){const e=t.sort(((t,e)=>t[0]-e[0])).map((t=>t[1]));return(t,i=0)=>{const r=[],n=t.split("\n");for(let t=i;t<n.length;t++){const i=n[t];if(i.length>1024)continue;const s=Ct.test(i)?i.replace(Ct,"$1"):i;if(!s.match(/\S*Error: /)){for(const t of e){const e=t(s);if(e){r.push(e);break}}if(r.length>=50)break}}return function(t){if(!t.length)return[];const e=t.slice(0,50),i=e[e.length-1].function;i&&/sentryWrapped/.test(i)&&e.pop(),e.reverse();const r=e[e.length-1].function;return r&&/captureMessage|captureException/.test(r)&&e.pop(),e.map((t=>({...t,filename:t.filename||e[e.length-1].filename,function:t.function||"?"})))}(r)}}const Ot="<anonymous>";function Pt(t){try{return t&&"function"==typeof t&&t.name||Ot}catch(t){return Ot}}const kt=(0,_.Rf)();function Dt(){if(!("fetch"in kt))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(t){return!1}}function Nt(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}const Lt=(0,_.Rf)(),Ft=(0,_.Rf)(),Bt={},Ut={};function Gt(t,e){Bt[t]=Bt[t]||[],Bt[t].push(e),function(t){if(!Ut[t])switch(Ut[t]=!0,t){case"console":"console"in Ft&&L.forEach((function(t){t in Ft.console&&S(Ft.console,t,(function(e){return function(...i){Wt("console",{args:i,level:t}),e&&e.apply(Ft.console,i)}}))}));break;case"dom":!function(){if(!("document"in Ft))return;const t=Wt.bind(null,"dom"),e=Vt(t,!0);Ft.document.addEventListener("click",e,!1),Ft.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach((e=>{const i=Ft[e]&&Ft[e].prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(S(i,"addEventListener",(function(e){return function(i,r,n){if("click"===i||"keypress"==i)try{const r=this,s=r.__sentry_instrumentation_handlers__=r.__sentry_instrumentation_handlers__||{},a=s[i]=s[i]||{refCount:0};if(!a.handler){const r=Vt(t);a.handler=r,e.call(this,i,r,n)}a.refCount++}catch(t){}return e.call(this,i,r,n)}})),S(i,"removeEventListener",(function(t){return function(e,i,r){if("click"===e||"keypress"==e)try{const i=this,n=i.__sentry_instrumentation_handlers__||{},s=n[e];s&&(s.refCount--,s.refCount<=0&&(t.call(this,e,s.handler,r),s.handler=void 0,delete n[e]),0===Object.keys(n).length&&delete i.__sentry_instrumentation_handlers__)}catch(t){}return t.call(this,e,i,r)}})))}))}();break;case"xhr":!function(){if(!("XMLHttpRequest"in Ft))return;const t=XMLHttpRequest.prototype;S(t,"open",(function(t){return function(...e){const i=e[1],r=this.__sentry_xhr_v2__={method:u(e[0])?e[0].toUpperCase():e[0],url:e[1],request_headers:{}};u(i)&&"POST"===r.method&&i.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const n=()=>{const t=this.__sentry_xhr_v2__;if(t&&4===this.readyState){try{t.status_code=this.status}catch(t){}Wt("xhr",{args:e,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:this})}};return"onreadystatechange"in this&&"function"==typeof this.onreadystatechange?S(this,"onreadystatechange",(function(t){return function(...e){return n(),t.apply(this,e)}})):this.addEventListener("readystatechange",n),S(this,"setRequestHeader",(function(t){return function(...e){const[i,r]=e,n=this.__sentry_xhr_v2__;return n&&(n.request_headers[i.toLowerCase()]=r),t.apply(this,e)}})),t.apply(this,e)}})),S(t,"send",(function(t){return function(...e){const i=this.__sentry_xhr_v2__;return i&&void 0!==e[0]&&(i.body=e[0]),Wt("xhr",{args:e,startTimestamp:Date.now(),xhr:this}),t.apply(this,e)}}))}();break;case"fetch":(function(){if(!Dt())return!1;if(Nt(kt.fetch))return!0;let t=!1;const e=kt.document;if(e&&"function"==typeof e.createElement)try{const i=e.createElement("iframe");i.hidden=!0,e.head.appendChild(i),i.contentWindow&&i.contentWindow.fetch&&(t=Nt(i.contentWindow.fetch)),e.head.removeChild(i)}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",t)}return t})()&&S(Ft,"fetch",(function(t){return function(...e){const{method:i,url:r}=function(t){if(0===t.length)return{method:"GET",url:""};if(2===t.length){const[e,i]=t;return{url:Yt(e),method:jt(i,"method")?String(i.method).toUpperCase():"GET"}}const e=t[0];return{url:Yt(e),method:jt(e,"method")?String(e.method).toUpperCase():"GET"}}(e),n={args:e,fetchData:{method:i,url:r},startTimestamp:Date.now()};return Wt("fetch",{...n}),t.apply(Ft,e).then((t=>(Wt("fetch",{...n,endTimestamp:Date.now(),response:t}),t)),(t=>{throw Wt("fetch",{...n,endTimestamp:Date.now(),error:t}),t}))}}));break;case"history":!function(){if(!function(){const t=Lt.chrome,e=t&&t.app&&t.app.runtime,i="history"in Lt&&!!Lt.history.pushState&&!!Lt.history.replaceState;return!e&&i}())return;const t=Ft.onpopstate;function e(t){return function(...e){const i=e.length>2?e[2]:void 0;if(i){const t=zt,e=String(i);zt=e,Wt("history",{from:t,to:e})}return t.apply(this,e)}}Ft.onpopstate=function(...e){const i=Ft.location.href,r=zt;if(zt=i,Wt("history",{from:r,to:i}),t)try{return t.apply(this,e)}catch(t){}},S(Ft.history,"pushState",e),S(Ft.history,"replaceState",e)}();break;case"error":qt=Ft.onerror,Ft.onerror=function(t,e,i,r,n){return Wt("error",{column:r,error:n,line:i,msg:t,url:e}),!(!qt||qt.__SENTRY_LOADER__)&&qt.apply(this,arguments)},Ft.onerror.__SENTRY_INSTRUMENTED__=!0;break;case"unhandledrejection":Kt=Ft.onunhandledrejection,Ft.onunhandledrejection=function(t){return Wt("unhandledrejection",t),!(Kt&&!Kt.__SENTRY_LOADER__)||Kt.apply(this,arguments)},Ft.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0;break;default:("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("unknown instrumentation type:",t)}}(t)}function Wt(t,e){if(t&&Bt[t])for(const i of Bt[t]||[])try{i(e)}catch(e){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error(`Error while triggering instrumentation handler.\nType: ${t}\nName: ${Pt(i)}\nError:`,e)}}function jt(t,e){return!!t&&"object"==typeof t&&!!t[e]}function Yt(t){return"string"==typeof t?t:t?jt(t,"url")?t.url:t.toString?t.toString():"":""}let zt,Ht,Xt;function Vt(t,e=!1){return i=>{if(!i||Xt===i)return;if(function(t){if("keypress"!==t.type)return!1;try{const e=t.target;if(!e||!e.tagName)return!0;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable)return!1}catch(t){}return!0}(i))return;const r="keypress"===i.type?"input":i.type;(void 0===Ht||function(t,e){if(!t)return!0;if(t.type!==e.type)return!0;try{if(t.target!==e.target)return!0}catch(t){}return!1}(Xt,i))&&(t({event:i,name:r,global:e}),Xt=i),clearTimeout(Ht),Ht=Ft.setTimeout((()=>{Ht=void 0}),1e3)}}let qt=null,Kt=null;function $t(t){return(t||ct()).getScope().getTransaction()}let Zt=!1;function Qt(){const t=$t();if(t){const e="internal_error";("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Tracing] Transaction: ${e} -> Global error occured`),t.setStatus(e)}}Qt.tag="sentry_tracingErrorCallback";class Jt{__init(){this.spans=[]}constructor(t=1e3){Jt.prototype.__init.call(this),this._maxlen=t}add(t){this.spans.length>this._maxlen?t.spanRecorder=void 0:this.spans.push(t)}}class te{__init2(){this.traceId=G()}__init3(){this.spanId=G().substring(16)}__init4(){this.startTimestamp=(0,Z.ph)()}__init5(){this.tags={}}__init6(){this.data={}}__init7(){this.instrumenter="sentry"}constructor(t){if(te.prototype.__init2.call(this),te.prototype.__init3.call(this),te.prototype.__init4.call(this),te.prototype.__init5.call(this),te.prototype.__init6.call(this),te.prototype.__init7.call(this),!t)return this;t.traceId&&(this.traceId=t.traceId),t.spanId&&(this.spanId=t.spanId),t.parentSpanId&&(this.parentSpanId=t.parentSpanId),"sampled"in t&&(this.sampled=t.sampled),t.op&&(this.op=t.op),t.description&&(this.description=t.description),t.data&&(this.data=t.data),t.tags&&(this.tags=t.tags),t.status&&(this.status=t.status),t.startTimestamp&&(this.startTimestamp=t.startTimestamp),t.endTimestamp&&(this.endTimestamp=t.endTimestamp),t.instrumenter&&(this.instrumenter=t.instrumenter)}startChild(t){const e=new te({...t,parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId});if(e.spanRecorder=this.spanRecorder,e.spanRecorder&&e.spanRecorder.add(e),e.transaction=this.transaction,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&e.transaction){const i=`[Tracing] Starting '${t&&t.op||"< unknown op >"}' span on transaction '${e.transaction.name||"< unknown name >"}' (${e.transaction.spanId}).`;e.transaction.metadata.spanMetadata[e.spanId]={logMessage:i},U.log(i)}return e}setTag(t,e){return this.tags={...this.tags,[t]:e},this}setData(t,e){return this.data={...this.data,[t]:e},this}setStatus(t){return this.status=t,this}setHttpStatus(t){this.setTag("http.status_code",String(t));const e=ee(t);return"unknown_error"!==e&&this.setStatus(e),this}isSuccess(){return"ok"===this.status}finish(t){if(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&this.transaction&&this.transaction.spanId!==this.spanId){const{logMessage:t}=this.transaction.metadata.spanMetadata[this.spanId];t&&U.log(t.replace("Starting","Finishing"))}this.endTimestamp="number"==typeof t?t:(0,Z.ph)()}toTraceparent(){let t="";return void 0!==this.sampled&&(t=this.sampled?"-1":"-0"),`${this.traceId}-${this.spanId}${t}`}toContext(){return P({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(t){return this.data=t.data||{},this.description=t.description,this.endTimestamp=t.endTimestamp,this.op=t.op,this.parentSpanId=t.parentSpanId,this.sampled=t.sampled,this.spanId=t.spanId||this.spanId,this.startTimestamp=t.startTimestamp||this.startTimestamp,this.status=t.status,this.tags=t.tags||{},this.traceId=t.traceId||this.traceId,this}getTraceContext(){return P({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId})}toJSON(){return P({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId})}}function ee(t){if(t<400&&t>=100)return"ok";if(t>=400&&t<500)switch(t){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(t>=500&&t<600)switch(t){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}class ie extends te{__init(){this._measurements={}}__init2(){this._contexts={}}__init3(){this._frozenDynamicSamplingContext=void 0}constructor(t,e){super(t),ie.prototype.__init.call(this),ie.prototype.__init2.call(this),ie.prototype.__init3.call(this),this._hub=e||ct(),this._name=t.name||"",this.metadata={source:"custom",...t.metadata,spanMetadata:{}},this._trimEnd=t.trimEnd,this.transaction=this;const i=this.metadata.dynamicSamplingContext;i&&(this._frozenDynamicSamplingContext={...i})}get name(){return this._name}set name(t){this.setName(t)}setName(t,e="custom"){this._name=t,this.metadata.source=e}initSpanRecorder(t=1e3){this.spanRecorder||(this.spanRecorder=new Jt(t)),this.spanRecorder.add(this)}setContext(t,e){null===e?delete this._contexts[t]:this._contexts[t]=e}setMeasurement(t,e,i=""){this._measurements[t]={value:e,unit:i}}setMetadata(t){this.metadata={...this.metadata,...t}}finish(t){if(void 0!==this.endTimestamp)return;this.name||(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.finish(t);const e=this._hub.getClient();if(e&&e.emit&&e.emit("finishTransaction",this),!0!==this.sampled)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),void(e&&e.recordDroppedEvent("sample_rate","transaction"));const i=this.spanRecorder?this.spanRecorder.spans.filter((t=>t!==this&&t.endTimestamp)):[];this._trimEnd&&i.length>0&&(this.endTimestamp=i.reduce(((t,e)=>t.endTimestamp&&e.endTimestamp?t.endTimestamp>e.endTimestamp?t:e:t)).endTimestamp);const r=this.metadata,n={contexts:{...this._contexts,trace:this.getTraceContext()},spans:i,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:{...r,dynamicSamplingContext:this.getDynamicSamplingContext()},...r.source&&{transaction_info:{source:r.source}}};return Object.keys(this._measurements).length>0&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),n.measurements=this._measurements),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),this._hub.captureEvent(n)}toContext(){return P({...super.toContext(),name:this.name,trimEnd:this._trimEnd})}updateWithContext(t){return super.updateWithContext(t),this.name=t.name||"",this._trimEnd=t.trimEnd,this}getDynamicSamplingContext(){if(this._frozenDynamicSamplingContext)return this._frozenDynamicSamplingContext;const t=this._hub||ct(),e=t&&t.getClient();if(!e)return{};const{environment:i,release:r}=e.getOptions()||{},{publicKey:n}=e.getDsn()||{},s=this.metadata.sampleRate,a=void 0!==s?s.toString():void 0,{segment:o}=t.getScope().getUser()||{},l=this.metadata.source,h=l&&"url"!==l?this.name:void 0,u=P({environment:i||Q,release:r,transaction:h,user_segment:o,public_key:n,trace_id:this.traceId,sample_rate:a});return e.emit&&e.emit("createDsc",u),u}setHub(t){this._hub=t}}const re={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},ne=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class se extends Jt{constructor(t,e,i,r){super(r),this._pushActivity=t,this._popActivity=e,this.transactionSpanId=i}add(t){t.spanId!==this.transactionSpanId&&(t.finish=e=>{t.endTimestamp="number"==typeof e?e:(0,Z.ph)(),this._popActivity(t.spanId)},void 0===t.endTimestamp&&this._pushActivity(t.spanId)),super.add(t)}}class ae extends ie{__init(){this.activities={}}__init2(){this._heartbeatCounter=0}__init3(){this._finished=!1}__init4(){this._idleTimeoutCanceledPermanently=!1}__init5(){this._beforeFinishCallbacks=[]}__init6(){this._finishReason=ne[4]}constructor(t,e,i=re.idleTimeout,r=re.finalTimeout,n=re.heartbeatInterval,s=!1){super(t,e),this._idleHub=e,this._idleTimeout=i,this._finalTimeout=r,this._heartbeatInterval=n,this._onScope=s,ae.prototype.__init.call(this),ae.prototype.__init2.call(this),ae.prototype.__init3.call(this),ae.prototype.__init4.call(this),ae.prototype.__init5.call(this),ae.prototype.__init6.call(this),s&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`),e.configureScope((t=>t.setSpan(this)))),this._restartIdleTimeout(),setTimeout((()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=ne[3],this.finish())}),this._finalTimeout)}finish(t=(0,Z.ph)()){if(this._finished=!0,this.activities={},"ui.action.click"===this.op&&this.setTag("finishReason",this._finishReason),this.spanRecorder){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Tracing] finishing IdleTransaction",new Date(1e3*t).toISOString(),this.op);for(const e of this._beforeFinishCallbacks)e(this,t);this.spanRecorder.spans=this.spanRecorder.spans.filter((e=>{if(e.spanId===this.spanId)return!0;e.endTimestamp||(e.endTimestamp=t,e.setStatus("cancelled"),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(e,void 0,2)));const i=e.startTimestamp<t;return i||("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Tracing] discarding Span since it happened after Transaction was finished",JSON.stringify(e,void 0,2)),i})),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Tracing] flushing IdleTransaction")}else("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Tracing] No active IdleTransaction");if(this._onScope){const t=this._idleHub.getScope();t.getTransaction()===this&&t.setSpan(void 0)}return super.finish(t)}registerBeforeFinishCallback(t){this._beforeFinishCallbacks.push(t)}initSpanRecorder(t){if(!this.spanRecorder){const e=t=>{this._finished||this._pushActivity(t)},i=t=>{this._finished||this._popActivity(t)};this.spanRecorder=new se(e,i,this.spanId,t),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(t,{restartOnChildSpanChange:e}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=!1===e,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,0===Object.keys(this.activities).length&&this._idleTimeoutCanceledPermanently&&(this._finishReason=ne[5],this.finish(t)))}setFinishReason(t){this._finishReason=t}_restartIdleTimeout(t){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout((()=>{this._finished||0!==Object.keys(this.activities).length||(this._finishReason=ne[1],this.finish(t))}),this._idleTimeout)}_pushActivity(t){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Tracing] pushActivity: ${t}`),this.activities[t]=!0,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(t){if(this.activities[t]&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Tracing] popActivity ${t}`),delete this.activities[t],("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){const t=(0,Z.ph)();this._idleTimeoutCanceledPermanently?(this._finishReason=ne[5],this.finish(t)):this._restartIdleTimeout(t+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const t=Object.keys(this.activities).join("");t===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=t,this._heartbeatCounter>=3?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=ne[0],this.finish()):this._pingHeartbeat()}_pingHeartbeat(){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout((()=>{this._beat()}),this._heartbeatInterval)}}function oe(){const t=this.getScope().getSpan();return t?{"sentry-trace":t.toTraceparent()}:{}}function le(t,e,i){if(!Rt(e))return t.sampled=!1,t;if(void 0!==t.sampled)return t.setMetadata({sampleRate:Number(t.sampled)}),t;let r;return"function"==typeof e.tracesSampler?(r=e.tracesSampler(i),t.setMetadata({sampleRate:Number(r)})):void 0!==i.parentSampled?r=i.parentSampled:void 0!==e.tracesSampleRate?(r=e.tracesSampleRate,t.setMetadata({sampleRate:Number(r)})):(r=1,t.setMetadata({sampleRate:r})),(m(n=r)||"number"!=typeof n&&"boolean"!=typeof n?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(n)} of type ${JSON.stringify(typeof n)}.`),0):!(n<0||n>1)||(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${n}.`),0))?r?(t.sampled=Math.random()<r,t.sampled?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Tracing] starting ${t.op} transaction - ${t.name}`),t):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(r)})`),t)):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Tracing] Discarding transaction because "+("function"==typeof e.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),t.sampled=!1,t):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("[Tracing] Discarding transaction because of invalid sample rate."),t.sampled=!1,t);var n}function he(t,e){const i=this.getClient(),r=i&&i.getOptions()||{},n=r.instrumenter||"sentry",s=t.instrumenter||"sentry";n!==s&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error(`A transaction was started with instrumenter=\`${s}\`, but the SDK is configured with the \`${n}\` instrumenter.\nThe transaction will not be sampled. Please use the ${n} instrumentation to start transactions.`),t.sampled=!1);let a=new ie(t,this);return a=le(a,r,{parentSampled:t.parentSampled,transactionContext:t,...e}),a.sampled&&a.initSpanRecorder(r._experiments&&r._experiments.maxSpans),i&&i.emit&&i.emit("startTransaction",a),a}function ue(t,e,i,r,n,s,a){const o=t.getClient(),l=o&&o.getOptions()||{};let h=new ae(e,t,i,r,a,n);return h=le(h,l,{parentSampled:e.parentSampled,transactionContext:e,...s}),h.sampled&&h.initSpanRecorder(l._experiments&&l._experiments.maxSpans),o&&o.emit&&o.emit("startTransaction",h),h}function ce(){const t=ht();t.__SENTRY__&&(t.__SENTRY__.extensions=t.__SENTRY__.extensions||{},t.__SENTRY__.extensions.startTransaction||(t.__SENTRY__.extensions.startTransaction=he),t.__SENTRY__.extensions.traceHeaders||(t.__SENTRY__.extensions.traceHeaders=oe),Zt||(Zt=!0,Gt("error",Qt),Gt("unhandledrejection",Qt)))}class de extends Error{constructor(t,e="warn"){super(t),this.message=t,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=e}}const pe=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function fe(t,e=!1){const{host:i,path:r,pass:n,port:s,projectId:a,protocol:o,publicKey:l}=t;return`${o}://${l}${e&&n?`:${n}`:""}@${i}${s?`:${s}`:""}/${r?`${r}/`:r}${a}`}function me(t){const e=pe.exec(t);if(!e)return void console.error(`Invalid Sentry Dsn: ${t}`);const[i,r,n="",s,a="",o]=e.slice(1);let l="",h=o;const u=h.split("/");if(u.length>1&&(l=u.slice(0,-1).join("/"),h=u.pop()),h){const t=h.match(/^\d+/);t&&(h=t[0])}return ge({host:s,pass:n,path:l,projectId:h,port:a,protocol:i,publicKey:r})}function ge(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function _e(t){const e="string"==typeof t?me(t):ge(t);if(e&&function(t){if("undefined"!=typeof __SENTRY_DEBUG__&&!__SENTRY_DEBUG__)return!0;const{port:e,projectId:i,protocol:r}=t;return!(["protocol","publicKey","host","projectId"].find((e=>!t[e]&&(U.error(`Invalid Sentry Dsn: ${e} missing`),!0)))||(i.match(/^\d+$/)?function(t){return"http"===t||"https"===t}(r)?e&&isNaN(parseInt(e,10))&&(U.error(`Invalid Sentry Dsn: Invalid port ${e}`),1):(U.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):(U.error(`Invalid Sentry Dsn: Invalid projectId ${i}`),1)))}(e))return e}function ye(t,e=100,i=1/0){try{return xe("",t,e,i)}catch(t){return{ERROR:`**non-serializable** (${t})`}}}function ve(t,e=3,i=102400){const r=ye(t,e);return n=r,function(t){return~-encodeURI(t).split(/%..|./).length}(JSON.stringify(n))>i?ve(t,e-1,i):r;var n}function xe(t,e,r=1/0,n=1/0,s=function(){const t="function"==typeof WeakSet,e=t?new WeakSet:[];return[function(i){if(t)return!!e.has(i)||(e.add(i),!1);for(let t=0;t<e.length;t++)if(e[t]===i)return!0;return e.push(i),!1},function(i){if(t)e.delete(i);else for(let t=0;t<e.length;t++)if(e[t]===i){e.splice(t,1);break}}]}()){const[a,o]=s;if(null==e||["number","boolean","string"].includes(typeof e)&&!m(e))return e;const l=function(t,e){try{if("domain"===t&&e&&"object"==typeof e&&e._events)return"[Domain]";if("domainEmitter"===t)return"[DomainEmitter]";if(void 0!==i.g&&e===i.g)return"[Global]";if("undefined"!=typeof window&&e===window)return"[Window]";if("undefined"!=typeof document&&e===document)return"[Document]";if(d(r=e)&&"nativeEvent"in r&&"preventDefault"in r&&"stopPropagation"in r)return"[SyntheticEvent]";if("number"==typeof e&&e!=e)return"[NaN]";if("function"==typeof e)return`[Function: ${Pt(e)}]`;if("symbol"==typeof e)return`[${String(e)}]`;if("bigint"==typeof e)return`[BigInt: ${String(e)}]`;const n=function(t){const e=Object.getPrototypeOf(t);return e?e.constructor.name:"null prototype"}(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(t){return`**non-serializable** (${t})`}var r}(t,e);if(!l.startsWith("[object "))return l;if(e.__sentry_skip_normalization__)return e;const h="number"==typeof e.__sentry_override_normalization_depth__?e.__sentry_override_normalization_depth__:r;if(0===h)return l.replace("object ","");if(a(e))return"[Circular ~]";const u=e;if(u&&"function"==typeof u.toJSON)try{return xe("",u.toJSON(),h-1,n,s)}catch(t){}const c=Array.isArray(e)?[]:{};let p=0;const f=R(e);for(const t in f){if(!Object.prototype.hasOwnProperty.call(f,t))continue;if(p>=n){c[t]="[MaxProperties ~]";break}const e=f[t];c[t]=xe(t,e,h-1,n,s),p++}return o(e),c}function be(t,e=[]){return[t,e]}function Ee(t,e){const[i,r]=t;return[i,[...r,e]]}function Te(t,e){const i=t[1];for(const t of i)if(e(t,t[0].type))return!0;return!1}function Se(t,e){return(e||new TextEncoder).encode(t)}function we(t,e){const[i,r]=t;let n=JSON.stringify(i);function s(t){"string"==typeof n?n="string"==typeof t?n+t:[Se(n,e),t]:n.push("string"==typeof t?Se(t,e):t)}for(const t of r){const[e,i]=t;if(s(`\n${JSON.stringify(e)}\n`),"string"==typeof i||i instanceof Uint8Array)s(i);else{let t;try{t=JSON.stringify(i)}catch(e){t=JSON.stringify(ye(i))}s(t)}}return"string"==typeof n?n:function(t){const e=t.reduce(((t,e)=>t+e.length),0),i=new Uint8Array(e);let r=0;for(const e of t)i.set(e,r),r+=e.length;return i}(n)}function Ae(t,e){const i="string"==typeof t.data?Se(t.data,e):t.data;return[P({type:"attachment",length:i.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),i]}const Ie={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor"};function Re(t){return Ie[t]}function Ce(t){if(!t||!t.sdk)return;const{name:e,version:i}=t.sdk;return{name:e,version:i}}function Me(t,e,i,r){const n=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:(new Date).toISOString(),...e&&{sdk:e},...!!i&&{dsn:fe(r)},...n&&{trace:P({...n})}}}function Oe(t,e=Date.now()){const i=parseInt(`${t}`,10);if(!isNaN(i))return 1e3*i;const r=Date.parse(`${t}`);return isNaN(r)?6e4:r-e}function Pe(t,e,i=function(t){const e=[];function i(t){return e.splice(e.indexOf(t),1)[0]}return{$:e,add:function(r){if(!(void 0===t||e.length<t))return et(new de("Not adding Promise because buffer limit was reached."));const n=r();return-1===e.indexOf(n)&&e.push(n),n.then((()=>i(n))).then(null,(()=>i(n).then(null,(()=>{})))),n},drain:function(t){return new it(((i,r)=>{let n=e.length;if(!n)return i(!0);const s=setTimeout((()=>{t&&t>0&&i(!1)}),t);e.forEach((t=>{tt(t).then((()=>{--n||(clearTimeout(s),i(!0))}),r)}))}))}}}(t.bufferSize||30)){let r={};function n(n){const s=[];if(Te(n,((e,i)=>{const n=Re(i);if(function(t,e,i=Date.now()){return function(t,e){return t[e]||t.all||0}(t,e)>i}(r,n)){const r=ke(e,i);t.recordDroppedEvent("ratelimit_backoff",n,r)}else s.push(e)})),0===s.length)return tt();const a=be(n[0],s),o=e=>{Te(a,((i,r)=>{const n=ke(i,r);t.recordDroppedEvent(e,Re(r),n)}))};return i.add((()=>e({body:we(a,t.textEncoder)}).then((t=>(void 0!==t.statusCode&&(t.statusCode<200||t.statusCode>=300)&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`Sentry responded with status code ${t.statusCode} to sent event.`),r=function(t,{statusCode:e,headers:i},r=Date.now()){const n={...t},s=i&&i["x-sentry-rate-limits"],a=i&&i["retry-after"];if(s)for(const t of s.trim().split(",")){const[e,i]=t.split(":",2),s=parseInt(e,10),a=1e3*(isNaN(s)?60:s);if(i)for(const t of i.split(";"))n[t]=r+a;else n.all=r+a}else a?n.all=r+Oe(a,r):429===e&&(n.all=r+6e4);return n}(r,t),t)),(t=>{throw o("network_error"),t})))).then((t=>t),(t=>{if(t instanceof de)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("Skipped sending event because buffer is full."),o("queue_overflow"),tt();throw t}))}return n.__sentry__baseTransport__=!0,{send:n,flush:t=>i.drain(t)}}function ke(t,e){if("event"===e||"transaction"===e)return Array.isArray(t)?t[1]:void 0}const De=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function Ne(t){const e=t.match(De);if(!t||!e)return;let i;return"1"===e[3]?i=!0:"0"===e[3]&&(i=!1),{traceId:e[1],parentSampled:i,parentSpanId:e[2]}}function Le(t){const e=t.protocol?`${t.protocol}:`:"",i=t.port?`:${t.port}`:"";return`${e}//${t.host}${i}${t.path?`/${t.path}`:""}/api/`}function Fe(t,e={}){const i="string"==typeof e?e:e.tunnel,r="string"!=typeof e&&e._metadata?e._metadata.sdk:void 0;return i||`${function(t){return`${Le(t)}${t.projectId}/envelope/`}(t)}?${function(t,e){return i={sentry_key:t.publicKey,sentry_version:"7",...e&&{sentry_client:`${e.name}/${e.version}`}},Object.keys(i).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(i[t])}`)).join("&");var i}(t,r)}`}function Be(t,e){return i=>{const r=t(i),n={};return{send:async function(s){const a=e({envelope:s,getEvent:function(t){const e=t&&t.length?t:["event"];return function(t,e){let i;return Te(t,((t,r)=>(e.includes(r)&&(i=Array.isArray(t)?t[1]:void 0),!!i))),i}(s,e)}}).map((e=>function(e){if(!n[e]){const r=me(e);if(!r)return;const s=Fe(r);n[e]=t({...i,url:s})}return n[e]}(e))).filter((t=>!!t));return 0===a.length&&a.push(r),(await Promise.all(a.map((t=>t.send(s)))))[0]},flush:async function(t){const e=[...Object.keys(n).map((t=>n[t])),r];return(await Promise.all(e.map((e=>e.flush(t))))).every((t=>t))}}}}function Ue(t,e,i=(()=>{})){const r={...t};void 0!==r.name&&void 0===r.description&&(r.description=r.name);const n=ct(),s=n.getScope(),a=s.getSpan(),o=a?a.startChild(r):n.startTransaction(r);function l(){o&&o.finish(),n.getScope().setSpan(a)}let h;s.setSpan(o);try{h=e(o)}catch(t){throw o&&o.setStatus("internal_error"),i(t),l(),t}return f(h)?Promise.resolve(h).then((()=>{l()}),(t=>{o&&o.setStatus("internal_error"),i(t),l()})):l(),h}const Ge=_.n2;let We=0;function je(){return We>0}function Ye(){We++,setTimeout((()=>{We--}))}function ze(t,e={},i){if("function"!=typeof t)return t;try{const e=t.__sentry_wrapped__;if(e)return e;if(I(t))return t}catch(e){return t}const r=function(){const r=Array.prototype.slice.call(arguments);try{i&&"function"==typeof i&&i.apply(this,arguments);const n=r.map((t=>ze(t,e)));return t.apply(this,n)}catch(t){throw Ye(),At((i=>{i.addEventProcessor((t=>(e.mechanism&&(Y(t,void 0,void 0),z(t,e.mechanism)),t.extra={...t.extra,arguments:r},t))),mt(t)})),t}};try{for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])}catch(t){}A(r,t),w(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get:()=>t.name})}catch(t){}return r}const He=[];function Xe(t){const e=t.defaultIntegrations||[],i=t.integrations;let r;e.forEach((t=>{t.isDefaultInstance=!0})),r=Array.isArray(i)?[...e,...i]:"function"==typeof i?X(i(e)):e;const n=function(t){const e={};return t.forEach((t=>{const{name:i}=t,r=e[i];r&&!r.isDefaultInstance&&t.isDefaultInstance||(e[i]=t)})),Object.keys(e).map((t=>e[t]))}(r),s=function(t,e){for(let e=0;e<t.length;e++)if(!0==("Debug"===t[e].name))return e;return-1}(n);if(-1!==s){const[t]=n.splice(s,1);n.push(t)}return n}function Ve(t,e){e[t.name]=t,-1===He.indexOf(t.name)&&(t.setupOnce(at,ct),He.push(t.name),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`Integration installed: ${t.name}`))}function qe(t,e,i,r){const{normalizeDepth:n=3,normalizeMaxBreadth:s=1e3}=t,a={...e,event_id:e.event_id||i.event_id||G(),timestamp:e.timestamp||(0,Z.yW)()},o=i.integrations||t.integrations.map((t=>t.name));!function(t,e){const{environment:i,release:r,dist:n,maxValueLength:s=250}=e;"environment"in t||(t.environment="environment"in e?i:Q),void 0===t.release&&void 0!==r&&(t.release=r),void 0===t.dist&&void 0!==n&&(t.dist=n),t.message&&(t.message=b(t.message,s));const a=t.exception&&t.exception.values&&t.exception.values[0];a&&a.value&&(a.value=b(a.value,s));const o=t.request;o&&o.url&&(o.url=b(o.url,s))}(a,t),function(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}(a,o),void 0===e.type&&function(t,e){const i=_.n2._sentryDebugIds;if(!i)return;let r;const n=Ke.get(e);n?r=n:(r=new Map,Ke.set(e,r));const s=Object.keys(i).reduce(((t,n)=>{let s;const a=r.get(n);a?s=a:(s=e(n),r.set(n,s));for(let e=s.length-1;e>=0;e--){const r=s[e];if(r.filename){t[r.filename]=i[n];break}}return t}),{});try{t.exception.values.forEach((t=>{t.stacktrace.frames.forEach((t=>{t.filename&&(t.debug_id=s[t.filename])}))}))}catch(t){}}(a,t.stackParser);let l=r;i.captureContext&&(l=nt.clone(l).update(i.captureContext));let h=tt(a);if(l){if(l.getAttachments){const t=[...i.attachments||[],...l.getAttachments()];t.length&&(i.attachments=t)}h=l.applyToEvent(a,i)}return h.then((t=>(t&&function(t){const e={};try{t.exception.values.forEach((t=>{t.stacktrace.frames.forEach((t=>{t.debug_id&&(t.abs_path?e[t.abs_path]=t.debug_id:t.filename&&(e[t.filename]=t.debug_id),delete t.debug_id)}))}))}catch(t){}if(0===Object.keys(e).length)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const i=t.debug_meta.images;Object.keys(e).forEach((t=>{i.push({type:"sourcemap",code_file:t,debug_id:e[t]})}))}(t),"number"==typeof n&&n>0?function(t,e,i){if(!t)return null;const r={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map((t=>({...t,...t.data&&{data:ye(t.data,e,i)}})))},...t.user&&{user:ye(t.user,e,i)},...t.contexts&&{contexts:ye(t.contexts,e,i)},...t.extra&&{extra:ye(t.extra,e,i)}};return t.contexts&&t.contexts.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=ye(t.contexts.trace.data,e,i))),t.spans&&(r.spans=t.spans.map((t=>(t.data&&(t.data=ye(t.data,e,i)),t)))),r}(t,n,s):t)))}const Ke=new WeakMap,$e="Not capturing exception because it's already been captured.";class Ze{__init(){this._integrations={}}__init2(){this._integrationsInitialized=!1}__init3(){this._numProcessing=0}__init4(){this._outcomes={}}__init5(){this._hooks={}}constructor(t){if(Ze.prototype.__init.call(this),Ze.prototype.__init2.call(this),Ze.prototype.__init3.call(this),Ze.prototype.__init4.call(this),Ze.prototype.__init5.call(this),this._options=t,t.dsn?this._dsn=_e(t.dsn):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("No DSN provided, client will not do anything."),this._dsn){const e=Fe(this._dsn,t);this._transport=t.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...t.transportOptions,url:e})}}captureException(t,e,i){if(H(t))return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log($e));let r=e&&e.event_id;return this._process(this.eventFromException(t,e).then((t=>this._captureEvent(t,e,i))).then((t=>{r=t}))),r}captureMessage(t,e,i,r){let n=i&&i.event_id;const s=c(t)?this.eventFromMessage(String(t),e,i):this.eventFromException(t,i);return this._process(s.then((t=>this._captureEvent(t,i,r))).then((t=>{n=t}))),n}captureEvent(t,e,i){if(e&&e.originalException&&H(e.originalException))return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log($e));let r=e&&e.event_id;return this._process(this._captureEvent(t,e,i).then((t=>{r=t}))),r}captureSession(t){this._isEnabled()?"string"!=typeof t.release?("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("Discarded session because of missing or non-string release"):(this.sendSession(t),rt(t,{init:!1})):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("SDK not enabled, will not capture session.")}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){const e=this._transport;return e?this._isClientDoneProcessing(t).then((i=>e.flush(t).then((t=>i&&t)))):tt(!0)}close(t){return this.flush(t).then((t=>(this.getOptions().enabled=!1,t)))}setupIntegrations(){this._isEnabled()&&!this._integrationsInitialized&&(this._integrations=function(t){const e={};return t.forEach((t=>{t&&Ve(t,e)})),e}(this._options.integrations),this._integrationsInitialized=!0)}getIntegrationById(t){return this._integrations[t]}getIntegration(t){try{return this._integrations[t.id]||null}catch(e){return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`Cannot retrieve integration ${t.id} from the current Client`),null}}addIntegration(t){Ve(t,this._integrations)}sendEvent(t,e={}){if(this._dsn){let i=function(t,e,i,r){const n=Ce(i),s=t.type&&"replay_event"!==t.type?t.type:"event";!function(t,e){e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]])}(t,i&&i.sdk);const a=Me(t,n,r,e);return delete t.sdkProcessingMetadata,be(a,[[{type:s},t]])}(t,this._dsn,this._options._metadata,this._options.tunnel);for(const t of e.attachments||[])i=Ee(i,Ae(t,this._options.transportOptions&&this._options.transportOptions.textEncoder));const r=this._sendEnvelope(i);r&&r.then((e=>this.emit("afterSendEvent",t,e)),null)}}sendSession(t){if(this._dsn){const e=function(t,e,i,r){const n=Ce(i);return be({sent_at:(new Date).toISOString(),...n&&{sdk:n},...!!r&&{dsn:fe(e)}},["aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()]])}(t,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(e)}}recordDroppedEvent(t,e,i){if(this._options.sendClientReports){const i=`${t}:${e}`;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`Adding outcome: "${i}"`),this._outcomes[i]=this._outcomes[i]+1||1}}on(t,e){this._hooks[t]||(this._hooks[t]=[]),this._hooks[t].push(e)}emit(t,...e){this._hooks[t]&&this._hooks[t].forEach((t=>t(...e)))}_updateSessionFromEvent(t,e){let i=!1,r=!1;const n=e.exception&&e.exception.values;if(n){r=!0;for(const t of n){const e=t.mechanism;if(e&&!1===e.handled){i=!0;break}}}const s="ok"===t.status;(s&&0===t.errors||s&&i)&&(rt(t,{...i&&{status:"crashed"},errors:t.errors||Number(r||i)}),this.captureSession(t))}_isClientDoneProcessing(t){return new it((e=>{let i=0;const r=setInterval((()=>{0==this._numProcessing?(clearInterval(r),e(!0)):(i+=1,t&&i>=t&&(clearInterval(r),e(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._dsn}_prepareEvent(t,e,i){const r=this.getOptions(),n=Object.keys(this._integrations);return!e.integrations&&n.length>0&&(e.integrations=n),qe(r,t,e,i)}_captureEvent(t,e={},i){return this._processEvent(t,e,i).then((t=>t.event_id),(t=>{if("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__){const e=t;"log"===e.logLevel?U.log(e.message):U.warn(e)}}))}_processEvent(t,e,i){const r=this.getOptions(),{sampleRate:n}=r;if(!this._isEnabled())return et(new de("SDK not enabled, will not capture event.","log"));const s=Je(t),a=Qe(t),o=t.type||"error",l=`before send for type \`${o}\``;if(a&&"number"==typeof n&&Math.random()>n)return this.recordDroppedEvent("sample_rate","error",t),et(new de(`Discarding event because it's not included in the random sample (sampling rate = ${n})`,"log"));const h="replay_event"===o?"replay":o;return this._prepareEvent(t,e,i).then((i=>{if(null===i)throw this.recordDroppedEvent("event_processor",h,t),new de("An event processor returned `null`, will not send event.","log");if(e.data&&!0===e.data.__sentry__)return i;const n=function(t,e,i){const{beforeSend:r,beforeSendTransaction:n}=t;return Qe(e)&&r?r(e,i):Je(e)&&n?n(e,i):e}(r,i,e);return function(t,e){const i=`${e} must return \`null\` or a valid event.`;if(f(t))return t.then((t=>{if(!d(t)&&null!==t)throw new de(i);return t}),(t=>{throw new de(`${e} rejected with ${t}`)}));if(!d(t)&&null!==t)throw new de(i);return t}(n,l)})).then((r=>{if(null===r)throw this.recordDroppedEvent("before_send",h,t),new de(`${l} returned \`null\`, will not send event.`,"log");const n=i&&i.getSession();!s&&n&&this._updateSessionFromEvent(n,r);const a=r.transaction_info;if(s&&a&&r.transaction!==t.transaction){const t="custom";r.transaction_info={...a,source:t}}return this.sendEvent(r,e),r})).then(null,(t=>{if(t instanceof de)throw t;throw this.captureException(t,{data:{__sentry__:!0},originalException:t}),new de(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${t}`)}))}_process(t){this._numProcessing++,t.then((t=>(this._numProcessing--,t)),(t=>(this._numProcessing--,t)))}_sendEnvelope(t){if(this._transport&&this._dsn)return this.emit("beforeEnvelope",t),this._transport.send(t).then(null,(t=>{("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("Error while sending event:",t)}));("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("Transport disabled")}_clearOutcomes(){const t=this._outcomes;return this._outcomes={},Object.keys(t).map((e=>{const[i,r]=e.split(":");return{reason:i,category:r,quantity:t[e]}}))}}function Qe(t){return void 0===t.type}function Je(t){return"transaction"===t.type}var ti=i(8518);function ei(t,e){const i=ri(t,e),r={type:e&&e.name,value:si(e)};return i.length&&(r.stacktrace={frames:i}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function ii(t,e){return{exception:{values:[ei(t,e)]}}}function ri(t,e){const i=e.stacktrace||e.stack||"",r=function(t){if(t){if("number"==typeof t.framesToPop)return t.framesToPop;if(ni.test(t.message))return 1}return 0}(e);try{return t(i,r)}catch(t){}return[]}const ni=/Minified React error #\d+;/i;function si(t){const e=t&&t.message;return e?e.error&&"string"==typeof e.error.message?e.error.message:e:"No error message"}function ai(t,e,i,r){const n=li(t,e,i&&i.syntheticException||void 0,r);return z(n),n.level="error",i&&i.event_id&&(n.event_id=i.event_id),tt(n)}function oi(t,e,i="info",r,n){const s=hi(t,e,r&&r.syntheticException||void 0,n);return s.level=i,r&&r.event_id&&(s.event_id=r.event_id),tt(s)}function li(t,e,i,r,n){let s;if(l(e)&&e.error)return ii(t,e.error);if(h(e)||o(e,"DOMException")){const n=e;if("stack"in e)s=ii(t,e);else{const e=n.name||(h(n)?"DOMError":"DOMException"),a=n.message?`${e}: ${n.message}`:e;s=hi(t,a,i,r),Y(s,a)}return"code"in n&&(s.tags={...s.tags,"DOMException.code":`${n.code}`}),s}return a(e)?ii(t,e):d(e)||p(e)?(s=function(t,e,i,r){const n=ct().getClient(),s=n&&n.getOptions().normalizeDepth,a={exception:{values:[{type:p(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:`Non-Error ${r?"promise rejection":"exception"} captured with keys: ${O(e)}`}]},extra:{__serialized__:ve(e,s)}};if(i){const e=ri(t,i);e.length&&(a.exception.values[0].stacktrace={frames:e})}return a}(t,e,i,n),z(s,{synthetic:!0}),s):(s=hi(t,e,i,r),Y(s,`${e}`,void 0),z(s,{synthetic:!0}),s)}function hi(t,e,i,r){const n={message:e};if(r&&i){const r=ri(t,i);r.length&&(n.exception={values:[{value:e,stacktrace:{frames:r}}]})}return n}const ui=["fatal","error","warning","log","info","debug"];function ci(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const i=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:i,hash:r,relative:e[5]+i+r}}const di="Breadcrumbs";class pi{static __initStatic(){this.id=di}__init(){this.name=pi.id}constructor(t){pi.prototype.__init.call(this),this.options={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t}}setupOnce(){var t;this.options.console&&Gt("console",fi),this.options.dom&&Gt("dom",(t=this.options.dom,function(e){let i,r="object"==typeof t?t.serializeAttribute:void 0,n="object"==typeof t&&"number"==typeof t.maxStringLength?t.maxStringLength:void 0;n&&n>1024&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${n} was configured. Sentry will use 1024 instead.`),n=1024),"string"==typeof r&&(r=[r]);try{const t=e.event;i=function(t){return t&&!!t.target}(t)?v(t.target,{keyAttrs:r,maxStringLength:n}):v(t,{keyAttrs:r,maxStringLength:n})}catch(t){i="<unknown>"}0!==i.length&&ct().addBreadcrumb({category:`ui.${e.name}`,message:i},{event:e.event,name:e.name,global:e.global})})),this.options.xhr&&Gt("xhr",mi),this.options.fetch&&Gt("fetch",gi),this.options.history&&Gt("history",_i)}addSentryBreadcrumb(t){this.options.sentry&&ct().addBreadcrumb({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:j(t)},{event:t})}}function fi(t){for(let e=0;e<t.args.length;e++)if("ref=Ref<"===t.args[e]){t.args[e+1]="viewRef";break}const e={category:"console",data:{arguments:t.args,logger:"console"},level:(i=t.level,"warn"===i?"warning":ui.includes(i)?i:"log"),message:E(t.args," ")};var i;if("assert"===t.level){if(!1!==t.args[0])return;e.message=`Assertion failed: ${E(t.args.slice(1)," ")||"console.assert"}`,e.data.arguments=t.args.slice(1)}ct().addBreadcrumb(e,{input:t.args,level:t.level})}function mi(t){const{startTimestamp:e,endTimestamp:i}=t,r=t.xhr.__sentry_xhr_v2__;if(!e||!i||!r)return;const{method:n,url:s,status_code:a,body:o}=r,l={method:n,url:s,status_code:a},h={xhr:t.xhr,input:o,startTimestamp:e,endTimestamp:i};ct().addBreadcrumb({category:"xhr",data:l,type:"http"},h)}function gi(t){const{startTimestamp:e,endTimestamp:i}=t;if(i&&(!t.fetchData.url.match(/sentry_key/)||"POST"!==t.fetchData.method))if(t.error){const r=t.fetchData,n={data:t.error,input:t.args,startTimestamp:e,endTimestamp:i};ct().addBreadcrumb({category:"fetch",data:r,level:"error",type:"http"},n)}else{const r={...t.fetchData,status_code:t.response&&t.response.status},n={input:t.args,response:t.response,startTimestamp:e,endTimestamp:i};ct().addBreadcrumb({category:"fetch",data:r,type:"http"},n)}}function _i(t){let e=t.from,i=t.to;const r=ci(Ge.location.href);let n=ci(e);const s=ci(i);n.path||(n=r),r.protocol===s.protocol&&r.host===s.host&&(i=s.relative),r.protocol===n.protocol&&r.host===n.host&&(e=n.relative),ct().addBreadcrumb({category:"navigation",data:{from:e,to:i}})}function yi(t,{metadata:e,tunnel:i,dsn:r}){const n={event_id:t.event_id,sent_at:(new Date).toISOString(),...e&&e.sdk&&{sdk:{name:e.sdk.name,version:e.sdk.version}},...!!i&&!!r&&{dsn:fe(r)}},s=function(t){return[{type:"user_report"},t]}(t);return be(n,[s])}pi.__initStatic();class vi extends Ze{constructor(t){const e=Ge.SENTRY_SDK_SOURCE||(0,ti.S)();t._metadata=t._metadata||{},t._metadata.sdk=t._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:`${e}:@sentry/browser`,version:ft}],version:ft},super(t),t.sendClientReports&&Ge.document&&Ge.document.addEventListener("visibilitychange",(()=>{"hidden"===Ge.document.visibilityState&&this._flushOutcomes()}))}eventFromException(t,e){return ai(this._options.stackParser,t,e,this._options.attachStacktrace)}eventFromMessage(t,e="info",i){return oi(this._options.stackParser,t,e,i,this._options.attachStacktrace)}sendEvent(t,e){const i=this.getIntegrationById(di);i&&i.addSentryBreadcrumb&&i.addSentryBreadcrumb(t),super.sendEvent(t,e)}captureUserFeedback(t){if(!this._isEnabled())return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("SDK not enabled, will not capture user feedback."));const e=yi(t,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(e)}_prepareEvent(t,e,i){return t.platform=t.platform||"javascript",super._prepareEvent(t,e,i)}_flushOutcomes(){const t=this._clearOutcomes();if(0===t.length)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("No outcomes to send"));if(!this._dsn)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("No dsn provided, will not send outcomes"));("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("Sending outcomes:",t);const e=(i=t,be((r=this._options.tunnel&&fe(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:(0,Z.yW)(),discarded_events:i}]]));var i,r;this._sendEnvelope(e)}}let xi;function bi(t,e=function(){if(xi)return xi;if(Nt(Ge.fetch))return xi=Ge.fetch.bind(Ge);const t=Ge.document;let e=Ge.fetch;if(t&&"function"==typeof t.createElement)try{const i=t.createElement("iframe");i.hidden=!0,t.head.appendChild(i);const r=i.contentWindow;r&&r.fetch&&(e=r.fetch),t.head.removeChild(i)}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",t)}return xi=e.bind(Ge)}()){let i=0,r=0;return Pe(t,(function(n){const s=n.body.length;i+=s,r++;const a={body:n.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:i<=6e4&&r<15,...t.fetchOptions};try{return e(t.url,a).then((t=>(i-=s,r--,{statusCode:t.status,headers:{"x-sentry-rate-limits":t.headers.get("X-Sentry-Rate-Limits"),"retry-after":t.headers.get("Retry-After")}})))}catch(t){return xi=void 0,i-=s,r--,et(t)}}))}function Ei(t){return Pe(t,(function(e){return new it(((i,r)=>{const n=new XMLHttpRequest;n.onerror=r,n.onreadystatechange=()=>{4===n.readyState&&i({statusCode:n.status,headers:{"x-sentry-rate-limits":n.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":n.getResponseHeader("Retry-After")}})},n.open("POST",t.url);for(const e in t.headers)Object.prototype.hasOwnProperty.call(t.headers,e)&&n.setRequestHeader(e,t.headers[e]);n.send(e.body)}))}))}const Ti="?";function Si(t,e,i,r){const n={filename:t,function:e,in_app:!0};return void 0!==i&&(n.lineno=i),void 0!==r&&(n.colno=r),n}const wi=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Ai=/\((\S*)(?::(\d+))(?::(\d+))\)/,Ii=[30,t=>{const e=wi.exec(t);if(e){if(e[2]&&0===e[2].indexOf("eval")){const t=Ai.exec(e[2]);t&&(e[2]=t[1],e[3]=t[2],e[4]=t[3])}const[t,i]=Ui(e[1]||Ti,e[2]);return Si(i,t,e[3]?+e[3]:void 0,e[4]?+e[4]:void 0)}}],Ri=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Ci=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Mi=[50,t=>{const e=Ri.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const t=Ci.exec(e[3]);t&&(e[1]=e[1]||"eval",e[3]=t[1],e[4]=t[2],e[5]="")}let t=e[3],i=e[1]||Ti;return[i,t]=Ui(i,t),Si(t,i,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}],Oi=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Pi=[40,t=>{const e=Oi.exec(t);return e?Si(e[2],e[1]||Ti,+e[3],e[4]?+e[4]:void 0):void 0}],ki=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,Di=[10,t=>{const e=ki.exec(t);return e?Si(e[2],e[3]||Ti,+e[1]):void 0}],Ni=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\(.*\))? in (.*):\s*$/i,Li=[20,t=>{const e=Ni.exec(t);return e?Si(e[5],e[3]||e[4]||Ti,+e[1],+e[2]):void 0}],Fi=[Ii,Mi,Pi],Bi=Mt(...Fi),Ui=(t,e)=>{const i=-1!==t.indexOf("safari-extension"),r=-1!==t.indexOf("safari-web-extension");return i||r?[-1!==t.indexOf("@")?t.split("@")[0]:Ti,i?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]};class Gi{static __initStatic(){this.id="GlobalHandlers"}__init(){this.name=Gi.id}__init2(){this._installFunc={onerror:Wi,onunhandledrejection:ji}}constructor(t){Gi.prototype.__init.call(this),Gi.prototype.__init2.call(this),this._options={onerror:!0,onunhandledrejection:!0,...t}}setupOnce(){Error.stackTraceLimit=50;const t=this._options;for(const i in t){const r=this._installFunc[i];r&&t[i]&&(e=i,("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`Global Handler attached: ${e}`),r(),this._installFunc[i]=void 0)}var e}}function Wi(){Gt("error",(t=>{const[e,i,r]=Hi();if(!e.getIntegration(Gi))return;const{msg:n,url:s,line:a,column:o,error:h}=t;if(je()||h&&h.__sentry_own_request__)return;const c=void 0===h&&u(n)?function(t,e,i,r){let n=l(t)?t.message:t,s="Error";const a=n.match(/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i);return a&&(s=a[1],n=a[2]),Yi({exception:{values:[{type:s,value:n}]}},e,i,r)}(n,s,a,o):Yi(li(i,h||n,void 0,r,!1),s,a,o);c.level="error",zi(e,h,c,"onerror")}))}function ji(){Gt("unhandledrejection",(t=>{const[e,i,r]=Hi();if(!e.getIntegration(Gi))return;let n=t;try{"reason"in t?n=t.reason:"detail"in t&&"reason"in t.detail&&(n=t.detail.reason)}catch(t){}if(je()||n&&n.__sentry_own_request__)return!0;const s=c(n)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(n)}`}]}}:li(i,n,void 0,r,!0);s.level="error",zi(e,n,s,"onunhandledrejection")}))}function Yi(t,e,i,r){const n=t.exception=t.exception||{},s=n.values=n.values||[],a=s[0]=s[0]||{},o=a.stacktrace=a.stacktrace||{},l=o.frames=o.frames||[],h=isNaN(parseInt(r,10))?void 0:r,c=isNaN(parseInt(i,10))?void 0:i,d=u(e)&&e.length>0?e:function(){try{return y.document.location.href}catch(t){return""}}();return 0===l.length&&l.push({colno:h,filename:d,function:"?",in_app:!0,lineno:c}),t}function zi(t,e,i,r){z(i,{handled:!1,type:r}),t.captureEvent(i,{originalException:e})}function Hi(){const t=ct(),e=t.getClient(),i=e&&e.getOptions()||{stackParser:()=>[],attachStacktrace:!1};return[t,i.stackParser,i.attachStacktrace]}Gi.__initStatic();const Xi=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];class Vi{static __initStatic(){this.id="TryCatch"}__init(){this.name=Vi.id}constructor(t){Vi.prototype.__init.call(this),this._options={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t}}setupOnce(){this._options.setTimeout&&S(Ge,"setTimeout",qi),this._options.setInterval&&S(Ge,"setInterval",qi),this._options.requestAnimationFrame&&S(Ge,"requestAnimationFrame",Ki),this._options.XMLHttpRequest&&"XMLHttpRequest"in Ge&&S(XMLHttpRequest.prototype,"send",$i);const t=this._options.eventTarget;t&&(Array.isArray(t)?t:Xi).forEach(Zi)}}function qi(t){return function(...e){const i=e[0];return e[0]=ze(i,{mechanism:{data:{function:Pt(t)},handled:!0,type:"instrument"}}),t.apply(this,e)}}function Ki(t){return function(e){return t.apply(this,[ze(e,{mechanism:{data:{function:"requestAnimationFrame",handler:Pt(t)},handled:!0,type:"instrument"}})])}}function $i(t){return function(...e){const i=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((t=>{t in i&&"function"==typeof i[t]&&S(i,t,(function(e){const i={mechanism:{data:{function:t,handler:Pt(e)},handled:!0,type:"instrument"}},r=I(e);return r&&(i.mechanism.data.handler=Pt(r)),ze(e,i)}))})),t.apply(this,e)}}function Zi(t){const e=Ge,i=e[t]&&e[t].prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(S(i,"addEventListener",(function(e){return function(i,r,n){try{"function"==typeof r.handleEvent&&(r.handleEvent=ze(r.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Pt(r),target:t},handled:!0,type:"instrument"}}))}catch(t){}return e.apply(this,[i,ze(r,{mechanism:{data:{function:"addEventListener",handler:Pt(r),target:t},handled:!0,type:"instrument"}}),n])}})),S(i,"removeEventListener",(function(t){return function(e,i,r){const n=i;try{const i=n&&n.__sentry_wrapped__;i&&t.call(this,e,i,r)}catch(t){}return t.call(this,e,n,r)}})))}Vi.__initStatic();class Qi{static __initStatic(){this.id="LinkedErrors"}__init(){this.name=Qi.id}constructor(t={}){Qi.prototype.__init.call(this),this._key=t.key||"cause",this._limit=t.limit||5}setupOnce(){const t=ct().getClient();t&&at(((e,i)=>{const r=ct().getIntegration(Qi);return r?function(t,e,i,r,n){if(!(r.exception&&r.exception.values&&n&&g(n.originalException,Error)))return r;const s=Ji(t,i,n.originalException,e);return r.exception.values=[...s,...r.exception.values],r}(t.getOptions().stackParser,r._key,r._limit,e,i):e}))}}function Ji(t,e,i,r,n=[]){if(!g(i[r],Error)||n.length+1>=e)return n;const s=ei(t,i[r]);return Ji(t,e,i[r],r,[s,...n])}Qi.__initStatic();class tr{constructor(){tr.prototype.__init.call(this)}static __initStatic(){this.id="HttpContext"}__init(){this.name=tr.id}setupOnce(){at((t=>{if(ct().getIntegration(tr)){if(!Ge.navigator&&!Ge.location&&!Ge.document)return t;const e=t.request&&t.request.url||Ge.location&&Ge.location.href,{referrer:i}=Ge.document||{},{userAgent:r}=Ge.navigator||{},n={...t.request&&t.request.headers,...i&&{Referer:i},...r&&{"User-Agent":r}},s={...t.request,...e&&{url:e},headers:n};return{...t,request:s}}return t}))}}tr.__initStatic();class er{constructor(){er.prototype.__init.call(this)}static __initStatic(){this.id="Dedupe"}__init(){this.name=er.id}setupOnce(t,e){const i=t=>{if(t.type)return t;const i=e().getIntegration(er);if(i){try{if(function(t,e){return!!e&&(!!function(t,e){const i=t.message,r=e.message;return!(!i&&!r)&&(!(i&&!r||!i&&r)&&(i===r&&(!!rr(t,e)&&!!ir(t,e))))}(t,e)||!!function(t,e){const i=nr(e),r=nr(t);return!(!i||!r)&&(i.type===r.type&&i.value===r.value&&(!!rr(t,e)&&!!ir(t,e)))}(t,e))}(t,i._previousEvent))return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(e){return i._previousEvent=t}return i._previousEvent=t}return t};i.id=this.name,t(i)}}function ir(t,e){let i=sr(t),r=sr(e);if(!i&&!r)return!0;if(i&&!r||!i&&r)return!1;if(r.length!==i.length)return!1;for(let t=0;t<r.length;t++){const e=r[t],n=i[t];if(e.filename!==n.filename||e.lineno!==n.lineno||e.colno!==n.colno||e.function!==n.function)return!1}return!0}function rr(t,e){let i=t.fingerprint,r=e.fingerprint;if(!i&&!r)return!0;if(i&&!r||!i&&r)return!1;try{return!(i.join("")!==r.join(""))}catch(t){return!1}}function nr(t){return t.exception&&t.exception.values&&t.exception.values[0]}function sr(t){const e=t.exception;if(e)try{return e.values[0].stacktrace.frames}catch(t){return}}er.__initStatic();const ar=[new K,new N,new Vi,new pi,new Gi,new Qi,new er,new tr];function or(t={}){void 0===t.defaultIntegrations&&(t.defaultIntegrations=ar),void 0===t.release&&("string"==typeof __SENTRY_RELEASE__&&(t.release=__SENTRY_RELEASE__),Ge.SENTRY_RELEASE&&Ge.SENTRY_RELEASE.id&&(t.release=Ge.SENTRY_RELEASE.id)),void 0===t.autoSessionTracking&&(t.autoSessionTracking=!0),void 0===t.sendClientReports&&(t.sendClientReports=!0);const e={...t,stackParser:(i=t.stackParser||Bi,Array.isArray(i)?Mt(...i):i),integrations:Xe(t),transport:t.transport||(Dt()?bi:Ei)};var i;!function(t,e){!0===e.debug&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__?U.enable():console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle."));const i=ct();i.getScope().update(e.initialScope);const r=new t(e);i.bindClient(r)}(vi,e),t.autoSessionTracking&&function(){if(void 0===Ge.document)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("Session tracking in non-browser environment with @sentry/browser is not supported."));const t=ct();t.captureSession&&(mr(t),Gt("history",(({from:t,to:e})=>{void 0!==t&&t!==e&&mr(ct())})))}()}function lr(t={},e=ct()){if(!Ge.document)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("Global document not defined in showReportDialog call"));const{client:i,scope:r}=e.getStackTop(),n=t.dsn||i&&i.getDsn();if(!n)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("DSN not configured for showReportDialog call"));r&&(t.user={...r.getUser(),...t.user}),t.eventId||(t.eventId=e.lastEventId());const s=Ge.document.createElement("script");s.async=!0,s.src=function(t,e){const i=_e(t);if(!i)return"";const r=`${Le(i)}embed/error-page/`;let n=`dsn=${fe(i)}`;for(const t in e)if("dsn"!==t)if("user"===t){const t=e.user;if(!t)continue;t.name&&(n+=`&name=${encodeURIComponent(t.name)}`),t.email&&(n+=`&email=${encodeURIComponent(t.email)}`)}else n+=`&${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`;return`${r}?${n}`}(n,t),t.onLoad&&(s.onload=t.onLoad);const a=Ge.document.head||Ge.document.body;a?a.appendChild(s):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("Not injecting report dialog. No injection point found in HTML")}function hr(){return ct().lastEventId()}function ur(){}function cr(t){t()}function dr(t){const e=ct().getClient();return e?e.flush(t):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("Cannot flush events. No client defined."),tt(!1))}function pr(t){const e=ct().getClient();return e?e.close(t):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("Cannot flush events and disable SDK. No client defined."),tt(!1))}function fr(t){return ze(t)()}function mr(t){t.startSession({ignoreDuration:!0}),t.captureSession()}function gr(t){const e=ct().getClient();e&&e.captureUserFeedback(t)}var _r=i(1422);const yr=_.n2,vr="sentryReplaySession",xr="Unable to send Replay",br=15e4,Er=5e3,Tr=2e7;var Sr;function wr(t){const e=null==t?void 0:t.host;return Boolean(e&&e.shadowRoot&&e.shadowRoot===t)}function Ar({maskInputOptions:t,tagName:e,type:i}){"option"===e.toLowerCase()&&(e="select");const r="string"==typeof i?i.toLowerCase():void 0;return t[e.toLowerCase()]||r&&t[r]||"password"===r||"input"===e&&!i&&t.text}function Ir({input:t,maskInputSelector:e,unmaskInputSelector:i,maskInputOptions:r,tagName:n,type:s,value:a,maskInputFn:o}){let l=a||"";return i&&t.matches(i)||(t.hasAttribute("data-rr-is-password")&&(s="password"),(Ar({maskInputOptions:r,tagName:n,type:s})||e&&t.matches(e))&&(l=o?o(l):"*".repeat(l.length))),l}!function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"}(Sr||(Sr={}));function Rr(t){const e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?e.toLowerCase():null}function Cr(t,e,i){return"string"==typeof i&&i.toLowerCase(),"INPUT"!==e||"radio"!==i&&"checkbox"!==i?t.value:t.getAttribute("value")||""}let Mr=1;const Or=new RegExp("[^a-z0-9-_:]");function Pr(t){return t?t.replace(/[\S]/g,"*"):""}function kr(t){try{const e=t.rules||t.cssRules;return e?Array.from(e).map(Dr).join(""):null}catch(t){return null}}function Dr(t){let e=t.cssText;if(function(t){return"styleSheet"in t}(t))try{e=kr(t.styleSheet)||e}catch(t){}return Nr(e)}function Nr(t){if(t.indexOf(":")>-1){const e=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return t.replace(e,"$1\\$2")}return t}let Lr,Fr;const Br=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Ur=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,Gr=/^(data:)([^,]*),(.*)/i;function Wr(t,e){return(t||"").replace(Br,((t,i,r,n,s,a)=>{const o=r||s||a,l=i||n||"";if(!o)return t;if(!Ur.test(o))return`url(${l}${o}${l})`;if(Gr.test(o))return`url(${l}${o}${l})`;if("/"===o[0])return`url(${l}${function(t){let e="";return e=t.indexOf("//")>-1?t.split("/").slice(0,3).join("/"):t.split("/")[0],e=e.split("?")[0],e}(e)+o}${l})`;const h=e.split("/"),u=o.split("/");h.pop();for(const t of u)"."!==t&&(".."===t?h.pop():h.push(t));return`url(${l}${h.join("/")}${l})`}))}const jr=/^[^ \t\n\r\u000c]+/,Yr=/^[, \t\n\r\u000c]+/;function zr(t,e){if(!e||""===e.trim())return e;const i=t.createElement("a");return i.href=e,i.href}function Hr(){const t=document.createElement("a");return t.href="",t.href}function Xr(t,e,i,r,n,s,a,o){if(!n)return n;const l=r.toLowerCase(),h=i.toLowerCase();return"src"===l||"href"===l||"xlink:href"===l&&"#"!==n[0]?zr(t,n):"background"!==l||"table"!==h&&"td"!==h&&"th"!==h?"srcset"===l?function(t,e){if(""===e.trim())return e;let i=0;function r(t){let r,n=t.exec(e.substring(i));return n?(r=n[0],i+=r.length,r):""}let n=[];for(;r(Yr),!(i>=e.length);){let s=r(jr);if(","===s.slice(-1))s=zr(t,s.substring(0,s.length-1)),n.push(s);else{let r="";s=zr(t,s);let a=!1;for(;;){let t=e.charAt(i);if(""===t){n.push((s+r).trim());break}if(a)")"===t&&(a=!1);else{if(","===t){i+=1,n.push((s+r).trim());break}"("===t&&(a=!0)}r+=t,i+=1}}}return n.join(", ")}(t,n):"style"===l?Wr(n,Hr()):"object"===h&&"data"===l?zr(t,n):s&&function(t,e,i,r){return(!r||!t.matches(r))&&(["placeholder","title","aria-label"].indexOf(e)>-1||"input"===i&&"value"===e&&t.hasAttribute("type")&&["submit","button"].indexOf(t.getAttribute("type").toLowerCase())>-1)}(e,l,h,a)?o?o(n):Pr(n):n:zr(t,n)}function Vr(t,e,i,r,n){if(!t)return!1;if(t.nodeType!==t.ELEMENT_NODE)return Vr(t.parentNode,e,i,r,n);if(r&&(t.matches(r)||t.closest(r)))return!1;if(n)return!0;if("string"==typeof e){if(t.classList.contains(e))return!0}else for(let i=0;i<t.classList.length;i++){const r=t.classList[i];if(e.test(r))return!0}return!(!i||!t.matches(i))||Vr(t.parentNode,e,i,r,n)}function qr(t){return null==t?"":t.toLowerCase()}function Kr(t,e){const{doc:i,map:r,blockClass:n,blockSelector:s,unblockSelector:a,maskTextClass:o,maskTextSelector:l,unmaskTextSelector:h,skipChild:u=!1,inlineStylesheet:c=!0,maskInputSelector:d,unmaskInputSelector:p,maskAllText:f,maskInputOptions:m={},maskTextFn:g,maskInputFn:_,slimDOMOptions:y,dataURLOptions:v={},inlineImages:x=!1,recordCanvas:b=!1,onSerialize:E,onIframeLoad:T,iframeLoadTimeout:S=5e3,keepIframeSrcFn:w=(()=>!1)}=e;let{preserveWhiteSpace:A=!0}=e;const I=function(t,e){var i;const{doc:r,blockClass:n,blockSelector:s,unblockSelector:a,maskTextClass:o,maskTextSelector:l,unmaskTextSelector:h,inlineStylesheet:u,maskInputSelector:c,unmaskInputSelector:d,maskAllText:p,maskInputOptions:f={},maskTextFn:m,maskInputFn:g,dataURLOptions:_={},inlineImages:y,recordCanvas:v,keepIframeSrcFn:x}=e;let b;if(r.__sn){const t=r.__sn.id;b=1===t?void 0:t}switch(t.nodeType){case t.DOCUMENT_NODE:return"CSS1Compat"!==t.compatMode?{type:Sr.Document,childNodes:[],compatMode:t.compatMode,rootId:b}:{type:Sr.Document,childNodes:[],rootId:b};case t.DOCUMENT_TYPE_NODE:return{type:Sr.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:b};case t.ELEMENT_NODE:const e=function(t,e,i,r){if(r&&t.matches(r))return!1;if("string"==typeof e){if(t.classList.contains(e))return!0}else for(let i=0;i<t.classList.length;i++){const r=t.classList[i];if(e.test(r))return!0}return!!i&&t.matches(i)}(t,n,s,a),S=function(t){if(t instanceof HTMLFormElement)return"form";const e=t.tagName.toLowerCase().trim();return Or.test(e)?"div":e}(t);let w={};for(const{name:e,value:i}of Array.from(t.attributes))$r(S,e)||(w[e]=Xr(r,t,S,e,i,p,h,m));if("link"===S&&u){const e=Array.from(r.styleSheets).find((e=>e.href===t.href));let i=null;e&&(i=kr(e)),i&&(delete w.rel,delete w.href,w._cssText=Wr(i,e.href))}if("style"===S&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){const e=kr(t.sheet);e&&(w._cssText=Wr(e,Hr()))}if("input"===S||"textarea"===S||"select"===S||"option"===S){const e=t,i=Rr(e),r=Cr(e,S.toUpperCase(),i),n=t.checked;"submit"!==i&&"button"!==i&&r&&(w.value=Ir({input:e,type:i,tagName:S,value:r,maskInputSelector:c,unmaskInputSelector:d,maskInputOptions:f,maskInputFn:g})),n&&(w.checked=n)}if("option"===S&&(t.selected&&!f.select?w.selected=!0:delete w.selected),"canvas"===S&&v)if("2d"===t.__context)(function(t){const e=t.getContext("2d");if(!e)return!0;for(let i=0;i<t.width;i+=50)for(let r=0;r<t.height;r+=50){const n=e.getImageData,s="__rrweb_original__"in n?n.__rrweb_original__:n;if(new Uint32Array(s.call(e,i,r,Math.min(50,t.width-i),Math.min(50,t.height-r)).data.buffer).some((t=>0!==t)))return!1}return!0})(t)||(w.rr_dataURL=t.toDataURL(_.type,_.quality));else if(!("__context"in t)){const e=t.toDataURL(_.type,_.quality),i=document.createElement("canvas");i.width=t.width,i.height=t.height,e!==i.toDataURL(_.type,_.quality)&&(w.rr_dataURL=e)}if("img"===S&&y){Lr||(Lr=r.createElement("canvas"),Fr=Lr.getContext("2d"));const e=t,i=e.crossOrigin;e.crossOrigin="anonymous";const n=()=>{try{Lr.width=e.naturalWidth,Lr.height=e.naturalHeight,Fr.drawImage(e,0,0),w.rr_dataURL=Lr.toDataURL(_.type,_.quality)}catch(t){console.warn(`Cannot inline img src=${e.currentSrc}! Error: ${t}`)}i?w.crossOrigin=i:delete w.crossOrigin};e.complete&&0!==e.naturalWidth?n():e.onload=n}if("audio"!==S&&"video"!==S||(w.rr_mediaState=t.paused?"paused":"played",w.rr_mediaCurrentTime=t.currentTime),t.scrollLeft&&(w.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(w.rr_scrollTop=t.scrollTop),e){const{width:e,height:i}=t.getBoundingClientRect();w={class:w.class,rr_width:`${e}px`,rr_height:`${i}px`}}return"iframe"!==S||x(w.src)||(t.contentDocument||(w.rr_src=w.src),delete w.src),{type:Sr.Element,tagName:S,attributes:w,childNodes:[],isSVG:(T=t,Boolean("svg"===T.tagName||T.ownerSVGElement)||void 0),needBlock:e,rootId:b};case t.TEXT_NODE:const A=t.parentNode&&t.parentNode.tagName;let I=t.textContent;const R="STYLE"===A||void 0,C="SCRIPT"===A||void 0;if(R&&I){try{t.nextSibling||t.previousSibling||(null===(i=t.parentNode.sheet)||void 0===i?void 0:i.cssRules)&&(I=(E=t.parentNode.sheet).cssRules?Array.from(E.cssRules).map((t=>t.cssText?Nr(t.cssText):"")).join(""):"")}catch(e){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${e}`,t)}I=Wr(I,Hr())}return C&&(I="SCRIPT_PLACEHOLDER"),"TEXTAREA"===A&&I?I="":"OPTION"===A&&I?I=Ir({input:t.parentNode,type:null,tagName:A,value:I,maskInputSelector:c,unmaskInputSelector:d,maskInputOptions:f,maskInputFn:g}):!R&&!C&&Vr(t,o,l,h,p)&&I&&(I=m?m(I):Pr(I)),{type:Sr.Text,textContent:I||"",isStyle:R,rootId:b};case t.CDATA_SECTION_NODE:return{type:Sr.CDATA,textContent:"",rootId:b};case t.COMMENT_NODE:return{type:Sr.Comment,textContent:t.textContent||"",rootId:b};default:return!1}var E,T}(t,{doc:i,blockClass:n,blockSelector:s,unblockSelector:a,maskTextClass:o,maskTextSelector:l,unmaskTextSelector:h,inlineStylesheet:c,maskInputSelector:d,unmaskInputSelector:p,maskAllText:f,maskInputOptions:m,maskTextFn:g,maskInputFn:_,dataURLOptions:v,inlineImages:x,recordCanvas:b,keepIframeSrcFn:w});if(!I)return console.warn(t,"not serialized"),null;let R;R="__sn"in t?t.__sn.id:!function(t,e){if(e.comment&&t.type===Sr.Comment)return!0;if(t.type===Sr.Element){if(e.script&&("script"===t.tagName||"link"===t.tagName&&("preload"===t.attributes.rel||"modulepreload"===t.attributes.rel)&&"script"===t.attributes.as||"link"===t.tagName&&"prefetch"===t.attributes.rel&&"string"==typeof t.attributes.href&&t.attributes.href.endsWith(".js")))return!0;if(e.headFavicon&&("link"===t.tagName&&"shortcut icon"===t.attributes.rel||"meta"===t.tagName&&(qr(t.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===qr(t.attributes.name)||"icon"===qr(t.attributes.rel)||"apple-touch-icon"===qr(t.attributes.rel)||"shortcut icon"===qr(t.attributes.rel))))return!0;if("meta"===t.tagName){if(e.headMetaDescKeywords&&qr(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(qr(t.attributes.property).match(/^(og|twitter|fb):/)||qr(t.attributes.name).match(/^(og|twitter):/)||"pinterest"===qr(t.attributes.name)))return!0;if(e.headMetaRobots&&("robots"===qr(t.attributes.name)||"googlebot"===qr(t.attributes.name)||"bingbot"===qr(t.attributes.name)))return!0;if(e.headMetaHttpEquiv&&void 0!==t.attributes["http-equiv"])return!0;if(e.headMetaAuthorship&&("author"===qr(t.attributes.name)||"generator"===qr(t.attributes.name)||"framework"===qr(t.attributes.name)||"publisher"===qr(t.attributes.name)||"progid"===qr(t.attributes.name)||qr(t.attributes.property).match(/^article:/)||qr(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&("google-site-verification"===qr(t.attributes.name)||"yandex-verification"===qr(t.attributes.name)||"csrf-token"===qr(t.attributes.name)||"p:domain_verify"===qr(t.attributes.name)||"verify-v1"===qr(t.attributes.name)||"verification"===qr(t.attributes.name)||"shopify-checkout-api-token"===qr(t.attributes.name)))return!0}}return!1}(I,y)&&(A||I.type!==Sr.Text||I.isStyle||I.textContent.replace(/^\s+|\s+$/gm,"").length)?Mr++:-2;const C=Object.assign(I,{id:R});if(t.__sn=C,-2===R)return null;r[R]=t,E&&E(t);let M=!u;if(C.type===Sr.Element&&(M=M&&!C.needBlock,delete C.needBlock,t.shadowRoot&&(C.isShadowHost=!0)),(C.type===Sr.Document||C.type===Sr.Element)&&M){y.headWhitespace&&I.type===Sr.Element&&"head"===I.tagName&&(A=!1);const e={doc:i,map:r,blockClass:n,blockSelector:s,unblockSelector:a,maskTextClass:o,maskTextSelector:l,unmaskTextSelector:h,skipChild:u,inlineStylesheet:c,maskInputSelector:d,unmaskInputSelector:p,maskAllText:f,maskInputOptions:m,maskTextFn:g,maskInputFn:_,slimDOMOptions:y,dataURLOptions:v,inlineImages:x,recordCanvas:b,preserveWhiteSpace:A,onSerialize:E,onIframeLoad:T,iframeLoadTimeout:S,keepIframeSrcFn:w};for(const i of Array.from(t.childNodes)){const t=Kr(i,e);t&&C.childNodes.push(t)}if(function(t){return t.nodeType===t.ELEMENT_NODE}(t)&&t.shadowRoot)for(const i of Array.from(t.shadowRoot.childNodes)){const t=Kr(i,e);t&&(t.isShadow=!0,C.childNodes.push(t))}}return t.parentNode&&wr(t.parentNode)&&(C.isShadow=!0),C.type===Sr.Element&&"iframe"===C.tagName&&function(t,e,i){const r=t.contentWindow;if(!r)return;let n,s=!1;try{n=r.document.readyState}catch(t){return}if("complete"!==n){const r=setTimeout((()=>{s||(e(),s=!0)}),i);return void t.addEventListener("load",(()=>{clearTimeout(r),s=!0,e()}))}const a="about:blank";r.location.href===a&&t.src!==a&&""!==t.src?t.addEventListener("load",e):setTimeout(e,0)}(t,(()=>{const e=t.contentDocument;if(e&&T){const i=Kr(e,{doc:e,map:r,blockClass:n,blockSelector:s,unblockSelector:a,maskTextClass:o,maskTextSelector:l,unmaskTextSelector:h,skipChild:!1,inlineStylesheet:c,maskInputSelector:d,unmaskInputSelector:p,maskAllText:f,maskInputOptions:m,maskTextFn:g,maskInputFn:_,slimDOMOptions:y,dataURLOptions:v,inlineImages:x,recordCanvas:b,preserveWhiteSpace:A,onSerialize:E,onIframeLoad:T,iframeLoadTimeout:S,keepIframeSrcFn:w});i&&T(t,i)}}),S),C}function $r(t,e,i){return("video"===t||"audio"===t)&&"autoplay"===e}var Zr,Qr,Jr,tn,en,rn;function nn(t,e,i=document){const r={capture:!0,passive:!0};return i.addEventListener(t,e,r),()=>i.removeEventListener(t,e,r)}!function(t){t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin"}(Zr||(Zr={})),function(t){t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration"}(Qr||(Qr={})),function(t){t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel"}(Jr||(Jr={})),function(t){t[t["2D"]=0]="2D",t[t.WebGL=1]="WebGL",t[t.WebGL2=2]="WebGL2"}(tn||(tn={})),function(t){t[t.Play=0]="Play",t[t.Pause=1]="Pause",t[t.Seeked=2]="Seeked",t[t.VolumeChange=3]="VolumeChange"}(en||(en={})),function(t){t.Start="start",t.Pause="pause",t.Resume="resume",t.Resize="resize",t.Finish="finish",t.FullsnapshotRebuilded="fullsnapshot-rebuilded",t.LoadStylesheetStart="load-stylesheet-start",t.LoadStylesheetEnd="load-stylesheet-end",t.SkipStart="skip-start",t.SkipEnd="skip-end",t.MouseInteraction="mouse-interaction",t.EventCast="event-cast",t.CustomEvent="custom-event",t.Flush="flush",t.StateChange="state-change",t.PlayBack="play-back"}(rn||(rn={}));const sn="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let an={map:{},getId:()=>(console.error(sn),-1),getNode:()=>(console.error(sn),null),removeNodeFromMap(){console.error(sn)},has:()=>(console.error(sn),!1),reset(){console.error(sn)}};function on(t,e,i={}){let r=null,n=0;return function(s){let a=Date.now();n||!1!==i.leading||(n=a);let o=e-(a-n),l=this,h=arguments;o<=0||o>e?(r&&(clearTimeout(r),r=null),n=a,t.apply(l,h)):r||!1===i.trailing||(r=setTimeout((()=>{n=!1===i.leading?0:Date.now(),r=null,t.apply(l,h)}),o))}}function ln(t,e,i,r,n=window){const s=n.Object.getOwnPropertyDescriptor(t,e);return n.Object.defineProperty(t,e,r?i:{set(t){setTimeout((()=>{i.set.call(this,t)}),0),s&&s.set&&s.set.call(this,t)}}),()=>ln(t,e,s||{},!0)}function hn(t,e,i){try{if(!(e in t))return()=>{};const r=t[e],n=i(r);return"function"==typeof n&&(n.prototype=n.prototype||{},Object.defineProperties(n,{__rrweb_original__:{enumerable:!1,value:r}})),t[e]=n,()=>{t[e]=r}}catch(t){return()=>{}}}function un(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function cn(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function dn(t,e,i,r){if(!t)return!1;if(t.nodeType===t.ELEMENT_NODE){let n=!1;const s=r&&t.matches(r);return"string"==typeof e?n=void 0!==t.closest?!s&&null!==t.closest("."+e):!s&&t.classList.contains(e):!s&&t.classList.forEach((t=>{e.test(t)&&(n=!0)})),!n&&i&&(n=t.matches(i)),!s&&n||dn(t.parentNode,e,i,r)}return t.nodeType,t.TEXT_NODE,dn(t.parentNode,e,i,r)}function pn(t){return"__sn"in t&&-2===t.__sn.id}function fn(t,e){if(wr(t))return!1;const i=e.getId(t);return!e.has(i)||(!t.parentNode||t.parentNode.nodeType!==t.DOCUMENT_NODE)&&(!t.parentNode||fn(t.parentNode,e))}function mn(t){return Boolean(t.changedTouches)}function gn(t){return"__sn"in t&&t.__sn.type===Sr.Element&&"iframe"===t.__sn.tagName}function _n(t){return Boolean(null==t?void 0:t.shadowRoot)}function yn(t){return"__ln"in t}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(an=new Proxy(an,{get:(t,e,i)=>("map"===e&&console.error(sn),Reflect.get(t,e,i))}));class vn{constructor(){this.length=0,this.head=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let e=this.head;for(let i=0;i<t;i++)e=(null==e?void 0:e.next)||null;return e}addNode(t){const e={value:t,previous:null,next:null};if(t.__ln=e,t.previousSibling&&yn(t.previousSibling)){const i=t.previousSibling.__ln.next;e.next=i,e.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=e,i&&(i.previous=e)}else if(t.nextSibling&&yn(t.nextSibling)&&t.nextSibling.__ln.previous){const i=t.nextSibling.__ln.previous;e.previous=i,e.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=e,i&&(i.next=e)}else this.head&&(this.head.previous=e),e.next=this.head,this.head=e;this.length++}removeNode(t){const e=t.__ln;this.head&&(e.previous?(e.previous.next=e.next,e.next&&(e.next.previous=e.previous)):(this.head=e.next,this.head&&(this.head.previous=null)),t.__ln&&delete t.__ln,this.length--)}}const xn=(t,e)=>`${t}@${e}`;function bn(t){return"__sn"in t}class En{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=t=>{t.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const t=[],e=new vn,i=t=>{let e=t,i=-2;for(;-2===i;)e=e&&e.nextSibling,i=e&&this.mirror.getId(e);return i},r=r=>{var n,s,a,o,l;const h=r.getRootNode?null===(n=r.getRootNode())||void 0===n?void 0:n.host:null;let u=h;for(;null===(a=null===(s=null==u?void 0:u.getRootNode)||void 0===s?void 0:s.call(u))||void 0===a?void 0:a.host;)u=(null===(l=null===(o=null==u?void 0:u.getRootNode)||void 0===o?void 0:o.call(u))||void 0===l?void 0:l.host)||null;const c=!(this.doc.contains(r)||u&&this.doc.contains(u));if(!r.parentNode||c)return;const d=wr(r.parentNode)?this.mirror.getId(h):this.mirror.getId(r.parentNode),p=i(r);if(-1===d||-1===p)return e.addNode(r);let f=Kr(r,{doc:this.doc,map:this.mirror.map,blockClass:this.blockClass,blockSelector:this.blockSelector,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,maskInputSelector:this.maskInputSelector,unmaskInputSelector:this.unmaskInputSelector,skipChild:!0,inlineStylesheet:this.inlineStylesheet,maskAllText:this.maskAllText,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:t=>{gn(t)&&this.iframeManager.addIframe(t),_n(r)&&this.shadowDomManager.addShadowRoot(r.shadowRoot,document)},onIframeLoad:(t,e)=>{this.iframeManager.attachIframe(t,e),this.shadowDomManager.observeAttachShadow(t)}});f&&t.push({parentId:d,nextId:p,node:f})};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const t of this.movedSet)Sn(this.removes,t,this.mirror)&&!this.movedSet.has(t.parentNode)||r(t);for(const t of this.addedSet)wn(this.droppedSet,t)||Sn(this.removes,t,this.mirror)?wn(this.movedSet,t)?r(t):this.droppedSet.add(t):r(t);let n=null;for(;e.length;){let t=null;if(n){const e=this.mirror.getId(n.value.parentNode),r=i(n.value);-1!==e&&-1!==r&&(t=n)}if(!t)for(let r=e.length-1;r>=0;r--){const n=e.get(r);if(n){const e=this.mirror.getId(n.value.parentNode),r=i(n.value);if(-1!==e&&-1!==r){t=n;break}}}if(!t){for(;e.head;)e.removeNode(e.head.value);break}n=t.previous,e.removeNode(t.value),r(t.value)}const s={texts:this.texts.map((t=>({id:this.mirror.getId(t.node),value:t.value}))).filter((t=>this.mirror.has(t.id))),attributes:this.attributes.map((t=>({id:this.mirror.getId(t.node),attributes:t.attributes}))).filter((t=>this.mirror.has(t.id))),removes:this.removes,adds:t};(s.texts.length||s.attributes.length||s.removes.length||s.adds.length)&&(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(s))},this.processMutation=t=>{if(!pn(t.target))switch(t.type){case"characterData":{const e=t.target.textContent;dn(t.target,this.blockClass,this.blockSelector,this.unblockSelector)||e===t.oldValue||this.texts.push({value:Vr(t.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextSelector,this.maskAllText)&&e?this.maskTextFn?this.maskTextFn(e):e.replace(/[\S]/g,"*"):e,node:t.target});break}case"attributes":{const e=t.target;let i=e.getAttribute(t.attributeName);if("value"===t.attributeName&&(i=Ir({input:e,maskInputSelector:this.maskInputSelector,unmaskInputSelector:this.unmaskInputSelector,maskInputOptions:this.maskInputOptions,tagName:e.tagName,type:e.getAttribute("type"),value:i,maskInputFn:this.maskInputFn})),dn(t.target,this.blockClass,this.blockSelector,this.unblockSelector)||i===t.oldValue)return;let r=this.attributes.find((e=>e.node===t.target));if(r||(r={node:t.target,attributes:{}},this.attributes.push(r)),"type"===t.attributeName&&"INPUT"===e.tagName&&"password"===(t.oldValue||"").toLowerCase()&&e.setAttribute("data-rr-is-password","true"),"style"===t.attributeName){const i=this.doc.createElement("span");t.oldValue&&i.setAttribute("style",t.oldValue),void 0!==r.attributes.style&&null!==r.attributes.style||(r.attributes.style={});try{const t=r.attributes.style;for(const r of Array.from(e.style)){const n=e.style.getPropertyValue(r),s=e.style.getPropertyPriority(r);n===i.style.getPropertyValue(r)&&s===i.style.getPropertyPriority(r)||(t[r]=""===s?n:[n,s])}for(const r of Array.from(i.style))""===e.style.getPropertyValue(r)&&(t[r]=!1)}catch(t){console.warn("[rrweb] Error when parsing update to style attribute:",t)}}else{const e=t.target;r.attributes[t.attributeName]=Xr(this.doc,e,e.tagName,t.attributeName,i,this.maskAllText,this.unmaskTextSelector,this.maskTextFn)}break}case"childList":t.addedNodes.forEach((e=>this.genAdds(e,t.target))),t.removedNodes.forEach((e=>{const i=this.mirror.getId(e),r=wr(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);dn(t.target,this.blockClass,this.blockSelector,this.unblockSelector)||pn(e)||(this.addedSet.has(e)?(Tn(this.addedSet,e),this.droppedSet.add(e)):this.addedSet.has(t.target)&&-1===i||fn(t.target,this.mirror)||(this.movedSet.has(e)&&this.movedMap[xn(i,r)]?Tn(this.movedSet,e):this.removes.push({parentId:r,id:i,isShadow:!!wr(t.target)||void 0})),this.mapRemoves.push(e))}))}},this.genAdds=(t,e)=>{if(!e||!dn(e,this.blockClass,this.blockSelector,this.unblockSelector)){if(bn(t)){if(pn(t))return;this.movedSet.add(t);let i=null;e&&bn(e)&&(i=e.__sn.id),i&&(this.movedMap[xn(t.__sn.id,i)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);dn(t,this.blockClass,this.blockSelector,this.unblockSelector)||t.childNodes.forEach((t=>this.genAdds(t)))}}}init(t){["mutationCb","blockClass","blockSelector","unblockSelector","maskTextClass","maskTextSelector","unmaskTextSelector","maskInputSelector","unmaskInputSelector","inlineStylesheet","maskAllText","maskInputOptions","maskTextFn","maskInputFn","recordCanvas","inlineImages","slimDOMOptions","doc","mirror","iframeManager","shadowDomManager","canvasManager"].forEach((e=>{this[e]=t[e]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Tn(t,e){t.delete(e),e.childNodes.forEach((e=>Tn(t,e)))}function Sn(t,e,i){const{parentNode:r}=e;if(!r)return!1;const n=i.getId(r);return!!t.some((t=>t.id===n))||Sn(t,r,i)}function wn(t,e){const{parentNode:i}=e;return!!i&&(!!t.has(i)||wn(t,i))}const An=t=>(...e)=>{try{return t(...e)}catch(t){try{t.__rrweb__=!0}catch(t){}throw t}},In=[];function Rn(t){try{if("composedPath"in t){const e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0]}catch(t){}return t&&t.target}function Cn(t,e){var i,r;const n=new En;In.push(n),n.init(t);let s=window.MutationObserver||window.__rrMutationObserver;const a=null===(r=null===(i=null===window||void 0===window?void 0:window.Zone)||void 0===i?void 0:i.__symbol__)||void 0===r?void 0:r.call(i,"MutationObserver");a&&window[a]&&(s=window[a]);const o=new s(An((e=>{t.onMutation&&!1===t.onMutation(e)||n.processMutations(e)})));return o.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),o}function Mn({scrollCb:t,doc:e,mirror:i,blockClass:r,blockSelector:n,unblockSelector:s,sampling:a}){const o=on((a=>{const o=Rn(a);if(!o||dn(o,r,n,s))return;const l=i.getId(o);if(o===e){const i=e.scrollingElement||e.documentElement;An(t)({id:l,x:i.scrollLeft,y:i.scrollTop})}else An(t)({id:l,x:o.scrollLeft,y:o.scrollTop})}),a.scroll||100);return nn("scroll",An(o),e)}function On(t,e){const i=Object.assign({},t);return e||delete i.userTriggered,i}const Pn=["INPUT","TEXTAREA","SELECT"],kn=new WeakMap;function Dn(t){return function(t,e){if(Ln("CSSGroupingRule")&&t.parentRule instanceof CSSGroupingRule||Ln("CSSMediaRule")&&t.parentRule instanceof CSSMediaRule||Ln("CSSSupportsRule")&&t.parentRule instanceof CSSSupportsRule||Ln("CSSConditionRule")&&t.parentRule instanceof CSSConditionRule){const i=Array.from(t.parentRule.cssRules).indexOf(t);e.unshift(i)}else{const i=Array.from(t.parentStyleSheet.cssRules).indexOf(t);e.unshift(i)}return e}(t,[])}function Nn(t,e={}){const i=t.doc.defaultView;if(!i)return()=>{};!function(t,e){const{mutationCb:i,mousemoveCb:r,mouseInteractionCb:n,scrollCb:s,viewportResizeCb:a,inputCb:o,mediaInteractionCb:l,styleSheetRuleCb:h,styleDeclarationCb:u,canvasMutationCb:c,fontCb:d}=t;t.mutationCb=(...t)=>{e.mutation&&e.mutation(...t),i(...t)},t.mousemoveCb=(...t)=>{e.mousemove&&e.mousemove(...t),r(...t)},t.mouseInteractionCb=(...t)=>{e.mouseInteraction&&e.mouseInteraction(...t),n(...t)},t.scrollCb=(...t)=>{e.scroll&&e.scroll(...t),s(...t)},t.viewportResizeCb=(...t)=>{e.viewportResize&&e.viewportResize(...t),a(...t)},t.inputCb=(...t)=>{e.input&&e.input(...t),o(...t)},t.mediaInteractionCb=(...t)=>{e.mediaInteaction&&e.mediaInteaction(...t),l(...t)},t.styleSheetRuleCb=(...t)=>{e.styleSheetRule&&e.styleSheetRule(...t),h(...t)},t.styleDeclarationCb=(...t)=>{e.styleDeclaration&&e.styleDeclaration(...t),u(...t)},t.canvasMutationCb=(...t)=>{e.canvasMutation&&e.canvasMutation(...t),c(...t)},t.fontCb=(...t)=>{e.font&&e.font(...t),d(...t)}}(t,e);const r=Cn(t,t.doc),n=function({mousemoveCb:t,sampling:e,doc:i,mirror:r}){if(!1===e.mousemove)return()=>{};const n="number"==typeof e.mousemove?e.mousemove:50,s="number"==typeof e.mousemoveCallback?e.mousemoveCallback:500;let a,o=[];const l=on((e=>{const i=Date.now()-a;An(t)(o.map((t=>(t.timeOffset-=i,t))),e),o=[],a=null}),s),h=on((t=>{const e=Rn(t),{clientX:i,clientY:n}=mn(t)?t.changedTouches[0]:t;a||(a=Date.now()),o.push({x:i,y:n,id:r.getId(e),timeOffset:Date.now()-a}),l("undefined"!=typeof DragEvent&&t instanceof DragEvent?Qr.Drag:t instanceof MouseEvent?Qr.MouseMove:Qr.TouchMove)}),n,{trailing:!1}),u=[nn("mousemove",An(h),i),nn("touchmove",An(h),i),nn("drag",An(h),i)];return An((()=>{u.forEach((t=>t()))}))}(t),s=function({mouseInteractionCb:t,doc:e,mirror:i,blockClass:r,blockSelector:n,unblockSelector:s,sampling:a}){if(!1===a.mouseInteraction)return()=>{};const o=!0===a.mouseInteraction||void 0===a.mouseInteraction?{}:a.mouseInteraction,l=[];return Object.keys(Jr).filter((t=>Number.isNaN(Number(t))&&!t.endsWith("_Departed")&&!1!==o[t])).forEach((a=>{const o=a.toLowerCase(),h=An((e=>a=>{const o=Rn(a);if(dn(o,r,n,s))return;const l=mn(a)?a.changedTouches[0]:a;if(!l)return;const h=i.getId(o),{clientX:u,clientY:c}=l;An(t)({type:Jr[e],id:h,x:u,y:c})})(a));l.push(nn(o,h,e))})),An((()=>{l.forEach((t=>t()))}))}(t),a=Mn(t),o=function({viewportResizeCb:t}){let e=-1,i=-1;const r=on((()=>{const r=un(),n=cn();e===r&&i===n||(An(t)({width:Number(n),height:Number(r)}),e=r,i=n)}),200);return nn("resize",An(r),window)}(t),l=function({inputCb:t,doc:e,mirror:i,blockClass:r,blockSelector:n,unblockSelector:s,ignoreClass:a,ignoreSelector:o,maskInputSelector:l,unmaskInputSelector:h,maskInputOptions:u,maskInputFn:c,sampling:d,userTriggeredOnInput:p}){function f(t){let i=Rn(t);const d=i&&i.tagName,f=t.isTrusted;if("OPTION"===d&&(i=i.parentElement),!i||!d||Pn.indexOf(d)<0||dn(i,r,n,s))return;const g=i,_=Rr(g);if(g.classList.contains(a)||o&&g.matches(o))return;let y=Cr(g,d,_),v=!1;"radio"!==_&&"checkbox"!==_||(v=i.checked),function({tagName:t,type:e,maskInputOptions:i,maskInputSelector:r}){return r||Ar({maskInputOptions:i,tagName:t,type:e})}({maskInputOptions:u,maskInputSelector:l,tagName:d,type:_})&&(y=Ir({input:g,maskInputOptions:u,maskInputSelector:l,unmaskInputSelector:h,tagName:d,type:_,value:y,maskInputFn:c})),m(i,An(On)({text:y,isChecked:v,userTriggered:f},p));const x=i.name;"radio"===_&&x&&v&&e.querySelectorAll(`input[type="radio"][name="${x}"]`).forEach((t=>{if(t!==i){const e=Ir({input:t,maskInputOptions:u,maskInputSelector:l,unmaskInputSelector:h,tagName:d,type:_,value:Cr(t,d,_),maskInputFn:c});m(t,An(On)({text:e,isChecked:!v,userTriggered:!1},p))}}))}function m(e,r){const n=kn.get(e);if(!n||n.text!==r.text||n.isChecked!==r.isChecked){kn.set(e,r);const n=i.getId(e);t(Object.assign(Object.assign({},r),{id:n}))}}const g=("last"===d.input?["change"]:["input","change"]).map((t=>nn(t,An(f),e))),_=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"),y=[[HTMLInputElement.prototype,"value"],[HTMLInputElement.prototype,"checked"],[HTMLSelectElement.prototype,"value"],[HTMLTextAreaElement.prototype,"value"],[HTMLSelectElement.prototype,"selectedIndex"],[HTMLOptionElement.prototype,"selected"]];return _&&_.set&&g.push(...y.map((t=>ln(t[0],t[1],{set(){An(f)({target:this})}})))),An((()=>{g.forEach((t=>t()))}))}(t),h=function({mediaInteractionCb:t,blockClass:e,blockSelector:i,unblockSelector:r,mirror:n,sampling:s}){const a=a=>on(An((s=>{const o=Rn(s);if(!o||dn(o,e,i,r))return;const{currentTime:l,volume:h,muted:u}=o;t({type:a,id:n.getId(o),currentTime:l,volume:h,muted:u})})),s.media||500),o=[nn("play",a(0)),nn("pause",a(1)),nn("seeked",a(2)),nn("volumechange",a(3))];return An((()=>{o.forEach((t=>t()))}))}(t),u=function({styleSheetRuleCb:t,mirror:e},{win:i}){if(!i.CSSStyleSheet||!i.CSSStyleSheet.prototype)return()=>{};const r=i.CSSStyleSheet.prototype.insertRule;i.CSSStyleSheet.prototype.insertRule=new Proxy(r,{apply:An(((i,r,n)=>{const[s,a]=n,o=e.getId(r.ownerNode);return-1!==o&&t({id:o,adds:[{rule:s,index:a}]}),i.apply(r,n)}))});const n=i.CSSStyleSheet.prototype.deleteRule;i.CSSStyleSheet.prototype.deleteRule=new Proxy(n,{apply:An(((i,r,n)=>{const[s]=n,a=e.getId(r.ownerNode);return-1!==a&&t({id:a,removes:[{index:s}]}),i.apply(r,n)}))});const s={};Fn("CSSGroupingRule")?s.CSSGroupingRule=i.CSSGroupingRule:(Fn("CSSMediaRule")&&(s.CSSMediaRule=i.CSSMediaRule),Fn("CSSConditionRule")&&(s.CSSConditionRule=i.CSSConditionRule),Fn("CSSSupportsRule")&&(s.CSSSupportsRule=i.CSSSupportsRule));const a={};return Object.entries(s).forEach((([i,r])=>{a[i]={insertRule:r.prototype.insertRule,deleteRule:r.prototype.deleteRule},r.prototype.insertRule=new Proxy(a[i].insertRule,{apply:An(((i,r,n)=>{const[s,a]=n,o=e.getId(r.parentStyleSheet.ownerNode);return-1!==o&&t({id:o,adds:[{rule:s,index:[...Dn(r),a||0]}]}),i.apply(r,n)}))}),r.prototype.deleteRule=new Proxy(a[i].deleteRule,{apply:An(((i,r,n)=>{const[s]=n,a=e.getId(r.parentStyleSheet.ownerNode);return-1!==a&&t({id:a,removes:[{index:[...Dn(r),s]}]}),i.apply(r,n)}))})})),An((()=>{i.CSSStyleSheet.prototype.insertRule=r,i.CSSStyleSheet.prototype.deleteRule=n,Object.entries(s).forEach((([t,e])=>{e.prototype.insertRule=a[t].insertRule,e.prototype.deleteRule=a[t].deleteRule}))}))}(t,{win:i}),c=function({styleDeclarationCb:t,mirror:e},{win:i}){const r=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(r,{apply:An(((i,r,n)=>{var s,a;const[o,l,h]=n,u=e.getId(null===(a=null===(s=r.parentRule)||void 0===s?void 0:s.parentStyleSheet)||void 0===a?void 0:a.ownerNode);return-1!==u&&t({id:u,set:{property:o,value:l,priority:h},index:Dn(r.parentRule)}),i.apply(r,n)}))});const n=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(n,{apply:An(((i,r,n)=>{var s,a;const[o]=n,l=e.getId(null===(a=null===(s=r.parentRule)||void 0===s?void 0:s.parentStyleSheet)||void 0===a?void 0:a.ownerNode);return-1!==l&&t({id:l,remove:{property:o},index:Dn(r.parentRule)}),i.apply(r,n)}))}),An((()=>{i.CSSStyleDeclaration.prototype.setProperty=r,i.CSSStyleDeclaration.prototype.removeProperty=n}))}(t,{win:i}),d=t.collectFonts?function({fontCb:t,doc:e}){const i=e.defaultView;if(!i)return()=>{};const r=[],n=new WeakMap,s=i.FontFace;i.FontFace=function(t,e,i){const r=new s(t,e,i);return n.set(r,{family:t,buffer:"string"!=typeof e,descriptors:i,fontSource:"string"==typeof e?e:JSON.stringify(Array.from(new Uint8Array(e)))}),r};const a=hn(e.fonts,"add",(function(e){return function(i){return setTimeout((()=>{const e=n.get(i);e&&(t(e),n.delete(i))}),0),e.apply(this,[i])}}));return r.push((()=>{i.FontFace=s})),r.push(a),An((()=>{r.forEach((t=>t()))}))}(t):()=>{},p=[];for(const e of t.plugins)p.push(e.observer(e.callback,i,e.options));return An((()=>{In.forEach((t=>t.reset())),r.disconnect(),n(),s(),a(),o(),l(),h();try{u(),c()}catch(t){}d(),p.forEach((t=>t()))}))}function Ln(t){return void 0!==window[t]}function Fn(t){return Boolean(void 0!==window[t]&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}class Bn{constructor(t){this.iframes=new WeakMap,this.mutationCb=t.mutationCb}addIframe(t){this.iframes.set(t,!0)}addLoadListener(t){this.loadListener=t}attachIframe(t,e){var i;this.mutationCb({adds:[{parentId:t.__sn.id,nextId:null,node:e}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(i=this.loadListener)||void 0===i||i.call(this,t)}}class Un{constructor(t){this.restorePatches=[],this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror;const e=this;this.restorePatches.push(hn(HTMLElement.prototype,"attachShadow",(function(t){return function(){const i=t.apply(this,arguments);return this.shadowRoot&&e.addShadowRoot(this.shadowRoot,this.ownerDocument),i}})))}addShadowRoot(t,e){Cn(Object.assign(Object.assign({},this.bypassOptions),{doc:e,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),t),Mn(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:t,mirror:this.mirror}))}observeAttachShadow(t){if(t.contentWindow){const e=this;this.restorePatches.push(hn(t.contentWindow.HTMLElement.prototype,"attachShadow",(function(i){return function(){const r=i.apply(this,arguments);return this.shadowRoot&&e.addShadowRoot(this.shadowRoot,t.contentDocument),r}})))}}reset(){this.restorePatches.forEach((t=>t()))}}for(var Gn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wn="undefined"==typeof Uint8Array?[]:new Uint8Array(256),jn=0;jn<Gn.length;jn++)Wn[Gn.charCodeAt(jn)]=jn;const Yn=new Map,zn=(t,e,i)=>{if(!t||!Vn(t,e)&&"object"!=typeof t)return;const r=function(t,e){let i=Yn.get(t);return i||(i=new Map,Yn.set(t,i)),i.has(e)||i.set(e,[]),i.get(e)}(i,t.constructor.name);let n=r.indexOf(t);return-1===n&&(n=r.length,r.push(t)),n};function Hn(t,e,i){if(t instanceof Array)return t.map((t=>Hn(t,e,i)));if(null===t)return t;if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray)return{rr_type:t.constructor.name,args:[Object.values(t)]};if(t instanceof ArrayBuffer){const e=t.constructor.name,i=function(t){var e,i=new Uint8Array(t),r=i.length,n="";for(e=0;e<r;e+=3)n+=Gn[i[e]>>2],n+=Gn[(3&i[e])<<4|i[e+1]>>4],n+=Gn[(15&i[e+1])<<2|i[e+2]>>6],n+=Gn[63&i[e+2]];return r%3==2?n=n.substring(0,n.length-1)+"=":r%3==1&&(n=n.substring(0,n.length-2)+"=="),n}(t);return{rr_type:e,base64:i}}if(t instanceof DataView)return{rr_type:t.constructor.name,args:[Hn(t.buffer,e,i),t.byteOffset,t.byteLength]};if(t instanceof HTMLImageElement){const e=t.constructor.name,{src:i}=t;return{rr_type:e,src:i}}return t instanceof ImageData?{rr_type:t.constructor.name,args:[Hn(t.data,e,i),t.width,t.height]}:Vn(t,e)||"object"==typeof t?{rr_type:t.constructor.name,index:zn(t,e,i)}:t}const Xn=(t,e,i)=>[...t].map((t=>Hn(t,e,i))),Vn=(t,e)=>{const i=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((t=>"function"==typeof e[t]));return Boolean(i.find((i=>t instanceof e[i])))};function qn(t,e,i,r,n,s,a,o){const l=[],h=Object.getOwnPropertyNames(t);for(const u of h)try{if("function"!=typeof t[u])continue;const h=hn(t,u,(function(l){return function(...h){const c=l.apply(this,h);if(zn(c,o,t),!dn(this.canvas,r,s,n)){a.getId(this.canvas);const r=Xn([...h],o,t),n={type:e,property:u,args:r};i(this.canvas,n)}return c}}));l.push(h)}catch(r){const n=ln(t,u,{set(t){i(this.canvas,{type:e,property:u,args:[t],setter:!0})}});l.push(n)}return l}class Kn{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(t){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=function(t,e){!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(t)||this.pendingCanvasMutations.set(t,[]),this.pendingCanvasMutations.get(t).push(e)},this.mutationCb=t.mutationCb,this.mirror=t.mirror,!0===t.recordCanvas&&this.initCanvasMutationObserver(t.win,t.blockClass,t.blockSelector,t.unblockSelector)}initCanvasMutationObserver(t,e,i,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const n=function(t,e,i,r){const n=[];try{const s=hn(t.HTMLCanvasElement.prototype,"getContext",(function(t){return function(n,...s){return dn(this,e,i,r)||"__context"in this||(this.__context=n),t.apply(this,[n,...s])}}));n.push(s)}catch(t){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{n.forEach((t=>t()))}}(t,e,r,i),s=function(t,e,i,r,n,s){const a=[],o=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype);for(const s of o)try{if("function"!=typeof e.CanvasRenderingContext2D.prototype[s])continue;const o=hn(e.CanvasRenderingContext2D.prototype,s,(function(e){return function(...a){return dn(this.canvas,i,n,r)||setTimeout((()=>{const e=[...a];if("drawImage"===s&&e[0]&&e[0]instanceof HTMLCanvasElement){const t=e[0],i=t.getContext("2d");let r=null==i?void 0:i.getImageData(0,0,t.width,t.height),n=null==r?void 0:r.data;e[0]=JSON.stringify(n)}t(this.canvas,{type:tn["2D"],property:s,args:e})}),0),e.apply(this,a)}}));a.push(o)}catch(i){const r=ln(e.CanvasRenderingContext2D.prototype,s,{set(e){t(this.canvas,{type:tn["2D"],property:s,args:[e],setter:!0})}});a.push(r)}return()=>{a.forEach((t=>t()))}}(this.processMutation.bind(this),t,e,r,i,this.mirror),a=function(t,e,i,r,n,s){const a=[];return a.push(...qn(e.WebGLRenderingContext.prototype,tn.WebGL,t,i,r,n,s,e)),void 0!==e.WebGL2RenderingContext&&a.push(...qn(e.WebGL2RenderingContext.prototype,tn.WebGL2,t,i,r,n,s,e)),()=>{a.forEach((t=>t()))}}(this.processMutation.bind(this),t,e,r,i,this.mirror);this.resetObservers=()=>{n(),s(),a()}}startPendingCanvasMutationFlusher(){requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){const t=e=>{this.rafStamps.latestId=e,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((t,e)=>{const i=this.mirror.getId(e);this.flushPendingCanvasMutationFor(e,i)})),requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(t,e){if(this.frozen||this.locked)return;const i=this.pendingCanvasMutations.get(t);if(!i||-1===e)return;const r=i.map((t=>{const e=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i}(t,["type"]);return e})),{type:n}=i[0];this.mutationCb({id:e,type:n,commands:r}),this.pendingCanvasMutations.delete(t)}}function $n(t){return Object.assign(Object.assign({},t),{timestamp:Date.now()})}let Zn,Qn;const Jn={map:{},getId:t=>t&&t.__sn?t.__sn.id:-1,getNode(t){return this.map[t]||null},removeNodeFromMap(t){const e=t.__sn&&t.__sn.id;delete this.map[e],t.childNodes&&t.childNodes.forEach((t=>this.removeNodeFromMap(t)))},has(t){return this.map.hasOwnProperty(t)},reset(){this.map={}}};function ts(t={}){const{emit:e,checkoutEveryNms:i,checkoutEveryNth:r,blockClass:n="rr-block",blockSelector:s=null,unblockSelector:a=null,ignoreClass:o="rr-ignore",ignoreSelector:l=null,maskTextClass:h="rr-mask",maskTextSelector:u=null,maskInputSelector:c=null,unmaskTextSelector:d=null,unmaskInputSelector:p=null,inlineStylesheet:f=!0,maskAllText:m=!1,maskAllInputs:g,maskInputOptions:_,slimDOMOptions:y,maskInputFn:v,maskTextFn:x,hooks:b,packFn:E,sampling:T={},mousemoveWait:S,recordCanvas:w=!1,userTriggeredOnInput:A=!1,collectFonts:I=!1,inlineImages:R=!1,plugins:C,keepIframeSrcFn:M=(()=>!1),onMutation:O}=t;if(!e)throw new Error("emit function is required");void 0!==S&&void 0===T.mousemove&&(T.mousemove=S);const P=!0===g?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,radio:!0,checkbox:!0}:void 0!==_?_:{},k=!0===y||"all"===y?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===y,headMetaDescKeywords:"all"===y}:y||{};let D;!function(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=function(t){if(!(0 in arguments))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}();let N=0;Zn=(t,n)=>{var s;if(!(null===(s=In[0])||void 0===s?void 0:s.isFrozen())||t.type===Zr.FullSnapshot||t.type===Zr.IncrementalSnapshot&&t.data.source===Qr.Mutation||In.forEach((t=>t.unfreeze())),e((t=>{for(const e of C||[])e.eventProcessor&&(t=e.eventProcessor(t));return E&&(t=E(t)),t})(t),n),t.type===Zr.FullSnapshot)D=t,N=0;else if(t.type===Zr.IncrementalSnapshot){if(t.data.source===Qr.Mutation&&t.data.isAttachIframe)return;N++;const e=r&&N>=r,n=i&&t.timestamp-D.timestamp>i;(e||n)&&Qn(!0)}};const L=t=>{Zn($n({type:Zr.IncrementalSnapshot,data:Object.assign({source:Qr.Mutation},t)}))},F=t=>Zn($n({type:Zr.IncrementalSnapshot,data:Object.assign({source:Qr.Scroll},t)})),B=t=>Zn($n({type:Zr.IncrementalSnapshot,data:Object.assign({source:Qr.CanvasMutation},t)})),U=new Bn({mutationCb:L}),G=new Kn({recordCanvas:w,mutationCb:B,win:window,blockClass:n,blockSelector:s,unblockSelector:a,mirror:Jn}),W=new Un({mutationCb:L,scrollCb:F,bypassOptions:{onMutation:O,blockClass:n,blockSelector:s,unblockSelector:a,maskTextClass:h,maskTextSelector:u,unmaskTextSelector:d,maskInputSelector:c,unmaskInputSelector:p,inlineStylesheet:f,maskAllText:m,maskInputOptions:P,maskTextFn:x,maskInputFn:v,recordCanvas:w,inlineImages:R,sampling:T,slimDOMOptions:k,iframeManager:U,canvasManager:G},mirror:Jn});Qn=(t=!1)=>{var e,i,r,o;Zn($n({type:Zr.Meta,data:{href:window.location.href,width:cn(),height:un()}}),t),In.forEach((t=>t.lock()));const[l,g]=function(t,e){const{blockClass:i="rr-block",blockSelector:r=null,unblockSelector:n=null,maskTextClass:s="rr-mask",maskTextSelector:a=null,unmaskTextSelector:o=null,inlineStylesheet:l=!0,inlineImages:h=!1,recordCanvas:u=!1,maskInputSelector:c=null,unmaskInputSelector:d=null,maskAllText:p=!1,maskAllInputs:f=!1,maskTextFn:m,maskInputFn:g,slimDOM:_=!1,dataURLOptions:y,preserveWhiteSpace:v,onSerialize:x,onIframeLoad:b,iframeLoadTimeout:E,keepIframeSrcFn:T=(()=>!1)}=e||{},S={};return[Kr(t,{doc:t,map:S,blockClass:i,blockSelector:r,unblockSelector:n,maskTextClass:s,maskTextSelector:a,unmaskTextSelector:o,skipChild:!1,inlineStylesheet:l,maskInputSelector:c,unmaskInputSelector:d,maskAllText:p,maskInputOptions:!0===f?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0}:!1===f?{}:f,maskTextFn:m,maskInputFn:g,slimDOMOptions:!0===_||"all"===_?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===_,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===_?{}:_,dataURLOptions:y,inlineImages:h,recordCanvas:u,preserveWhiteSpace:v,onSerialize:x,onIframeLoad:b,iframeLoadTimeout:E,keepIframeSrcFn:T}),S]}(document,{blockClass:n,blockSelector:s,unblockSelector:a,maskTextClass:h,maskTextSelector:u,unmaskTextSelector:d,maskInputSelector:c,unmaskInputSelector:p,inlineStylesheet:f,maskAllText:m,maskAllInputs:P,maskTextFn:x,slimDOM:k,recordCanvas:w,inlineImages:R,onSerialize:t=>{gn(t)&&U.addIframe(t),_n(t)&&W.addShadowRoot(t.shadowRoot,document)},onIframeLoad:(t,e)=>{U.attachIframe(t,e),W.observeAttachShadow(t)},keepIframeSrcFn:M});if(!l)return console.warn("Failed to snapshot the document");Jn.map=g,Zn($n({type:Zr.FullSnapshot,data:{node:l,initialOffset:{left:void 0!==window.pageXOffset?window.pageXOffset:(null===document||void 0===document?void 0:document.documentElement.scrollLeft)||(null===(i=null===(e=null===document||void 0===document?void 0:document.body)||void 0===e?void 0:e.parentElement)||void 0===i?void 0:i.scrollLeft)||(null===document||void 0===document?void 0:document.body.scrollLeft)||0,top:void 0!==window.pageYOffset?window.pageYOffset:(null===document||void 0===document?void 0:document.documentElement.scrollTop)||(null===(o=null===(r=null===document||void 0===document?void 0:document.body)||void 0===r?void 0:r.parentElement)||void 0===o?void 0:o.scrollTop)||(null===document||void 0===document?void 0:document.body.scrollTop)||0}}})),In.forEach((t=>t.unlock()))};try{const t=[];t.push(nn("DOMContentLoaded",(()=>{Zn($n({type:Zr.DomContentLoaded,data:{}}))})));const e=t=>{var e;return An(Nn)({onMutation:O,mutationCb:L,mousemoveCb:(t,e)=>Zn($n({type:Zr.IncrementalSnapshot,data:{source:e,positions:t}})),mouseInteractionCb:t=>Zn($n({type:Zr.IncrementalSnapshot,data:Object.assign({source:Qr.MouseInteraction},t)})),scrollCb:F,viewportResizeCb:t=>Zn($n({type:Zr.IncrementalSnapshot,data:Object.assign({source:Qr.ViewportResize},t)})),inputCb:t=>Zn($n({type:Zr.IncrementalSnapshot,data:Object.assign({source:Qr.Input},t)})),mediaInteractionCb:t=>Zn($n({type:Zr.IncrementalSnapshot,data:Object.assign({source:Qr.MediaInteraction},t)})),styleSheetRuleCb:t=>Zn($n({type:Zr.IncrementalSnapshot,data:Object.assign({source:Qr.StyleSheetRule},t)})),styleDeclarationCb:t=>Zn($n({type:Zr.IncrementalSnapshot,data:Object.assign({source:Qr.StyleDeclaration},t)})),canvasMutationCb:B,fontCb:t=>Zn($n({type:Zr.IncrementalSnapshot,data:Object.assign({source:Qr.Font},t)})),blockClass:n,ignoreClass:o,ignoreSelector:l,maskTextClass:h,maskTextSelector:u,unmaskTextSelector:d,maskInputSelector:c,unmaskInputSelector:p,maskInputOptions:P,inlineStylesheet:f,sampling:T,recordCanvas:w,inlineImages:R,userTriggeredOnInput:A,collectFonts:I,doc:t,maskAllText:m,maskInputFn:v,maskTextFn:x,blockSelector:s,unblockSelector:a,slimDOMOptions:k,mirror:Jn,iframeManager:U,shadowDomManager:W,canvasManager:G,plugins:(null===(e=null==C?void 0:C.filter((t=>t.observer)))||void 0===e?void 0:e.map((t=>({observer:t.observer,options:t.options,callback:e=>Zn($n({type:Zr.Plugin,data:{plugin:t.name,payload:e}}))}))))||[]},b)};U.addLoadListener((i=>{try{t.push(e(i.contentDocument))}catch(t){console.warn(t)}}));const i=()=>{Qn(),t.push(e(document))};return"interactive"===document.readyState||"complete"===document.readyState?i():t.push(nn("load",(()=>{Zn($n({type:Zr.Load,data:{}})),i()}),window)),()=>{t.forEach((t=>t()))}}catch(t){console.warn(t)}}function es(t,e){"sentry.transaction"!==e.category&&(["ui.click","ui.input"].includes(e.category)?t.triggerUserActivity():t.checkAndHandleExpiredSession(),t.addUpdate((()=>(t.throttledAddEvent({type:Zr.Custom,timestamp:1e3*(e.timestamp||0),data:{tag:"breadcrumb",payload:ye(e,10,1e3)}}),"console"===e.category))))}function is(t){const e=rs(t);return e&&e instanceof Element&&e.closest("button,a")||e}function rs(t){return function(t){return"object"==typeof t&&!!t&&"target"in t}(t)?t.target:t}let ns;ts.addCustomEvent=(t,e)=>{if(!Zn)throw new Error("please add custom event after start recording");Zn($n({type:Zr.Custom,data:{tag:t,payload:e}}))},ts.freezePage=()=>{In.forEach((t=>t.freeze()))},ts.takeFullSnapshot=t=>{if(!Qn)throw new Error("please take full snapshot after start recording");Qn(t)},ts.mirror=Jn;class ss{__init(){this._lastMutation=0}__init2(){this._lastScroll=0}__init3(){this._clicks=[]}constructor(t,e,i=es){ss.prototype.__init.call(this),ss.prototype.__init2.call(this),ss.prototype.__init3.call(this),this._timeout=e.timeout/1e3,this._multiClickTimeout=e.multiClickTimeout/1e3,this._threshold=e.threshold/1e3,this._scollTimeout=e.scrollTimeout/1e3,this._replay=t,this._ignoreSelector=e.ignoreSelector,this._addBreadcrumbEvent=i}addListeners(){const t=()=>{this._lastScroll=os()},e=(n=()=>{this._lastMutation=os()},ns||(ns=[],S(yr,"open",(function(t){return function(...e){if(ns)try{ns.forEach((t=>t()))}catch(t){}return t.apply(yr,e)}}))),ns.push(n),()=>{const t=ns?ns.indexOf(n):-1;t>-1&&ns.splice(t,1)}),i=t=>{if(!t.target)return;const e=is(t);e&&this._handleMultiClick(e)},r=new MutationObserver((()=>{this._lastMutation=os()}));var n;r.observe(yr.document.documentElement,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),yr.addEventListener("scroll",t,{passive:!0}),yr.addEventListener("click",i,{passive:!0}),this._teardown=()=>{yr.removeEventListener("scroll",t),yr.removeEventListener("click",i),e(),r.disconnect(),this._clicks=[],this._lastMutation=0,this._lastScroll=0}}removeListeners(){this._teardown&&this._teardown(),this._checkClickTimeout&&clearTimeout(this._checkClickTimeout)}handleClick(t,e){if(function(t,e){return!as.includes(t.tagName)||("INPUT"===t.tagName&&!["submit","button"].includes(t.getAttribute("type")||"")||(!("A"!==t.tagName||!(t.hasAttribute("download")||t.hasAttribute("target")&&"_self"!==t.getAttribute("target")))||!(!e||!t.matches(e))))}(e,this._ignoreSelector)||!function(t){return!(!t.data||"number"!=typeof t.data.nodeId||!t.timestamp)}(t))return;if(this._getClick(e))return;const i={timestamp:t.timestamp,clickBreadcrumb:t,clickCount:0,node:e};this._clicks.push(i),1===this._clicks.length&&this._scheduleCheckClicks()}_handleMultiClick(t){const e=this._getClick(t);e&&e.clickCount++}_getClick(t){const e=os();return this._clicks.find((i=>i.node===t&&e-i.timestamp<this._multiClickTimeout))}_checkClicks(){const t=[],e=os();this._clicks.forEach((i=>{!i.mutationAfter&&this._lastMutation&&(i.mutationAfter=i.timestamp<=this._lastMutation?this._lastMutation-i.timestamp:void 0),!i.scrollAfter&&this._lastScroll&&(i.scrollAfter=i.timestamp<=this._lastScroll?this._lastScroll-i.timestamp:void 0);const r=i.scrollAfter||i.mutationAfter||0;(r&&r>=this._multiClickTimeout||i.timestamp+this._timeout<=e)&&t.push(i)}));for(const e of t){this._generateBreadcrumbs(e);const t=this._clicks.indexOf(e);-1!==t&&this._clicks.splice(t,1)}this._clicks.length&&this._scheduleCheckClicks()}_generateBreadcrumbs(t){const e=this._replay,i=t.scrollAfter&&t.scrollAfter<=this._scollTimeout,r=t.mutationAfter&&t.mutationAfter<=this._threshold,n=!i&&!r,{clickCount:s,clickBreadcrumb:a}=t;if(n){const i=1e3*Math.min(t.mutationAfter||this._timeout,this._timeout),r=i<1e3*this._timeout?"mutation":"timeout",n={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.slowClickDetected",data:{...a.data,url:yr.location.href,route:e.getCurrentRoute(),timeAfterClickMs:i,endReason:r,clickCount:s||1}};this._addBreadcrumbEvent(e,n)}else if(s>1){const t={type:"default",message:a.message,timestamp:a.timestamp,category:"ui.multiClick",data:{...a.data,url:yr.location.href,route:e.getCurrentRoute(),clickCount:s,metric:!0}};this._addBreadcrumbEvent(e,t)}}_scheduleCheckClicks(){this._checkClickTimeout=setTimeout((()=>this._checkClicks()),1e3)}}const as=["A","BUTTON","INPUT"];function os(){return Date.now()/1e3}function ls(t){return{timestamp:Date.now()/1e3,type:"default",...t}}var hs;!function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"}(hs||(hs={}));const us=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled"]);function cs(t){const e={};for(const i in t)if(us.has(i)){let r=i;"data-testid"!==i&&"data-test-id"!==i||(r="testId"),e[r]=t[i]}return e}function ds(t,e){const i=t&&"__sn"in t&&t.__sn.type===hs.Element?t.__sn:null;return{message:e,data:i?{nodeId:i.id,node:{id:i.id,tagName:i.tagName,textContent:t?Array.from(t.childNodes).map((t=>"__sn"in t&&t.__sn.type===hs.Text&&t.__sn.textContent)).filter(Boolean).map((t=>t.trim())).join(""):"",attributes:cs(i.attributes)}}:{}}}const ps=["name","type","startTime","transferSize","duration"];function fs(t){return function(e){return ps.every((i=>t[i]===e[i]))}}function ms(t){return t>9999999999?t:1e3*t}class gs{__init(){this._totalSize=0}constructor(){gs.prototype.__init.call(this),this.events=[]}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(t){const e=JSON.stringify(t).length;if(this._totalSize+=e,this._totalSize>Tr)throw new xs;this.events.push(t)}finish(){return new Promise((t=>{const e=this.events;this.clear(),t(JSON.stringify(e))}))}clear(){this.events=[],this._totalSize=0}getEarliestTimestamp(){const t=this.events.map((t=>t.timestamp)).sort()[0];return t?ms(t):null}}class _s{constructor(t){this._worker=t,this._id=0}ensureReady(){return this._ensureReadyPromise||(this._ensureReadyPromise=new Promise(((t,e)=>{this._worker.addEventListener("message",(({data:i})=>{i.success?t():e()}),{once:!0}),this._worker.addEventListener("error",(t=>{e(t)}),{once:!0})}))),this._ensureReadyPromise}destroy(){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Replay] Destroying compression worker"),this._worker.terminate()}postMessage(t,e){const i=this._getAndIncrementId();return new Promise(((r,n)=>{const s=({data:e})=>{const a=e;if(a.method===t&&a.id===i){if(this._worker.removeEventListener("message",s),!a.success)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("[Replay]",a.response),void n(new Error("Error in compression worker"));r(a.response)}};this._worker.addEventListener("message",s),this._worker.postMessage({id:i,method:t,arg:e})}))}_getAndIncrementId(){return this._id++}}class ys{__init(){this._totalSize=0}constructor(t){ys.prototype.__init.call(this),this._worker=new _s(t),this._earliestTimestamp=null}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(t){const e=ms(t.timestamp);(!this._earliestTimestamp||e<this._earliestTimestamp)&&(this._earliestTimestamp=e);const i=JSON.stringify(t);return this._totalSize+=i.length,this._totalSize>Tr?Promise.reject(new xs):this._sendEventToWorker(i)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null,this._totalSize=0,this._worker.postMessage("clear")}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(t){return this._worker.postMessage("addEvent",t)}async _finishRequest(){const t=await this._worker.postMessage("finish");return this._earliestTimestamp=null,this._totalSize=0,t}}class vs{constructor(t){this._fallback=new gs,this._compression=new ys(t),this._used=this._fallback,this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}destroy(){this._fallback.destroy(),this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(t){return this._used.addEvent(t)}async finish(){return await this.ensureWorkerIsLoaded(),this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch(t){return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Replay] Failed to load the compression worker, falling back to simple buffer"))}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events:t}=this._fallback,e=[];for(const i of t)e.push(this._compression.addEvent(i));this._used=this._compression;try{await Promise.all(e)}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("[Replay] Failed to add events when switching buffers.",t)}}}class xs extends Error{constructor(){super("Event buffer exceeded maximum size of 20000000.")}}function bs(t,e,i=+new Date){return null===t||void 0===e||e<0||0!==e&&t+e<=i}function Es(t,e,i=+new Date){return bs(t.started,e.maxSessionLife,i)||bs(t.lastActivity,e.sessionIdleExpire,i)}function Ts(t){return void 0!==t&&Math.random()<t}function Ss(t){if("sessionStorage"in yr)try{yr.sessionStorage.setItem(vr,JSON.stringify(t))}catch(t){}}function ws(t){const e=Date.now();return{id:t.id||G(),started:t.started||e,lastActivity:t.lastActivity||e,segmentId:t.segmentId||0,sampled:t.sampled,shouldRefresh:!0}}function As({sessionSampleRate:t,allowBuffering:e,stickySession:i=!1}){const r=function(t,e){return Ts(t)?"session":!!e&&"buffer"}(t,e),n=ws({sampled:r});return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Replay] Creating new session: ${n.id}`),i&&Ss(n),n}function Is({timeouts:t,currentSession:e,stickySession:i,sessionSampleRate:r,allowBuffering:n}){const s=e||i&&function(){if(!("sessionStorage"in yr))return null;try{const t=yr.sessionStorage.getItem(vr);return t?ws(JSON.parse(t)):null}catch(t){return null}}();if(s){if(!Es(s,t)||n&&s.shouldRefresh)return{type:"saved",session:s};if(!s.shouldRefresh)return{type:"new",session:ws({sampled:!1})};("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Replay] Session has expired")}return{type:"new",session:As({stickySession:i,sessionSampleRate:r,allowBuffering:n})}}async function Rs(t,e,i){if(!t.eventBuffer)return null;if(t.isPaused())return null;if(ms(e.timestamp)+t.timeouts.sessionIdlePause<Date.now())return null;try{i&&t.eventBuffer.clear();const r=t.getOptions(),n="function"==typeof r.beforeAddRecordingEvent&&function(t){return t.type===Zr.Custom}(e)?r.beforeAddRecordingEvent(e):e;if(!n)return;return await t.eventBuffer.addEvent(n)}catch(e){const i=e&&e instanceof xs?"addEventSizeExceeded":"addEvent";("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error(e),await t.stop(i);const r=ct().getClient();r&&r.recordDroppedEvent("internal_sdk_error","replay")}}function Cs(t){return!t.type}function Ms(t){return"transaction"===t.type}function Os(t){const e=function(){const t=ct().getClient();if(!t)return!1;const e=t.getTransport();return e&&e.send.__sentry__baseTransport__||!1}();return(i,r)=>{if(!Cs(i)&&!Ms(i))return;const n=r&&r.statusCode;e&&(!n||n<200||n>=300)||(Ms(i)&&i.contexts&&i.contexts.trace&&i.contexts.trace.trace_id?t.getContext().traceIds.add(i.contexts.trace.trace_id):Cs(i)&&(i.event_id&&t.getContext().errorIds.add(i.event_id),"buffer"===t.recordingMode&&i.tags&&i.tags.replayId&&setTimeout((()=>{t.sendBufferedReplayOrFlush()}))))}}function Ps(t,e){return e.map((({type:e,start:i,end:r,name:n,data:s})=>{const a=t.throttledAddEvent({type:Zr.Custom,timestamp:i,data:{tag:"performanceSpan",payload:{op:e,description:n,startTimestamp:i,endTimestamp:r,data:s}}});return"string"==typeof a?Promise.resolve(null):a}))}function ks(t,e){t.isEnabled()&&null!==e&&(function(t,e){return("undefined"!=typeof __SENTRY_DEBUG__&&!__SENTRY_DEBUG__||!t.getOptions()._experiments.traceInternals)&&function(t){const e=ct().getClient(),i=e&&e.getDsn();return!!i&&t.includes(i.host)}(e)}(t,e.name)||t.addUpdate((()=>(Ps(t,[e]),!0))))}const Ds=10,Ns=13,Ls=15,Fs=20,Bs=21,Us=23,Gs=["true","false","null"];function Ws(t,e,i){const r=t[t.length-1],n=e[i];if(!/\s/.test(n))if('"'!==n||js(e,i))switch(n){case"{":!function(t,e){e&&e!==Ns?(e===Bs&&t.push(Ds),e===Fs&&t.push(Ds)):t.push(Ds)}(t,r);break;case"[":!function(t,e){e?e===Ns?(t.push(Fs),t.push(Bs)):(e===Bs&&(t.push(Fs),t.push(Bs)),e===Fs&&(t.push(Fs),t.push(Bs))):(t.push(Fs),t.push(Bs))}(t,r);break;case":":!function(t,e){11===e&&(t.pop(),t.push(Ns))}(t,r);break;case",":!function(t,e){if(e!==Ns)return e===Ls?(t.pop(),void t.pop()):void(e!==Bs&&e===Us&&t.pop());t.pop()}(t,r);break;case"}":!function(t,e){e===Ds&&t.pop(),e===Ns&&(t.pop(),t.pop()),e===Ls&&(t.pop(),t.pop(),t.pop()),t[t.length-1]===Ns&&t.push(Ls),t[t.length-1]===Bs&&t.push(Us)}(t,r);break;case"]":!function(t,e){e===Fs&&t.pop(),e===Bs&&(t.pop(),t.pop()),e===Us&&(t.pop(),t.pop(),t.pop()),t[t.length-1]===Ns&&t.push(Ls),t[t.length-1]===Bs&&t.push(Us)}(t,r)}else!function(t,e){14===e?(t.pop(),t.push(Ls)):22===e?(t.pop(),t.push(Us)):e!==Ns?e!==Bs?e!==Ds?12===e&&(t.pop(),t.push(11)):t.push(12):t.push(22):t.push(14)}(t,r)}function js(t,e){return"\\"===t[e-1]&&!js(t,e-1)}function Ys(t){return function(t,e){if(!e.length)return t;let i=t;const r=e.length-1;i=function(t,e){switch(e){case Ds:return`${t}"~~":"~~"`;case 11:return`${t}:"~~"`;case 12:return`${t}~~":"~~"`;case Ns:return function(t){const e=t.lastIndexOf(":"),i=t.slice(e+1);return Gs.includes(i.trim())?`${t},"~~":"~~"`:`${t.slice(0,e+1)}"~~"`}(t);case 14:return`${t}~~"`;case Ls:return`${t},"~~":"~~"`;case Fs:return`${t}"~~"`;case Bs:return function(t){const e=function(t){for(let e=t.length-1;e>=0;e--){const i=t[e];if(","===i||"["===i)return e}return-1}(t);if(e>-1){const i=t.slice(e+1);return Gs.includes(i.trim())?`${t},"~~"`:`${t.slice(0,e+1)}"~~"`}return t}(t);case 22:return`${t}~~"`;case Us:return`${t},"~~"`}return t}(i,e[r]);for(let t=r;t>=0;t--)switch(e[t]){case Ds:i=`${i}}`;break;case Fs:i=`${i}]`}return i}(t,function(t){const e=[];for(let i=0;i<t.length;i++)Ws(e,t,i);return e}(t))}function zs(t,e){if(t)try{if("string"==typeof t)return e.encode(t).length;if(t instanceof URLSearchParams)return e.encode(t.toString()).length;if(t instanceof FormData){const i=Zs(t);return e.encode(i).length}if(t instanceof Blob)return t.size;if(t instanceof ArrayBuffer)return t.byteLength}catch(t){}}function Hs(t){if(!t)return;const e=parseInt(t,10);return isNaN(e)?void 0:e}function Xs(t){return"string"==typeof t?t:t instanceof URLSearchParams?t.toString():t instanceof FormData?Zs(t):void 0}function Vs(t,e){if(!e)return null;const{startTimestamp:i,endTimestamp:r,url:n,method:s,statusCode:a,request:o,response:l}=e;return{type:t,start:i/1e3,end:r/1e3,name:n,data:P({method:s,statusCode:a,request:o,response:l})}}function qs(t){return{headers:{},size:t,_meta:{warnings:["URL_SKIPPED"]}}}function Ks(t,e,i){if(!e&&0===Object.keys(t).length)return;if(!e)return{headers:t};if(!i)return{headers:t,size:e};const r={headers:t,size:e},{body:n,warnings:s}=function(t){if(!t||"string"!=typeof t)return{body:t,warnings:[]};const e=t.length>br;if(function(t){const e=t[0],i=t[t.length-1];return"["===e&&"]"===i||"{"===e&&"}"===i}(t))try{const i=e?Ys(t.slice(0,br)):t;return{body:JSON.parse(i),warnings:e?["JSON_TRUNCATED"]:[]}}catch(i){return{body:e?`${t.slice(0,br)}…`:t,warnings:e?["INVALID_JSON","TEXT_TRUNCATED"]:["INVALID_JSON"]}}return{body:e?`${t.slice(0,br)}…`:t,warnings:e?["TEXT_TRUNCATED"]:[]}}(i);return r.body=n,s.length>0&&(r._meta={warnings:s}),r}function $s(t,e){return Object.keys(t).reduce(((i,r)=>{const n=r.toLowerCase();return e.includes(n)&&t[r]&&(i[n]=t[r]),i}),{})}function Zs(t){return new URLSearchParams(t).toString()}function Qs(t,e){const i=function(t,e=yr.document.baseURI){if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith(yr.location.origin))return t;const i=new URL(t,e);if(i.origin!==new URL(e).origin)return t;const r=i.href;return!t.endsWith("/")&&r.endsWith("/")?r.slice(0,-1):r}(t);return T(i,e)}function Js(t=[]){if(2===t.length&&"object"==typeof t[1])return t[1].body}function ta(t,e){const i={};return e.forEach((e=>{t.get(e)&&(i[e]=t.get(e))})),i}function ea(t,e){if(!t)return{};const i=t.headers;return i?i instanceof Headers?ta(i,e):Array.isArray(i)?{}:$s(i,e):{}}function ia(t){const e=ct().getClient();try{const i=new TextEncoder,{networkDetailAllowUrls:r,networkCaptureBodies:n,networkRequestHeaders:s,networkResponseHeaders:a}=t.getOptions(),o={replay:t,textEncoder:i,networkDetailAllowUrls:r,networkCaptureBodies:n,networkRequestHeaders:s,networkResponseHeaders:a};e&&e.on?e.on("beforeAddBreadcrumb",((t,e)=>function(t,e,i){if(e.data)try{(function(t){return"xhr"===t.category})(e)&&function(t){return t&&t.xhr}(i)&&(function(t,e,i){const{xhr:r,input:n}=e,s=zs(n,i.textEncoder),a=r.getResponseHeader("content-length")?Hs(r.getResponseHeader("content-length")):zs(r.response,i.textEncoder);void 0!==s&&(t.data.request_body_size=s),void 0!==a&&(t.data.response_body_size=a)}(e,i,t),async function(t,e,i){try{const r=function(t,e,i){const{startTimestamp:r,endTimestamp:n,input:s,xhr:a}=e,{url:o,method:l,status_code:h=0,request_body_size:u,response_body_size:c}=t.data;if(!o)return null;if(!Qs(o,i.networkDetailAllowUrls))return{startTimestamp:r,endTimestamp:n,url:o,method:l,statusCode:h,request:qs(u),response:qs(c)};const d=a.__sentry_xhr_v2__,p=d?$s(d.request_headers,i.networkRequestHeaders):{},f=$s(function(t){const e=t.getAllResponseHeaders();return e?e.split("\r\n").reduce(((t,e)=>{const[i,r]=e.split(": ");return t[i.toLowerCase()]=r,t}),{}):{}}(a),i.networkResponseHeaders);return{startTimestamp:r,endTimestamp:n,url:o,method:l,statusCode:h,request:Ks(p,u,i.networkCaptureBodies?Xs(s):void 0),response:Ks(f,c,i.networkCaptureBodies?e.xhr.responseText:void 0)}}(t,e,i),n=Vs("resource.xhr",r);ks(i.replay,n)}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("[Replay] Failed to capture fetch breadcrumb",t)}}(e,i,t)),function(t){return"fetch"===t.category}(e)&&function(t){return t&&t.response}(i)&&(function(t,e,i){const{input:r,response:n}=e,s=zs(Js(r),i.textEncoder),a=n?Hs(n.headers.get("content-length")):void 0;void 0!==s&&(t.data.request_body_size=s),void 0!==a&&(t.data.response_body_size=a)}(e,i,t),async function(t,e,i){try{const r=await async function(t,e,i){const{startTimestamp:r,endTimestamp:n}=e,{url:s,method:a,status_code:o=0,request_body_size:l,response_body_size:h}=t.data,u=Qs(s,i.networkDetailAllowUrls),c=u?function({networkCaptureBodies:t,networkRequestHeaders:e},i,r){const n=(a=e,1===(s=i).length&&"string"!=typeof s[0]?ea(s[0],a):2===s.length?ea(s[1],a):{});var s,a;return Ks(n,r,t?Xs(Js(i)):void 0)}(i,e.input,l):qs(l),d=await async function(t,{networkCaptureBodies:e,textEncoder:i,networkResponseHeaders:r},n,s){if(!t&&void 0!==s)return qs(s);const a=ta(n.headers,r);if(!e&&void 0!==s)return Ks(a,s,void 0);try{const r=n.clone(),o=await async function(t){try{return await t.text()}catch(t){return}}(r),l=o&&o.length&&void 0===s?zs(o,i):s;return t?Ks(a,l,e?o:void 0):qs(l)}catch(t){return Ks(a,s,void 0)}}(u,i,e.response,h);return{startTimestamp:r,endTimestamp:n,url:s,method:a,statusCode:o,request:c,response:d}}(t,e,i),n=Vs("resource.fetch",r);ks(i.replay,n)}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("[Replay] Failed to capture fetch breadcrumb",t)}}(e,i,t))}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("Error when enriching network breadcrumb")}}(o,t,e))):(Gt("fetch",function(t){return e=>{if(!t.isEnabled())return;const i=function(t){const{startTimestamp:e,endTimestamp:i,fetchData:r,response:n}=t;if(!i)return null;const{method:s,url:a}=r;return{type:"resource.fetch",start:e/1e3,end:i/1e3,name:a,data:{method:s,statusCode:n&&n.status}}}(e);ks(t,i)}}(t)),Gt("xhr",function(t){return e=>{if(!t.isEnabled())return;const i=function(t){const{startTimestamp:e,endTimestamp:i,xhr:r}=t,n=r.__sentry_xhr_v2__;if(!e||!i||!n)return null;const{method:s,url:a,status_code:o}=n;return void 0===a?null:{type:"resource.xhr",name:a,start:e/1e3,end:i/1e3,data:{method:s,statusCode:o}}}(e);ks(t,i)}}(t)))}catch(t){}}let ra=null;function na(t){return!(!t||!t.on)}function sa(t){const{jsHeapSizeLimit:e,totalJSHeapSize:i,usedJSHeapSize:r}=t,n=Date.now()/1e3;return{type:"memory",name:"memory",start:n,end:n,data:{memory:{jsHeapSizeLimit:e,totalJSHeapSize:i,usedJSHeapSize:r}}}}const aa={resource:function(t){const{entryType:e,initiatorType:i,name:r,responseEnd:n,startTime:s,decodedBodySize:a,encodedBodySize:o,responseStatus:l,transferSize:h}=t;return["fetch","xmlhttprequest"].includes(i)?null:{type:`${e}.${i}`,start:la(s),end:la(n),name:r,data:{size:h,statusCode:l,decodedBodySize:a,encodedBodySize:o}}},paint:function(t){const{duration:e,entryType:i,name:r,startTime:n}=t,s=la(n);return{type:i,name:r,start:s,end:s+e,data:void 0}},navigation:function(t){const{entryType:e,name:i,decodedBodySize:r,duration:n,domComplete:s,encodedBodySize:a,domContentLoadedEventStart:o,domContentLoadedEventEnd:l,domInteractive:h,loadEventStart:u,loadEventEnd:c,redirectCount:d,startTime:p,transferSize:f,type:m}=t;return 0===n?null:{type:`${e}.${m}`,start:la(p),end:la(s),name:i,data:{size:f,decodedBodySize:r,encodedBodySize:a,duration:n,domInteractive:h,domContentLoadedEventStart:o,domContentLoadedEventEnd:l,loadEventStart:u,loadEventEnd:c,domComplete:s,redirectCount:d}}},"largest-contentful-paint":function(t){const{entryType:e,startTime:i,size:r}=t;let n=0;if(yr.performance){const t=yr.performance.getEntriesByType("navigation")[0];n=t&&t.activationStart||0}const s=Math.max(i-n,0),a=la(n)+s/1e3;return{type:e,name:e,start:a,end:a,data:{value:s,size:r,nodeId:ts.mirror.getId(t.element)}}}};function oa(t){return void 0===aa[t.entryType]?null:aa[t.entryType](t)}function la(t){return((Z.Z1||yr.performance.timeOrigin)+t)/1e3}function ha(t){let e=!1;return(i,r)=>{if(!t.checkAndHandleExpiredSession())return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("[Replay] Received replay event after session expired."));const n=r||!e;e=!0,t.addUpdate((()=>{if("buffer"===t.recordingMode&&n&&t.setInitialState(),Rs(t,i,n),!n)return!1;if(function(t,e){if(!e||!t.session||0!==t.session.segmentId)return Promise.resolve(null);Rs(t,function(t){const e=t.getOptions();return{type:Zr.Custom,timestamp:Date.now(),data:{tag:"options",payload:{sessionSampleRate:e.sessionSampleRate,errorSampleRate:e.errorSampleRate,useCompressionOption:e.useCompression,blockAllMedia:e.blockAllMedia,maskAllText:e.maskAllText,maskAllInputs:e.maskAllInputs,useCompression:!!t.eventBuffer&&"worker"===t.eventBuffer.type,networkDetailHasUrls:e.networkDetailAllowUrls.length>0,networkCaptureBodies:e.networkCaptureBodies,networkRequestHasHeaders:e.networkRequestHeaders.length>0,networkResponseHasHeaders:e.networkResponseHeaders.length>0}}}}(t),!1)}(t,n),t.session&&t.session.previousSessionId)return!0;if("buffer"===t.recordingMode&&t.session&&t.eventBuffer){const e=t.eventBuffer.getEarliestTimestamp();e&&(t.session.started=e,t.getOptions().stickySession&&Ss(t.session))}const e=t.getOptions();return e._experiments.delayFlushOnCheckout?(setTimeout((()=>t.conditionalFlush()),e._experiments.delayFlushOnCheckout),t.cancelFlush(),!0):("session"===t.recordingMode&&t.flushImmediate(),!0)}))}}class ua extends Error{constructor(t){super(`Transport returned status code ${t}`)}}async function ca(t,e={count:0,interval:5e3}){const{recordingData:i,options:r}=t;if(i.length)try{return await async function({recordingData:t,replayId:e,segmentId:i,eventContext:r,timestamp:n,session:s}){const a=function({recordingData:t,headers:e}){let i;const r=`${JSON.stringify(e)}\n`;if("string"==typeof t)i=`${r}${t}`;else{const e=(new TextEncoder).encode(r);i=new Uint8Array(e.length+t.length),i.set(e),i.set(t,e.length)}return i}({recordingData:t,headers:{segment_id:i}}),{urls:o,errorIds:l,traceIds:h,initialTimestamp:u}=r,c=ct(),d=c.getClient(),p=c.getScope(),f=d&&d.getTransport(),m=d&&d.getDsn();if(!(d&&p&&f&&m&&s.sampled))return;const g={type:"replay_event",replay_start_timestamp:u/1e3,timestamp:n/1e3,error_ids:l,trace_ids:h,urls:o,replay_id:e,segment_id:i,replay_type:s.sampled},_=await async function({client:t,scope:e,replayId:i,event:r}){const n="object"!=typeof t._integrations||null===t._integrations||Array.isArray(t._integrations)?void 0:Object.keys(t._integrations),s=await qe(t.getOptions(),r,{event_id:i,integrations:n},e);if(!s)return null;s.platform=s.platform||"javascript";const a=t.getSdkMetadata&&t.getSdkMetadata(),{name:o,version:l}=a&&a.sdk||{};return s.sdk={...s.sdk,name:o||"sentry.javascript.unknown",version:l||"0.0.0"},s}({scope:p,client:d,replayId:e,event:g});if(!_)return d.recordDroppedEvent("event_processor","replay",g),void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("An event processor returned `null`, will not send event."));const y=function(t,e,i,r){return be(Me(t,Ce(t),r,i),[[{type:"replay_event"},t],[{type:"replay_recording",length:"string"==typeof e?(new TextEncoder).encode(e).length:e.length},e]])}(_,a,m,d.getOptions().tunnel);let v;try{v=await f.send(y)}catch(t){const e=new Error(xr);try{e.cause=t}catch(t){}throw e}if(!v)return v;if("number"==typeof v.statusCode&&(v.statusCode<200||v.statusCode>=300))throw new ua(v.statusCode);return v}(t),!0}catch(i){if(i instanceof ua)throw i;if(xt("Replays",{_retryCount:e.count}),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&r._experiments&&r._experiments.captureExceptions&&mt(i),e.count>=3){const t=new Error("Unable to send Replay - max retries exceeded");try{t.cause=i}catch(t){}throw t}return e.interval*=++e.count,await new Promise(((i,r)=>{setTimeout((async()=>{try{await ca(t,e),i(!0)}catch(t){r(t)}}),e.interval)}))}}const da="__THROTTLED";class pa{__init(){this.eventBuffer=null}__init2(){this.performanceEvents=[]}__init3(){this.recordingMode="session"}__init4(){this.timeouts={sessionIdlePause:3e5,sessionIdleExpire:9e5,maxSessionLife:36e5}}__init5(){this._performanceObserver=null}__init6(){this._flushLock=null}__init7(){this._lastActivity=Date.now()}__init8(){this._isEnabled=!1}__init9(){this._isPaused=!1}__init10(){this._hasInitializedCoreListeners=!1}__init11(){this._stopRecording=null}__init12(){this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""}}constructor({options:t,recordingOptions:e}){pa.prototype.__init.call(this),pa.prototype.__init2.call(this),pa.prototype.__init3.call(this),pa.prototype.__init4.call(this),pa.prototype.__init5.call(this),pa.prototype.__init6.call(this),pa.prototype.__init7.call(this),pa.prototype.__init8.call(this),pa.prototype.__init9.call(this),pa.prototype.__init10.call(this),pa.prototype.__init11.call(this),pa.prototype.__init12.call(this),pa.prototype.__init13.call(this),pa.prototype.__init14.call(this),pa.prototype.__init15.call(this),pa.prototype.__init16.call(this),pa.prototype.__init17.call(this),pa.prototype.__init18.call(this),this._recordingOptions=e,this._options=t,this._debouncedFlush=function(t,e,i){let r,n,s;const a=i&&i.maxWait?Math.max(i.maxWait,e):0;function o(){return l(),r=t(),r}function l(){void 0!==n&&clearTimeout(n),void 0!==s&&clearTimeout(s),n=s=void 0}function h(){return n&&clearTimeout(n),n=setTimeout(o,e),a&&void 0===s&&(s=setTimeout(o,a)),r}return h.cancel=l,h.flush=function(){return void 0!==n||void 0!==s?o():r},h}((()=>this._flush()),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay}),this._throttledAddEvent=function(t,e,i){const r=new Map;let n=!1;return(...s)=>{const a=Math.floor(Date.now()/1e3);if((t=>{const e=t-i;r.forEach(((t,i)=>{i<e&&r.delete(i)}))})(a),[...r.values()].reduce(((t,e)=>t+e),0)>=e){const t=n;return n=!0,t?"__SKIPPED":da}n=!1;const o=r.get(a)||0;return r.set(a,o+1),t(...s)}}(((t,e)=>Rs(this,t,e)),300,5);const{slowClickTimeout:i,slowClickIgnoreSelectors:r}=this.getOptions(),n=i?{threshold:Math.min(3e3,i),timeout:i,scrollTimeout:300,ignoreSelector:r?r.join(","):"",multiClickTimeout:1e3}:void 0;n&&(this.clickDetector=new ss(this,n))}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}getOptions(){return this._options}initializeSampling(){const{errorSampleRate:t,sessionSampleRate:e}=this._options;t<=0&&e<=0||this._loadAndCheckSession()&&(this.session?(this.session.sampled&&"session"!==this.session.sampled&&(this.recordingMode="buffer"),this._initializeRecording()):this._handleException(new Error("Unable to initialize and create session")))}start(){if(this._isEnabled&&"session"===this.recordingMode)throw new Error("Replay recording is already in progress");if(this._isEnabled&&"buffer"===this.recordingMode)throw new Error("Replay buffering is in progress, call `flush()` to save the replay");const t=this.session&&this.session.id,{session:e}=Is({timeouts:this.timeouts,stickySession:Boolean(this._options.stickySession),currentSession:this.session,sessionSampleRate:1,allowBuffering:!1});e.previousSessionId=t,this.session=e,this._initializeRecording()}startBuffering(){if(this._isEnabled)throw new Error("Replay recording is already in progress");const t=this.session&&this.session.id,{session:e}=Is({timeouts:this.timeouts,stickySession:Boolean(this._options.stickySession),currentSession:this.session,sessionSampleRate:0,allowBuffering:!0});e.previousSessionId=t,this.session=e,this.recordingMode="buffer",this._initializeRecording()}startRecording(){try{this._stopRecording=ts({...this._recordingOptions,..."buffer"===this.recordingMode&&{checkoutEveryNms:6e4},emit:ha(this),onMutation:this._onMutationHandler})}catch(t){this._handleException(t)}}stopRecording(){try{return this._stopRecording&&(this._stopRecording(),this._stopRecording=void 0),!0}catch(t){return this._handleException(t),!1}}async stop(t){if(this._isEnabled)try{if("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__){const e="[Replay] Stopping Replay"+(t?` triggered by ${t}`:"");(this.getOptions()._experiments.traceInternals?console.warn:U.log)(e)}this._isEnabled=!1,this._removeListeners(),this.stopRecording(),this._debouncedFlush.cancel(),"session"===this.recordingMode&&await this._flush({force:!0}),this.eventBuffer&&this.eventBuffer.destroy(),this.eventBuffer=null,e=this,function(){if("sessionStorage"in yr)try{yr.sessionStorage.removeItem(vr)}catch(t){}}(),e.session=void 0}catch(t){this._handleException(t)}var e}pause(){this._isPaused=!0,this.stopRecording()}resume(){this._loadAndCheckSession()&&(this._isPaused=!1,this.startRecording())}async sendBufferedReplayOrFlush({continueRecording:t=!0}={}){if("session"===this.recordingMode)return this.flushImmediate();const e=Date.now();await this.flushImmediate();const i=this.stopRecording();t&&i&&(this.recordingMode="session",this.session&&(this.session.shouldRefresh=!1,this._updateUserActivity(e),this._updateSessionActivity(e),this.session.started=e,this._maybeSaveSession()),this.startRecording())}addUpdate(t){const e=t();"buffer"!==this.recordingMode&&!0!==e&&this._debouncedFlush()}triggerUserActivity(){if(this._updateUserActivity(),this._stopRecording)this.checkAndHandleExpiredSession(),this._updateSessionActivity();else{if(!this._loadAndCheckSession())return;this.resume()}}updateUserActivity(){this._updateUserActivity(),this._updateSessionActivity()}conditionalFlush(){return"buffer"===this.recordingMode?Promise.resolve():this.flushImmediate()}flushImmediate(){return this._debouncedFlush(),this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){const t=this.getSessionId();if(this._lastActivity&&bs(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&"session"===this.session.sampled)this.pause();else if(this._loadAndCheckSession())return t===this.getSessionId()||(this._triggerFullSnapshot(),!1)}setInitialState(){const t=`${yr.location.pathname}${yr.location.hash}${yr.location.search}`,e=`${yr.location.origin}${t}`;this.performanceEvents=[],this._clearContext(),this._context.initialUrl=e,this._context.initialTimestamp=Date.now(),this._context.urls.push(e)}throttledAddEvent(t,e){const i=this._throttledAddEvent(t,e);if(i===da){const t=ls({category:"replay.throttled"});this.addUpdate((()=>{Rs(this,{type:Zr.Custom,timestamp:t.timestamp||0,data:{tag:"breadcrumb",payload:t,metric:!0}})}))}return i}getCurrentRoute(){const t=this.lastTransaction||ct().getScope().getTransaction();if(t&&["route","custom"].includes(t.metadata.source))return t.name}_initializeRecording(){this.setInitialState(),this._updateSessionActivity(),this.eventBuffer=function({useCompression:t}){if(t&&window.Worker)try{const t=function(){const t=new Blob(['/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */\nfunction t(t){let e=t.length;for(;--e>=0;)t[e]=0}const e=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),a=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),i=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),n=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=new Array(576);t(s);const r=new Array(60);t(r);const o=new Array(512);t(o);const l=new Array(256);t(l);const h=new Array(29);t(h);const d=new Array(30);function _(t,e,a,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=a,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}let f,c,u;function w(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}t(d);const m=t=>t<256?o[t]:o[256+(t>>>7)],b=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},g=(t,e,a)=>{t.bi_valid>16-a?(t.bi_buf|=e<<t.bi_valid&65535,b(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=a-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=a)},p=(t,e,a)=>{g(t,a[2*e],a[2*e+1])},k=(t,e)=>{let a=0;do{a|=1&t,t>>>=1,a<<=1}while(--e>0);return a>>>1},v=(t,e,a)=>{const i=new Array(16);let n,s,r=0;for(n=1;n<=15;n++)r=r+a[n-1]<<1,i[n]=r;for(s=0;s<=e;s++){let e=t[2*s+1];0!==e&&(t[2*s]=k(i[e]++,e))}},y=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},x=t=>{t.bi_valid>8?b(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},z=(t,e,a,i)=>{const n=2*e,s=2*a;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[a]},A=(t,e,a)=>{const i=t.heap[a];let n=a<<1;for(;n<=t.heap_len&&(n<t.heap_len&&z(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!z(e,i,t.heap[n],t.depth));)t.heap[a]=t.heap[n],a=n,n<<=1;t.heap[a]=i},E=(t,i,n)=>{let s,r,o,_,f=0;if(0!==t.sym_next)do{s=255&t.pending_buf[t.sym_buf+f++],s+=(255&t.pending_buf[t.sym_buf+f++])<<8,r=t.pending_buf[t.sym_buf+f++],0===s?p(t,r,i):(o=l[r],p(t,o+256+1,i),_=e[o],0!==_&&(r-=h[o],g(t,r,_)),s--,o=m(s),p(t,o,n),_=a[o],0!==_&&(s-=d[o],g(t,s,_)))}while(f<t.sym_next);p(t,256,i)},R=(t,e)=>{const a=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems;let r,o,l,h=-1;for(t.heap_len=0,t.heap_max=573,r=0;r<s;r++)0!==a[2*r]?(t.heap[++t.heap_len]=h=r,t.depth[r]=0):a[2*r+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=h<2?++h:0,a[2*l]=1,t.depth[l]=0,t.opt_len--,n&&(t.static_len-=i[2*l+1]);for(e.max_code=h,r=t.heap_len>>1;r>=1;r--)A(t,a,r);l=s;do{r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],A(t,a,1),o=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=o,a[2*l]=a[2*r]+a[2*o],t.depth[l]=(t.depth[r]>=t.depth[o]?t.depth[r]:t.depth[o])+1,a[2*r+1]=a[2*o+1]=l,t.heap[1]=l++,A(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const a=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,r=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,l=e.stat_desc.max_length;let h,d,_,f,c,u,w=0;for(f=0;f<=15;f++)t.bl_count[f]=0;for(a[2*t.heap[t.heap_max]+1]=0,h=t.heap_max+1;h<573;h++)d=t.heap[h],f=a[2*a[2*d+1]+1]+1,f>l&&(f=l,w++),a[2*d+1]=f,d>i||(t.bl_count[f]++,c=0,d>=o&&(c=r[d-o]),u=a[2*d],t.opt_len+=u*(f+c),s&&(t.static_len+=u*(n[2*d+1]+c)));if(0!==w){do{for(f=l-1;0===t.bl_count[f];)f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[l]--,w-=2}while(w>0);for(f=l;0!==f;f--)for(d=t.bl_count[f];0!==d;)_=t.heap[--h],_>i||(a[2*_+1]!==f&&(t.opt_len+=(f-a[2*_+1])*a[2*_],a[2*_+1]=f),d--)}})(t,e),v(a,h,t.bl_count)},Z=(t,e,a)=>{let i,n,s=-1,r=e[1],o=0,l=7,h=4;for(0===r&&(l=138,h=3),e[2*(a+1)+1]=65535,i=0;i<=a;i++)n=r,r=e[2*(i+1)+1],++o<l&&n===r||(o<h?t.bl_tree[2*n]+=o:0!==n?(n!==s&&t.bl_tree[2*n]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,s=n,0===r?(l=138,h=3):n===r?(l=6,h=3):(l=7,h=4))},U=(t,e,a)=>{let i,n,s=-1,r=e[1],o=0,l=7,h=4;for(0===r&&(l=138,h=3),i=0;i<=a;i++)if(n=r,r=e[2*(i+1)+1],!(++o<l&&n===r)){if(o<h)do{p(t,n,t.bl_tree)}while(0!=--o);else 0!==n?(n!==s&&(p(t,n,t.bl_tree),o--),p(t,16,t.bl_tree),g(t,o-3,2)):o<=10?(p(t,17,t.bl_tree),g(t,o-3,3)):(p(t,18,t.bl_tree),g(t,o-11,7));o=0,s=n,0===r?(l=138,h=3):n===r?(l=6,h=3):(l=7,h=4)}};let S=!1;const D=(t,e,a,i)=>{g(t,0+(i?1:0),3),x(t),b(t,a),b(t,~a),a&&t.pending_buf.set(t.window.subarray(e,e+a),t.pending),t.pending+=a};var T=(t,e,a,i)=>{let o,l,h=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,a=4093624447;for(e=0;e<=31;e++,a>>>=1)if(1&a&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),R(t,t.l_desc),R(t,t.d_desc),h=(t=>{let e;for(Z(t,t.dyn_ltree,t.l_desc.max_code),Z(t,t.dyn_dtree,t.d_desc.max_code),R(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*n[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),o=t.opt_len+3+7>>>3,l=t.static_len+3+7>>>3,l<=o&&(o=l)):o=l=a+5,a+4<=o&&-1!==e?D(t,e,a,i):4===t.strategy||l===o?(g(t,2+(i?1:0),3),E(t,s,r)):(g(t,4+(i?1:0),3),((t,e,a,i)=>{let s;for(g(t,e-257,5),g(t,a-1,5),g(t,i-4,4),s=0;s<i;s++)g(t,t.bl_tree[2*n[s]+1],3);U(t,t.dyn_ltree,e-1),U(t,t.dyn_dtree,a-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,h+1),E(t,t.dyn_ltree,t.dyn_dtree)),y(t),i&&x(t)},O={_tr_init:t=>{S||((()=>{let t,n,w,m,b;const g=new Array(16);for(w=0,m=0;m<28;m++)for(h[m]=w,t=0;t<1<<e[m];t++)l[w++]=m;for(l[w-1]=m,b=0,m=0;m<16;m++)for(d[m]=b,t=0;t<1<<a[m];t++)o[b++]=m;for(b>>=7;m<30;m++)for(d[m]=b<<7,t=0;t<1<<a[m]-7;t++)o[256+b++]=m;for(n=0;n<=15;n++)g[n]=0;for(t=0;t<=143;)s[2*t+1]=8,t++,g[8]++;for(;t<=255;)s[2*t+1]=9,t++,g[9]++;for(;t<=279;)s[2*t+1]=7,t++,g[7]++;for(;t<=287;)s[2*t+1]=8,t++,g[8]++;for(v(s,287,g),t=0;t<30;t++)r[2*t+1]=5,r[2*t]=k(t,5);f=new _(s,e,257,286,15),c=new _(r,a,0,30,15),u=new _(new Array(0),i,0,19,7)})(),S=!0),t.l_desc=new w(t.dyn_ltree,f),t.d_desc=new w(t.dyn_dtree,c),t.bl_desc=new w(t.bl_tree,u),t.bi_buf=0,t.bi_valid=0,y(t)},_tr_stored_block:D,_tr_flush_block:T,_tr_tally:(t,e,a)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=a,0===e?t.dyn_ltree[2*a]++:(t.matches++,e--,t.dyn_ltree[2*(l[a]+256+1)]++,t.dyn_dtree[2*m(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{g(t,2,3),p(t,256,s),(t=>{16===t.bi_valid?(b(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var F=(t,e,a,i)=>{let n=65535&t|0,s=t>>>16&65535|0,r=0;for(;0!==a;){r=a>2e3?2e3:a,a-=r;do{n=n+e[i++]|0,s=s+n|0}while(--r);n%=65521,s%=65521}return n|s<<16|0};const L=new Uint32Array((()=>{let t,e=[];for(var a=0;a<256;a++){t=a;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[a]=t}return e})());var N=(t,e,a,i)=>{const n=L,s=i+a;t^=-1;for(let a=i;a<s;a++)t=t>>>8^n[255&(t^e[a])];return-1^t},I={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},B={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:C,_tr_stored_block:H,_tr_flush_block:M,_tr_tally:j,_tr_align:K}=O,{Z_NO_FLUSH:P,Z_PARTIAL_FLUSH:Y,Z_FULL_FLUSH:G,Z_FINISH:X,Z_BLOCK:W,Z_OK:q,Z_STREAM_END:J,Z_STREAM_ERROR:Q,Z_DATA_ERROR:V,Z_BUF_ERROR:$,Z_DEFAULT_COMPRESSION:tt,Z_FILTERED:et,Z_HUFFMAN_ONLY:at,Z_RLE:it,Z_FIXED:nt,Z_DEFAULT_STRATEGY:st,Z_UNKNOWN:rt,Z_DEFLATED:ot}=B,lt=(t,e)=>(t.msg=I[e],e),ht=t=>2*t-(t>4?9:0),dt=t=>{let e=t.length;for(;--e>=0;)t[e]=0},_t=t=>{let e,a,i,n=t.w_size;e=t.hash_size,i=e;do{a=t.head[--i],t.head[i]=a>=n?a-n:0}while(--e);e=n,i=e;do{a=t.prev[--i],t.prev[i]=a>=n?a-n:0}while(--e)};let ft=(t,e,a)=>(e<<t.hash_shift^a)&t.hash_mask;const ct=t=>{const e=t.state;let a=e.pending;a>t.avail_out&&(a=t.avail_out),0!==a&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+a),t.next_out),t.next_out+=a,e.pending_out+=a,t.total_out+=a,t.avail_out-=a,e.pending-=a,0===e.pending&&(e.pending_out=0))},ut=(t,e)=>{M(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,ct(t.strm)},wt=(t,e)=>{t.pending_buf[t.pending++]=e},mt=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},bt=(t,e,a,i)=>{let n=t.avail_in;return n>i&&(n=i),0===n?0:(t.avail_in-=n,e.set(t.input.subarray(t.next_in,t.next_in+n),a),1===t.state.wrap?t.adler=F(t.adler,e,n,a):2===t.state.wrap&&(t.adler=N(t.adler,e,n,a)),t.next_in+=n,t.total_in+=n,n)},gt=(t,e)=>{let a,i,n=t.max_chain_length,s=t.strstart,r=t.prev_length,o=t.nice_match;const l=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,h=t.window,d=t.w_mask,_=t.prev,f=t.strstart+258;let c=h[s+r-1],u=h[s+r];t.prev_length>=t.good_match&&(n>>=2),o>t.lookahead&&(o=t.lookahead);do{if(a=e,h[a+r]===u&&h[a+r-1]===c&&h[a]===h[s]&&h[++a]===h[s+1]){s+=2,a++;do{}while(h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&h[++s]===h[++a]&&s<f);if(i=258-(f-s),s=f-258,i>r){if(t.match_start=e,r=i,i>=o)break;c=h[s+r-1],u=h[s+r]}}}while((e=_[e&d])>l&&0!=--n);return r<=t.lookahead?r:t.lookahead},pt=t=>{const e=t.w_size;let a,i,n;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-262)&&(t.window.set(t.window.subarray(e,e+e-i),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),_t(t),i+=e),0===t.strm.avail_in)break;if(a=bt(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=a,t.lookahead+t.insert>=3)for(n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=ft(t,t.ins_h,t.window[n+1]);t.insert&&(t.ins_h=ft(t,t.ins_h,t.window[n+3-1]),t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)},kt=(t,e)=>{let a,i,n,s=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,r=0,o=t.strm.avail_in;do{if(a=65535,n=t.bi_valid+42>>3,t.strm.avail_out<n)break;if(n=t.strm.avail_out-n,i=t.strstart-t.block_start,a>i+t.strm.avail_in&&(a=i+t.strm.avail_in),a>n&&(a=n),a<s&&(0===a&&e!==X||e===P||a!==i+t.strm.avail_in))break;r=e===X&&a===i+t.strm.avail_in?1:0,H(t,0,0,r),t.pending_buf[t.pending-4]=a,t.pending_buf[t.pending-3]=a>>8,t.pending_buf[t.pending-2]=~a,t.pending_buf[t.pending-1]=~a>>8,ct(t.strm),i&&(i>a&&(i=a),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+i),t.strm.next_out),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i,t.block_start+=i,a-=i),a&&(bt(t.strm,t.strm.output,t.strm.next_out,a),t.strm.next_out+=a,t.strm.avail_out-=a,t.strm.total_out+=a)}while(0===r);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),r?4:e!==P&&e!==X&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(n=t.window_size-t.strstart,t.strm.avail_in>n&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,n+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),n>t.strm.avail_in&&(n=t.strm.avail_in),n&&(bt(t.strm,t.window,t.strstart,n),t.strstart+=n,t.insert+=n>t.w_size-t.insert?t.w_size-t.insert:n),t.high_water<t.strstart&&(t.high_water=t.strstart),n=t.bi_valid+42>>3,n=t.pending_buf_size-n>65535?65535:t.pending_buf_size-n,s=n>t.w_size?t.w_size:n,i=t.strstart-t.block_start,(i>=s||(i||e===X)&&e!==P&&0===t.strm.avail_in&&i<=n)&&(a=i>n?n:i,r=e===X&&0===t.strm.avail_in&&a===i?1:0,H(t,t.block_start,a,r),t.block_start+=a,ct(t.strm)),r?3:1)},vt=(t,e)=>{let a,i;for(;;){if(t.lookahead<262){if(pt(t),t.lookahead<262&&e===P)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==a&&t.strstart-a<=t.w_size-262&&(t.match_length=gt(t,a)),t.match_length>=3)if(i=j(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=ft(t,t.ins_h,t.window[t.strstart+1]);else i=j(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(ut(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===X?(ut(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ut(t,!1),0===t.strm.avail_out)?1:2},yt=(t,e)=>{let a,i,n;for(;;){if(t.lookahead<262){if(pt(t),t.lookahead<262&&e===P)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==a&&t.prev_length<t.max_lazy_match&&t.strstart-a<=t.w_size-262&&(t.match_length=gt(t,a),t.match_length<=5&&(t.strategy===et||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-3,i=j(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=n&&(t.ins_h=ft(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(ut(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=j(t,0,t.window[t.strstart-1]),i&&ut(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=j(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===X?(ut(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ut(t,!1),0===t.strm.avail_out)?1:2};function xt(t,e,a,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=a,this.max_chain=i,this.func=n}const zt=[new xt(0,0,0,0,kt),new xt(4,4,8,4,vt),new xt(4,5,16,8,vt),new xt(4,6,32,32,vt),new xt(4,4,16,16,yt),new xt(8,16,32,32,yt),new xt(8,16,128,128,yt),new xt(8,32,128,256,yt),new xt(32,128,258,1024,yt),new xt(32,258,258,4096,yt)];function At(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ot,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),dt(this.dyn_ltree),dt(this.dyn_dtree),dt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),dt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),dt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Et=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||42!==e.status&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&113!==e.status&&666!==e.status?1:0},Rt=t=>{if(Et(t))return lt(t,Q);t.total_in=t.total_out=0,t.data_type=rt;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=-2,C(e),q},Zt=t=>{const e=Rt(t);var a;return e===q&&((a=t.state).window_size=2*a.w_size,dt(a.head),a.max_lazy_match=zt[a.level].max_lazy,a.good_match=zt[a.level].good_length,a.nice_match=zt[a.level].nice_length,a.max_chain_length=zt[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=2,a.match_available=0,a.ins_h=0),e},Ut=(t,e,a,i,n,s)=>{if(!t)return Q;let r=1;if(e===tt&&(e=6),i<0?(r=0,i=-i):i>15&&(r=2,i-=16),n<1||n>9||a!==ot||i<8||i>15||e<0||e>9||s<0||s>nt||8===i&&1!==r)return lt(t,Q);8===i&&(i=9);const o=new At;return t.state=o,o.strm=t,o.status=42,o.wrap=r,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=e,o.strategy=s,o.method=a,Zt(t)};var St={deflateInit:(t,e)=>Ut(t,e,ot,15,8,st),deflateInit2:Ut,deflateReset:Zt,deflateResetKeep:Rt,deflateSetHeader:(t,e)=>Et(t)||2!==t.state.wrap?Q:(t.state.gzhead=e,q),deflate:(t,e)=>{if(Et(t)||e>W||e<0)return t?lt(t,Q):Q;const a=t.state;if(!t.output||0!==t.avail_in&&!t.input||666===a.status&&e!==X)return lt(t,0===t.avail_out?$:Q);const i=a.last_flush;if(a.last_flush=e,0!==a.pending){if(ct(t),0===t.avail_out)return a.last_flush=-1,q}else if(0===t.avail_in&&ht(e)<=ht(i)&&e!==X)return lt(t,$);if(666===a.status&&0!==t.avail_in)return lt(t,$);if(42===a.status&&0===a.wrap&&(a.status=113),42===a.status){let e=ot+(a.w_bits-8<<4)<<8,i=-1;if(i=a.strategy>=at||a.level<2?0:a.level<6?1:6===a.level?2:3,e|=i<<6,0!==a.strstart&&(e|=32),e+=31-e%31,mt(a,e),0!==a.strstart&&(mt(a,t.adler>>>16),mt(a,65535&t.adler)),t.adler=1,a.status=113,ct(t),0!==a.pending)return a.last_flush=-1,q}if(57===a.status)if(t.adler=0,wt(a,31),wt(a,139),wt(a,8),a.gzhead)wt(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),wt(a,255&a.gzhead.time),wt(a,a.gzhead.time>>8&255),wt(a,a.gzhead.time>>16&255),wt(a,a.gzhead.time>>24&255),wt(a,9===a.level?2:a.strategy>=at||a.level<2?4:0),wt(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(wt(a,255&a.gzhead.extra.length),wt(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(t.adler=N(t.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69;else if(wt(a,0),wt(a,0),wt(a,0),wt(a,0),wt(a,0),wt(a,9===a.level?2:a.strategy>=at||a.level<2?4:0),wt(a,3),a.status=113,ct(t),0!==a.pending)return a.last_flush=-1,q;if(69===a.status){if(a.gzhead.extra){let e=a.pending,i=(65535&a.gzhead.extra.length)-a.gzindex;for(;a.pending+i>a.pending_buf_size;){let n=a.pending_buf_size-a.pending;if(a.pending_buf.set(a.gzhead.extra.subarray(a.gzindex,a.gzindex+n),a.pending),a.pending=a.pending_buf_size,a.gzhead.hcrc&&a.pending>e&&(t.adler=N(t.adler,a.pending_buf,a.pending-e,e)),a.gzindex+=n,ct(t),0!==a.pending)return a.last_flush=-1,q;e=0,i-=n}let n=new Uint8Array(a.gzhead.extra);a.pending_buf.set(n.subarray(a.gzindex,a.gzindex+i),a.pending),a.pending+=i,a.gzhead.hcrc&&a.pending>e&&(t.adler=N(t.adler,a.pending_buf,a.pending-e,e)),a.gzindex=0}a.status=73}if(73===a.status){if(a.gzhead.name){let e,i=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>i&&(t.adler=N(t.adler,a.pending_buf,a.pending-i,i)),ct(t),0!==a.pending)return a.last_flush=-1,q;i=0}e=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,wt(a,e)}while(0!==e);a.gzhead.hcrc&&a.pending>i&&(t.adler=N(t.adler,a.pending_buf,a.pending-i,i)),a.gzindex=0}a.status=91}if(91===a.status){if(a.gzhead.comment){let e,i=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>i&&(t.adler=N(t.adler,a.pending_buf,a.pending-i,i)),ct(t),0!==a.pending)return a.last_flush=-1,q;i=0}e=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,wt(a,e)}while(0!==e);a.gzhead.hcrc&&a.pending>i&&(t.adler=N(t.adler,a.pending_buf,a.pending-i,i))}a.status=103}if(103===a.status){if(a.gzhead.hcrc){if(a.pending+2>a.pending_buf_size&&(ct(t),0!==a.pending))return a.last_flush=-1,q;wt(a,255&t.adler),wt(a,t.adler>>8&255),t.adler=0}if(a.status=113,ct(t),0!==a.pending)return a.last_flush=-1,q}if(0!==t.avail_in||0!==a.lookahead||e!==P&&666!==a.status){let i=0===a.level?kt(a,e):a.strategy===at?((t,e)=>{let a;for(;;){if(0===t.lookahead&&(pt(t),0===t.lookahead)){if(e===P)return 1;break}if(t.match_length=0,a=j(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,a&&(ut(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===X?(ut(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ut(t,!1),0===t.strm.avail_out)?1:2})(a,e):a.strategy===it?((t,e)=>{let a,i,n,s;const r=t.window;for(;;){if(t.lookahead<=258){if(pt(t),t.lookahead<=258&&e===P)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=t.strstart-1,i=r[n],i===r[++n]&&i===r[++n]&&i===r[++n])){s=t.strstart+258;do{}while(i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&i===r[++n]&&n<s);t.match_length=258-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(a=j(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(a=j(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),a&&(ut(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===X?(ut(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ut(t,!1),0===t.strm.avail_out)?1:2})(a,e):zt[a.level].func(a,e);if(3!==i&&4!==i||(a.status=666),1===i||3===i)return 0===t.avail_out&&(a.last_flush=-1),q;if(2===i&&(e===Y?K(a):e!==W&&(H(a,0,0,!1),e===G&&(dt(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),ct(t),0===t.avail_out))return a.last_flush=-1,q}return e!==X?q:a.wrap<=0?J:(2===a.wrap?(wt(a,255&t.adler),wt(a,t.adler>>8&255),wt(a,t.adler>>16&255),wt(a,t.adler>>24&255),wt(a,255&t.total_in),wt(a,t.total_in>>8&255),wt(a,t.total_in>>16&255),wt(a,t.total_in>>24&255)):(mt(a,t.adler>>>16),mt(a,65535&t.adler)),ct(t),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?q:J)},deflateEnd:t=>{if(Et(t))return Q;const e=t.state.status;return t.state=null,113===e?lt(t,V):q},deflateSetDictionary:(t,e)=>{let a=e.length;if(Et(t))return Q;const i=t.state,n=i.wrap;if(2===n||1===n&&42!==i.status||i.lookahead)return Q;if(1===n&&(t.adler=F(t.adler,e,a,0)),i.wrap=0,a>=i.w_size){0===n&&(dt(i.head),i.strstart=0,i.block_start=0,i.insert=0);let t=new Uint8Array(i.w_size);t.set(e.subarray(a-i.w_size,a),0),e=t,a=i.w_size}const s=t.avail_in,r=t.next_in,o=t.input;for(t.avail_in=a,t.next_in=0,t.input=e,pt(i);i.lookahead>=3;){let t=i.strstart,e=i.lookahead-2;do{i.ins_h=ft(i,i.ins_h,i.window[t+3-1]),i.prev[t&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=t,t++}while(--e);i.strstart=t,i.lookahead=2,pt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=r,t.input=o,t.avail_in=s,i.wrap=n,q},deflateInfo:"pako deflate (from Nodeca project)"};const Dt=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Tt=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const a=e.shift();if(a){if("object"!=typeof a)throw new TypeError(a+"must be non-object");for(const e in a)Dt(a,e)&&(t[e]=a[e])}}return t},Ot=t=>{let e=0;for(let a=0,i=t.length;a<i;a++)e+=t[a].length;const a=new Uint8Array(e);for(let e=0,i=0,n=t.length;e<n;e++){let n=t[e];a.set(n,i),i+=n.length}return a};let Ft=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Ft=!1}const Lt=new Uint8Array(256);for(let t=0;t<256;t++)Lt[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Lt[254]=Lt[254]=1;var Nt=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,a,i,n,s,r=t.length,o=0;for(n=0;n<r;n++)a=t.charCodeAt(n),55296==(64512&a)&&n+1<r&&(i=t.charCodeAt(n+1),56320==(64512&i)&&(a=65536+(a-55296<<10)+(i-56320),n++)),o+=a<128?1:a<2048?2:a<65536?3:4;for(e=new Uint8Array(o),s=0,n=0;s<o;n++)a=t.charCodeAt(n),55296==(64512&a)&&n+1<r&&(i=t.charCodeAt(n+1),56320==(64512&i)&&(a=65536+(a-55296<<10)+(i-56320),n++)),a<128?e[s++]=a:a<2048?(e[s++]=192|a>>>6,e[s++]=128|63&a):a<65536?(e[s++]=224|a>>>12,e[s++]=128|a>>>6&63,e[s++]=128|63&a):(e[s++]=240|a>>>18,e[s++]=128|a>>>12&63,e[s++]=128|a>>>6&63,e[s++]=128|63&a);return e},It=(t,e)=>{const a=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let i,n;const s=new Array(2*a);for(n=0,i=0;i<a;){let e=t[i++];if(e<128){s[n++]=e;continue}let r=Lt[e];if(r>4)s[n++]=65533,i+=r-1;else{for(e&=2===r?31:3===r?15:7;r>1&&i<a;)e=e<<6|63&t[i++],r--;r>1?s[n++]=65533:e<65536?s[n++]=e:(e-=65536,s[n++]=55296|e>>10&1023,s[n++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&Ft)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let a="";for(let i=0;i<e;i++)a+=String.fromCharCode(t[i]);return a})(s,n)},Bt=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let a=e-1;for(;a>=0&&128==(192&t[a]);)a--;return a<0||0===a?e:a+Lt[t[a]]>e?a:e};var Ct=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Ht=Object.prototype.toString,{Z_NO_FLUSH:Mt,Z_SYNC_FLUSH:jt,Z_FULL_FLUSH:Kt,Z_FINISH:Pt,Z_OK:Yt,Z_STREAM_END:Gt,Z_DEFAULT_COMPRESSION:Xt,Z_DEFAULT_STRATEGY:Wt,Z_DEFLATED:qt}=B;function Jt(t){this.options=Tt({level:Xt,method:qt,chunkSize:16384,windowBits:15,memLevel:8,strategy:Wt},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ct,this.strm.avail_out=0;let a=St.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(a!==Yt)throw new Error(I[a]);if(e.header&&St.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?Nt(e.dictionary):"[object ArrayBuffer]"===Ht.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,a=St.deflateSetDictionary(this.strm,t),a!==Yt)throw new Error(I[a]);this._dict_set=!0}}function Qt(t,e){const a=new Jt(e);if(a.push(t,!0),a.err)throw a.msg||I[a.err];return a.result}Jt.prototype.push=function(t,e){const a=this.strm,i=this.options.chunkSize;let n,s;if(this.ended)return!1;for(s=e===~~e?e:!0===e?Pt:Mt,"string"==typeof t?a.input=Nt(t):"[object ArrayBuffer]"===Ht.call(t)?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;;)if(0===a.avail_out&&(a.output=new Uint8Array(i),a.next_out=0,a.avail_out=i),(s===jt||s===Kt)&&a.avail_out<=6)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else{if(n=St.deflate(a,s),n===Gt)return a.next_out>0&&this.onData(a.output.subarray(0,a.next_out)),n=St.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Yt;if(0!==a.avail_out){if(s>0&&a.next_out>0)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else if(0===a.avail_in)break}else this.onData(a.output)}return!0},Jt.prototype.onData=function(t){this.chunks.push(t)},Jt.prototype.onEnd=function(t){t===Yt&&(this.result=Ot(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Vt={Deflate:Jt,deflate:Qt,deflateRaw:function(t,e){return(e=e||{}).raw=!0,Qt(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,Qt(t,e)},constants:B};var $t=function(t,e){let a,i,n,s,r,o,l,h,d,_,f,c,u,w,m,b,g,p,k,v,y,x,z,A;const E=t.state;a=t.next_in,z=t.input,i=a+(t.avail_in-5),n=t.next_out,A=t.output,s=n-(e-t.avail_out),r=n+(t.avail_out-257),o=E.dmax,l=E.wsize,h=E.whave,d=E.wnext,_=E.window,f=E.hold,c=E.bits,u=E.lencode,w=E.distcode,m=(1<<E.lenbits)-1,b=(1<<E.distbits)-1;t:do{c<15&&(f+=z[a++]<<c,c+=8,f+=z[a++]<<c,c+=8),g=u[f&m];e:for(;;){if(p=g>>>24,f>>>=p,c-=p,p=g>>>16&255,0===p)A[n++]=65535&g;else{if(!(16&p)){if(0==(64&p)){g=u[(65535&g)+(f&(1<<p)-1)];continue e}if(32&p){E.mode=16191;break t}t.msg="invalid literal/length code",E.mode=16209;break t}k=65535&g,p&=15,p&&(c<p&&(f+=z[a++]<<c,c+=8),k+=f&(1<<p)-1,f>>>=p,c-=p),c<15&&(f+=z[a++]<<c,c+=8,f+=z[a++]<<c,c+=8),g=w[f&b];a:for(;;){if(p=g>>>24,f>>>=p,c-=p,p=g>>>16&255,!(16&p)){if(0==(64&p)){g=w[(65535&g)+(f&(1<<p)-1)];continue a}t.msg="invalid distance code",E.mode=16209;break t}if(v=65535&g,p&=15,c<p&&(f+=z[a++]<<c,c+=8,c<p&&(f+=z[a++]<<c,c+=8)),v+=f&(1<<p)-1,v>o){t.msg="invalid distance too far back",E.mode=16209;break t}if(f>>>=p,c-=p,p=n-s,v>p){if(p=v-p,p>h&&E.sane){t.msg="invalid distance too far back",E.mode=16209;break t}if(y=0,x=_,0===d){if(y+=l-p,p<k){k-=p;do{A[n++]=_[y++]}while(--p);y=n-v,x=A}}else if(d<p){if(y+=l+d-p,p-=d,p<k){k-=p;do{A[n++]=_[y++]}while(--p);if(y=0,d<k){p=d,k-=p;do{A[n++]=_[y++]}while(--p);y=n-v,x=A}}}else if(y+=d-p,p<k){k-=p;do{A[n++]=_[y++]}while(--p);y=n-v,x=A}for(;k>2;)A[n++]=x[y++],A[n++]=x[y++],A[n++]=x[y++],k-=3;k&&(A[n++]=x[y++],k>1&&(A[n++]=x[y++]))}else{y=n-v;do{A[n++]=A[y++],A[n++]=A[y++],A[n++]=A[y++],k-=3}while(k>2);k&&(A[n++]=A[y++],k>1&&(A[n++]=A[y++]))}break}}break}}while(a<i&&n<r);k=c>>3,a-=k,c-=k<<3,f&=(1<<c)-1,t.next_in=a,t.next_out=n,t.avail_in=a<i?i-a+5:5-(a-i),t.avail_out=n<r?r-n+257:257-(n-r),E.hold=f,E.bits=c};const te=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ee=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ae=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ie=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ne=(t,e,a,i,n,s,r,o)=>{const l=o.bits;let h,d,_,f,c,u,w=0,m=0,b=0,g=0,p=0,k=0,v=0,y=0,x=0,z=0,A=null;const E=new Uint16Array(16),R=new Uint16Array(16);let Z,U,S,D=null;for(w=0;w<=15;w++)E[w]=0;for(m=0;m<i;m++)E[e[a+m]]++;for(p=l,g=15;g>=1&&0===E[g];g--);if(p>g&&(p=g),0===g)return n[s++]=20971520,n[s++]=20971520,o.bits=1,0;for(b=1;b<g&&0===E[b];b++);for(p<b&&(p=b),y=1,w=1;w<=15;w++)if(y<<=1,y-=E[w],y<0)return-1;if(y>0&&(0===t||1!==g))return-1;for(R[1]=0,w=1;w<15;w++)R[w+1]=R[w]+E[w];for(m=0;m<i;m++)0!==e[a+m]&&(r[R[e[a+m]]++]=m);if(0===t?(A=D=r,u=20):1===t?(A=te,D=ee,u=257):(A=ae,D=ie,u=0),z=0,m=0,w=b,c=s,k=p,v=0,_=-1,x=1<<p,f=x-1,1===t&&x>852||2===t&&x>592)return 1;for(;;){Z=w-v,r[m]+1<u?(U=0,S=r[m]):r[m]>=u?(U=D[r[m]-u],S=A[r[m]-u]):(U=96,S=0),h=1<<w-v,d=1<<k,b=d;do{d-=h,n[c+(z>>v)+d]=Z<<24|U<<16|S|0}while(0!==d);for(h=1<<w-1;z&h;)h>>=1;if(0!==h?(z&=h-1,z+=h):z=0,m++,0==--E[w]){if(w===g)break;w=e[a+r[m]]}if(w>p&&(z&f)!==_){for(0===v&&(v=p),c+=b,k=w-v,y=1<<k;k+v<g&&(y-=E[k+v],!(y<=0));)k++,y<<=1;if(x+=1<<k,1===t&&x>852||2===t&&x>592)return 1;_=z&f,n[_]=p<<24|k<<16|c-s|0}}return 0!==z&&(n[c+z]=w-v<<24|64<<16|0),o.bits=p,0};const{Z_FINISH:se,Z_BLOCK:re,Z_TREES:oe,Z_OK:le,Z_STREAM_END:he,Z_NEED_DICT:de,Z_STREAM_ERROR:_e,Z_DATA_ERROR:fe,Z_MEM_ERROR:ce,Z_BUF_ERROR:ue,Z_DEFLATED:we}=B,me=16209,be=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function ge(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const pe=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<16180||e.mode>16211?1:0},ke=t=>{if(pe(t))return _e;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=16180,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,le},ve=t=>{if(pe(t))return _e;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,ke(t)},ye=(t,e)=>{let a;if(pe(t))return _e;const i=t.state;return e<0?(a=0,e=-e):(a=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?_e:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=a,i.wbits=e,ve(t))},xe=(t,e)=>{if(!t)return _e;const a=new ge;t.state=a,a.strm=t,a.window=null,a.mode=16180;const i=ye(t,e);return i!==le&&(t.state=null),i};let ze,Ae,Ee=!0;const Re=t=>{if(Ee){ze=new Int32Array(512),Ae=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(ne(1,t.lens,0,288,ze,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;ne(2,t.lens,0,32,Ae,0,t.work,{bits:5}),Ee=!1}t.lencode=ze,t.lenbits=9,t.distcode=Ae,t.distbits=5},Ze=(t,e,a,i)=>{let n;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(a-s.wsize,a),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),s.window.set(e.subarray(a-i,a-i+n),s.wnext),(i-=n)?(s.window.set(e.subarray(a-i,a),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0};var Ue={inflateReset:ve,inflateReset2:ye,inflateResetKeep:ke,inflateInit:t=>xe(t,15),inflateInit2:xe,inflate:(t,e)=>{let a,i,n,s,r,o,l,h,d,_,f,c,u,w,m,b,g,p,k,v,y,x,z=0;const A=new Uint8Array(4);let E,R;const Z=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(pe(t)||!t.output||!t.input&&0!==t.avail_in)return _e;a=t.state,16191===a.mode&&(a.mode=16192),r=t.next_out,n=t.output,l=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,h=a.hold,d=a.bits,_=o,f=l,x=le;t:for(;;)switch(a.mode){case 16180:if(0===a.wrap){a.mode=16192;break}for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(2&a.wrap&&35615===h){0===a.wbits&&(a.wbits=15),a.check=0,A[0]=255&h,A[1]=h>>>8&255,a.check=N(a.check,A,2,0),h=0,d=0,a.mode=16181;break}if(a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",a.mode=me;break}if((15&h)!==we){t.msg="unknown compression method",a.mode=me;break}if(h>>>=4,d-=4,y=8+(15&h),0===a.wbits&&(a.wbits=y),y>15||y>a.wbits){t.msg="invalid window size",a.mode=me;break}a.dmax=1<<a.wbits,a.flags=0,t.adler=a.check=1,a.mode=512&h?16189:16191,h=0,d=0;break;case 16181:for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(a.flags=h,(255&a.flags)!==we){t.msg="unknown compression method",a.mode=me;break}if(57344&a.flags){t.msg="unknown header flags set",a.mode=me;break}a.head&&(a.head.text=h>>8&1),512&a.flags&&4&a.wrap&&(A[0]=255&h,A[1]=h>>>8&255,a.check=N(a.check,A,2,0)),h=0,d=0,a.mode=16182;case 16182:for(;d<32;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.head&&(a.head.time=h),512&a.flags&&4&a.wrap&&(A[0]=255&h,A[1]=h>>>8&255,A[2]=h>>>16&255,A[3]=h>>>24&255,a.check=N(a.check,A,4,0)),h=0,d=0,a.mode=16183;case 16183:for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.head&&(a.head.xflags=255&h,a.head.os=h>>8),512&a.flags&&4&a.wrap&&(A[0]=255&h,A[1]=h>>>8&255,a.check=N(a.check,A,2,0)),h=0,d=0,a.mode=16184;case 16184:if(1024&a.flags){for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.length=h,a.head&&(a.head.extra_len=h),512&a.flags&&4&a.wrap&&(A[0]=255&h,A[1]=h>>>8&255,a.check=N(a.check,A,2,0)),h=0,d=0}else a.head&&(a.head.extra=null);a.mode=16185;case 16185:if(1024&a.flags&&(c=a.length,c>o&&(c=o),c&&(a.head&&(y=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(i.subarray(s,s+c),y)),512&a.flags&&4&a.wrap&&(a.check=N(a.check,i,c,s)),o-=c,s+=c,a.length-=c),a.length))break t;a.length=0,a.mode=16186;case 16186:if(2048&a.flags){if(0===o)break t;c=0;do{y=i[s+c++],a.head&&y&&a.length<65536&&(a.head.name+=String.fromCharCode(y))}while(y&&c<o);if(512&a.flags&&4&a.wrap&&(a.check=N(a.check,i,c,s)),o-=c,s+=c,y)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=16187;case 16187:if(4096&a.flags){if(0===o)break t;c=0;do{y=i[s+c++],a.head&&y&&a.length<65536&&(a.head.comment+=String.fromCharCode(y))}while(y&&c<o);if(512&a.flags&&4&a.wrap&&(a.check=N(a.check,i,c,s)),o-=c,s+=c,y)break t}else a.head&&(a.head.comment=null);a.mode=16188;case 16188:if(512&a.flags){for(;d<16;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(4&a.wrap&&h!==(65535&a.check)){t.msg="header crc mismatch",a.mode=me;break}h=0,d=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),t.adler=a.check=0,a.mode=16191;break;case 16189:for(;d<32;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}t.adler=a.check=be(h),h=0,d=0,a.mode=16190;case 16190:if(0===a.havedict)return t.next_out=r,t.avail_out=l,t.next_in=s,t.avail_in=o,a.hold=h,a.bits=d,de;t.adler=a.check=1,a.mode=16191;case 16191:if(e===re||e===oe)break t;case 16192:if(a.last){h>>>=7&d,d-=7&d,a.mode=16206;break}for(;d<3;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}switch(a.last=1&h,h>>>=1,d-=1,3&h){case 0:a.mode=16193;break;case 1:if(Re(a),a.mode=16199,e===oe){h>>>=2,d-=2;break t}break;case 2:a.mode=16196;break;case 3:t.msg="invalid block type",a.mode=me}h>>>=2,d-=2;break;case 16193:for(h>>>=7&d,d-=7&d;d<32;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if((65535&h)!=(h>>>16^65535)){t.msg="invalid stored block lengths",a.mode=me;break}if(a.length=65535&h,h=0,d=0,a.mode=16194,e===oe)break t;case 16194:a.mode=16195;case 16195:if(c=a.length,c){if(c>o&&(c=o),c>l&&(c=l),0===c)break t;n.set(i.subarray(s,s+c),r),o-=c,s+=c,l-=c,r+=c,a.length-=c;break}a.mode=16191;break;case 16196:for(;d<14;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(a.nlen=257+(31&h),h>>>=5,d-=5,a.ndist=1+(31&h),h>>>=5,d-=5,a.ncode=4+(15&h),h>>>=4,d-=4,a.nlen>286||a.ndist>30){t.msg="too many length or distance symbols",a.mode=me;break}a.have=0,a.mode=16197;case 16197:for(;a.have<a.ncode;){for(;d<3;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.lens[Z[a.have++]]=7&h,h>>>=3,d-=3}for(;a.have<19;)a.lens[Z[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,E={bits:a.lenbits},x=ne(0,a.lens,0,19,a.lencode,0,a.work,E),a.lenbits=E.bits,x){t.msg="invalid code lengths set",a.mode=me;break}a.have=0,a.mode=16198;case 16198:for(;a.have<a.nlen+a.ndist;){for(;z=a.lencode[h&(1<<a.lenbits)-1],m=z>>>24,b=z>>>16&255,g=65535&z,!(m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(g<16)h>>>=m,d-=m,a.lens[a.have++]=g;else{if(16===g){for(R=m+2;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(h>>>=m,d-=m,0===a.have){t.msg="invalid bit length repeat",a.mode=me;break}y=a.lens[a.have-1],c=3+(3&h),h>>>=2,d-=2}else if(17===g){for(R=m+3;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}h>>>=m,d-=m,y=0,c=3+(7&h),h>>>=3,d-=3}else{for(R=m+7;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}h>>>=m,d-=m,y=0,c=11+(127&h),h>>>=7,d-=7}if(a.have+c>a.nlen+a.ndist){t.msg="invalid bit length repeat",a.mode=me;break}for(;c--;)a.lens[a.have++]=y}}if(a.mode===me)break;if(0===a.lens[256]){t.msg="invalid code -- missing end-of-block",a.mode=me;break}if(a.lenbits=9,E={bits:a.lenbits},x=ne(1,a.lens,0,a.nlen,a.lencode,0,a.work,E),a.lenbits=E.bits,x){t.msg="invalid literal/lengths set",a.mode=me;break}if(a.distbits=6,a.distcode=a.distdyn,E={bits:a.distbits},x=ne(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,E),a.distbits=E.bits,x){t.msg="invalid distances set",a.mode=me;break}if(a.mode=16199,e===oe)break t;case 16199:a.mode=16200;case 16200:if(o>=6&&l>=258){t.next_out=r,t.avail_out=l,t.next_in=s,t.avail_in=o,a.hold=h,a.bits=d,$t(t,f),r=t.next_out,n=t.output,l=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,h=a.hold,d=a.bits,16191===a.mode&&(a.back=-1);break}for(a.back=0;z=a.lencode[h&(1<<a.lenbits)-1],m=z>>>24,b=z>>>16&255,g=65535&z,!(m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(b&&0==(240&b)){for(p=m,k=b,v=g;z=a.lencode[v+((h&(1<<p+k)-1)>>p)],m=z>>>24,b=z>>>16&255,g=65535&z,!(p+m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}h>>>=p,d-=p,a.back+=p}if(h>>>=m,d-=m,a.back+=m,a.length=g,0===b){a.mode=16205;break}if(32&b){a.back=-1,a.mode=16191;break}if(64&b){t.msg="invalid literal/length code",a.mode=me;break}a.extra=15&b,a.mode=16201;case 16201:if(a.extra){for(R=a.extra;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.length+=h&(1<<a.extra)-1,h>>>=a.extra,d-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=16202;case 16202:for(;z=a.distcode[h&(1<<a.distbits)-1],m=z>>>24,b=z>>>16&255,g=65535&z,!(m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(0==(240&b)){for(p=m,k=b,v=g;z=a.distcode[v+((h&(1<<p+k)-1)>>p)],m=z>>>24,b=z>>>16&255,g=65535&z,!(p+m<=d);){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}h>>>=p,d-=p,a.back+=p}if(h>>>=m,d-=m,a.back+=m,64&b){t.msg="invalid distance code",a.mode=me;break}a.offset=g,a.extra=15&b,a.mode=16203;case 16203:if(a.extra){for(R=a.extra;d<R;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}a.offset+=h&(1<<a.extra)-1,h>>>=a.extra,d-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){t.msg="invalid distance too far back",a.mode=me;break}a.mode=16204;case 16204:if(0===l)break t;if(c=f-l,a.offset>c){if(c=a.offset-c,c>a.whave&&a.sane){t.msg="invalid distance too far back",a.mode=me;break}c>a.wnext?(c-=a.wnext,u=a.wsize-c):u=a.wnext-c,c>a.length&&(c=a.length),w=a.window}else w=n,u=r-a.offset,c=a.length;c>l&&(c=l),l-=c,a.length-=c;do{n[r++]=w[u++]}while(--c);0===a.length&&(a.mode=16200);break;case 16205:if(0===l)break t;n[r++]=a.length,l--,a.mode=16200;break;case 16206:if(a.wrap){for(;d<32;){if(0===o)break t;o--,h|=i[s++]<<d,d+=8}if(f-=l,t.total_out+=f,a.total+=f,4&a.wrap&&f&&(t.adler=a.check=a.flags?N(a.check,n,f,r-f):F(a.check,n,f,r-f)),f=l,4&a.wrap&&(a.flags?h:be(h))!==a.check){t.msg="incorrect data check",a.mode=me;break}h=0,d=0}a.mode=16207;case 16207:if(a.wrap&&a.flags){for(;d<32;){if(0===o)break t;o--,h+=i[s++]<<d,d+=8}if(4&a.wrap&&h!==(4294967295&a.total)){t.msg="incorrect length check",a.mode=me;break}h=0,d=0}a.mode=16208;case 16208:x=he;break t;case me:x=fe;break t;case 16210:return ce;default:return _e}return t.next_out=r,t.avail_out=l,t.next_in=s,t.avail_in=o,a.hold=h,a.bits=d,(a.wsize||f!==t.avail_out&&a.mode<me&&(a.mode<16206||e!==se))&&Ze(t,t.output,t.next_out,f-t.avail_out),_-=t.avail_in,f-=t.avail_out,t.total_in+=_,t.total_out+=f,a.total+=f,4&a.wrap&&f&&(t.adler=a.check=a.flags?N(a.check,n,f,t.next_out-f):F(a.check,n,f,t.next_out-f)),t.data_type=a.bits+(a.last?64:0)+(16191===a.mode?128:0)+(16199===a.mode||16194===a.mode?256:0),(0===_&&0===f||e===se)&&x===le&&(x=ue),x},inflateEnd:t=>{if(pe(t))return _e;let e=t.state;return e.window&&(e.window=null),t.state=null,le},inflateGetHeader:(t,e)=>{if(pe(t))return _e;const a=t.state;return 0==(2&a.wrap)?_e:(a.head=e,e.done=!1,le)},inflateSetDictionary:(t,e)=>{const a=e.length;let i,n,s;return pe(t)?_e:(i=t.state,0!==i.wrap&&16190!==i.mode?_e:16190===i.mode&&(n=1,n=F(n,e,a,0),n!==i.check)?fe:(s=Ze(t,e,a,a),s?(i.mode=16210,ce):(i.havedict=1,le)))},inflateInfo:"pako inflate (from Nodeca project)"};var Se=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const De=Object.prototype.toString,{Z_NO_FLUSH:Te,Z_FINISH:Oe,Z_OK:Fe,Z_STREAM_END:Le,Z_NEED_DICT:Ne,Z_STREAM_ERROR:Ie,Z_DATA_ERROR:Be,Z_MEM_ERROR:Ce}=B;function He(t){this.options=Tt({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ct,this.strm.avail_out=0;let a=Ue.inflateInit2(this.strm,e.windowBits);if(a!==Fe)throw new Error(I[a]);if(this.header=new Se,Ue.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Nt(e.dictionary):"[object ArrayBuffer]"===De.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(a=Ue.inflateSetDictionary(this.strm,e.dictionary),a!==Fe)))throw new Error(I[a])}He.prototype.push=function(t,e){const a=this.strm,i=this.options.chunkSize,n=this.options.dictionary;let s,r,o;if(this.ended)return!1;for(r=e===~~e?e:!0===e?Oe:Te,"[object ArrayBuffer]"===De.call(t)?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(i),a.next_out=0,a.avail_out=i),s=Ue.inflate(a,r),s===Ne&&n&&(s=Ue.inflateSetDictionary(a,n),s===Fe?s=Ue.inflate(a,r):s===Be&&(s=Ne));a.avail_in>0&&s===Le&&a.state.wrap>0&&0!==t[a.next_in];)Ue.inflateReset(a),s=Ue.inflate(a,r);switch(s){case Ie:case Be:case Ne:case Ce:return this.onEnd(s),this.ended=!0,!1}if(o=a.avail_out,a.next_out&&(0===a.avail_out||s===Le))if("string"===this.options.to){let t=Bt(a.output,a.next_out),e=a.next_out-t,n=It(a.output,t);a.next_out=e,a.avail_out=i-e,e&&a.output.set(a.output.subarray(t,t+e),0),this.onData(n)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(s!==Fe||0!==o){if(s===Le)return s=Ue.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},He.prototype.onData=function(t){this.chunks.push(t)},He.prototype.onEnd=function(t){t===Fe&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ot(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};const{Deflate:Me,deflate:je,deflateRaw:Ke,gzip:Pe}=Vt;var Ye=Me,Ge=je,Xe=B;const We=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const e=this._hasEvents?",":"";this.deflate.push(e+t,Xe.Z_SYNC_FLUSH),this._hasEvents=!0}finish(){if(this.deflate.push("]",Xe.Z_FINISH),this.deflate.err)throw this.deflate.err;const t=this.deflate.result;return this._init(),t}_init(){this._hasEvents=!1,this.deflate=new Ye,this.deflate.push("[",Xe.Z_NO_FLUSH)}},qe={clear:()=>{We.clear()},addEvent:t=>We.addEvent(t),finish:()=>We.finish(),compress:t=>function(t){return Ge(t)}(t)};addEventListener("message",(function(t){const e=t.data.method,a=t.data.id,i=t.data.arg;if(e in qe&&"function"==typeof qe[e])try{const t=qe[e](i);postMessage({id:a,method:e,success:!0,response:t})}catch(t){postMessage({id:a,method:e,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});']);return URL.createObjectURL(t)}();("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Replay] Using compression worker");const e=new Worker(t);return new vs(e)}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Replay] Failed to create compression worker")}return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Replay] Using simple buffer"),new gs}({useCompression:this._options.useCompression}),this._removeListeners(),this._addListeners(),this._isEnabled=!0,this.startRecording()}_handleException(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("[Replay]",t),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&this._options._experiments&&this._options._experiments.captureExceptions&&mt(t)}_loadAndCheckSession(){const{type:t,session:e}=Is({timeouts:this.timeouts,stickySession:Boolean(this._options.stickySession),currentSession:this.session,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:this._options.errorSampleRate>0||"buffer"===this.recordingMode});"new"===t&&this.setInitialState();const i=this.getSessionId();return e.id!==i&&(e.previousSessionId=i),this.session=e,!!this.session.sampled||(this.stop("session unsampled"),!1)}_addListeners(){try{yr.document.addEventListener("visibilitychange",this._handleVisibilityChange),yr.addEventListener("blur",this._handleWindowBlur),yr.addEventListener("focus",this._handleWindowFocus),yr.addEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.addListeners(),this._hasInitializedCoreListeners||(function(t){const e=ct().getScope(),i=ct().getClient();e&&e.addScopeListener((t=>e=>{if(!t.isEnabled())return;const i=function(t){const e=t.getLastBreadcrumb&&t.getLastBreadcrumb();return ra!==e&&e?(ra=e,!e.category||["fetch","xhr","sentry.event","sentry.transaction"].includes(e.category)||e.category.startsWith("ui.")?null:"console"===e.category?function(t){const e=t.data&&t.data.arguments;if(!Array.isArray(e)||0===e.length)return ls(t);let i=!1;const r=e.map((t=>{if(!t)return t;if("string"==typeof t)return t.length>Er?(i=!0,`${t.slice(0,Er)}…`):t;if("object"==typeof t)try{const e=ye(t,7),r=JSON.stringify(e);if(r.length>Er){const t=Ys(r.slice(0,Er)),e=JSON.parse(t);return i=!0,e}return e}catch(t){}return t}));return ls({...t,data:{...t.data,arguments:r,...i?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}(e):ls(e)):null}(e);i&&es(t,i)})(t)),Gt("dom",(t=>e=>{if(!t.isEnabled())return;const i=function(t){const{target:e,message:i}=function(t){const e="click"===t.name;let i,r=null;try{r=e?is(t.event):rs(t.event),i=v(r,{maxStringLength:200})||"<unknown>"}catch(t){i="<unknown>"}return{target:r,message:i}}(t);return ls({category:`ui.${t.name}`,...ds(e,i)})}(e);if(!i)return;const r="click"===e.name,n=r&&e.event;var s,a,o;r&&t.clickDetector&&n&&!n.altKey&&!n.metaKey&&!n.ctrlKey&&(s=t.clickDetector,a=i,o=is(e.event),s.handleClick(a,o)),es(t,i)})(t)),Gt("history",function(t){return e=>{if(!t.isEnabled())return;const i=function(t){const{from:e,to:i}=t,r=Date.now()/1e3;return{type:"navigation.push",start:r,end:r,name:i,data:{previous:e}}}(e);null!==i&&(t.getContext().urls.push(i.name),t.triggerUserActivity(),t.addUpdate((()=>(Ps(t,[i]),!1))))}}(t)),ia(t),at(function(t,e=!1){const i=e?Os(t):void 0;return(e,r)=>{if(function(t){return"replay_event"===t.type}(e))return delete e.breadcrumbs,e;if(!Cs(e)&&!Ms(e))return e;if(function(t,e){return!(t.type||!t.exception||!t.exception.values||!t.exception.values.length)&&(!(!e.originalException||!e.originalException.__rrweb__)||t.exception.values.some((t=>!!(t.stacktrace&&t.stacktrace.frames&&t.stacktrace.frames.length)&&t.stacktrace.frames.some((t=>t.filename&&t.filename.includes("/rrweb/src/"))))))}(e,r)&&!t.getOptions()._experiments.captureExceptions)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Replay] Ignoring error from rrweb internals",e),null;const n=function(t,e){return"buffer"===t.recordingMode&&e.message!==xr&&!(!e.exception||e.type)&&Ts(t.getOptions().errorSampleRate)}(t,e);return(n||"session"===t.recordingMode)&&(e.tags={...e.tags,replayId:t.getSessionId()}),i&&i(e,{statusCode:200}),e}}(t,!na(i))),na(i)&&(i.on("afterSendEvent",Os(t)),i.on("createDsc",(e=>{const i=t.getSessionId();i&&t.isEnabled()&&"session"===t.recordingMode&&(e.replay_id=i)})),i.on("startTransaction",(e=>{t.lastTransaction=e})),i.on("finishTransaction",(e=>{t.lastTransaction=e})))}(this),this._hasInitializedCoreListeners=!0)}catch(t){this._handleException(t)}"PerformanceObserver"in yr&&(this._performanceObserver=function(t){const e=new PerformanceObserver((e=>{const i=function(t,e){const[i,r,n]=t.reduce(((t,e)=>("navigation"===e.entryType?t[0].push(e):"largest-contentful-paint"===e.entryType?t[1].push(e):t[2].push(e),t)),[[],[],[]]),s=[],a=[];let o=r.length?r[r.length-1]:void 0;return e.forEach((t=>{if("largest-contentful-paint"!==t.entryType)if("navigation"!==t.entryType)s.push(t);else{const e=t;t.duration>0&&!i.find(fs(e))&&!a.find(fs(e))&&a.push(e)}else(!o||o.startTime<t.startTime)&&(o=t)})),[...o?[o]:[],...i,...n,...s,...a].sort(((t,e)=>t.startTime-e.startTime))}(t.performanceEvents,e.getEntries());t.performanceEvents=i}));return["element","event","first-input","largest-contentful-paint","layout-shift","longtask","navigation","paint","resource"].forEach((t=>{try{e.observe({type:t,buffered:!0})}catch(t){}})),e}(this))}_removeListeners(){try{yr.document.removeEventListener("visibilitychange",this._handleVisibilityChange),yr.removeEventListener("blur",this._handleWindowBlur),yr.removeEventListener("focus",this._handleWindowFocus),yr.removeEventListener("keydown",this._handleKeyboardEvent),this.clickDetector&&this.clickDetector.removeListeners(),this._performanceObserver&&(this._performanceObserver.disconnect(),this._performanceObserver=null)}catch(t){this._handleException(t)}}__init13(){this._handleVisibilityChange=()=>{"visible"===yr.document.visibilityState?this._doChangeToForegroundTasks():this._doChangeToBackgroundTasks()}}__init14(){this._handleWindowBlur=()=>{const t=ls({category:"ui.blur"});this._doChangeToBackgroundTasks(t)}}__init15(){this._handleWindowFocus=()=>{const t=ls({category:"ui.focus"});this._doChangeToForegroundTasks(t)}}__init16(){this._handleKeyboardEvent=t=>{!function(t,e){if(!t.isEnabled())return;t.updateUserActivity();const i=function(t){const{metaKey:e,shiftKey:i,ctrlKey:r,altKey:n,key:s,target:a}=t;if(!a||function(t){return"INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable}(a)||!s)return null;const o=e||r||n,l=1===s.length;if(!o&&l)return null;const h=v(a,{maxStringLength:200})||"<unknown>";return ls({category:"ui.keyDown",message:h,data:{...ds(a,h).data,metaKey:e,shiftKey:i,ctrlKey:r,altKey:n,key:s}})}(e);i&&es(t,i)}(this,t)}}_doChangeToBackgroundTasks(t){if(!this.session)return;const e=Es(this.session,this.timeouts);t&&!e&&this._createCustomBreadcrumb(t),this.conditionalFlush()}_doChangeToForegroundTasks(t){this.session&&(this.checkAndHandleExpiredSession()?t&&this._createCustomBreadcrumb(t):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Replay] Document has become active, but session has expired"))}_triggerFullSnapshot(t=!0){try{("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Replay] Taking full rrweb snapshot"),ts.takeFullSnapshot(t)}catch(t){this._handleException(t)}}_updateUserActivity(t=Date.now()){this._lastActivity=t}_updateSessionActivity(t=Date.now()){this.session&&(this.session.lastActivity=t,this._maybeSaveSession())}_createCustomBreadcrumb(t){this.addUpdate((()=>{this.throttledAddEvent({type:Zr.Custom,timestamp:t.timestamp||0,data:{tag:"breadcrumb",payload:t}})}))}_addPerformanceEntries(){const t=[...this.performanceEvents];return this.performanceEvents=[],Promise.all(Ps(this,function(t){return t.map(oa).filter(Boolean)}(t)))}_clearContext(){this._context.errorIds.clear(),this._context.traceIds.clear(),this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session:t,eventBuffer:e}=this;if(!t||!e)return;if(t.segmentId)return;const i=e.getEarliestTimestamp();i&&i<this._context.initialTimestamp&&(this._context.initialTimestamp=i)}_popEventContext(){const t={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};return this._clearContext(),t}async _runFlush(){if(this.session&&this.eventBuffer){if(await this._addPerformanceEntries(),this.eventBuffer&&this.eventBuffer.hasEvents&&(await async function(t){try{return Promise.all(Ps(t,[sa(yr.performance.memory)]))}catch(t){return[]}}(this),this.eventBuffer))try{this._updateInitialTimestampFromEventBuffer();const t=await this.eventBuffer.finish(),e=this.session.id,i=this._popEventContext(),r=this.session.segmentId++;this._maybeSaveSession(),await ca({replayId:e,recordingData:t,segmentId:r,eventContext:i,session:this.session,options:this.getOptions(),timestamp:Date.now()})}catch(t){this._handleException(t),this.stop("sendReplay");const e=ct().getClient();e&&e.recordDroppedEvent("send_error","replay")}}else("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("[Replay] No session or eventBuffer found to flush.")}__init17(){this._flush=async({force:t=!1}={})=>{if(this._isEnabled||t)if(this.checkAndHandleExpiredSession())if(this.session){if(this._debouncedFlush.cancel(),!this._flushLock)return this._flushLock=this._runFlush(),await this._flushLock,void(this._flushLock=null);try{await this._flushLock}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error(t)}finally{this._debouncedFlush()}}else("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("[Replay] No session found to flush.");else("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.error("[Replay] Attempting to finish replay event after session expired.")}}_maybeSaveSession(){this.session&&this._options.stickySession&&Ss(this.session)}__init18(){this._onMutationHandler=t=>{const e=t.length,i=this._options.mutationLimit,r=i&&e>i;if(e>this._options.mutationBreadcrumbLimit||r){const t=ls({category:"replay.mutations",data:{count:e,limit:r}});this._createCustomBreadcrumb(t)}return!r||(this.stop("mutationLimit"),!1)}}}function fa(t,e,i,r){const n=[...t,..."string"==typeof r?r.split(","):[],...e];return void 0!==i&&("string"==typeof i&&n.push(`.${i}`),console.warn("[Replay] You are using a deprecated configuration item for privacy. Read the documentation on how to use the new privacy configuration.")),n.join(",")}function ma({mask:t,unmask:e,block:i,unblock:r,ignore:n,blockClass:s,blockSelector:a,maskTextClass:o,maskTextSelector:l,ignoreClass:h}){const u=fa(t,[".sentry-mask","[data-sentry-mask]"],o,l),c=fa(e,[".sentry-unmask","[data-sentry-unmask]"]),d={maskTextSelector:u,unmaskTextSelector:c,maskInputSelector:u,unmaskInputSelector:c,blockSelector:fa(i,[".sentry-block","[data-sentry-block]",'base[href="/"]'],s,a),unblockSelector:fa(r,[".sentry-unblock","[data-sentry-unblock]"]),ignoreSelector:fa(n,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'],h)};return s instanceof RegExp&&(d.blockClass=s),o instanceof RegExp&&(d.maskTextClass=o),d}function ga(){return"undefined"!=typeof window&&(!(0,_r.KV)()||"undefined"!=typeof process&&"renderer"===process.type)}const _a='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]',ya=["content-length","content-type","accept"];let va=!1;class xa{static __initStatic(){this.id="Replay"}__init(){this.name=xa.id}constructor({flushMinDelay:t=5e3,flushMaxDelay:e=5500,stickySession:i=!0,useCompression:r=!0,_experiments:n={},sessionSampleRate:s,errorSampleRate:a,maskAllText:o=!0,maskAllInputs:l=!0,blockAllMedia:h=!0,mutationBreadcrumbLimit:u=750,mutationLimit:c=1e4,slowClickTimeout:d=7e3,slowClickIgnoreSelectors:p=[],networkDetailAllowUrls:f=[],networkCaptureBodies:m=!0,networkRequestHeaders:g=[],networkResponseHeaders:_=[],mask:y=[],unmask:v=[],block:x=[],unblock:b=[],ignore:E=[],maskFn:T,beforeAddRecordingEvent:S,blockClass:w,blockSelector:A,maskInputOptions:I,maskTextClass:R,maskTextSelector:C,ignoreClass:M}={}){if(xa.prototype.__init.call(this),this._recordingOptions={maskAllInputs:l,maskAllText:o,maskInputOptions:{...I||{},password:!0},maskTextFn:T,maskInputFn:T,...ma({mask:y,unmask:v,block:x,unblock:b,ignore:E,blockClass:w,blockSelector:A,maskTextClass:R,maskTextSelector:C,ignoreClass:M}),slimDOMOptions:"all",inlineStylesheet:!0,inlineImages:!1,collectFonts:!0},this._initialOptions={flushMinDelay:t,flushMaxDelay:e,stickySession:i,sessionSampleRate:s,errorSampleRate:a,useCompression:r,blockAllMedia:h,maskAllInputs:l,maskAllText:o,mutationBreadcrumbLimit:u,mutationLimit:c,slowClickTimeout:d,slowClickIgnoreSelectors:p,networkDetailAllowUrls:f,networkCaptureBodies:m,networkRequestHeaders:ba(g),networkResponseHeaders:ba(_),beforeAddRecordingEvent:S,_experiments:n},"number"==typeof s&&(console.warn(`[Replay] You are passing \`sessionSampleRate\` to the Replay integration.\nThis option is deprecated and will be removed soon.\nInstead, configure \`replaysSessionSampleRate\` directly in the SDK init options, e.g.:\nSentry.init({ replaysSessionSampleRate: ${s} })`),this._initialOptions.sessionSampleRate=s),"number"==typeof a&&(console.warn(`[Replay] You are passing \`errorSampleRate\` to the Replay integration.\nThis option is deprecated and will be removed soon.\nInstead, configure \`replaysOnErrorSampleRate\` directly in the SDK init options, e.g.:\nSentry.init({ replaysOnErrorSampleRate: ${a} })`),this._initialOptions.errorSampleRate=a),this._initialOptions.blockAllMedia&&(this._recordingOptions.blockSelector=this._recordingOptions.blockSelector?`${this._recordingOptions.blockSelector},${_a}`:_a),this._isInitialized&&ga())throw new Error("Multiple Sentry Session Replay instances are not supported");this._isInitialized=!0}get _isInitialized(){return va}set _isInitialized(t){va=t}setupOnce(){ga()&&(this._setup(),setTimeout((()=>this._initialize())))}start(){this._replay&&this._replay.start()}startBuffering(){this._replay&&this._replay.startBuffering()}stop(){return this._replay?this._replay.stop():Promise.resolve()}flush(t){return this._replay&&this._replay.isEnabled()?this._replay.sendBufferedReplayOrFlush(t):Promise.resolve()}getReplayId(){if(this._replay&&this._replay.isEnabled())return this._replay.getSessionId()}_initialize(){this._replay&&this._replay.initializeSampling()}_setup(){const t=function(t){const e=ct().getClient(),i=e&&e.getOptions(),r={sessionSampleRate:0,errorSampleRate:0,...P(t)};return i?(null==t.sessionSampleRate&&null==t.errorSampleRate&&null==i.replaysSessionSampleRate&&null==i.replaysOnErrorSampleRate&&console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set."),"number"==typeof i.replaysSessionSampleRate&&(r.sessionSampleRate=i.replaysSessionSampleRate),"number"==typeof i.replaysOnErrorSampleRate&&(r.errorSampleRate=i.replaysOnErrorSampleRate),r):(console.warn("SDK client is not available."),r)}(this._initialOptions);this._replay=new pa({options:t,recordingOptions:this._recordingOptions})}}function ba(t){return[...ya,...t.map((t=>t.toLowerCase()))]}xa.__initStatic();const Ea="baggage",Ta=/^sentry-/;function Sa(t){return function(t){if(0!==Object.keys(t).length)return Object.entries(t).reduce(((t,[e,i],r)=>{const n=`${encodeURIComponent(e)}=${encodeURIComponent(i)}`,s=0===r?n:`${t},${n}`;return s.length>8192?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`Not adding key: ${e} with val: ${i} to baggage header due to exceeding baggage size limits.`),t):s}),"")}(Object.entries(t).reduce(((t,[e,i])=>(i&&(t[`sentry-${e}`]=i),t)),{}))}function wa(t){return t.split(",").map((t=>t.split("=").map((t=>decodeURIComponent(t.trim()))))).reduce(((t,[e,i])=>(t[e]=i,t)),{})}const Aa=_.n2,Ia=(t,e,i)=>{let r,n;return s=>{e.value>=0&&(s||i)&&(n=e.value-(r||0),(n||void 0===r)&&(r=e.value,e.delta=n,t(e)))}},Ra=()=>Aa.__WEB_VITALS_POLYFILL__?Aa.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||(()=>{const t=Aa.performance.timing,e=Aa.performance.navigation.type,i={entryType:"navigation",startTime:0,type:2==e?"back_forward":1===e?"reload":"navigate"};for(const e in t)"navigationStart"!==e&&"toJSON"!==e&&(i[e]=Math.max(t[e]-t.navigationStart,0));return i})()):Aa.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],Ca=()=>{const t=Ra();return t&&t.activationStart||0},Ma=(t,e)=>{const i=Ra();let r="navigate";return i&&(r=Aa.document.prerendering||Ca()>0?"prerender":i.type.replace(/_/g,"-")),{name:t,value:void 0===e?-1:e,rating:"good",delta:0,entries:[],id:`v3-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:r}},Oa=(t,e,i)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver((t=>{e(t.getEntries())}));return r.observe(Object.assign({type:t,buffered:!0},i||{})),r}}catch(t){}},Pa=(t,e)=>{const i=r=>{"pagehide"!==r.type&&"hidden"!==Aa.document.visibilityState||(t(r),e&&(removeEventListener("visibilitychange",i,!0),removeEventListener("pagehide",i,!0)))};addEventListener("visibilitychange",i,!0),addEventListener("pagehide",i,!0)};let ka=-1;const Da=()=>(ka<0&&(ka="hidden"!==Aa.document.visibilityState||Aa.document.prerendering?1/0:0,Pa((({timeStamp:t})=>{ka=t}),!0)),{get firstHiddenTime(){return ka}}),Na={};function La(t){return"number"==typeof t&&isFinite(t)}function Fa(t,{startTimestamp:e,...i}){return e&&t.startTimestamp>e&&(t.startTimestamp=e),t.startChild({startTimestamp:e,...i})}function Ba(t){return t/1e3}function Ua(){return Aa&&Aa.addEventListener&&Aa.performance}let Ga,Wa,ja=0,Ya={};function za(){const t=Ua();if(t&&Z.Z1){t.mark&&Aa.performance.mark("sentry-tracing-init"),(t=>{const e=Da(),i=Ma("FID");let r;const n=t=>{t.startTime<e.firstHiddenTime&&(i.value=t.processingStart-t.startTime,i.entries.push(t),r(!0))},s=t=>{t.forEach(n)},a=Oa("first-input",s);r=Ia((t=>{const e=t.entries.pop();if(!e)return;const i=Ba(Z.Z1),r=Ba(e.startTime);("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Measurements] Adding FID"),Ya.fid={value:t.value,unit:"millisecond"},Ya["mark.fid"]={value:i+r,unit:"second"}}),i),a&&Pa((()=>{s(a.takeRecords()),a.disconnect()}),!0)})();const e=(t=>{const e=Ma("CLS",0);let i,r=0,n=[];const s=t=>{t.forEach((t=>{if(!t.hadRecentInput){const s=n[0],a=n[n.length-1];r&&0!==n.length&&t.startTime-a.startTime<1e3&&t.startTime-s.startTime<5e3?(r+=t.value,n.push(t)):(r=t.value,n=[t]),r>e.value&&(e.value=r,e.entries=n,i&&i())}}))},a=Oa("layout-shift",s);if(a){i=Ia((t=>{const e=t.entries.pop();e&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Measurements] Adding CLS"),Ya.cls={value:t.value,unit:""},Wa=e)}),e);const t=()=>{s(a.takeRecords()),i(!0)};return Pa(t),t}})(),i=(t=>{const e=Da(),i=Ma("LCP");let r;const n=t=>{const n=t[t.length-1];if(n){const t=Math.max(n.startTime-Ca(),0);t<e.firstHiddenTime&&(i.value=t,i.entries=[n],r())}},s=Oa("largest-contentful-paint",n);if(s){r=Ia((t=>{const e=t.entries.pop();e&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Measurements] Adding LCP"),Ya.lcp={value:t.value,unit:"millisecond"},Ga=e)}),i);const t=()=>{Na[i.id]||(n(s.takeRecords()),s.disconnect(),Na[i.id]=!0,r(!0))};return["keydown","click"].forEach((e=>{addEventListener(e,t,{once:!0,capture:!0})})),Pa(t,!0),t}})();return()=>{e&&e(),i&&i()}}return()=>{}}function Ha(t,e,i,r,n,s){const a=s?e[s]:e[`${i}End`],o=e[`${i}Start`];o&&a&&Fa(t,{op:"browser",description:n||i,startTimestamp:r+Ba(o),endTimestamp:r+Ba(a)})}const Xa=["localhost",/^\/(?!\/)/],Va={traceFetch:!0,traceXHR:!0,tracingOrigins:Xa,tracePropagationTargets:Xa};function qa(t){const{traceFetch:e,traceXHR:i,tracePropagationTargets:r,tracingOrigins:n,shouldCreateSpanForRequest:s}={traceFetch:Va.traceFetch,traceXHR:Va.traceXHR,...t},a="function"==typeof s?s:t=>!0,o=t=>function(t,e){return T(t,e||Xa)}(t,r||n),l={};e&&Gt("fetch",(t=>{!function(t,e,i,r){if(!Rt()||!t.fetchData||!e(t.fetchData.url))return;if(t.endTimestamp){const e=t.fetchData.__span;if(!e)return;const i=r[e];if(i){if(t.response){i.setHttpStatus(t.response.status);const e=t.response&&t.response.headers&&t.response.headers.get("content-length"),r=parseInt(e);r>0&&i.setData("http.response_content_length",r)}else t.error&&i.setStatus("internal_error");i.finish(),delete r[e]}return}const n=ct().getScope(),s=n&&n.getSpan(),a=s&&s.transaction;if(s&&a){const{method:e,url:n}=t.fetchData,o=s.startChild({data:{url:n,type:"fetch","http.method":e},description:`${e} ${n}`,op:"http.client"});t.fetchData.__span=o.spanId,r[o.spanId]=o;const l=t.args[0];t.args[1]=t.args[1]||{};const h=t.args[1];i(t.fetchData.url)&&(h.headers=function(t,e,i,r){const n=Sa(e),s=i.toTraceparent(),a="undefined"!=typeof Request&&g(t,Request)?t.headers:r.headers;if(a){if("undefined"!=typeof Headers&&g(a,Headers)){const t=new Headers(a);return t.append("sentry-trace",s),n&&t.append(Ea,n),t}if(Array.isArray(a)){const t=[...a,["sentry-trace",s]];return n&&t.push([Ea,n]),t}{const t="baggage"in a?a.baggage:void 0,e=[];return Array.isArray(t)?e.push(...t):t&&e.push(t),n&&e.push(n),{...a,"sentry-trace":s,baggage:e.length>0?e.join(","):void 0}}}return{"sentry-trace":s,baggage:n}}(l,a.getDynamicSamplingContext(),o,h))}}(t,a,o,l)})),i&&Gt("xhr",(t=>{!function(t,e,i,r){const n=t.xhr,s=n&&n.__sentry_xhr_v2__;if(!Rt()||n&&n.__sentry_own_request__||!(n&&s&&e(s.url)))return;if(t.endTimestamp){const t=n.__sentry_xhr_span_id__;if(!t)return;const e=r[t];return void(e&&(e.setHttpStatus(s.status_code),e.finish(),delete r[t]))}const a=ct().getScope(),o=a&&a.getSpan(),l=o&&o.transaction;if(o&&l){const t=o.startChild({data:{...s.data,type:"xhr","http.method":s.method,url:s.url},description:`${s.method} ${s.url}`,op:"http.client"});if(n.__sentry_xhr_span_id__=t.spanId,r[n.__sentry_xhr_span_id__]=t,n.setRequestHeader&&i(s.url))try{n.setRequestHeader("sentry-trace",t.toTraceparent());const e=Sa(l.getDynamicSamplingContext());e&&n.setRequestHeader(Ea,e)}catch(t){}}}(t,a,o,l)}))}const Ka={...re,markBackgroundTransactions:!0,routingInstrumentation:function(t,e=!0,i=!0){if(!Aa||!Aa.location)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("Could not initialize routing instrumentation due to invalid location"));let r,n=Aa.location.href;e&&(r=t({name:Aa.location.pathname,startTimestamp:Z.Z1?Z.Z1/1e3:void 0,op:"pageload",metadata:{source:"url"}})),i&&Gt("history",(({to:e,from:i})=>{void 0===i&&n&&-1!==n.indexOf(e)?n=void 0:i!==e&&(n=void 0,r&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Tracing] Finishing current transaction with op: ${r.op}`),r.finish()),r=t({name:Aa.location.pathname,op:"navigation",metadata:{source:"url"}}))}))},startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...Va};class $a{__init(){this.name="BrowserTracing"}constructor(t){$a.prototype.__init.call(this),ce(),this.options={...Ka,...t},void 0!==this.options._experiments.enableLongTask&&(this.options.enableLongTask=this.options._experiments.enableLongTask),t&&!t.tracePropagationTargets&&t.tracingOrigins&&(this.options.tracePropagationTargets=t.tracingOrigins),this._collectWebVitals=za(),this.options.enableLongTask&&Oa("longtask",(t=>{for(const e of t){const t=$t();if(!t)return;const i=Ba(Z.Z1+e.startTime),r=Ba(e.duration);t.startChild({description:"Main UI thread blocked",op:"ui.long-task",startTimestamp:i,endTimestamp:i+r})}})),this.options._experiments.enableInteractions&&Oa("event",(t=>{for(const e of t){const t=$t();if(!t)return;if("click"===e.name){const i=Ba(Z.Z1+e.startTime),r=Ba(e.duration);t.startChild({description:v(e.target),op:`ui.interaction.${e.name}`,startTimestamp:i,endTimestamp:i+r})}}}),{durationThreshold:0})}setupOnce(t,e){this._getCurrentHub=e;const{routingInstrumentation:i,startTransactionOnLocationChange:r,startTransactionOnPageLoad:n,markBackgroundTransactions:s,traceFetch:a,traceXHR:o,tracePropagationTargets:l,shouldCreateSpanForRequest:h,_experiments:u}=this.options;i((t=>{const i=this._createRouteTransaction(t);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(i,t,e),i}),n,r),s&&(Aa&&Aa.document?Aa.document.addEventListener("visibilitychange",(()=>{const t=$t();if(Aa.document.hidden&&t){const e="cancelled";("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Tracing] Transaction: ${e} -> since tab moved to the background, op: ${t.op}`),t.status||t.setStatus(e),t.setTag("visibilitychange","document.hidden"),t.finish()}})):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn("[Tracing] Could not set up background tab detection due to lack of global document")),u.enableInteractions&&this._registerInteractionListener(),qa({traceFetch:a,traceXHR:o,tracePropagationTargets:l,shouldCreateSpanForRequest:h})}_createRouteTransaction(t){if(!this._getCurrentHub)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`[Tracing] Did not create ${t.op} transaction because _getCurrentHub is invalid.`));const{beforeNavigate:e,idleTimeout:i,finalTimeout:r,heartbeatInterval:n}=this.options,s="pageload"===t.op,a=s?Za("sentry-trace"):null,o=s?Za("baggage"):null,l=a?Ne(a):void 0,h=o?function(t){if(!u(t)&&!Array.isArray(t))return;let e={};if(Array.isArray(t))e=t.reduce(((t,e)=>({...t,...wa(e)})),{});else{if(!t)return;e=wa(t)}const i=Object.entries(e).reduce(((t,[e,i])=>(e.match(Ta)&&(t[e.slice("sentry-".length)]=i),t)),{});return Object.keys(i).length>0?i:void 0}(o):void 0,c={...t,...l,metadata:{...t.metadata,dynamicSamplingContext:l&&!h?{}:h},trimEnd:!0},d="function"==typeof e?e(c):c,p=void 0===d?{...c,sampled:!1}:d;p.metadata=p.name!==c.name?{...p.metadata,source:"custom"}:p.metadata,this._latestRouteName=p.name,this._latestRouteSource=p.metadata&&p.metadata.source,!1===p.sampled&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Tracing] Will not send ${p.op} transaction because of beforeNavigate.`),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Tracing] Starting ${p.op} transaction on scope`);const f=this._getCurrentHub(),{location:m}=Aa,g=ue(f,p,i,r,!0,{location:m},n);return g.registerBeforeFinishCallback((t=>{this._collectWebVitals(),function(t){const e=Ua();if(!e||!Aa.performance.getEntries||!Z.Z1)return;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Tracing] Adding & adjusting spans using Performance API");const i=Ba(Z.Z1),r=e.getEntries();let n,s;if(r.slice(ja).forEach((e=>{const r=Ba(e.startTime),a=Ba(e.duration);if(!("navigation"===t.op&&i+r<t.startTimestamp))switch(e.entryType){case"navigation":!function(t,e,i){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach((r=>{Ha(t,e,r,i)})),Ha(t,e,"secureConnection",i,"TLS/SSL","connectEnd"),Ha(t,e,"fetch",i,"cache","domainLookupStart"),Ha(t,e,"domainLookup",i,"DNS"),function(t,e,i){Fa(t,{op:"browser",description:"request",startTimestamp:i+Ba(e.requestStart),endTimestamp:i+Ba(e.responseEnd)}),Fa(t,{op:"browser",description:"response",startTimestamp:i+Ba(e.responseStart),endTimestamp:i+Ba(e.responseEnd)})}(t,e,i)}(t,e,i),n=i+Ba(e.responseStart),s=i+Ba(e.requestStart);break;case"mark":case"paint":case"measure":{!function(t,e,i,r,n){const s=n+i,a=s+r;Fa(t,{description:e.name,endTimestamp:a,op:e.entryType,startTimestamp:s})}(t,e,r,a,i);const n=Da(),s=e.startTime<n.firstHiddenTime;"first-paint"===e.name&&s&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Measurements] Adding FP"),Ya.fp={value:e.startTime,unit:"millisecond"}),"first-contentful-paint"===e.name&&s&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Measurements] Adding FCP"),Ya.fcp={value:e.startTime,unit:"millisecond"});break}case"resource":{const n=e.name.replace(Aa.location.origin,"");!function(t,e,i,r,n,s){if("xmlhttprequest"===e.initiatorType||"fetch"===e.initiatorType)return;const a={};"transferSize"in e&&(a["http.response_transfer_size"]=e.transferSize),"encodedBodySize"in e&&(a["http.response_content_length"]=e.encodedBodySize),"decodedBodySize"in e&&(a["http.decoded_response_content_length"]=e.decodedBodySize),"renderBlockingStatus"in e&&(a["resource.render_blocking_status"]=e.renderBlockingStatus);const o=s+r;Fa(t,{description:i,endTimestamp:o+n,op:e.initiatorType?`resource.${e.initiatorType}`:"resource.other",startTimestamp:o,data:a})}(t,e,n,r,a,i);break}}})),ja=Math.max(r.length-1,0),function(t){const e=Aa.navigator;if(!e)return;const i=e.connection;i&&(i.effectiveType&&t.setTag("effectiveConnectionType",i.effectiveType),i.type&&t.setTag("connectionType",i.type),La(i.rtt)&&(Ya["connection.rtt"]={value:i.rtt,unit:"millisecond"})),La(e.deviceMemory)&&t.setTag("deviceMemory",`${e.deviceMemory} GB`),La(e.hardwareConcurrency)&&t.setTag("hardwareConcurrency",String(e.hardwareConcurrency))}(t),"pageload"===t.op){"number"==typeof n&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Measurements] Adding TTFB"),Ya.ttfb={value:1e3*(n-t.startTimestamp),unit:"millisecond"},"number"==typeof s&&s<=n&&(Ya["ttfb.requestTime"]={value:1e3*(n-s),unit:"millisecond"})),["fcp","fp","lcp"].forEach((e=>{if(!Ya[e]||i>=t.startTimestamp)return;const r=Ya[e].value,n=i+Ba(r),s=Math.abs(1e3*(n-t.startTimestamp)),a=s-r;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Measurements] Normalized ${e} from ${r} to ${s} (${a})`),Ya[e].value=s}));const e=Ya["mark.fid"];e&&Ya.fid&&(Fa(t,{description:"first input delay",endTimestamp:e.value+Ba(Ya.fid.value),op:"ui.action",startTimestamp:e.value}),delete Ya["mark.fid"]),"fcp"in Ya||delete Ya.cls,Object.keys(Ya).forEach((e=>{t.setMeasurement(e,Ya[e].value,Ya[e].unit)})),function(t){Ga&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Measurements] Adding LCP Data"),Ga.element&&t.setTag("lcp.element",v(Ga.element)),Ga.id&&t.setTag("lcp.id",Ga.id),Ga.url&&t.setTag("lcp.url",Ga.url.trim().slice(0,200)),t.setTag("lcp.size",Ga.size)),Wa&&Wa.sources&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Measurements] Adding CLS Data"),Wa.sources.forEach(((e,i)=>t.setTag(`cls.source.${i+1}`,v(e.node)))))}(t)}Ga=void 0,Wa=void 0,Ya={}}(t)})),g}_registerInteractionListener(){let t;const e=()=>{const{idleTimeout:e,finalTimeout:i,heartbeatInterval:r}=this.options,n="ui.action.click",s=$t();if(s&&s.op&&["navigation","pageload"].includes(s.op))return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`[Tracing] Did not create ${n} transaction because a pageload or navigation transaction is in progress.`));if(t&&(t.setFinishReason("interactionInterrupted"),t.finish(),t=void 0),!this._getCurrentHub)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`[Tracing] Did not create ${n} transaction because _getCurrentHub is invalid.`));if(!this._latestRouteName)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.warn(`[Tracing] Did not create ${n} transaction because _latestRouteName is missing.`));const a=this._getCurrentHub(),{location:o}=Aa,l={name:this._latestRouteName,op:n,trimEnd:!0,metadata:{source:this._latestRouteSource||"url"}};t=ue(a,l,e,i,!0,{location:o},r)};["click"].forEach((t=>{addEventListener(t,e,{once:!1,capture:!0})}))}}function Za(t){const e=(i=`meta[name=${t}]`,y.document&&y.document.querySelector?y.document.querySelector(i):null);var i;return e?e.getAttribute("content"):null}function Qa(t,e){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.info(`[Offline]: ${t}`,e)}function Ja(t){return e=>{const i=t(e),r=e.createStore?e.createStore(e):void 0;let n,s=5e3;function a(t){r&&(n&&clearTimeout(n),n=setTimeout((async()=>{n=void 0;const t=await r.pop();t&&(Qa("Attempting to send previously queued event"),l(t).catch((t=>{Qa("Failed to retry sending",t)})))}),t),"number"!=typeof n&&n.unref&&n.unref())}function o(){n||(a(s),s=Math.min(2*s,36e5))}async function l(t){try{const e=await i.send(t);let r=100;if(e)if(e.headers&&e.headers["retry-after"])r=Oe(e.headers["retry-after"]);else if((e.statusCode||0)>=400)return e;return a(r),s=5e3,e}catch(i){if(r&&await function(t,i,r){return n=["replay_event","replay_recording","client_report"],!Te(t,((t,e)=>n.includes(e)))&&(!e.shouldStore||e.shouldStore(t,i,r));var n}(t,i,s))return await r.insert(t),o(),Qa("Error sending. Event queued",i),{};throw i}}return e.flushAtStartup&&o(),{send:l,flush:t=>i.flush(t)}}}function to(t){return new Promise(((e,i)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>i(t.error)}))}function eo(t){return to(t.getAllKeys())}function io(t){let e;function i(){return null==e&&(e=function(t,e){const i=indexedDB.open(t);i.onupgradeneeded=()=>i.result.createObjectStore(e);const r=to(i);return t=>r.then((i=>t(i.transaction(e,"readwrite").objectStore(e))))}(t.dbName||"sentry-offline",t.storeName||"queue")),e}return{insert:async e=>{try{const r=await we(e,t.textEncoder);await function(t,e,i){return t((t=>eo(t).then((r=>{if(!(r.length>=i))return t.put(e,Math.max(...r,0)+1),to(t.transaction)}))))}(i(),r,t.maxQueueSize||30)}catch(t){}},pop:async()=>{try{const e=await function(t){return t((t=>eo(t).then((e=>{if(0!==e.length)return to(t.get(e[0])).then((i=>(t.delete(e[0]),to(t.transaction).then((()=>i)))))}))))}(i());if(e)return function(t,e,i){let r="string"==typeof t?e.encode(t):t;function n(t){const e=r.subarray(0,t);return r=r.subarray(t+1),e}function s(){let t=r.indexOf(10);return t<0&&(t=r.length),JSON.parse(i.decode(n(t)))}const a=s(),o=[];for(;r.length;){const t=s(),e="number"==typeof t.length?t.length:void 0;o.push([t,e?n(e):s()])}return[a,o]}(e,t.textEncoder||new TextEncoder,t.textDecoder||new TextDecoder)}catch(t){}}}}function ro(t){return function(t){return e=>t({...e,createStore:io})}(Ja(t))}const no=function(t){let e=[],i={};return{add(t,r){for(;e.length>=20;){const t=e.shift();void 0!==t&&delete i[t]}i[t]&&this.delete(t),e.push(t),i[t]=r},clear(){i={},e=[]},get:t=>i[t],size:()=>e.length,delete(t){if(!i[t])return!1;delete i[t];for(let i=0;i<e.length;i++)if(e[i]===t){e.splice(i,1);break}return!0}}}(),so=1e6,ao=String(0);let oo="",lo="",ho="",uo=Ge.navigator&&Ge.navigator.userAgent||"",co="";const po=Ge.navigator&&Ge.navigator.language||Ge.navigator&&Ge.navigator.languages&&Ge.navigator.languages[0]||"",fo=Ge.navigator&&Ge.navigator.userAgentData;var mo;function go(t,e,i,r){if("transaction"!==t.type)throw new TypeError("Profiling events may only be attached to transactions, this should never occur.");const n=t.sdkProcessingMetadata.profile;if(null==n)throw new TypeError(`Cannot construct profiling event envelope without a valid profile. Got ${n} instead.`);if(!n.profile_id)throw new TypeError("Profile is missing profile_id");if(n.samples.length<=1)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Discarding profile because it contains less than 2 samples"),null;const s=function(t){const e=t&&t.contexts&&t.contexts.trace&&t.contexts.trace.trace_id;return"string"==typeof e&&32!==e.length&&("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Profiling] Invalid traceId: ${e} on profiled event`),"string"!=typeof e?"":e}(t),a=function(t){if(t&&t.sdk)return{name:t.sdk.name,version:t.sdk.version}}(i);!function(t,e){e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name||"unknown sdk",t.sdk.version=t.sdk.version||e.version||"unknown sdk version",t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]])}(t,i&&i.sdk);const o=function(t,e,i,r){const n=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:(new Date).toISOString(),...e&&{sdk:e},...!!i&&{dsn:fe(r)},..."transaction"===t.type&&n&&{trace:P({...n})}}}(t,a,r,e),l=function(t){return!("thread_metadata"in t)}(c=n)?function(t){let e,i=0;const r={samples:[],stacks:[],frames:[],thread_metadata:{[ao]:{name:"main"}}};if(!t.samples.length)return r;const n=t.samples[0].timestamp;for(let s=0;s<t.samples.length;s++){const a=t.samples[s];if(void 0===a.stackId){void 0===e&&(e=i,r.stacks[e]=[],i++),r.samples[s]={elapsed_since_start_ns:((a.timestamp-n)*so).toFixed(0),stack_id:e,thread_id:ao};continue}let o=t.stacks[a.stackId];const l=[];for(;o;){l.push(o.frameId);const e=t.frames[o.frameId];void 0===r.frames[o.frameId]&&(r.frames[o.frameId]={function:e.name,file:e.resourceId?t.resources[e.resourceId]:void 0,line:e.line,column:e.column}),o=void 0===o.parentId?void 0:t.stacks[o.parentId]}const h={elapsed_since_start_ns:((a.timestamp-n)*so).toFixed(0),stack_id:i,thread_id:ao};r.stacks[i]=l,r.samples[s]=h,i++}return r}(c):c,h="number"==typeof t.start_timestamp?1e3*t.start_timestamp:Date.now(),u="number"==typeof t.timestamp?1e3*t.timestamp:Date.now();var c;return be(o,[[{type:"profile"},{event_id:n.profile_id,timestamp:new Date(h).toISOString(),platform:"javascript",version:"1",release:t.release||"",environment:t.environment||Q,runtime:{name:"javascript",version:Ge.navigator.userAgent},os:{name:oo,version:lo,build_number:uo},device:{locale:po,model:co,manufacturer:uo,architecture:ho,is_emulator:!1},profile:l,transactions:[{name:t.transaction||"",id:t.event_id||G(),trace_id:s,active_thread_id:ao,relative_start_ns:"0",relative_end_ns:(1e6*(u-h)).toFixed(0)}]}]])}"object"==typeof(mo=fo)&&null!==mo&&"getHighEntropyValues"in mo&&fo.getHighEntropyValues(["architecture","model","platform","platformVersion","fullVersionList"]).then((t=>{if(oo=t.platform||"",ho=t.architecture||"",co=t.model||"",lo=t.platformVersion||"",t.fullVersionList&&t.fullVersionList.length>0){const e=t.fullVersionList[t.fullVersionList.length-1];uo=`${e.brand} ${e.version}`}})).catch((t=>{}));let _o=!1;function yo(t){return t?vo(t):(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Transaction is undefined, skipping profiling"),t)}function vo(t){const e=Ge.Profiler;if("function"!=typeof e)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Profiling is not supported by this browser, Profiler interface missing on window object."),t;if(!t.sampled)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Transaction is not sampled, skipping profiling"),t;if(_o)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Profiling has been disabled for the duration of the current user session."),t;const i=ct().getClient(),r=i&&i.getOptions(),n=r&&r.profilesSampleRate||0;if(void 0===n)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Profiling disabled, enable it by setting `profilesSampleRate` option to SDK init call."),t;if(Math.random()>n)return("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Skip profiling transaction due to sampling."),t;const s=Math.floor(3e3);let a;try{a=new e({sampleInterval:10,maxBufferSize:s})}catch(t){("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&(U.log("[Profiling] Failed to initialize the Profiling constructor, this is likely due to a missing 'Document-Policy': 'js-profiling' header."),U.log("[Profiling] Disabling profiling for current user session.")),_o=!0}if(!a)return t;("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Profiling] started profiling transaction: ${t.name||t.description}`);const o=G();let l=null;function h(){t&&a&&(l?("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] profile for:",t.name||t.description,"already exists, returning early"):a.stop().then((e=>{u&&(Ge.clearTimeout(u),u=void 0),("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Profiling] stopped profiling of transaction: ${t.name||t.description}`),e?e.samples.length<2||(l={...e,profile_id:o},function(t,e){const i=no.get(t);if(!i)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Couldn't find a transaction event for this profile, dropping it."));i.sdkProcessingMetadata=i.sdkProcessingMetadata||{},i.sdkProcessingMetadata&&!i.sdkProcessingMetadata.profile&&(i.sdkProcessingMetadata.profile=e);const r=ct().getClient();if(!r)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] getClient did not return a Client, removing profile from event and forwarding to next event processors."));const n=r.getDsn();if(!n)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] getDsn did not return a Dsn, removing profile from event and forwarding to next event processors."));const s=r.getTransport();if(!s)return void(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] getTransport did not return a Transport, removing profile from event and forwarding to next event processors."));("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Preparing envelope and sending a profiling event");const a=go(i,n);no.delete(t),a?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Envelope constructed, sending it"),s.send(a).then(null,(t=>{("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Error while sending event:",t)}))):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Failed to construct envelope")}(o,l)):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log(`[Profiling] profiler returned null profile for: ${t.name||t.description}`,"this may indicate an overlapping transaction or a call to stopProfiling with a profile title that was never started")})).catch((t=>(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] error while stopping profiler:",t),null))))}let u=Ge.setTimeout((()=>{("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] max profile duration elapsed, stopping profiling for:",t.name||t.description),h()}),3e4);const c=t.finish.bind(t);return t.finish=function(){return t?(h(),t.setContext("profile",{profile_id:o}),c()):c()},t}class xo{constructor(){xo.prototype.__init.call(this)}__init(){this.name="BrowserProfilingIntegration"}setupOnce(t){(function(){const t=ht();t.__SENTRY__?(t.__SENTRY__.extensions=t.__SENTRY__.extensions||{},t.__SENTRY__.extensions.startTransaction?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] startTransaction exists, patching it with profiling functionality..."),t.__SENTRY__.extensions.startTransaction=function(t){return function(e,i){const r=t.call(this,e,i);return void 0===r?(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Transaction is undefined, skipping profiling"),r):vo(r)}}(t.__SENTRY__.extensions.startTransaction)):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] startTransaction does not exists, profiling will not work. Make sure you import @sentry/tracing package before @sentry/profiling-node as import order matters.")):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Can't find main carrier, profiling won't work.")})(),t(this.handleGlobalEvent.bind(this))}handleGlobalEvent(t){const e=t.contexts&&t.contexts.profile&&t.contexts.profile.profile_id;return e&&"string"==typeof e&&(("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&U.log("[Profiling] Profiling event found, caching it."),no.add(e,t)),t}}let bo={};Ge.Sentry&&Ge.Sentry.Integrations&&(bo=Ge.Sentry.Integrations);const Eo={...bo,...r,...n}},8518:(t,e,i)=>{"use strict";function r(){return"undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&!!__SENTRY_BROWSER_BUNDLE__}function n(){return"npm"}i.d(e,{S:()=>n,n:()=>r})},1422:(t,e,i)=>{"use strict";i.d(e,{KV:()=>n,l$:()=>s});var r=i(8518);function n(){return!(0,r.n)()&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function s(t,e){return t.require(e)}t=i.hmd(t)},1170:(t,e,i)=>{"use strict";i.d(e,{Z1:()=>d,ph:()=>u,yW:()=>h});var r=i(1422),n=i(1235);t=i.hmd(t);const s=(0,n.Rf)(),a={nowSeconds:()=>Date.now()/1e3},o=(0,r.KV)()?function(){try{return(0,r.l$)(t,"perf_hooks").performance}catch(t){return}}():function(){const{performance:t}=s;if(t&&t.now)return{now:()=>t.now(),timeOrigin:Date.now()-t.now()}}(),l=void 0===o?a:{nowSeconds:()=>(o.timeOrigin+o.now())/1e3},h=a.nowSeconds.bind(a),u=l.nowSeconds.bind(l);let c;const d=(()=>{const{performance:t}=s;if(!t||!t.now)return void(c="none");const e=36e5,i=t.now(),r=Date.now(),n=t.timeOrigin?Math.abs(t.timeOrigin+i-r):e,a=n<e,o=t.timing&&t.timing.navigationStart,l="number"==typeof o?Math.abs(o+i-r):e;return a||l<e?n<=l?(c="timeOrigin",t.timeOrigin):(c="navigationStart",o):(c="dateNow",r)})()},1235:(t,e,i)=>{"use strict";function r(t){return t&&t.Math==Math?t:void 0}i.d(e,{Rf:()=>s,YO:()=>a,n2:()=>n});const n="object"==typeof globalThis&&r(globalThis)||"object"==typeof window&&r(window)||"object"==typeof self&&r(self)||"object"==typeof i.g&&r(i.g)||function(){return this}()||{};function s(){return n}function a(t,e,i){const r=i||n,s=r.__SENTRY__=r.__SENTRY__||{};return s[t]||(s[t]=e())}},3474:(t,e,i)=>{const{TextMetrics:r}=i(8687);function n(t){this.PIXIText=t,this.lastUpdateMillis=0}n.prototype.clear=function(){this.lastText=!1,this.PIXIText.text=""},n.prototype.setText=function(t){this.PIXIText.text=t},n.prototype.addText=function(t){if(t!==this.lastText){var e=(new Date).getTime();e-this.lastUpdateMillis>200&&(this.PIXIText.text=""),r.measureText(this.PIXIText.text+t+" ",this.PIXIText.style).lines.length>2&&(this.PIXIText.text=""),this.lastUpdateMillis=e,this.currentMultiplier=1,this.lastText=t,this.PIXIText.text+=t+" "}else this.multiply()},n.prototype.multiply=function(){this.currentMultiplier++;const t=this.PIXIText.text;if(this.currentMultiplier>2){const e=t.substring(0,t.lastIndexOf("x"));newText=e+"x"+this.currentMultiplier+". "}else newText=t+"x2. ";this.PIXIText.text=newText},t.exports=n},9969:(t,e,i)=>{const{Text:r,TextMetrics:n}=i(8687);t.exports={createTextBox(t,e,i,n,s){const a=new r(i,{fontFamily:"PixeloidSans",fontSize:s?.fontSize||this.defaultFontSize,fill:s?.fill?s?.fill:14540253,align:s?.align||"left",wordWrap:!!n,wordWrapWidth:8*n});return a.scale.x=.125,a.scale.y=.125,a.position.x=t,a.position.y=e,a.text=i,"right"!==s?.align||n||(a.anchor.x=1),a},lines:(t,e)=>n.measureText(t,e.style).lines}},5002:t=>{var e={};function i(t,e,i){this.x=t,this.y=e,this.z=i}i.prototype.dot2=function(t,e){return this.x*t+this.y*e},i.prototype.dot3=function(t,e,i){return this.x*t+this.y*e+this.z*i};var r=[new i(1,1,0),new i(-1,1,0),new i(1,-1,0),new i(-1,-1,0),new i(1,0,1),new i(-1,0,1),new i(1,0,-1),new i(-1,0,-1),new i(0,1,1),new i(0,-1,1),new i(0,1,-1),new i(0,-1,-1)],n=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],s=new Array(512),a=new Array(512);e.seed=function(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(var e=0;e<256;e++){var i;i=1&e?n[e]^255&t:n[e]^t>>8&255,s[e]=s[e+256]=i,a[e]=a[e+256]=r[i%12]}},e.seed(0);var o=.5*(Math.sqrt(3)-1),l=(3-Math.sqrt(3))/6,h=1/6;function u(t){return t*t*t*(t*(6*t-15)+10)}function c(t,e,i){return(1-i)*t+i*e}e.simplex2=function(t,e){var i,r,n=(t+e)*o,h=Math.floor(t+n),u=Math.floor(e+n),c=(h+u)*l,d=t-h+c,p=e-u+c;d>p?(i=1,r=0):(i=0,r=1);var f=d-i+l,m=p-r+l,g=d-1+2*l,_=p-1+2*l,y=a[(h&=255)+s[u&=255]],v=a[h+i+s[u+r]],x=a[h+1+s[u+1]],b=.5-d*d-p*p,E=.5-f*f-m*m,T=.5-g*g-_*_;return 70*((b<0?0:(b*=b)*b*y.dot2(d,p))+(E<0?0:(E*=E)*E*v.dot2(f,m))+(T<0?0:(T*=T)*T*x.dot2(g,_)))},e.simplex3=function(t,e,i){var r,n,o,l,u,c,d=.3333333333333333*(t+e+i),p=Math.floor(t+d),f=Math.floor(e+d),m=Math.floor(i+d),g=(p+f+m)*h,_=t-p+g,y=e-f+g,v=i-m+g;_>=y?y>=v?(r=1,n=0,o=0,l=1,u=1,c=0):_>=v?(r=1,n=0,o=0,l=1,u=0,c=1):(r=0,n=0,o=1,l=1,u=0,c=1):y<v?(r=0,n=0,o=1,l=0,u=1,c=1):_<v?(r=0,n=1,o=0,l=0,u=1,c=1):(r=0,n=1,o=0,l=1,u=1,c=0);var x=_-r+h,b=y-n+h,E=v-o+h,T=_-l+2*h,S=y-u+2*h,w=v-c+2*h,A=_-1+.5,I=y-1+.5,R=v-1+.5,C=a[(p&=255)+s[(f&=255)+s[m&=255]]],M=a[p+r+s[f+n+s[m+o]]],O=a[p+l+s[f+u+s[m+c]]],P=a[p+1+s[f+1+s[m+1]]],k=.6-_*_-y*y-v*v,D=.6-x*x-b*b-E*E,N=.6-T*T-S*S-w*w,L=.6-A*A-I*I-R*R;return 32*((k<0?0:(k*=k)*k*C.dot3(_,y,v))+(D<0?0:(D*=D)*D*M.dot3(x,b,E))+(N<0?0:(N*=N)*N*O.dot3(T,S,w))+(L<0?0:(L*=L)*L*P.dot3(A,I,R)))},e.perlin2=function(t,e){var i=Math.floor(t),r=Math.floor(e);t-=i,e-=r;var n=a[(i&=255)+s[r&=255]].dot2(t,e),o=a[i+s[r+1]].dot2(t,e-1),l=a[i+1+s[r]].dot2(t-1,e),h=a[i+1+s[r+1]].dot2(t-1,e-1),d=u(t);return c(c(n,l,d),c(o,h,d),u(e))},e.perlin3=function(t,e,i){var r=Math.floor(t),n=Math.floor(e),o=Math.floor(i);t-=r,e-=n,i-=o;var l=a[(r&=255)+s[(n&=255)+s[o&=255]]].dot3(t,e,i),h=a[r+s[n+s[o+1]]].dot3(t,e,i-1),d=a[r+s[n+1+s[o]]].dot3(t,e-1,i),p=a[r+s[n+1+s[o+1]]].dot3(t,e-1,i-1),f=a[r+1+s[n+s[o]]].dot3(t-1,e,i),m=a[r+1+s[n+s[o+1]]].dot3(t-1,e,i-1),g=a[r+1+s[n+1+s[o]]].dot3(t-1,e-1,i),_=a[r+1+s[n+1+s[o+1]]].dot3(t-1,e-1,i-1),y=u(t),v=u(e),x=u(i);return c(c(c(l,f,y),c(h,m,y),x),c(c(d,g,y),c(p,_,y),x),v)},t.exports=e},3774:t=>{function e(t,e,i,r){this.term=t,this.height=e,this.width=i,this.position=r,this.spaces="";for(var n=0;n<i;n++)this.spaces+=" "}e.prototype.draw=function(){for(var t=0;t<this.height;t++)this.term.putString(this.spaces,this.position.x,this.position.y+t,255,255,255)},t.exports=e},1792:(t,e,i)=>{const r=i(3774);function n(t,e,i,n,s,a=0){this.term=t,this.term=t,this.height=s,this.width=n,this.border=a,this.x=e,this.y=i,this.backgroundBox=new r(t,s+2*a,n+2*a,{x:e,y:i}),this.scrollingIndex=0}n.prototype={setData:function(t,e,i,r){this.data=t,this.displayFunction=e,this.iconFunction=i,this.leftMargin=r||0,this.scrollingIndex=0},draw:function(){this.backgroundBox.draw();const t=this.iconFunction?2:0,e=this.border;for(var i=0;i<this.height;i++){const r=this.data[this.scrollingIndex+i];if(r&&(this.term.putString(this.displayFunction(r),this.x+t+e+this.leftMargin,this.y+i+e,240,255,255),this.iconFunction)){const t=this.iconFunction(r);this.term.putString(t.character,this.x+e+this.leftMargin,this.y+i+e,t.r,t.g,t.b)}}},scrollUp(){0!==this.scrollingIndex&&this.scrollingIndex--},scrollDown(){this.scrollingIndex+this.height>=this.data.length-1||this.scrollingIndex++}},t.exports=n},4225:t=>{function e(t,e,i,r,n){this.display=n,this.term=t,this.curx=0,this.cury=0,this.height=e,this.width=i,this.currentMultiplier=1,this.lines=new Array,this.position=r;for(var s=0;s<e;s++)this.lines[s]="";for(this.spaces="",s=0;s<i;s++)this.spaces+=" ";this.lastUpdateMillis=0}e.prototype.draw=function(){for(var t=0;t<this.lines.length;t++)this.term.putString(this.lines[t],this.position.x,this.position.y+t,255,255,255)},e.prototype.overgrown=function(){return this.lines.length>this.height},e.prototype.checkFaint=function(){var t=(new Date).getTime();this.overgrown()&&t-this.lastUpdateMillis>200&&(this.clear(),this.display.refresh())},e.prototype.multiply=function(){this.currentMultiplier++;const t=this.lines[this.cury];let e;e=this.currentMultiplier>2?t.substring(0,t.lastIndexOf("x"))+"x"+this.currentMultiplier+". ":t+"x2. ",e.length>this.width?(this.curx=0,this.lines[this.cury]="",this.tokenize(e)):(this.curx=e.length-1,this.lines[this.cury]=e),this.display.refresh()},e.prototype.tokenize=function(t){for(var e=t.split(" "),i=0;i<e.length;i++)this.width-this.curx<e[i].length+1&&this.newLine(),this.lines[this.cury]||(this.lines[this.cury]=[]),this.lines[this.cury]+=e[i]+" ",this.curx+=e[i].length+1},e.prototype.addText=function(t){var e=(new Date).getTime();this.cury>=this.height-1&&(this.overflowed&&(this.clear(),this.display.refresh(),this.overflowed=!1),this.overflowed=!0),this.lastUpdateMillis=e,t!=this.lastText?(this.currentMultiplier=1,this.lastText=t,this.tokenize(t)):this.multiply()},e.prototype.newLine=function(){this.curx=0,this.cury++},e.prototype.setText=function(t){this.clear(),this.addText(t),this.draw(),this.term.render()},e.prototype.clear=function(){for(var t=0;t<this.lines.length;t++)this.lines[t]="",this.term.putString(this.spaces,this.position.x,this.position.y+t,255,255,255);this.lines.length=this.height,this.curx=0,this.cury=0,this.currentMultiplier=0,this.lastText=!1},t.exports=e},6288:(t,e,i)=>{var r=i(4225),n=(i(3774),i(1792));const s=i(6217).RecipesStore;var a=i(3945).default;const o=i(234),l=i(9242),h=i(6786),{InputMode:u}=i(9273),c=40,d=192,p=116,f={r:192,g:40,b:116},m={r:255,g:207,b:142};let g;function _(){if(!g)return;const t=document.getElementById("game"),e=g.height/g.width;innerWidth*e<=innerHeight?(g.style.width=innerWidth-40+"px",g.style.height=innerWidth*e-40+"px"):(g.style.width=1*innerHeight/e-40+"px",g.style.height=innerHeight-40+"px"),t.style.width=g.style.width,t.style.height=g.style.height}window.addEventListener("resize",_),t.exports={BLANK_TILE:new ut.Tile(" ",255,255,255),CURSOR_TILE:new ut.Tile("*",255,255,255),init:function(t,e){this.game=t,this.term=new ut.Viewport(document.getElementById("game"),80,25,"canvas"),g=this.term.renderer.canvas,this.eng=new ut.Engine(this.term,this.getDisplayedTile.bind(this),512,512),this.textBox=new r(this.term,2,80,{x:0,y:0},this),this.inventoryBox=new n(this.term,1,3,50,20,1),this.toolbox=new n(this.term,60,1,20,20,1),this.centered=e&&e.centered,this.camera={x:40,y:12,viewport:{x:2,y:2,w:60,h:20},deadZone:{left:20,right:8,bottom:5,top:5}},_()},getDisplayedTile:function(t,e){var i=this.game.world.level;if(t===i.player.x&&e===i.player.y)return i.player.getAppearance().tile;let r=t===i.player.x+i.player.dx&&e===i.player.y+i.player.dy,n=this.__getDisplayTile(t,e);if(r){const t=n.clone();return t.setBackground(55,55,55),t}return n},__coloredTilesCache:{},__coloredTile:function(t,e,i,r){const n=t.ch+"["+e+","+i+","+r+"]";if(this.__coloredTilesCache[n])return this.__coloredTilesCache[n];{const s=t.clone();return s.setColor(e,i,r),this.__coloredTilesCache[n]=s,s}},__getSeenApp(t,e,i){var r=this.game.world.level;if(!i&&r.beings[t]&&r.beings[t][e])return{baseApp:r.beings[t][e].app};if(r.items[t]&&r.items[t][e]){const i=r.items[t][e];return{baseApp:i.def.app,paintColor:i.paintColor}}if(r.getPlantAt(t,e)){const i=r.getPlantAt(t,e);return{baseApp:i.getApp(),paintColor:i.paintColor}}return r.getFlooringAt(t,e)?{baseApp:r.getFlooringAt(t,e).app,paintColor:r.getPaintColor(t,e)}:r.map[t]&&r.map[t][e]?{baseApp:r.map[t][e].app,paintColor:r.getPaintColor(t,e)}:null},__getDisplayTile:function(t,e){var i=this.game.world.level,r=t-i.player.x,n=e-i.player.y;if(i.player.canSee(r,n)){const r=this.__getSeenApp(t,e);if(!r)return ut.NULLTILE;r.baseApp.isBeing?i.player.remember(t,e,this.__getSeenApp(t,e,!0).baseApp):i.player.remember(t,e,r.baseApp);let n=r.baseApp.tile;return this.lightLevel<5?n=this.__coloredTile(n,20,68,145):r.paintColor&&(n=this.__coloredTile(n,r.paintColor.r,r.paintColor.g,r.paintColor.b)),n}const s=i.player.getRememberedApp(t,e);return s?this.__coloredTile(s.tile,21,60,74):ut.NULLTILE},refresh:function(){if(this.lightLevel=this.game.player.getLightLevel(),this.centered)this.eng.update(this.game.player.x,this.game.player.y);else{const t=this.game.player.x-this.camera.x,e=this.game.player.y-this.camera.y;e>this.camera.deadZone.top&&(this.camera.y=this.game.player.y-this.camera.deadZone.top),e<-this.camera.deadZone.bottom&&(this.camera.y=this.game.player.y+this.camera.deadZone.bottom),t>this.camera.deadZone.right&&(this.camera.x=this.game.player.x-this.camera.deadZone.right),t<-this.camera.deadZone.left&&(this.camera.x=this.game.player.x+this.camera.deadZone.left),this.eng.update(this.camera.x,this.camera.y)}this.textBox.draw(),this.toolbox.setData(this.game.player.items,(t=>t.getInventoryDescription()),(t=>t.iconAppearance)),this.toolbox.draw(),this.term.putString(">",this.toolbox.x-1,this.toolbox.y+this.game.player.currentToolIndex+1,255,0,0),this.term.putString("Day "+this.game.player.dayCounter+", "+this.__formatTimeOfDay(this.game.world.currentTime),1,3,255,255,255),this.print(this.game.player.orient(),2,4,a.NORMAL_WHITE),this.drawStatus(1,6),this.drawHelp(1,13),this.term.render()},drawHelp(t,e){const i=this.game.input.getContextualAction().shortDescription,r=this.game.player.currentTool;if(this.print("N: Sleep",t,e++,a.NORMAL_WHITE),this.print("Comma: Pick up",t,e++,a.NORMAL_WHITE),r&&(this.print("L: Examine   R: Drop",this.toolbox.x,this.toolbox.y+this.toolbox.height+1,a.NORMAL_WHITE),this.print("P: Plant     U: Use",this.toolbox.x,this.toolbox.y+this.toolbox.height+2,a.NORMAL_WHITE),this.print("Tab: Change",this.toolbox.x,this.toolbox.y+this.toolbox.height+3,a.NORMAL_WHITE)),r&&this.game.player.canMakeSeeds()&&this.print("T: Mash ",t,e++,a.NORMAL_WHITE),this.print("I: Imagine",t,e++,a.NORMAL_WHITE),this.game.player.canCook())this.print("M: Cook",t,e++,a.NORMAL_WHITE);else{const i=this.game.player.selectedRecipe;if(i){let r=i.verb||"Build";r=r.charAt(0).toUpperCase()+r.substr(1);const n=i.flooringId?Items.get(i.flooringId).name:Items.get(i.itemId).name;this.print("M: "+r,t,e++,a.NORMAL_WHITE),this.print(" "+n,t,e++,a.NORMAL_WHITE)}}this.game.player.farmMode?this.print("F: Explore Mode",t,e++,a.NORMAL_WHITE):(this.print("F: Work Mode",t,e++,a.NORMAL_WHITE),this.print("Shift+Dir: Turn",t,e++,a.NORMAL_WHITE)),this.print("G: Save Game",t,e++,a.NORMAL_WHITE),this.print("O: Orient",t,e++,a.NORMAL_WHITE),this.print("J: Journal",t,e++,a.NORMAL_WHITE),e++,this.print("Ctrl: "+i,t,e++,a.NORMAL_WHITE)},drawStatus(t,e){this.term.putString(" Health     ",t,e+0,250,255,255),this.term.putString("[          ]",t,e+1,250,255,255),this.term.putString(" Fatigue    ",t,e+2,250,255,255),this.term.putString("[          ]",t,e+3,250,255,255),this.term.putString(" Hunger     ",t,e+4,250,255,255),this.term.putString("[          ]",t,e+5,250,255,255),this.term.putString(this.__formatBar(this.game.player.health,10),t+1,e+1,212,30,60),this.term.putString(this.__formatBar(this.game.player.stamina,10,!0),t+1,e+3,61,255,110),this.term.putString(this.__formatBar(this.game.player.hunger,10),t+1,e+5,255,245,64),this.game.player.isStarving()&&this.term.putString("STARVING",t+8,e+4,255,0,0),this.game.player.isSick()&&this.term.putString("SICK",t+8,e+0,0,255,0)},examine:function(t){this.textBox.clear(),this.message(t.getExamineDescription())},__formatTimeOfDay:function(t){const e=Math.floor(t),i=Math.floor(60*(t-e));return(0==e?"12":e>12?e-12:e)+":"+(i<10?"0"+i:i)+(e>=12?"PM":"AM")},__formatBar:function(t,e,i){let r=Math.floor(t.current/t.max*e);i&&(r=e-r);let n="";for(let t=0;t<r;t++)n+="#";return n},getSelectedRecipe(t){return this.currentRecipes[t]},showRecipes:function(t,e,i){this.inventoryMode=i,this.currentRecipes=e,this.selectedItemIndex>=e.length&&(this.selectedItemIndex=0),this.__showList(t,e,(t=>{const e=s.getItem(t).app;return{character:e.tile.ch,r:e.tile.r,g:e.tile.g,b:e.tile.b}}),(t=>s.getMaterialsDescription(t)),1)},__showList:function(t,e,i,r,n){this.inventoryBox.setData(e,r,i,n),this.currentInventoryParams={title:t,items:e,leftMargin:n},this.refreshInventory()},refreshInventory:function(){const{title:t,items:e,leftMargin:i}=this.currentInventoryParams;if(this.currentItems=e,this.inventoryBox.draw(),this.term.putString(t,2,3,c,d,p),i)for(var r=0;r<e.length;r++)r==this.selectedItemIndex?this.term.put(this.CURSOR_TILE,2,4+r):this.term.put(this.BLANK_TILE,2,4+r);this.term.render()},hideInventory:function(){this.term.clear(),this.refresh()},message:function(t,e){e&&this.textBox.clear(),this.textBox.addText(t),this.textBox.draw(),this.term.render()},errorMessage(t,e){this.message(t,e),this.game.audio.playSfx("ui_neg_fbk")},intro(){this.term.clear();const t=new r(this.term,22,80,{x:0,y:0},this);o.intro.forEach((e=>this.addIntroParagraph(t,e))),t.draw(),this.term.render()},addIntroParagraph(t,e){t.addText(e),t.newLine(),t.newLine()},hideIntro(){this.term.clear()},titleScreen(){this.term.putString("Emerald Woods",2,2,c,d,p),this.term.putString("New Game",6,4,255,207,142),this.term.putString("Continue",6,5,255,207,142),this.term.putString("*",4,4,212,30,60),this.term.putString("v"+this.game.version,2,22,212,100,83),this.term.putString("Copyright (c) 2020-2024 - Slashware S.A.S.",2,23,212,100,83),this.currentTitleOption=0,this.term.render()},showNewVersion(t){this.game.input.mode==u.TITLE_SCREEN&&(this.printRGB("A newest version (v"+t.version+") is available!",20,4,f),this.printRGB("Visit "+t.updateSite+" to download it!",20,5,m),this.term.render())},showCurrentVersion(t){this.game.input.mode==u.TITLE_SCREEN&&(this.printRGB("You are using the latest available version",20,4,m),this.printRGB("from "+t.releaseDate+".",20,5,m),this.term.render())},showVersionError(t){this.game.input.mode==u.TITLE_SCREEN&&(this.printRGB("Up to date check failed.",20,4,m),this.term.render())},changeTitleOption(t){this.currentTitleOption+=t,this.currentTitleOption<0&&(this.currentTitleOption=0),this.currentTitleOption>1&&(this.currentTitleOption=1),this.term.putString(" ",4,4,212,30,60),this.term.putString(" ",4,5,212,30,60),this.term.putString("*",4,4+this.currentTitleOption,212,30,60),this.term.render()},confirmTitleSelection(){0==this.currentTitleOption?(this.term.putString("Creating World...",20,4,255,207,142),this.tickOnce((()=>this.game.newGame()))):(this.term.putString("Loading game...",20,5,255,207,142),this.tickOnce((()=>this.game.loadGame()))),this.term.render()},showLoadErrorMessage(t){this.term.putString(t,20,5,255,207,142),this.term.render()},debugBuffer:function(t){t:for(let e=0;e<t.length;e++){let i="";for(let r=0;r<t[0].length;r++){if(!t[e][r]){i+="!",console.log(i);break t}i+=t[e][r].ch}console.log(i)}},print(t,e,i,r){this.term.putString(t,e,i,...a.hexToRGB(r))},printRGB(t,e,i,r){this.term.putString(t,e,i,r.r,r.g,r.b)},activateMainMode(){},showJournal(){const t=this.game.world.level.player.progression,e=t.animals,i=t.crops,r=[{text:"\nFauna [ "+e.length+"/"+(Races.all().length-1)+"]"}];r.push(...e.map((t=>({text:Races.get(t).name,app:l.get(t)})))),r.push({text:""}),r.push({text:"\nCrops [ "+i.length+"/"+h.cropsCount+"]"}),r.push(...i.map((t=>{const e=Items.get(t);return{text:e.name,app:e.app}}))),r.push({text:""}),this.__showList("Field Notes",r,(t=>({character:t.app?.tile.ch||" ",r:t.app?.tile.r,g:t.app?.tile.g,b:t.app?.tile.b})),(t=>t.text))},hideJournal(){},journalUp(){this.inventoryBox.scrollUp(),this.refreshInventory()},journalDown(){this.inventoryBox.scrollDown(),this.refreshInventory()},resetSelectedRecipe(){this.selectedItemIndex=0},moveInventory(t){-1===t.y?(this.game.audio.playSfx("ui_selection"),this.selectedItemIndex>0&&this.selectedItemIndex--,this.refreshInventory()):1===t.y&&(this.game.audio.playSfx("ui_selection"),this.selectedItemIndex<this.currentItems.length-1&&this.selectedItemIndex++,this.refreshInventory())}}},7553:t=>{t.exports={version:"0.4.2",versionNumber:317,modelVersion:40,updateSite:"https://slash.itch.io/emerald-woods",releaseDate:"January 1, 2024"}},8368:t=>{t.exports={runCA:function(t,e,i,r,n){for(var s=0;s<i;s++){for(var a=[],o=0;o<t.length;o++)a[o]=[];for(o=0;o<t.length;o++)for(var l=0;l<t[o].length;l++){for(var h={},u=o-1;u<=o+1;u++)for(var c=l-1;c<=l+1;c++)if((!r||u==o||c==l)&&u>0&&u<t.length&&c>0&&c<t[o].length){var d=t[u][c];h[d]?h[d]++:h[d]=1}var p=e(t[o][l],h);a[o][l]=p||t[o][l]}t=a,n&&n(t)}return t}}},1845:(t,e,i)=>{const r=i(4738).default,n=i(8368);var s=i(6041).default;const a=i(7239),o=i(7591);t.exports={filter:function(t){function e(t){const e=Object.keys(t);let i,r=-1;return e.forEach((e=>{t[e]>r&&(r=t[e],i=e)})),i}return t=n.runCA(t,((t,e)=>!!("ROCK"==t&&e.STONE_FLOOR>0&&e.STONE_FLOOR<3&&r.chance(70))&&"STONE_FLOOR"),4,!0,(t=>this.snap(t))),t=n.runCA(t,((t,e)=>!!("COLD_ROCK"==t&&e.ROCK_FLOOR>0&&e.ROCK_FLOOR<3&&r.chance(80))&&"ROCK_FLOOR"),3,!0,(t=>this.snap(t))),t=n.runCA(t,((t,e)=>!!("ROCK_FLOOR"===t&&e.PUDDLE>0&&r.chance(80))&&"PUDDLE"),3,!0,(t=>this.snap(t))),t=n.runCA(t,((t,i)=>"ROCK"==t&&i.ROCK<3&&e(i)),1,!0,(t=>this.snap(t))),t=n.runCA(t,((t,i)=>"COLD_ROCK"==t&&i.COLD_ROCK<3&&e(i)),1,!0,(t=>this.snap(t))),t=n.runCA(t,((t,e)=>e.WATER>1&&"WATER"),2,!1,(t=>this.snap(t))),t=n.runCA(t,((t,e)=>!!(e.WATER>1&&r.chance(50))&&"WATER"),2,!1,(t=>this.snap(t))),t=n.runCA(t,((t,e)=>"GRASS"==t&&e.FOREST_FLOOR>2?"FOREST_FLOOR":"FOREST_FLOOR"==t&&e.FOREST_FLOOR<1&&"GRASS"),1,!1,(t=>this.snap(t))),t=n.runCA(t,((t,e)=>!!("ROCK"==t&&e.GRASS>1&&r.chance(80))&&(r.chance(50)?"GRASS":"FOREST_FLOOR")),5,!1,(t=>this.snap(t))),t=n.runCA(t,((t,e)=>!!("ROCK"==t&&e.FOREST_FLOOR>1&&1==e.ROCK&&r.chance(80))&&"ROCK"),3,!1,(t=>this.snap(t))),n.runCA(t,((t,e)=>e.WORLD_BOUNDARIES>1&&r.chance(60)?"WORLD_BOUNDARIES":!!("ROCK"==t&&e.GRASS>1&&1==e.ROCK&&r.chance(80))&&"ROCK"),3,!1,(t=>this.snap(t)))},snap(t){o.enabled&&(new a({canvasId:"mapPreview",zoomLevel:1,mapWidth:t.length,mapHeight:t[0].length,colorFunction:(t,e,i)=>s.get(t[e][i]).previewColor}).renderMap(t),o.addFrame("mapPreview"))}}},7239:t=>{function e(t){this.config=t}e.prototype={renderMap:function(t){const e=this.config,i=document.getElementById(e.canvasId);i.width=e.zoomLevel*e.mapWidth,i.height=e.zoomLevel*e.mapHeight,i.style.display="block";const r=i.getContext("2d");r.clearRect(0,0,i.width,i.height);const n=e.zoomLevel;for(let i=0;i<e.mapWidth;i++)for(let s=0;s<e.mapHeight;s++){const a=e.colorFunction(t,i,s);r.fillStyle=a,r.fillRect(i*n,s*n,n,n)}},renderFragment:function(t,e,i,r,n){const s=this.config,a=document.getElementById(s.canvasId);a.width=s.zoomLevel*r,a.height=s.zoomLevel*n,a.style.display="block";const o=a.getContext("2d");o.clearRect(0,0,a.width,a.height);const l=s.zoomLevel;for(let a=0;a<r;a++)for(let r=0;r<n;r++){const n=s.colorFunction(t,e+a,i+r);o.fillStyle=n,o.fillRect(a*l,r*l,l,l)}}},t.exports=e},7591:t=>{t.exports={init(){this.enabled=!0,this.gif=new GIF({workers:2,quality:10}),this.gif.on("finished",(function(t){document.getElementById("animation").src=URL.createObjectURL(t)}))},addFrame(t,e=500){const i=document.getElementById(t);this.gif.addFrame(i,{delay:e,copy:!0})},render(){this.gif.render()}}},8134:t=>{function e(t){var e;this.seeded=(e=t,function(){return(2147483647&(e=0|Math.imul(16807,e)))/2147483648})}e.prototype={int:function(t){return this.seeded()*(t||268435455)|0},range:function(t,e){return t===e?t:this.int(e-t)+t},of(t){return t[this.int(t.length)]},number(){return this.seeded()}},t.exports=e},7409:(t,e,i)=>{const r=i(8018),n=i(6961);t.exports={saveGame(t){const e={game:t,_c:r.register("emeraldWood")},i=r.serialize(e);console.log("Serialized Data Size: "+i.length);var s=n.compressToUTF16(i);console.log("Compressed Data Size: "+s.length),localStorage.setItem("ew_saveGame",s)},hasSaveGame:()=>null!=localStorage.getItem("ew_saveGame"),loadIntoGame(t,e){const i=localStorage.getItem("ew_saveGame"),s=n.decompressFromUTF16(i);let a;this.game=t;try{a=r.parse(s)}catch(t){throw{code:"parseError",parseError:t}}if(t.modelVersion!=a.game.modelVersion&&!e)throw{code:"versionMismatch",version:a.game.modelVersion};t.world=a.game.world,t.player=a.game.player,t.onboardingStep=a.game.onboardingStep},fillLevelToRevive(t){t.game.modelVersion!=this.game.modelVersion&&t.game.modelVersion<38&&this.game.modelVersion>=38&&(t.__serialData.dryMap={})},fillPlayerToRevive(t){t.game.modelVersion!=this.game.modelVersion&&t.game.modelVersion<40&&this.game.modelVersion>=40&&(t.__serialData.recipeIds.includes("CARBON")||t.__serialData.recipeIds.push("CARBON"))},fillBeingToRevive(t){t.game.modelVersion!=this.game.modelVersion&&t.game.modelVersion<39&&this.game.modelVersion>=39&&(t.hitPoints=t.race.hitPoints)}}},8018:t=>{var e={version:"0.0.3",currentId:1,showWarnings:!1,classes:{}};t.exports=e,e.registerClass=function(t,i,r){r||(r={}),r.prototype=i,e.classes[t]=r},e.register=function(t){return{type:t,uid:e.currentId++}},e.setSafe=function(){return{isCircularSafe:!0}},e.serialize=function(t){var i={},r={object:e._serializeObject(t,i),references:i};return JSON.stringify(r)},e.parse=function(t,i){var r=JSON.parse(t);return e._deserializeObject(r.object,r.references,[],i)},e._serializeObject=function(t,i){var r=null;if(r=e.isArray(t)?new Array:{},!t._c&&!e.isArray(t))throw console.log(t),"ERROR: "+typeof t+" without Circular metadata...";for(var n in e.isArray(t)||(i["x"+t._c.uid]=r,e._prepareObject(t)),t){var s=n,a=t[s];if((e.isArray(t)||!e._isTransient(t._c.type,s))&&"function"!=typeof a)if("_c"===s)r[s]=a;else if(e.isArray(a))r[s]=e._serializeObject(a,i);else if(null==a||"object"!=typeof a)r[s]=a;else{if(!a._c)throw t._c?"ERROR: "+s+" attribute from circular type "+t._c.type+" has no Circular metadata":"ERROR: ["+s+"] attribute from non circular object has no Circular metadata";a._c.isCircularSafe?r[s]=t[s]:(i["x"+a._c.uid]||(i["x"+a._c.uid]=e._serializeObject(a,i)),r[s]=a._c)}}return e.isArray(t)||e._cleanupObject(t),r},e._isTransient=function(t,i){return e.classes[t]&&e.classes[t].transients&&e.classes[t].transients[i]},e._prepareObject=function(t){var i=t._c.type;e.classes[i]&&e.classes[i].prepare&&(t.__serialData=e.classes[i].prepare(t),t.__serialData._c=this.setSafe())},e._cleanupObject=function(t){var i=t._c.type;e.classes[i]&&e.classes[i].prepare&&delete t.__serialData},e._deserializeObject=function(t,i,r,n){var s=null;for(var a in e.isArray(t)?s=[]:t._c&&(s=e.classes[t._c.type]&&e.classes[t._c.type].prototype?new e.classes[t._c.type].prototype:{},r["x"+t._c.uid]=s,t._c.uid>e.currentId&&(e.currentId=t._c.uid)),t){var o=a,l=t[o];"_c"===o?s[o]=t[o]:e.isArray(l)?s[o]=e._deserializeObject(l,i,r,n):l&&"object"==typeof l&&l.type&&l.uid?(r["x"+l.uid]||e._deserializeObject(i["x"+l.uid],i,r,n),s[o]=r["x"+l.uid]):s[o]=l}return t._c&&e.classes[t._c.type]&&e.classes[t._c.type].reviver&&e.classes[t._c.type].reviver(s,n),s},e.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}},5740:(t,e,i)=>{"use strict";i.d(e,{Z:()=>f});var r=i(8081),n=i.n(r),s=i(3645),a=i.n(s),o=i(1667),l=i.n(o),h=new URL(i(9345),i.b),u=new URL(i(8047),i.b),c=a()(n()),d=l()(h),p=l()(u);c.push([t.id,"@font-face {\r\n\tfont-family: 'Kenney Pixel';\r\n\tsrc: url("+d+") format('truetype');\r\n}\r\n\r\n@font-face {\r\n\tfont-family: 'PixeloidSans';\r\n\tsrc: url("+p+") format('truetype');\r\n}\r\n\r\nhtml {\r\n    height: 100%;\r\n}\r\n\r\nbody {\r\n    background-color: black;\r\n    font-family: DejaVuSansMono_ut, sans-serif;\r\n    color: white;\r\n    margin: 0px;\r\n    overflow: hidden;\r\n    touch-action: none;\r\n    min-height: 100%;\r\n    display: flex;\r\n    flex-direction: column-reverse;\r\n}\r\n\r\n.center {\r\n    margin-top: 20px;\r\n    margin-left: auto;\r\n    margin-right: auto;\r\n    text-align: center;\r\n}\r\n\r\n#game {\r\n    margin-left: auto;\r\n    margin-right: auto;\r\n    text-align: center;\r\n}",""]);const f=c},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",r=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),r&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),r&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,r,n,s){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(r)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(a[l]=!0)}for(var h=0;h<t.length;h++){var u=[].concat(t[h]);r&&a[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),i&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=i):u[2]=i),n&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=n):u[4]="".concat(n)),e.push(u))}},e}},1667:t=>{"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},8081:t=>{"use strict";t.exports=function(t){return t[1]}},9187:t=>{"use strict";function e(t,e,r){r=r||2;var s,a,o,l,c,d,f,m=e&&e.length,g=m?e[0]*r:t.length,_=i(t,0,g,r,!0),y=[];if(!_||_.next===_.prev)return y;if(m&&(_=function(t,e,r,n){var s,a,o,l=[];for(s=0,a=e.length;s<a;s++)(o=i(t,e[s]*n,s<a-1?e[s+1]*n:t.length,n,!1))===o.next&&(o.steiner=!0),l.push(p(o));for(l.sort(h),s=0;s<l.length;s++)r=u(l[s],r);return r}(t,e,_,r)),t.length>80*r){s=o=t[0],a=l=t[1];for(var v=r;v<g;v+=r)(c=t[v])<s&&(s=c),(d=t[v+1])<a&&(a=d),c>o&&(o=c),d>l&&(l=d);f=0!==(f=Math.max(o-s,l-a))?32767/f:0}return n(_,y,r,s,a,f,0),y}function i(t,e,i,r,n){var s,a;if(n===A(t,e,i,r)>0)for(s=e;s<i;s+=r)a=T(s,t[s],t[s+1],a);else for(s=i-r;s>=e;s-=r)a=T(s,t[s],t[s+1],a);return a&&_(a,a.next)&&(S(a),a=a.next),a}function r(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!_(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(S(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function n(t,e,i,h,u,c,p){if(t){!p&&c&&function(t,e,i,r){var n=t;do{0===n.z&&(n.z=d(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,s,a,o,l,h=1;do{for(i=t,t=null,s=null,a=0;i;){for(a++,r=i,o=0,e=0;e<h&&(o++,r=r.nextZ);e++);for(l=h;o>0||l>0&&r;)0!==o&&(0===l||!r||i.z<=r.z)?(n=i,i=i.nextZ,o--):(n=r,r=r.nextZ,l--),s?s.nextZ=n:t=n,n.prevZ=s,s=n;i=r}s.nextZ=null,h*=2}while(a>1)}(n)}(t,h,u,c);for(var f,m,g=t;t.prev!==t.next;)if(f=t.prev,m=t.next,c?a(t,h,u,c):s(t))e.push(f.i/i|0),e.push(t.i/i|0),e.push(m.i/i|0),S(t),t=m.next,g=m.next;else if((t=m)===g){p?1===p?n(t=o(r(t),e,i),e,i,h,u,c,2):2===p&&l(t,e,i,h,u,c):n(r(t),e,i,h,u,c,1);break}}}function s(t){var e=t.prev,i=t,r=t.next;if(g(e,i,r)>=0)return!1;for(var n=e.x,s=i.x,a=r.x,o=e.y,l=i.y,h=r.y,u=n<s?n<a?n:a:s<a?s:a,c=o<l?o<h?o:h:l<h?l:h,d=n>s?n>a?n:a:s>a?s:a,p=o>l?o>h?o:h:l>h?l:h,m=r.next;m!==e;){if(m.x>=u&&m.x<=d&&m.y>=c&&m.y<=p&&f(n,o,s,l,a,h,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function a(t,e,i,r){var n=t.prev,s=t,a=t.next;if(g(n,s,a)>=0)return!1;for(var o=n.x,l=s.x,h=a.x,u=n.y,c=s.y,p=a.y,m=o<l?o<h?o:h:l<h?l:h,_=u<c?u<p?u:p:c<p?c:p,y=o>l?o>h?o:h:l>h?l:h,v=u>c?u>p?u:p:c>p?c:p,x=d(m,_,e,i,r),b=d(y,v,e,i,r),E=t.prevZ,T=t.nextZ;E&&E.z>=x&&T&&T.z<=b;){if(E.x>=m&&E.x<=y&&E.y>=_&&E.y<=v&&E!==n&&E!==a&&f(o,u,l,c,h,p,E.x,E.y)&&g(E.prev,E,E.next)>=0)return!1;if(E=E.prevZ,T.x>=m&&T.x<=y&&T.y>=_&&T.y<=v&&T!==n&&T!==a&&f(o,u,l,c,h,p,T.x,T.y)&&g(T.prev,T,T.next)>=0)return!1;T=T.nextZ}for(;E&&E.z>=x;){if(E.x>=m&&E.x<=y&&E.y>=_&&E.y<=v&&E!==n&&E!==a&&f(o,u,l,c,h,p,E.x,E.y)&&g(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;T&&T.z<=b;){if(T.x>=m&&T.x<=y&&T.y>=_&&T.y<=v&&T!==n&&T!==a&&f(o,u,l,c,h,p,T.x,T.y)&&g(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function o(t,e,i){var n=t;do{var s=n.prev,a=n.next.next;!_(s,a)&&y(s,n,n.next,a)&&b(s,a)&&b(a,s)&&(e.push(s.i/i|0),e.push(n.i/i|0),e.push(a.i/i|0),S(n),S(n.next),n=t=a),n=n.next}while(n!==t);return r(n)}function l(t,e,i,s,a,o){var l=t;do{for(var h=l.next.next;h!==l.prev;){if(l.i!==h.i&&m(l,h)){var u=E(l,h);return l=r(l,l.next),u=r(u,u.next),n(l,e,i,s,a,o,0),void n(u,e,i,s,a,o,0)}h=h.next}l=l.next}while(l!==t)}function h(t,e){return t.x-e.x}function u(t,e){var i=function(t,e){var i,r=e,n=t.x,s=t.y,a=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var o=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=n&&o>a&&(a=o,i=r.x<r.next.x?r:r.next,o===n))return i}r=r.next}while(r!==e);if(!i)return null;var l,h=i,u=i.x,d=i.y,p=1/0;r=i;do{n>=r.x&&r.x>=u&&n!==r.x&&f(s<d?n:a,s,u,d,s<d?a:n,s,r.x,r.y)&&(l=Math.abs(s-r.y)/(n-r.x),b(r,t)&&(l<p||l===p&&(r.x>i.x||r.x===i.x&&c(i,r)))&&(i=r,p=l)),r=r.next}while(r!==h);return i}(t,e);if(!i)return e;var n=E(i,t);return r(n,n.next),r(i,i.next)}function c(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function d(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function p(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function f(t,e,i,r,n,s,a,o){return(n-a)*(e-o)>=(t-a)*(s-o)&&(t-a)*(r-o)>=(i-a)*(e-o)&&(i-a)*(s-o)>=(n-a)*(r-o)}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&y(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(b(t,e)&&b(e,t)&&function(t,e){var i=t,r=!1,n=(t.x+e.x)/2,s=(t.y+e.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&n<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||_(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function _(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,i,r){var n=x(g(t,e,i)),s=x(g(t,e,r)),a=x(g(i,r,t)),o=x(g(i,r,e));return n!==s&&a!==o||!(0!==n||!v(t,i,e))||!(0!==s||!v(t,r,e))||!(0!==a||!v(i,t,r))||!(0!==o||!v(i,e,r))}function v(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function x(t){return t>0?1:t<0?-1:0}function b(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function E(t,e){var i=new w(t.i,t.x,t.y),r=new w(e.i,e.x,e.y),n=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,s.next=r,r.prev=s,r}function T(t,e,i,r){var n=new w(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function w(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(t,e,i,r){for(var n=0,s=e,a=i-r;s<i;s+=r)n+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return n}t.exports=e,t.exports.default=e,e.deviation=function(t,e,i,r){var n=e&&e.length,s=n?e[0]*i:t.length,a=Math.abs(A(t,0,s,i));if(n)for(var o=0,l=e.length;o<l;o++){var h=e[o]*i,u=o<l-1?e[o+1]*i:t.length;a-=Math.abs(A(t,h,u,i))}var c=0;for(o=0;o<r.length;o+=3){var d=r[o]*i,p=r[o+1]*i,f=r[o+2]*i;c+=Math.abs((t[d]-t[f])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[f+1]-t[d+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},e.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++)for(var a=0;a<e;a++)i.vertices.push(t[n][s][a]);n>0&&(r+=t[n-1].length,i.holes.push(r))}return i}},6729:t=>{"use strict";var e=Object.prototype.hasOwnProperty,i="~";function r(){}function n(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function s(t,e,r,s,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new n(r,s||t,a),l=i?i+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],o]:t._events[l].push(o):(t._events[l]=o,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1)),o.prototype.eventNames=function(){var t,r,n=[];if(0===this._eventsCount)return n;for(r in t=this._events)e.call(t,r)&&n.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},o.prototype.listeners=function(t){var e=i?i+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,s=r.length,a=new Array(s);n<s;n++)a[n]=r[n].fn;return a},o.prototype.listenerCount=function(t){var e=i?i+t:t,r=this._events[e];return r?r.fn?1:r.length:0},o.prototype.emit=function(t,e,r,n,s,a){var o=i?i+t:t;if(!this._events[o])return!1;var l,h,u=this._events[o],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,n),!0;case 5:return u.fn.call(u.context,e,r,n,s),!0;case 6:return u.fn.call(u.context,e,r,n,s,a),!0}for(h=1,l=new Array(c-1);h<c;h++)l[h-1]=arguments[h];u.fn.apply(u.context,l)}else{var d,p=u.length;for(h=0;h<p;h++)switch(u[h].once&&this.removeListener(t,u[h].fn,void 0,!0),c){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,e);break;case 3:u[h].fn.call(u[h].context,e,r);break;case 4:u[h].fn.call(u[h].context,e,r,n);break;default:if(!l)for(d=1,l=new Array(c-1);d<c;d++)l[d-1]=arguments[d];u[h].fn.apply(u[h].context,l)}}return!0},o.prototype.on=function(t,e,i){return s(this,t,e,i,!1)},o.prototype.once=function(t,e,i){return s(this,t,e,i,!0)},o.prototype.removeListener=function(t,e,r,n){var s=i?i+t:t;if(!this._events[s])return this;if(!e)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||n&&!o.once||r&&o.context!==r||a(this,s);else{for(var l=0,h=[],u=o.length;l<u;l++)(o[l].fn!==e||n&&!o[l].once||r&&o[l].context!==r)&&h.push(o[l]);h.length?this._events[s]=1===h.length?h[0]:h:a(this,s)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&a(this,e)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,t.exports=o},4485:(t,e,i)=>{t.exports=i(2894)},2894:function(t,e,i){t=i.nmd(t),function(){var e,i,r,n,s,a,o,l,h,u,c,d,p,f,m;r=Math.floor,u=Math.min,i=function(t,e){return t<e?-1:t>e?1:0},h=function(t,e,n,s,a){var o;if(null==n&&(n=0),null==a&&(a=i),n<0)throw new Error("lo must be non-negative");for(null==s&&(s=t.length);n<s;)a(e,t[o=r((n+s)/2)])<0?s=o:n=o+1;return[].splice.apply(t,[n,n-n].concat(e)),e},a=function(t,e,r){return null==r&&(r=i),t.push(e),f(t,0,t.length-1,r)},s=function(t,e){var r,n;return null==e&&(e=i),r=t.pop(),t.length?(n=t[0],t[0]=r,m(t,0,e)):n=r,n},l=function(t,e,r){var n;return null==r&&(r=i),n=t[0],t[0]=e,m(t,0,r),n},o=function(t,e,r){var n;return null==r&&(r=i),t.length&&r(t[0],e)<0&&(e=(n=[t[0],e])[0],t[0]=n[1],m(t,0,r)),e},n=function(t,e){var n,s,a,o,l,h;for(null==e&&(e=i),l=[],s=0,a=(o=function(){h=[];for(var e=0,i=r(t.length/2);0<=i?e<i:e>i;0<=i?e++:e--)h.push(e);return h}.apply(this).reverse()).length;s<a;s++)n=o[s],l.push(m(t,n,e));return l},p=function(t,e,r){var n;if(null==r&&(r=i),-1!==(n=t.indexOf(e)))return f(t,0,n,r),m(t,n,r)},c=function(t,e,r){var s,a,l,h,u;if(null==r&&(r=i),!(a=t.slice(0,e)).length)return a;for(n(a,r),l=0,h=(u=t.slice(e)).length;l<h;l++)s=u[l],o(a,s,r);return a.sort(r).reverse()},d=function(t,e,r){var a,o,l,c,d,p,f,m,g;if(null==r&&(r=i),10*e<=t.length){if(!(l=t.slice(0,e).sort(r)).length)return l;for(o=l[l.length-1],c=0,p=(f=t.slice(e)).length;c<p;c++)r(a=f[c],o)<0&&(h(l,a,0,null,r),l.pop(),o=l[l.length-1]);return l}for(n(t,r),g=[],d=0,m=u(e,t.length);0<=m?d<m:d>m;0<=m?++d:--d)g.push(s(t,r));return g},f=function(t,e,r,n){var s,a,o;for(null==n&&(n=i),s=t[r];r>e&&n(s,a=t[o=r-1>>1])<0;)t[r]=a,r=o;return t[r]=s},m=function(t,e,r){var n,s,a,o,l;for(null==r&&(r=i),s=t.length,l=e,a=t[e],n=2*e+1;n<s;)(o=n+1)<s&&!(r(t[n],t[o])<0)&&(n=o),t[e]=t[n],n=2*(e=n)+1;return t[e]=a,f(t,l,e,r)},e=function(){function t(t){this.cmp=null!=t?t:i,this.nodes=[]}return t.push=a,t.pop=s,t.replace=l,t.pushpop=o,t.heapify=n,t.updateItem=p,t.nlargest=c,t.nsmallest=d,t.prototype.push=function(t){return a(this.nodes,t,this.cmp)},t.prototype.pop=function(){return s(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return l(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return o(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return n(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return p(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),(null!==t?t.exports:void 0)?t.exports=e:window.Heap=e}.call(this)},6961:(t,e,i)=>{var r,n=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function n(t,e){if(!r[t]){r[t]={};for(var i=0;i<t.length;i++)r[t][t.charAt(i)]=i}return r[t][e]}var s={compressToBase64:function(t){if(null==t)return"";var i=s._compress(t,6,(function(t){return e.charAt(t)}));switch(i.length%4){default:case 0:return i;case 1:return i+"===";case 2:return i+"==";case 3:return i+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:s._decompress(t.length,32,(function(i){return n(e,t.charAt(i))}))},compressToUTF16:function(e){return null==e?"":s._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:s._decompress(t.length,16384,(function(e){return t.charCodeAt(e)-32}))},compressToUint8Array:function(t){for(var e=s.compress(t),i=new Uint8Array(2*e.length),r=0,n=e.length;r<n;r++){var a=e.charCodeAt(r);i[2*r]=a>>>8,i[2*r+1]=a%256}return i},decompressFromUint8Array:function(e){if(null==e)return s.decompress(e);for(var i=new Array(e.length/2),r=0,n=i.length;r<n;r++)i[r]=256*e[2*r]+e[2*r+1];var a=[];return i.forEach((function(e){a.push(t(e))})),s.decompress(a.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":s._compress(t,6,(function(t){return i.charAt(t)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),s._decompress(t.length,32,(function(e){return n(i,t.charAt(e))})))},compress:function(e){return s._compress(e,16,(function(e){return t(e)}))},_compress:function(t,e,i){if(null==t)return"";var r,n,s,a={},o={},l="",h="",u="",c=2,d=3,p=2,f=[],m=0,g=0;for(s=0;s<t.length;s+=1)if(l=t.charAt(s),Object.prototype.hasOwnProperty.call(a,l)||(a[l]=d++,o[l]=!0),h=u+l,Object.prototype.hasOwnProperty.call(a,h))u=h;else{if(Object.prototype.hasOwnProperty.call(o,u)){if(u.charCodeAt(0)<256){for(r=0;r<p;r++)m<<=1,g==e-1?(g=0,f.push(i(m)),m=0):g++;for(n=u.charCodeAt(0),r=0;r<8;r++)m=m<<1|1&n,g==e-1?(g=0,f.push(i(m)),m=0):g++,n>>=1}else{for(n=1,r=0;r<p;r++)m=m<<1|n,g==e-1?(g=0,f.push(i(m)),m=0):g++,n=0;for(n=u.charCodeAt(0),r=0;r<16;r++)m=m<<1|1&n,g==e-1?(g=0,f.push(i(m)),m=0):g++,n>>=1}0==--c&&(c=Math.pow(2,p),p++),delete o[u]}else for(n=a[u],r=0;r<p;r++)m=m<<1|1&n,g==e-1?(g=0,f.push(i(m)),m=0):g++,n>>=1;0==--c&&(c=Math.pow(2,p),p++),a[h]=d++,u=String(l)}if(""!==u){if(Object.prototype.hasOwnProperty.call(o,u)){if(u.charCodeAt(0)<256){for(r=0;r<p;r++)m<<=1,g==e-1?(g=0,f.push(i(m)),m=0):g++;for(n=u.charCodeAt(0),r=0;r<8;r++)m=m<<1|1&n,g==e-1?(g=0,f.push(i(m)),m=0):g++,n>>=1}else{for(n=1,r=0;r<p;r++)m=m<<1|n,g==e-1?(g=0,f.push(i(m)),m=0):g++,n=0;for(n=u.charCodeAt(0),r=0;r<16;r++)m=m<<1|1&n,g==e-1?(g=0,f.push(i(m)),m=0):g++,n>>=1}0==--c&&(c=Math.pow(2,p),p++),delete o[u]}else for(n=a[u],r=0;r<p;r++)m=m<<1|1&n,g==e-1?(g=0,f.push(i(m)),m=0):g++,n>>=1;0==--c&&(c=Math.pow(2,p),p++)}for(n=2,r=0;r<p;r++)m=m<<1|1&n,g==e-1?(g=0,f.push(i(m)),m=0):g++,n>>=1;for(;;){if(m<<=1,g==e-1){f.push(i(m));break}g++}return f.join("")},decompress:function(t){return null==t?"":""==t?null:s._decompress(t.length,32768,(function(e){return t.charCodeAt(e)}))},_decompress:function(e,i,r){var n,s,a,o,l,h,u,c=[],d=4,p=4,f=3,m="",g=[],_={val:r(0),position:i,index:1};for(n=0;n<3;n+=1)c[n]=n;for(a=0,l=Math.pow(2,2),h=1;h!=l;)o=_.val&_.position,_.position>>=1,0==_.position&&(_.position=i,_.val=r(_.index++)),a|=(o>0?1:0)*h,h<<=1;switch(a){case 0:for(a=0,l=Math.pow(2,8),h=1;h!=l;)o=_.val&_.position,_.position>>=1,0==_.position&&(_.position=i,_.val=r(_.index++)),a|=(o>0?1:0)*h,h<<=1;u=t(a);break;case 1:for(a=0,l=Math.pow(2,16),h=1;h!=l;)o=_.val&_.position,_.position>>=1,0==_.position&&(_.position=i,_.val=r(_.index++)),a|=(o>0?1:0)*h,h<<=1;u=t(a);break;case 2:return""}for(c[3]=u,s=u,g.push(u);;){if(_.index>e)return"";for(a=0,l=Math.pow(2,f),h=1;h!=l;)o=_.val&_.position,_.position>>=1,0==_.position&&(_.position=i,_.val=r(_.index++)),a|=(o>0?1:0)*h,h<<=1;switch(u=a){case 0:for(a=0,l=Math.pow(2,8),h=1;h!=l;)o=_.val&_.position,_.position>>=1,0==_.position&&(_.position=i,_.val=r(_.index++)),a|=(o>0?1:0)*h,h<<=1;c[p++]=t(a),u=p-1,d--;break;case 1:for(a=0,l=Math.pow(2,16),h=1;h!=l;)o=_.val&_.position,_.position>>=1,0==_.position&&(_.position=i,_.val=r(_.index++)),a|=(o>0?1:0)*h,h<<=1;c[p++]=t(a),u=p-1,d--;break;case 2:return g.join("")}if(0==d&&(d=Math.pow(2,f),f++),c[u])m=c[u];else{if(u!==p)return null;m=s+s.charAt(0)}g.push(m),c[p++]=s+m.charAt(0),s=m,0==--d&&(d=Math.pow(2,f),f++)}}};return s}();void 0===(r=function(){return n}.call(e,i,e,t))||(t.exports=r)},9657:(t,e,i)=>{t.exports=i(9558)},9558:(t,e,i)=>{t.exports={Heap:i(4485),Node:i(1289),Grid:i(8809),Util:i(8408),DiagonalMovement:i(3506),Heuristic:i(9430),AStarFinder:i(2131),BestFirstFinder:i(3644),BreadthFirstFinder:i(7904),DijkstraFinder:i(3607),BiAStarFinder:i(713),BiBestFirstFinder:i(6325),BiBreadthFirstFinder:i(2513),BiDijkstraFinder:i(6511),IDAStarFinder:i(944),JumpPointFinder:i(8717)}},3506:t=>{t.exports={Always:1,Never:2,IfAtMostOneObstacle:3,OnlyWhenNoObstacles:4}},8809:(t,e,i)=>{var r=i(1289),n=i(3506);function s(t,e,i){var r;"object"!=typeof t?r=t:(e=t.length,r=t[0].length,i=t),this.width=r,this.height=e,this.nodes=this._buildNodes(r,e,i)}s.prototype._buildNodes=function(t,e,i){var n,s,a=new Array(e);for(n=0;n<e;++n)for(a[n]=new Array(t),s=0;s<t;++s)a[n][s]=new r(s,n);if(void 0===i)return a;if(i.length!==e||i[0].length!==t)throw new Error("Matrix size does not fit");for(n=0;n<e;++n)for(s=0;s<t;++s)i[n][s]&&(a[n][s].walkable=!1);return a},s.prototype.getNodeAt=function(t,e){return this.nodes[e][t]},s.prototype.isWalkableAt=function(t,e){return this.isInside(t,e)&&this.nodes[e][t].walkable},s.prototype.isInside=function(t,e){return t>=0&&t<this.width&&e>=0&&e<this.height},s.prototype.setWalkableAt=function(t,e,i){this.nodes[e][t].walkable=i},s.prototype.getNeighbors=function(t,e){var i=t.x,r=t.y,s=[],a=!1,o=!1,l=!1,h=!1,u=!1,c=!1,d=!1,p=!1,f=this.nodes;if(this.isWalkableAt(i,r-1)&&(s.push(f[r-1][i]),a=!0),this.isWalkableAt(i+1,r)&&(s.push(f[r][i+1]),l=!0),this.isWalkableAt(i,r+1)&&(s.push(f[r+1][i]),u=!0),this.isWalkableAt(i-1,r)&&(s.push(f[r][i-1]),d=!0),e===n.Never)return s;if(e===n.OnlyWhenNoObstacles)o=d&&a,h=a&&l,c=l&&u,p=u&&d;else if(e===n.IfAtMostOneObstacle)o=d||a,h=a||l,c=l||u,p=u||d;else{if(e!==n.Always)throw new Error("Incorrect value of diagonalMovement");o=!0,h=!0,c=!0,p=!0}return o&&this.isWalkableAt(i-1,r-1)&&s.push(f[r-1][i-1]),h&&this.isWalkableAt(i+1,r-1)&&s.push(f[r-1][i+1]),c&&this.isWalkableAt(i+1,r+1)&&s.push(f[r+1][i+1]),p&&this.isWalkableAt(i-1,r+1)&&s.push(f[r+1][i-1]),s},s.prototype.clone=function(){var t,e,i=this.width,n=this.height,a=this.nodes,o=new s(i,n),l=new Array(n);for(t=0;t<n;++t)for(l[t]=new Array(i),e=0;e<i;++e)l[t][e]=new r(e,t,a[t][e].walkable);return o.nodes=l,o},t.exports=s},9430:t=>{t.exports={manhattan:function(t,e){return t+e},euclidean:function(t,e){return Math.sqrt(t*t+e*e)},octile:function(t,e){var i=Math.SQRT2-1;return t<e?i*t+e:i*e+t},chebyshev:function(t,e){return Math.max(t,e)}}},1289:t=>{t.exports=function(t,e,i){this.x=t,this.y=e,this.walkable=void 0===i||i}},8408:(t,e)=>{function i(t){for(var e=[[t.x,t.y]];t.parent;)t=t.parent,e.push([t.x,t.y]);return e.reverse()}function r(t,e,i,r){var n,s,a,o,l,h,u=Math.abs,c=[];for(n=t<i?1:-1,s=e<r?1:-1,l=(a=u(i-t))-(o=u(r-e));c.push([t,e]),t!==i||e!==r;)(h=2*l)>-o&&(l-=o,t+=n),h<a&&(l+=a,e+=s);return c}e.backtrace=i,e.biBacktrace=function(t,e){var r=i(t),n=i(e);return r.concat(n.reverse())},e.pathLength=function(t){var e,i,r,n,s,a=0;for(e=1;e<t.length;++e)i=t[e-1],r=t[e],n=i[0]-r[0],s=i[1]-r[1],a+=Math.sqrt(n*n+s*s);return a},e.interpolate=r,e.expandPath=function(t){var e,i,n,s,a,o,l=[],h=t.length;if(h<2)return l;for(a=0;a<h-1;++a)for(e=t[a],i=t[a+1],s=(n=r(e[0],e[1],i[0],i[1])).length,o=0;o<s-1;++o)l.push(n[o]);return l.push(t[h-1]),l},e.smoothenPath=function(t,e){var i,n,s,a,o,l,h,u,c,d=e.length,p=e[0][0],f=e[0][1],m=e[d-1][0],g=e[d-1][1];for(s=[[i=p,n=f]],a=2;a<d;++a){for(h=r(i,n,(l=e[a])[0],l[1]),c=!1,o=1;o<h.length;++o)if(u=h[o],!t.isWalkableAt(u[0],u[1])){c=!0;break}c&&(lastValidCoord=e[a-1],s.push(lastValidCoord),i=lastValidCoord[0],n=lastValidCoord[1])}return s.push([m,g]),s},e.compressPath=function(t){if(t.length<3)return t;var e,i,r,n,s,a,o=[],l=t[0][0],h=t[0][1],u=t[1][0],c=t[1][1],d=u-l,p=c-h;for(d/=s=Math.sqrt(d*d+p*p),p/=s,o.push([l,h]),a=2;a<t.length;a++)e=u,i=c,r=d,n=p,d=(u=t[a][0])-e,p=(c=t[a][1])-i,p/=s=Math.sqrt(d*d+p*p),(d/=s)===r&&p===n||o.push([e,i]);return o.push([u,c]),o}},2131:(t,e,i)=>{var r=i(4485),n=i(8408),s=i(9430),a=i(3506);function o(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.heuristic=t.heuristic||s.manhattan,this.weight=t.weight||1,this.diagonalMovement=t.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=a.OnlyWhenNoObstacles:this.diagonalMovement=a.IfAtMostOneObstacle:this.diagonalMovement=a.Never),this.diagonalMovement===a.Never?this.heuristic=t.heuristic||s.manhattan:this.heuristic=t.heuristic||s.octile}o.prototype.findPath=function(t,e,i,s,a){var o,l,h,u,c,d,p,f,m=new r((function(t,e){return t.f-e.f})),g=a.getNodeAt(t,e),_=a.getNodeAt(i,s),y=this.heuristic,v=this.diagonalMovement,x=this.weight,b=Math.abs,E=Math.SQRT2;for(g.g=0,g.f=0,m.push(g),g.opened=!0;!m.empty();){if((o=m.pop()).closed=!0,o===_)return n.backtrace(_);for(u=0,c=(l=a.getNeighbors(o,v)).length;u<c;++u)(h=l[u]).closed||(d=h.x,p=h.y,f=o.g+(d-o.x==0||p-o.y==0?1:E),(!h.opened||f<h.g)&&(h.g=f,h.h=h.h||x*y(b(d-i),b(p-s)),h.f=h.g+h.h,h.parent=o,h.opened?m.updateItem(h):(m.push(h),h.opened=!0)))}return[]},t.exports=o},3644:(t,e,i)=>{var r=i(2131);function n(t){r.call(this,t);var e=this.heuristic;this.heuristic=function(t,i){return 1e6*e(t,i)}}n.prototype=new r,n.prototype.constructor=n,t.exports=n},713:(t,e,i)=>{var r=i(4485),n=i(8408),s=i(9430),a=i(3506);function o(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.diagonalMovement=t.diagonalMovement,this.heuristic=t.heuristic||s.manhattan,this.weight=t.weight||1,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=a.OnlyWhenNoObstacles:this.diagonalMovement=a.IfAtMostOneObstacle:this.diagonalMovement=a.Never),this.diagonalMovement===a.Never?this.heuristic=t.heuristic||s.manhattan:this.heuristic=t.heuristic||s.octile}o.prototype.findPath=function(t,e,i,s,a){var o,l,h,u,c,d,p,f,m=function(t,e){return t.f-e.f},g=new r(m),_=new r(m),y=a.getNodeAt(t,e),v=a.getNodeAt(i,s),x=this.heuristic,b=this.diagonalMovement,E=this.weight,T=Math.abs,S=Math.SQRT2;for(y.g=0,y.f=0,g.push(y),y.opened=1,v.g=0,v.f=0,_.push(v),v.opened=2;!g.empty()&&!_.empty();){for((o=g.pop()).closed=!0,u=0,c=(l=a.getNeighbors(o,b)).length;u<c;++u)if(!(h=l[u]).closed){if(2===h.opened)return n.biBacktrace(o,h);d=h.x,p=h.y,f=o.g+(d-o.x==0||p-o.y==0?1:S),(!h.opened||f<h.g)&&(h.g=f,h.h=h.h||E*x(T(d-i),T(p-s)),h.f=h.g+h.h,h.parent=o,h.opened?g.updateItem(h):(g.push(h),h.opened=1))}for((o=_.pop()).closed=!0,u=0,c=(l=a.getNeighbors(o,b)).length;u<c;++u)if(!(h=l[u]).closed){if(1===h.opened)return n.biBacktrace(h,o);d=h.x,p=h.y,f=o.g+(d-o.x==0||p-o.y==0?1:S),(!h.opened||f<h.g)&&(h.g=f,h.h=h.h||E*x(T(d-t),T(p-e)),h.f=h.g+h.h,h.parent=o,h.opened?_.updateItem(h):(_.push(h),h.opened=2))}}return[]},t.exports=o},6325:(t,e,i)=>{var r=i(713);function n(t){r.call(this,t);var e=this.heuristic;this.heuristic=function(t,i){return 1e6*e(t,i)}}n.prototype=new r,n.prototype.constructor=n,t.exports=n},2513:(t,e,i)=>{var r=i(8408),n=i(3506);function s(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.diagonalMovement=t.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=n.OnlyWhenNoObstacles:this.diagonalMovement=n.IfAtMostOneObstacle:this.diagonalMovement=n.Never)}s.prototype.findPath=function(t,e,i,n,s){var a,o,l,h,u,c=s.getNodeAt(t,e),d=s.getNodeAt(i,n),p=[],f=[],m=this.diagonalMovement;for(p.push(c),c.opened=!0,c.by=0,f.push(d),d.opened=!0,d.by=1;p.length&&f.length;){for((l=p.shift()).closed=!0,h=0,u=(a=s.getNeighbors(l,m)).length;h<u;++h)if(!(o=a[h]).closed)if(o.opened){if(1===o.by)return r.biBacktrace(l,o)}else p.push(o),o.parent=l,o.opened=!0,o.by=0;for((l=f.shift()).closed=!0,h=0,u=(a=s.getNeighbors(l,m)).length;h<u;++h)if(!(o=a[h]).closed)if(o.opened){if(0===o.by)return r.biBacktrace(o,l)}else f.push(o),o.parent=l,o.opened=!0,o.by=1}return[]},t.exports=s},6511:(t,e,i)=>{var r=i(713);function n(t){r.call(this,t),this.heuristic=function(t,e){return 0}}n.prototype=new r,n.prototype.constructor=n,t.exports=n},7904:(t,e,i)=>{var r=i(8408),n=i(3506);function s(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.diagonalMovement=t.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=n.OnlyWhenNoObstacles:this.diagonalMovement=n.IfAtMostOneObstacle:this.diagonalMovement=n.Never)}s.prototype.findPath=function(t,e,i,n,s){var a,o,l,h,u,c=[],d=this.diagonalMovement,p=s.getNodeAt(t,e),f=s.getNodeAt(i,n);for(c.push(p),p.opened=!0;c.length;){if((l=c.shift()).closed=!0,l===f)return r.backtrace(f);for(h=0,u=(a=s.getNeighbors(l,d)).length;h<u;++h)(o=a[h]).closed||o.opened||(c.push(o),o.opened=!0,o.parent=l)}return[]},t.exports=s},3607:(t,e,i)=>{var r=i(2131);function n(t){r.call(this,t),this.heuristic=function(t,e){return 0}}n.prototype=new r,n.prototype.constructor=n,t.exports=n},944:(t,e,i)=>{i(8408);var r=i(9430),n=i(1289),s=i(3506);function a(t){t=t||{},this.allowDiagonal=t.allowDiagonal,this.dontCrossCorners=t.dontCrossCorners,this.diagonalMovement=t.diagonalMovement,this.heuristic=t.heuristic||r.manhattan,this.weight=t.weight||1,this.trackRecursion=t.trackRecursion||!1,this.timeLimit=t.timeLimit||1/0,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=s.OnlyWhenNoObstacles:this.diagonalMovement=s.IfAtMostOneObstacle:this.diagonalMovement=s.Never),this.diagonalMovement===s.Never?this.heuristic=t.heuristic||r.manhattan:this.heuristic=t.heuristic||r.octile}a.prototype.findPath=function(t,e,i,r,s){var a,o,l,h=(new Date).getTime(),u=function(t,e){return this.heuristic(Math.abs(e.x-t.x),Math.abs(e.y-t.y))}.bind(this),c=function(t,e,i,r,a){if(this.timeLimit>0&&(new Date).getTime()-h>1e3*this.timeLimit)return 1/0;var o,l,d,f,m=e+u(t,p)*this.weight;if(m>i)return m;if(t==p)return r[a]=[t.x,t.y],t;var g,_,y=s.getNeighbors(t,this.diagonalMovement);for(d=0,o=1/0;f=y[d];++d){if(this.trackRecursion&&(f.retainCount=f.retainCount+1||1,!0!==f.tested&&(f.tested=!0)),(l=c(f,e+(_=f,(g=t).x===_.x||g.y===_.y?1:Math.SQRT2),i,r,a+1))instanceof n)return r[a]=[t.x,t.y],l;this.trackRecursion&&0==--f.retainCount&&(f.tested=!1),l<o&&(o=l)}return o}.bind(this),d=s.getNodeAt(t,e),p=s.getNodeAt(i,r),f=u(d,p);for(a=0;;++a){if((l=c(d,0,f,o=[],0))===1/0)return[];if(l instanceof n)return o;f=l}return[]},t.exports=a},4524:(t,e,i)=>{var r=i(1010),n=i(3506);function s(t){r.call(this,t)}s.prototype=new r,s.prototype.constructor=s,s.prototype._jump=function(t,e,i,r){var n=this.grid,s=t-i,a=e-r;if(!n.isWalkableAt(t,e))return null;if(!0===this.trackJumpRecursion&&(n.getNodeAt(t,e).tested=!0),n.getNodeAt(t,e)===this.endNode)return[t,e];if(0!==s&&0!==a){if(n.isWalkableAt(t-s,e+a)&&!n.isWalkableAt(t-s,e)||n.isWalkableAt(t+s,e-a)&&!n.isWalkableAt(t,e-a))return[t,e];if(this._jump(t+s,e,t,e)||this._jump(t,e+a,t,e))return[t,e]}else if(0!==s){if(n.isWalkableAt(t+s,e+1)&&!n.isWalkableAt(t,e+1)||n.isWalkableAt(t+s,e-1)&&!n.isWalkableAt(t,e-1))return[t,e]}else if(n.isWalkableAt(t+1,e+a)&&!n.isWalkableAt(t+1,e)||n.isWalkableAt(t-1,e+a)&&!n.isWalkableAt(t-1,e))return[t,e];return this._jump(t+s,e+a,t,e)},s.prototype._findNeighbors=function(t){var e,i,r,s,a,o,l,h,u=t.parent,c=t.x,d=t.y,p=this.grid,f=[];if(u)e=u.x,i=u.y,r=(c-e)/Math.max(Math.abs(c-e),1),s=(d-i)/Math.max(Math.abs(d-i),1),0!==r&&0!==s?(p.isWalkableAt(c,d+s)&&f.push([c,d+s]),p.isWalkableAt(c+r,d)&&f.push([c+r,d]),p.isWalkableAt(c+r,d+s)&&f.push([c+r,d+s]),p.isWalkableAt(c-r,d)||f.push([c-r,d+s]),p.isWalkableAt(c,d-s)||f.push([c+r,d-s])):0===r?(p.isWalkableAt(c,d+s)&&f.push([c,d+s]),p.isWalkableAt(c+1,d)||f.push([c+1,d+s]),p.isWalkableAt(c-1,d)||f.push([c-1,d+s])):(p.isWalkableAt(c+r,d)&&f.push([c+r,d]),p.isWalkableAt(c,d+1)||f.push([c+r,d+1]),p.isWalkableAt(c,d-1)||f.push([c+r,d-1]));else for(l=0,h=(a=p.getNeighbors(t,n.Always)).length;l<h;++l)o=a[l],f.push([o.x,o.y]);return f},t.exports=s},1405:(t,e,i)=>{var r=i(1010),n=i(3506);function s(t){r.call(this,t)}s.prototype=new r,s.prototype.constructor=s,s.prototype._jump=function(t,e,i,r){var n=this.grid,s=t-i,a=e-r;if(!n.isWalkableAt(t,e))return null;if(!0===this.trackJumpRecursion&&(n.getNodeAt(t,e).tested=!0),n.getNodeAt(t,e)===this.endNode)return[t,e];if(0!==s&&0!==a){if(n.isWalkableAt(t-s,e+a)&&!n.isWalkableAt(t-s,e)||n.isWalkableAt(t+s,e-a)&&!n.isWalkableAt(t,e-a))return[t,e];if(this._jump(t+s,e,t,e)||this._jump(t,e+a,t,e))return[t,e]}else if(0!==s){if(n.isWalkableAt(t+s,e+1)&&!n.isWalkableAt(t,e+1)||n.isWalkableAt(t+s,e-1)&&!n.isWalkableAt(t,e-1))return[t,e]}else if(n.isWalkableAt(t+1,e+a)&&!n.isWalkableAt(t+1,e)||n.isWalkableAt(t-1,e+a)&&!n.isWalkableAt(t-1,e))return[t,e];return n.isWalkableAt(t+s,e)||n.isWalkableAt(t,e+a)?this._jump(t+s,e+a,t,e):null},s.prototype._findNeighbors=function(t){var e,i,r,s,a,o,l,h,u=t.parent,c=t.x,d=t.y,p=this.grid,f=[];if(u)e=u.x,i=u.y,r=(c-e)/Math.max(Math.abs(c-e),1),s=(d-i)/Math.max(Math.abs(d-i),1),0!==r&&0!==s?(p.isWalkableAt(c,d+s)&&f.push([c,d+s]),p.isWalkableAt(c+r,d)&&f.push([c+r,d]),(p.isWalkableAt(c,d+s)||p.isWalkableAt(c+r,d))&&f.push([c+r,d+s]),!p.isWalkableAt(c-r,d)&&p.isWalkableAt(c,d+s)&&f.push([c-r,d+s]),!p.isWalkableAt(c,d-s)&&p.isWalkableAt(c+r,d)&&f.push([c+r,d-s])):0===r?p.isWalkableAt(c,d+s)&&(f.push([c,d+s]),p.isWalkableAt(c+1,d)||f.push([c+1,d+s]),p.isWalkableAt(c-1,d)||f.push([c-1,d+s])):p.isWalkableAt(c+r,d)&&(f.push([c+r,d]),p.isWalkableAt(c,d+1)||f.push([c+r,d+1]),p.isWalkableAt(c,d-1)||f.push([c+r,d-1]));else for(l=0,h=(a=p.getNeighbors(t,n.IfAtMostOneObstacle)).length;l<h;++l)o=a[l],f.push([o.x,o.y]);return f},t.exports=s},5368:(t,e,i)=>{var r=i(1010),n=i(3506);function s(t){r.call(this,t)}s.prototype=new r,s.prototype.constructor=s,s.prototype._jump=function(t,e,i,r){var n=this.grid,s=t-i,a=e-r;if(!n.isWalkableAt(t,e))return null;if(!0===this.trackJumpRecursion&&(n.getNodeAt(t,e).tested=!0),n.getNodeAt(t,e)===this.endNode)return[t,e];if(0!==s&&0!==a){if(this._jump(t+s,e,t,e)||this._jump(t,e+a,t,e))return[t,e]}else if(0!==s){if(n.isWalkableAt(t,e-1)&&!n.isWalkableAt(t-s,e-1)||n.isWalkableAt(t,e+1)&&!n.isWalkableAt(t-s,e+1))return[t,e]}else if(0!==a&&(n.isWalkableAt(t-1,e)&&!n.isWalkableAt(t-1,e-a)||n.isWalkableAt(t+1,e)&&!n.isWalkableAt(t+1,e-a)))return[t,e];return n.isWalkableAt(t+s,e)&&n.isWalkableAt(t,e+a)?this._jump(t+s,e+a,t,e):null},s.prototype._findNeighbors=function(t){var e,i,r,s,a,o,l,h,u,c=t.parent,d=t.x,p=t.y,f=this.grid,m=[];if(c){if(e=c.x,i=c.y,r=(d-e)/Math.max(Math.abs(d-e),1),s=(p-i)/Math.max(Math.abs(p-i),1),0!==r&&0!==s)f.isWalkableAt(d,p+s)&&m.push([d,p+s]),f.isWalkableAt(d+r,p)&&m.push([d+r,p]),f.isWalkableAt(d,p+s)&&f.isWalkableAt(d+r,p)&&m.push([d+r,p+s]);else if(0!==r){u=f.isWalkableAt(d+r,p);var g=f.isWalkableAt(d,p+1),_=f.isWalkableAt(d,p-1);u&&(m.push([d+r,p]),g&&m.push([d+r,p+1]),_&&m.push([d+r,p-1])),g&&m.push([d,p+1]),_&&m.push([d,p-1])}else if(0!==s){u=f.isWalkableAt(d,p+s);var y=f.isWalkableAt(d+1,p),v=f.isWalkableAt(d-1,p);u&&(m.push([d,p+s]),y&&m.push([d+1,p+s]),v&&m.push([d-1,p+s])),y&&m.push([d+1,p]),v&&m.push([d-1,p])}}else for(l=0,h=(a=f.getNeighbors(t,n.OnlyWhenNoObstacles)).length;l<h;++l)o=a[l],m.push([o.x,o.y]);return m},t.exports=s},2403:(t,e,i)=>{var r=i(1010),n=i(3506);function s(t){r.call(this,t)}s.prototype=new r,s.prototype.constructor=s,s.prototype._jump=function(t,e,i,r){var n=this.grid,s=t-i,a=e-r;if(!n.isWalkableAt(t,e))return null;if(!0===this.trackJumpRecursion&&(n.getNodeAt(t,e).tested=!0),n.getNodeAt(t,e)===this.endNode)return[t,e];if(0!==s){if(n.isWalkableAt(t,e-1)&&!n.isWalkableAt(t-s,e-1)||n.isWalkableAt(t,e+1)&&!n.isWalkableAt(t-s,e+1))return[t,e]}else{if(0===a)throw new Error("Only horizontal and vertical movements are allowed");if(n.isWalkableAt(t-1,e)&&!n.isWalkableAt(t-1,e-a)||n.isWalkableAt(t+1,e)&&!n.isWalkableAt(t+1,e-a))return[t,e];if(this._jump(t+1,e,t,e)||this._jump(t-1,e,t,e))return[t,e]}return this._jump(t+s,e+a,t,e)},s.prototype._findNeighbors=function(t){var e,i,r,s,a,o,l,h,u=t.parent,c=t.x,d=t.y,p=this.grid,f=[];if(u)e=u.x,i=u.y,r=(c-e)/Math.max(Math.abs(c-e),1),s=(d-i)/Math.max(Math.abs(d-i),1),0!==r?(p.isWalkableAt(c,d-1)&&f.push([c,d-1]),p.isWalkableAt(c,d+1)&&f.push([c,d+1]),p.isWalkableAt(c+r,d)&&f.push([c+r,d])):0!==s&&(p.isWalkableAt(c-1,d)&&f.push([c-1,d]),p.isWalkableAt(c+1,d)&&f.push([c+1,d]),p.isWalkableAt(c,d+s)&&f.push([c,d+s]));else for(l=0,h=(a=p.getNeighbors(t,n.Never)).length;l<h;++l)o=a[l],f.push([o.x,o.y]);return f},t.exports=s},8717:(t,e,i)=>{var r=i(3506),n=i(2403),s=i(4524),a=i(5368),o=i(1405);t.exports=function(t){return(t=t||{}).diagonalMovement===r.Never?new n(t):t.diagonalMovement===r.Always?new s(t):t.diagonalMovement===r.OnlyWhenNoObstacles?new a(t):new o(t)}},1010:(t,e,i)=>{var r=i(4485),n=i(8408),s=i(9430);function a(t){t=t||{},this.heuristic=t.heuristic||s.manhattan,this.trackJumpRecursion=t.trackJumpRecursion||!1}i(3506),a.prototype.findPath=function(t,e,i,s,a){var o,l=this.openList=new r((function(t,e){return t.f-e.f})),h=this.startNode=a.getNodeAt(t,e),u=this.endNode=a.getNodeAt(i,s);for(this.grid=a,h.g=0,h.f=0,l.push(h),h.opened=!0;!l.empty();){if((o=l.pop()).closed=!0,o===u)return n.expandPath(n.backtrace(u));this._identifySuccessors(o)}return[]},a.prototype._identifySuccessors=function(t){var e,i,r,n,a,o,l,h,u,c,d=this.grid,p=this.heuristic,f=this.openList,m=this.endNode.x,g=this.endNode.y,_=t.x,y=t.y,v=Math.abs;for(Math.max,n=0,a=(e=this._findNeighbors(t)).length;n<a;++n)if(i=e[n],r=this._jump(i[0],i[1],_,y)){if(o=r[0],l=r[1],(c=d.getNodeAt(o,l)).closed)continue;h=s.octile(v(o-_),v(l-y)),u=t.g+h,(!c.opened||u<c.g)&&(c.g=u,c.h=c.h||p(v(o-m),v(l-g)),c.f=c.g+c.h,c.parent=t,c.opened?f.updateItem(c):(f.push(c),c.opened=!0))}},t.exports=a},8687:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(370),n=i(3410),s=i(4920),a=i(1203),o=i(6194),l=i(8116);i(8096),i(1939),i(5713);var h=i(5649),u=i(1827),c=i(8415),d=i(3438),p=i(8742),f=i(7191),m=i(9743),g=i(6899),_=i(9296),y=i(1770),v=i(261),x=i(6661),b=i(2785),E=i(6903),T=i(9432),S=i(2693),w=i(4258),A=i(6338),I=i(3485);const R={AlphaFilter:r.AlphaFilter,BlurFilter:n.BlurFilter,BlurFilterPass:n.BlurFilterPass,ColorMatrixFilter:s.ColorMatrixFilter,DisplacementFilter:a.DisplacementFilter,FXAAFilter:o.FXAAFilter,NoiseFilter:l.NoiseFilter};e.filters=R,Object.keys(h).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return h[t]}})})),Object.keys(u).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return u[t]}})})),Object.keys(c).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return c[t]}})})),Object.keys(d).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return d[t]}})})),Object.keys(p).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return p[t]}})})),Object.keys(f).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return f[t]}})})),Object.keys(m).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return m[t]}})})),Object.keys(g).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return g[t]}})})),Object.keys(_).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return _[t]}})})),Object.keys(y).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return y[t]}})})),Object.keys(v).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return v[t]}})})),Object.keys(x).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return x[t]}})})),Object.keys(b).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return b[t]}})})),Object.keys(E).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return E[t]}})})),Object.keys(T).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return T[t]}})})),Object.keys(S).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return S[t]}})})),Object.keys(w).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return w[t]}})})),Object.keys(A).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return A[t]}})})),Object.keys(I).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return I[t]}})}))},2587:t=>{"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,i,r,n){i=i||"&",r=r||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(i);var o=1e3;n&&"number"==typeof n.maxKeys&&(o=n.maxKeys);var l=t.length;o>0&&l>o&&(l=o);for(var h=0;h<l;++h){var u,c,d,p,f=t[h].replace(a,"%20"),m=f.indexOf(r);m>=0?(u=f.substr(0,m),c=f.substr(m+1)):(u=f,c=""),d=decodeURIComponent(u),p=decodeURIComponent(c),e(s,d)?Array.isArray(s[d])?s[d].push(p):s[d]=[s[d],p]:s[d]=p}return s}},2361:t=>{"use strict";var e=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,i,r,n){return i=i||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(n){var s=encodeURIComponent(e(n))+r;return Array.isArray(t[n])?t[n].map((function(t){return s+encodeURIComponent(e(t))})).join(i):s+encodeURIComponent(e(t[n]))})).join(i):n?encodeURIComponent(e(n))+r+encodeURIComponent(e(t)):""}},7673:(t,e,i)=>{"use strict";e.decode=e.parse=i(2587),e.encode=e.stringify=i(2361)},3379:t=>{"use strict";var e=[];function i(t){for(var i=-1,r=0;r<e.length;r++)if(e[r].identifier===t){i=r;break}return i}function r(t,r){for(var s={},a=[],o=0;o<t.length;o++){var l=t[o],h=r.base?l[0]+r.base:l[0],u=s[h]||0,c="".concat(h," ").concat(u);s[h]=u+1;var d=i(c),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var f=n(p,r);r.byIndex=o,e.splice(o,0,{identifier:c,updater:f,references:1})}a.push(c)}return a}function n(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,n){var s=r(t=t||[],n=n||{});return function(t){t=t||[];for(var a=0;a<s.length;a++){var o=i(s[a]);e[o].references--}for(var l=r(t,n),h=0;h<s.length;h++){var u=i(s[h]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}s=l}}},569:t=>{"use strict";var e={};t.exports=function(t,i){var r=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(i)}},9216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,i)=>{"use strict";t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var r="";i.supports&&(r+="@supports (".concat(i.supports,") {")),i.media&&(r+="@media ".concat(i.media," {"));var n=void 0!==i.layer;n&&(r+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),r+=i.css,n&&(r+="}"),i.media&&(r+="}"),i.supports&&(r+="}");var s=i.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},1181:function(t,e,i){"use strict";var r=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function a(t){try{l(r.next(t))}catch(t){s(t)}}function o(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((r=r.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var i,r,n,s,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(a=0)),a;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var s=i(8779),a=i(265),o=i(6217),l=i(6786),h=i(9273),u=i(1518),c=i(6041),d=i(1989),p=i(2062),f=i(245),m=i(2865),g=i(8018),_=i(6288),y=i(7409),v=i(3773),x=i(7553),b=i(9242),E=i(6028),T=i(8696),S=i(2746),w=i(4775),A=i(6739),I=i(1623),R=i(9320),C=function(){function t(){}return t.prototype.start=function(t){return r(this,void 0,void 0,(function(){var e,i,r,s,u,C,M,O,P,k,D,N,L,F,B,U;return n(this,(function(n){switch(n.label){case 0:return I.default.isElectron()||location.hostname,this.version=x.version,this.modelVersion=x.modelVersion,A.default.init(this),e="pixi"===t.display?d.default:_,this.display=e,this.input=h.default,this.audio=f.default,this.persistence=y,R.default.setDisplay(this.display),[4,this.display.preinit(this)];case 1:return n.sent(),i=t.appearanceFile,[4,R.default.loadData(i)];case 2:return r=n.sent(),b.default.load(r.data),[4,R.default.loadData("plants.json")];case 3:return s=n.sent(),l.default.init(s.data),C=(u=E.default).init,[4,R.default.loadData("races.json")];case 4:return C.apply(u,[n.sent()]),[4,R.default.loadData("items.json")];case 5:return M=n.sent(),[4,R.default.loadData("worldObjects.json")];case 6:return O=n.sent(),[4,R.default.loadData("notes.json")];case 7:return P=n.sent(),w.default.init(this,M.data,O.data,P.data),[4,R.default.loadData("crafting.json")];case 8:return k=n.sent(),[4,R.default.loadData("cooking.json")];case 9:return D=n.sent(),o.default.init(k.data,D.data),L=(N=a.default).init,[4,R.default.loadData("achievements.json")];case 10:return L.apply(N,[n.sent()]),c.default.init(),[4,R.default.loadData("onboarding.json")];case 11:return F=n.sent(),S.default.init(this,F.data),p.default.init(this),this.onboardingStep=-1,B=this,[4,R.default.loadData("scenario.json")];case 12:return B.scenarioData=n.sent(),U={items:w.default,recipes:o.default},w.default.validate(),l.default.validate(U),E.default.validate(U),S.default.validate(U),o.default.validate(),c.default.validate(),T.default.load(),[4,this.display.init()];case 13:return n.sent(),h.default.init(this),f.default.init(),m.default.loadAudio(this),g.registerClass("Game",void 0,{transients:{display:!0,input:!0,audio:!0,persistence:!0,scenarioData:!0},reviver:function(t){t.display=e,t.input=h.default,t.audio=f.default,t.persistence=y}}),this._c=g.register("Game"),this.display.displayTitleScreen(),v.default.checkVersion(this.display),[2]}}))}))},t.prototype.loadGame=function(t,e){var i=this;if(this.persistence.hasSaveGame()){try{this.persistence.loadIntoGame(this,t)}catch(r){if("versionMismatch"==r.code)return void(t?e("Your save game is from an older model version (#"+r.version+"). Migration to model "+this.modelVersion+" failed."):(e("Your save game is from an older model version (#"+r.version+"). Attempting migration to model "+this.modelVersion),this.display.tickOnce((function(){return i.loadGame(!0,e)}))));if("unsupportedMigration"===r.code)return void e("Sorry, Migration from model version (#"+r.version+") is not supported.");if("parseError"===r.code)throw e("Error recovering game data."),r;throw r}this.scenarioData.knownRecipes.forEach((function(t){if(!o.default.get(t))throw new Error("Invalid known recipe [".concat(t,"]"));i.player.knowsRecipe(t)||i.player.addRecipe(o.default.get(t))})),this.world.level.updatePathfindingGrids(),this.display.tipsDisabled||(this.onboardingStep--,S.default.nextStep()),this.audio.resetKickstartMelodies(),this.player.updateFOV(),this.player.checkCampfireSFX(),this.display.refresh(),this.display.activateMainMode(),this.input.setMode(h.InputMode.MOVEMENT)}else e("No saved game found.")},t.prototype.newGame=function(t){var e=this;this.world=new u.default,(null==t?void 0:t.isWinter)&&(this.world.isWinter=!0),this.player=new s.default,this.player.init(this),(null==t?void 0:t.playerSuffix)&&(this.player.appearanceSuffix=t.playerSuffix),this.world.init(this),this.audio.resetKickstartMelodies(),this.scenarioData.startingItems.forEach((function(t){return e.player.addNewItem(t.itemId,t.quantity)})),this.player.setCurrentTool(this.scenarioData.startingItems[0].itemId),this.scenarioData.knownRecipes.forEach((function(t){if(!o.default.get(t))throw new Error("Invalid known recipe [".concat(t,"]"));e.player.addRecipe(o.default.get(t))})),this.display.intro(),this.input.setMode(h.InputMode.INTRO)},t.prototype.afterIntro=function(){this.input.setMode(h.InputMode.MOVEMENT),this.display.alert('Entering "Emerald Woods" Zone\n\nVery cold woods full of berries. Here, days are shorter and crops take longer to grow.\n\nRain is rare. Caves are unusually rich in carbon deposits and usually very wet.\n\nThe most common trees here are larchs, spruce, fir, and pines. Willows are uncommon.\n\nThe amanita muscaria fungi is common here.\n\nThis area is very rocky and full of lakes and rivers. It\'s located next to the mountains.',!1,(function(){S.default.nextStep()}))},t}();e.Game=C,g.registerClass("Game",C,{transients:{display:!0,input:!0,audio:!0,scenarioData:!0}});var M=new C;window.Game=M,e.default=M},265:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={init:function(t){var e=this.data={};this.list=t.data,t.data.forEach((function(t){e[t.id]=t}))},get:function(t){return this.data[t]},all:function(){return this.list}}},9242:function(t,e,i){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},r.apply(this,arguments)},n=this&&this.__spreadArray||function(t,e,i){if(i||2===arguments.length)for(var r,n=0,s=e.length;n<s;n++)!r&&n in e||(r||(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0});var s=i(3945).default,a=window.ut,o=new(function(){function t(){}return t.prototype.load=function(t){var e=this;this.data={},t.forEach((function(t){var i,r,o;if(!t.character)throw new Error("Invalid appearanceData ["+t.id+"]");t.tile=new((i=a.Tile).bind.apply(i,n([void 0,t.character],s.hexToRGB(t.color),!1))),t.hexColor=s.hexToByte(t.color),t.verticalOffset=null!==(r=t.verticalOffset)&&void 0!==r?r:0,t.horizontalOffset=null!==(o=t.horizontalOffset)&&void 0!==o?o:0,e.data[t.id]=t}))},t.prototype.exists=function(t){return!!this.data[t]},t.prototype.get=function(t){var e=this.data[t];if(!e)throw new Error("Invalid appearance ["+t+"]");return e},t.prototype.clone=function(t){return r({},t)},t.prototype.rotated=function(t,e){var i=this.data[t.id+"$$"+e];return i||((i=this.clone(t)).rotation=e,this.data[t.id+"$$"+e]=i,i)},t.prototype.painted=function(t,e){return t},t}());e.default=o},9320:function(t,e){"use strict";var i=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function a(t){try{l(r.next(t))}catch(t){s(t)}}function o(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((r=r.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var i,r,n,s,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(a=0)),a;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};function n(t,e){return i(this,void 0,void 0,(function(){return r(this,(function(i){return[2,new Promise((function(i,r){var n=new XMLHttpRequest;n.open(t,e),n.onload=function(){n.status>=200&&n.status<300?i(n.response):r({status:n.status,statusText:n.statusText})},n.onerror=function(){r({status:n.status,statusText:n.statusText})},n.send()}))]}))}))}Object.defineProperty(e,"__esModule",{value:!0});var s=new(function(){function t(){}return t.prototype.setDisplay=function(t){this.display=t},t.prototype.loadData=function(t){return i(this,void 0,void 0,(function(){var e;return r(this,(function(i){switch(i.label){case 0:return[4,n("GET","data/"+t)];case 1:return e=i.sent(),this.display.loadProgress(),[2,JSON.parse(e)]}}))}))},t}());e.default=s},9328:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.TOOL=0]="TOOL",t[t.SEED=1]="SEED",t[t.RESOURCE=2]="RESOURCE",t[t.OBJECT=3]="OBJECT",t[t.FRUIT=4]="FRUIT",t[t.BEING=5]="BEING",t[t.WORLD_OBJECT=6]="WORLD_OBJECT"}(i||(i={})),e.default=i},4775:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9242),n=i(6786),s=i(9328),a=i(6028),o=i(3945),l=5e3,h=new(function(){function t(){}return t.prototype.init=function(t,e,i,n){var h=this;this.game=t;var u=n.map((function(t,e){var i,r,n,s;return{id:null!==(i=t.id)&&void 0!==i?i:"$CLUE_"+e,type:"WORLD_OBJECT",name:null!==(r=t.name)&&void 0!==r?r:"TAPE"===t.noteType?"16mm Film Reel":"Note",app:null!==(n=t.app)&&void 0!==n?n:"TAPE"===t.noteType?"TAPE":"NOTE",effect:"read",description:null!==(s=t.description)&&void 0!==s?s:"TAPE"===t.noteType?"You need a projector to play it.":"A paper note.",grabSound:"grab_note",noteContents:t.contents,noteType:t.noteType,weight:t.weight}})),c=e.concat(i).concat(u),d={};c.forEach((function(t){d[t.id]=t,t.type=t.type?s.default[t.type]:s.default.WORLD_OBJECT,t.app=r.default.get(t.app),t.menuAppearance=t.menuAppearance&&r.default.get(t.menuAppearance),t.cropApp=t.cropApp?r.default.get(t.cropApp):t.app,t.noStack=t.containerCapacity,t.lightSource&&(t.lightSource.color=o.default.hexToByte(t.lightSource.color))})),c.filter((function(t){return t.seedProduce})).forEach((function(t){var e=Object.assign({},t);e.id="MASHED_".concat(t.id),e.name="".concat(t.name," (Mashed)"),e.isForagedPlant=!1,delete e.seedProduce,delete e.grabSound,d[e.id]=e})),a.default.all().forEach((function(t){var e=t.id;d["$RACE_"+e]={id:"$RACE_"+e,type:s.default.BEING,raceId:e,name:t.name,app:t.app,description:t.description,exchange:{value:20},sacrifice:h.getSacrificeForRace(t),noStack:!0,weight:t.weight};var i=.8*t.weight,r=i<l?i:l;d[e+"_MEAT"].weight=r,d["GRILLED_"+e].weight=.8*r})),this.data=d,this.plantsCount=c.filter((function(t){return t.isForagedPlant})).length},t.prototype.getSacrificeForRace=function(t){var e=.8*t.weight,i=Math.ceil(e/l);return{itemId:t.id+"_MEAT",quantity:i>1?2:1}},t.prototype.get=function(t){return this.data[t]},t.prototype.getAspect=function(t){return"EGG"===t?{name:"Egg"}:null},t.prototype.renderMaps=function(){var t=this;Object.keys(this.data).forEach((function(e){var i=t.get(e);i.map&&t.game.display.mapPanel.loadMap(i)}))},t.prototype.validate=function(){var t=this;Object.keys(this.data).forEach((function(e){var i,r=t.get(e);if(r.plantId&&!n.default.get(r.plantId))throw new Error("Plant "+r.plantId+" from item "+r.id+" not found");if((null===(i=r.transform)||void 0===i?void 0:i.itemId)&&!t.data[r.transform.itemId])throw new Error("Transform "+r.transform.itemId+" from item "+r.id+" not found");if(!r.weight)throw new Error("Item ".concat(r.id," has no weight"))}))},t}());e.default=h},6786:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4738),n=i(9242),s=new(function(){function t(){this.cropsCount=0}return t.prototype.get=function(t){return this.data[t]},t.prototype.getAFlower=function(t){return this.get("FLOWER_"+r.default.n(1,4))},t.prototype.init=function(t){var e=this;this.cropsCount=t.filter((function(t){return"Sprout"===t.type})).length;var i=t.map((function(t){var e,i={type:t.type,growStages:t.growStages,id:t.id,hp:t.hp,name:t.name,produce:t.produce&&""!=t.produce?{id:t.produce,quantity:t.produceQuantity,isTree:"Tree"===t.produceType}:void 0,isTimber:!!(null===(e=t.chopInto)||void 0===e?void 0:e.itemId),chopInto:t.chopInto,cutableBranches:t.cutableBranches,opaque:t.opaque,solid:t.solid,solidStage:t.solidStage,grabSound:t.grabSound,stages:t.stageAppearances?t.stageAppearances.split(",").map((function(t){return n.default.get(t)})):[n.default.get(t.id)],winterStages:[],phaseMinutes:t.stageTime,persistAfterProduce:t.persistAfterProduce,stumpAfterChop:t.stumpAfterChop,stumpAppearance:t.stumpAppearance?n.default.get(t.stumpAppearance):void 0};i.winterStages=i.stages.map((function(t){return n.default.exists(t.id+"_WINTER")?n.default.get(t.id+"_WINTER"):t}));var r=t.growStages?t.growStages+1:1;if(i.stages.length<r)for(var s=0;s<r-i.stages.length;s++)i.stages.push(n.default.get("NONE")),i.winterStages.push(n.default.get("NONE"));return i}));this.data=new Map,i.forEach((function(t){return e.data[t.id]=t}))},t.prototype.validate=function(t){var e=this;Object.keys(this.data).forEach((function(i){var r,n,s=e.data[i];if(s.produce)if(s.produce.isTree){if(!e.data[s.produce.id])throw new Error("Invalid tree produce ["+s.produce.id+"] for plant ["+s.id+"]")}else if(!t.items.get(s.produce.id))throw new Error("Invalid item produce ["+s.produce.id+"] for plant ["+s.id+"]");if((null===(r=s.chopInto)||void 0===r?void 0:r.itemId)&&!t.items.get(s.chopInto.itemId))throw new Error("Invalid item chopInto ["+s.chopInto.itemId+"] for plant ["+s.id+"]");if((null===(n=s.cutableBranches)||void 0===n?void 0:n.itemId)&&!t.items.get(s.cutableBranches.itemId))throw new Error("Invalid item cutableBranches ["+s.cutableBranches.itemId+"] for plant ["+s.id+"]");if(s.stumpAfterChop&&!s.stumpAppearance)throw new Error("Missing stump appearance forplant ["+s.id+"]")}))},t}());e.default=s},6028:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9242),n=new(function(){function t(){}return t.prototype.init=function(t){var e=this.data={};this.list=t.data,t.data.forEach((function(t){e[t.id]=t,t.app=r.default.get(t.id)}))},t.prototype.get=function(t){return this.data[t]},t.prototype.small=function(){return this.list.filter((function(t){return t.weight<=3e4}))},t.prototype.all=function(){return this.list},t.prototype.validate=function(t){var e=this;this.list.forEach((function(i){if(i.produce){if("item"===i.produce.type&&!t.items.get(i.produce.id))throw new Error("Invalid produce for race ["+i.id+"], item ["+i.produce.id+"]");if("animal"===i.produce.type&&!e.get(i.produce.id))throw new Error("Invalid produce for race ["+i.id+"], race ["+i.produce.id+"]")}}))},t}());e.default=n},6217:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9242),n=i(4775),s=new(function(){function t(){}return t.prototype.init=function(t,e){var i=this;e.forEach((function(t){return t.type="cook"})),this.data={},t.concat(e).forEach((function(t){i.data[t.id]=t}))},t.prototype.validate=function(){var t=this;Object.keys(this.data).forEach((function(e){var i=t.get(e);if(i.itemId&&!n.default.get(i.itemId))throw new Error("Invalid item ["+i.itemId+"] for recipe "+i.id);if(i.flooringId&&!n.default.get(i.flooringId))throw new Error("Invalid world object ["+i.flooringId+"] for recipe "+i.id);if(i.requiredContainer&&!n.default.get(i.requiredContainer))throw new Error("Invalid required container ["+i.requiredContainer+"] for recipe "+i.id);i.materials.forEach((function(e){if("WATER"!==e.id){if(e.isAspect&&!t.isValidAspect(e.id))throw new Error("Invalid ingredient ["+e.id+"] aspect for recipe "+i.id);if(isNaN(e.quantity))throw new Error("Invalid quantity ["+e.quantity+"] for ingredient ["+e.id+"] for recipe "+i.id);if(e.isAspect){if(!n.default.getAspect(e.id))throw new Error("Invalid aspect ["+e.id+"] for recipe "+i.id)}else{var r=n.default.get(e.id);if(!r)throw new Error("Invalid ingredient ["+e.id+"] for recipe "+i.id);if(r.noStack)throw new Error("Ingredient ["+e.id+"] for recipe "+i.id+" is noStack");if(r.fixed)throw new Error("Ingredient ["+e.id+"] for recipe "+i.id+" is fixed")}}}))}))},t.prototype.getItem=function(t){return t.flooringId?n.default.get(t.flooringId):n.default.get(t.itemId)},t.prototype.getMenuAppearance=function(t){var e;if(t.menuAppearance)return r.default.get(t.menuAppearance);var i=this.getItem(t);return null!==(e=i.menuAppearance)&&void 0!==e?e:i.app},t.prototype.getWorldAppearance=function(t){return this.getItem(t).app},t.prototype.getMaterialsDescription=function(t){var e=this.getItem(t).name+" (";return t.requiredContainer&&(e+=n.default.get(t.requiredContainer).name+", "),t.materials.forEach((function(i,r){"WATER"===i.id?e+="Water x"+i.quantity:e+=n.default.get(i.id).name+" x"+i.quantity,r<t.materials.length-1&&(e+=", ")})),e+=")"},t.prototype.get=function(t){return this.data[t]},t.prototype.isValidAspect=function(t){return"EGG"===t},t.prototype.getAspect=function(t){return"EGG"===t?{name:"Egg",app:r.default.get("EGG")}:null},t.prototype.learnAll=function(t){var e=this;Object.keys(this.data).forEach((function(i){return t.addRecipe(e.get(i))}))},t}());e.default=s},5402:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8866),n={charMap:{"#":{id:"GRASS",flooringId:"WOODEN_WALL"},x:{id:"GRASS",flooringId:"BRICK_FLOORING_2"},W:{id:"GRASS",flooringId:"BRICK_WALL"},".":{id:"GRASS",flooringId:"WOODEN_FLOOR"},",":{id:"GRASS"},"/":{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"WOODEN_DOOR_CLOSED"},D:{id:"GRASS",flooringId:"BRICK_FLOORING_2",itemId:"GRAY_DOOR_CLOSED"},C:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"WOODEN_CHAIR"}},templates:{HOUSE:{id:"FARM",charMap:{6:{id:"GRASS",flooringId:"WOODEN_FLOOR",buildingMarker:{type:r.BuildingType.CABIN,description:"Cabin"}},s:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"WOODEN_TABLE",stackedItemId:"$COMMON_INGREDIENT"},2:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"WOODEN_TABLE",stackedItemId:"$REFINED_INGREDIENT"}},map:["######","#26.s#","#....#","###/##"]},MY_HOUSE:{id:"CABIN",charMap:{B:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"SMALL_BED"},o:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"WOODEN_TABLE",stackedItemId:"BOOK_SPECIES"},u:{id:"GRASS",itemId:"GENCO_MANIFEST"},T:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"WOODEN_TABLE"},S:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"STOVE",stackedItemId:"STEEL_POT",buildingMarker:{type:r.BuildingType.CABIN,description:"Cabin"}},1:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"KNIFE"},2:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"LEASH"},3:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"SHOVEL"},4:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"PICKAXE"},"+":{id:"GRASS",flooringId:"WOODEN_WINDOW"},5:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"STEEL_POT"},6:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"WOODEN_CRATE"},7:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"FISHING_ROD"},8:{id:"GRASS",flooringId:"WOODEN_FLOOR",itemId:"FRYING_PAN"}},map:["### ###","#12346#","#..... ","### # 7","#o8 #  "," 5..   ","  u    ","#   #  "]},LAKE:{id:"LAKE",charMap:{w:{id:"PUDDLE"}},map:[" www ","  www"]},STATION:{id:"STATION",charMap:{"?":{id:"GRASS",flooringId:"BRICK_FLOORING_2",itemId:"GRAY_TABLE_M",stackedItemId:"$CLUE"},S:{id:"GRASS",flooringId:"BRICK_FLOORING_2",itemId:"GRAY_TABLE_L",stackedItemId:"$BERRY_SEED"},P:{id:"GRASS",flooringId:"BRICK_FLOORING_2",itemId:"GRAY_TABLE_R",stackedItemId:"$RARE_INGREDIENT"},1:{id:"GRASS",flooringId:"BRICK_FLOORING_2",itemId:"WOODEN_TABLE",stackedItemId:"$COMMON_INGREDIENT"},2:{id:"GRASS",flooringId:"BRICK_FLOORING_2",itemId:"WOODEN_TABLE",stackedItemId:"$REFINED_INGREDIENT"},4:{id:"GRASS",flooringId:"BRICK_FLOORING_2",buildingMarker:{type:r.BuildingType.STATION,description:"Genco Station"},itemId:"GRAY_TABLE_M",stackedItemId:"$TOOL"}},map:["   WWWWWW   ","  WWS?4PWW  "," WWxxxxxxWW "," W1xxxxxx1W "," W2xxxxxx2W "," W1xxxxxx1W "," WWxxxxxxWW ","  WWxxxxWW  ","   WWWDWW   "]},WORKSHOP:{id:"WORKSHOP",charMap:{"?":{id:"GRASS",flooringId:"BRICK_FLOORING_2",beingId:"RULFO"}},map:["   WWWWWW   ","   Wx?xxW   "," WWWxxxxWWW "," WxxxxxxxxW "," DxxxxxxxxD "," WWWWWxWWWW ","  WxxxxxxW  ","  WWxxWxWW  ","   WWWWWW   "]},RUINED_STATION:{id:"RUINED_STATION",charMap:{1:{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2",itemId:"MAP_GUIDE"},"*":{id:"GRASS",flooringId:"BRICK_FLOORING_2",buildingMarker:{type:r.BuildingType.STATION,description:"The Hatch"},itemId:"MAP"},x:{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2"},">":{id:"GRASS",itemId:"OPEN_HATCH"},"<":{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2",itemId:"STAIRS_UP"},W:{id:"STONE_FLOOR",flooringId:"PLOT_WALL"}},map:["               ","            >  ","               ","               ","               ","               ","               ","               ","               "],map2:["  WWWWW   WWWWW"," WWxxxWW  Wx<xW","WWxx1*xWW WxxxW","WxxxxxxxWWWxxxW","WxxxxxxxxxxxxxW","WxxxxxxxWWWWWWW","WWxxxxxWW      "," WWxxxWW       ","  WWWWW        "]},OFFICE:{id:"OFFICE",charMap:{x:{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2"},">":{id:"GRASS",itemId:"CLOSED_HATCH"},D:{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2",itemId:"GRAY_DOOR_CLOSED"},E:{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2",itemId:"GRAY_TABLE_L",stackedItemId:"EMBERBERRY_SEED"},"?":{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2",itemId:"GRAY_TABLE_R",stackedItemId:"$CLUE"},4:{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2",itemId:"GRAY_TABLE_M",stackedItemId:"$CLUE"},5:{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2",buildingMarker:{type:r.BuildingType.OFFICES,description:"Central Station"}},P:{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2",itemId:"WOODEN_TABLE",stackedItemId:"$RARE_INGREDIENT"},S:{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2",itemId:"WOODEN_TABLE",stackedItemId:"$BERRY_SEED"},V:{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2",itemId:"WOODEN_TABLE",stackedItemId:"TAPE_PROJECTOR"},"<":{id:"STONE_FLOOR",flooringId:"BRICK_FLOORING_2",itemId:"STAIRS_UP"},W:{id:"STONE_FLOOR",flooringId:"PLOT_WALL"}},map:["                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","              >              ","                             ","                             "],map2:["   WWWWWWWWWWWWWWWWWWWWWWW   ","  WWxxVxxxWxxE4?xxWxxxxxPWW  "," WWxxxxxxxWxxxxxxxWxxxxxxxWW "," WxxxxxxxxDxxxxxxxDxxxxxxxxW "," WxxxxxxxxWxxxxxxxWxxxxxxxxW "," WWWWWWWWWWxxxxxxxWWWWWWWWWW "," WxxxxxxxxxxxxxxxxxxxxxxxxxW "," WxxxxxxWxWWWWWWWWWxWxxxxxxW "," WxxxxxxWxxxxxxxxxxxWxxxxxxW "," WWWWDWWWWWWWWWWWWWWWWWDWWWW "," WPxxxxxxxxxxx5xxxxxxxxxxxxW "," WxxxxxxxxxWxxxxxWxxxxxxxxxW "," WWxxxxxxxxWxx<xxWxxxxxxxxWW ","  WWxxxxxxxWxxxxxWxxxxxxxWW  ","   WWWWWWWWWWWWWWWWWWWWWWW   "]}}};e.default=n},234:t=>{t.exports={intro:["Some weeks ago, you decided to take your chances and live the life of a hermit, far away from civilization.","You have been walking for days through these woods, losing yourself to nature and forgetting the way back. This land seems deserted and sealed off from the outside world.","As you start getting weary, you find a ruined cabin next to a tiny lagoon. There is not much inside the cabin, however, besides some carrot seeds and some farming tools.","With your reserves of food all but dry, you now gotta choose between becoming a farmer or continue exploring the zone. Maybe you'll find something of use inside other similarly abandoned dwellings.","Today is the first day of your new life. You are on your own.","Press $ACTION to start."],earlyDevelopment:"This is an early development version of the game, we have a lot of features planned, please check the roadmap at the website (https://slash.itch.io/emerald-woods) for further info."}},6041:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9242),n=i(4775),s={HOLE:{name:"Hole",solid:!0,opaque:!1,isGround:!1,previewColor:"#77B02A",mapColor:5882165,dropTransform:{acceptedItemId:"CLAY",requiredQuantity:10,targetTileId:"GRASS"}},GRASS:{name:"Grass",solid:!1,opaque:!1,isGround:!0,tillable:{toTileId:"TILLED_GRASS"},digTransform:{toTileId:"DUG_GROUND",digRewardId:"CLAY",rewardChance:50},previewColor:"#77B02A",mapColor:5882165,stepAudio:{preffix:"fs_grass_0",variations:6},dropAudio:{preffix:"drop_grass_0",variations:2},faintAudio:"faint_grass"},PERMAFROST:{name:"Permafrost",solid:!1,opaque:!1,isGround:!0,tillable:{toTileId:"TILLED_FROST"},previewColor:"#77B02A",stepAudio:{preffix:"fs_snow_0",variations:9}},SNOW:{name:"Snow",solid:!1,opaque:!1,isGround:!0,previewColor:"#77B02A",snowWalkTransform:"SNOW_WALKED",digTransform:{sfx:{preffix:"dig_snow_0",variations:6},digRewardId:"SNOW",toTileId:"PERMAFROST"},stepAudio:{preffix:"fs_snow_0",variations:9}},SNOW_WALKED:{name:"Snow",solid:!1,opaque:!1,isGround:!0,previewColor:"#77B02A",digTransform:{digRewardId:"SNOW",toTileId:"PERMAFROST"},stepAudio:{preffix:"fs_snow_0",variations:9}},FROZEN_WATER:{name:"Frozen Water",solid:!1,opaque:!1,isGround:!0,previewColor:"#77B02A",fragile:!0,breakable:{sfx:{prefix:"break_ice_0",variations:6},hp:1,toTile:"WATER"},stepAudio:{preffix:"fs_ice_0",variations:6}},FROZEN_DEEP_WATER:{name:"Frozen Water",solid:!1,opaque:!1,isGround:!0,previewColor:"#77B02A",fragile:!0,breakable:{sfx:{prefix:"break_ice_0",variations:6},hp:1,toTile:"DEEP_WATER"},stepAudio:{preffix:"fs_ice_0",variations:6}},FROZEN_PUDDLE:{name:"Frozen Water",solid:!1,opaque:!1,isGround:!0,previewColor:"#77B02A",fragile:!0,breakable:{sfx:{prefix:"break_ice_0",variations:6},hp:1,toTile:"PUDDLE"},stepAudio:{preffix:"fs_ice_0",variations:6}},FROZEN_CHANNEL:{name:"Frozen Water",solid:!1,opaque:!1,isGround:!0,previewColor:"#77B02A",fragile:!0,breakable:{sfx:{prefix:"break_ice_0",variations:6},hp:1,toTile:"CHANNEL"},stepAudio:{preffix:"fs_ice_0",variations:6}},TALL_GRASS:{name:"Tall Grass",solid:!1,opaque:!1,isGround:!0,tallGrass:!0,cutSFX:{prefix:"mow_0",variations:6},digTransform:{toTileId:"DUG_GROUND",digRewardId:"CLAY",rewardChance:50},previewColor:"#77B02A",mapColor:5882165,stepAudio:{preffix:"fs_grass_0",variations:6},dropAudio:{preffix:"drop_grass_0",variations:2},faintAudio:"faint_grass"},STONE_FLOOR:{name:"Stone floor",solid:!1,isGround:!0,isUnderMountain:!0,opaque:!1,tillable:{toTileId:"TILLED_GROUND"},previewColor:"#C7D4E1",mapColor:9278640,stepAudio:{preffix:"fs_cave_0",variations:6},dropAudio:{preffix:"drop_cave_0",variations:2},faintAudio:"faint_cave"},ROCK_FLOOR:{name:"Rock floor",solid:!1,isGround:!0,isUnderMountain:!0,opaque:!1,previewColor:"#C7D4E1",mapColor:9278640,stepAudio:{preffix:"fs_cave_0",variations:6},dropAudio:{preffix:"drop_cave_0",variations:2},faintAudio:"faint_cave"},TILLED_GROUND:{name:"Tilled ground",solid:!1,opaque:!1,tilled:!0,tillable:{toTileId:"STONE_FLOOR"},previewColor:"#F0C297",stepAudio:{preffix:"fs_dirt_0",variations:6},dropAudio:{preffix:"drop_dirt_0",variations:2},faintAudio:"faint_dirt"},TILLED_GRASS:{name:"Tilled ground",solid:!1,opaque:!1,tilled:!0,tillable:{toTileId:"GRASS"},digTransform:{toTileId:"DUG_GROUND",digRewardId:"CLAY",rewardChance:50},previewColor:"#F0C297",stepAudio:{preffix:"fs_dirt_0",variations:6},dropAudio:{preffix:"drop_dirt_0",variations:2},faintAudio:"faint_dirt"},TILLED_FROST:{name:"Tilled frost",solid:!1,opaque:!1,tilled:!0,tillable:{toTileId:"PERMAFROST"},previewColor:"#F0C297",stepAudio:{preffix:"fs_dirt_0",variations:6},dropAudio:{preffix:"drop_dirt_0",variations:2},faintAudio:"faint_dirt"},DUG_GROUND:{name:"Dug ground",solid:!1,opaque:!1,digDestroyable:!0,previewColor:"#F0C297",stepAudio:{preffix:"fs_dirt_0",variations:6},dropAudio:{preffix:"drop_dirt_0",variations:2},faintAudio:"faint_dirt"},WATER:{name:"Water",opaque:!1,previewColor:"#78D7FF",stepAudio:{preffix:"swim_surface_0",variations:5},mapColor:2645188,isWater:!0},CHANNEL:{name:"Channel",opaque:!1,previewColor:"#78D7FF",stepAudio:{preffix:"swim_surface_0",variations:5},mapColor:2645188,isHalfWater:!0,isWater:!0},PUDDLE:{name:"Puddle",opaque:!1,previewColor:"#78D7FF",stepAudio:{preffix:"swim_surface_0",variations:5},mapColor:2645188,isHalfWater:!0,isWater:!0},RAPID_WATER:{name:"Rapid Water",opaque:!1,previewColor:"#78D7FF",stepAudio:{preffix:"swim_surface_0",variations:5},mapColor:2645188,isRapidWater:!0,isWater:!0},RAPID_DEEP_WATER:{name:"Rapid Deep Water",opaque:!1,previewColor:"#78D7FF",stepAudio:{preffix:"swim_surface_0",variations:5},mapColor:2645188,isRapidWater:!0,isDeepWater:!0,isWater:!0},DEEP_WATER:{name:"Deep Water",opaque:!1,previewColor:"#78D7FF",stepAudio:{preffix:"swim_surface_0",variations:5},mapColor:2645188,isDeepWater:!0,isWater:!0},WORLD_BOUNDARIES:{name:"Void",solid:!0,opaque:!0,previewColor:"#928FB8",mapColor:2097152},ROCK:{name:"Rock",solid:!0,opaque:!0,isUnderMountain:!0,previewColor:"#928FB8",mapColor:9278640,breakable:{sfx:{prefix:"rock_break"},hp:7,toTile:"STONE_FLOOR",toItem:[{itemId:"STONE",itemQuantity:3,chance:20},{itemId:"FLINTSTONE",itemQuantity:1,chance:5},{itemId:"CARBON",itemQuantity:1,chance:5},{itemId:"IRON_ORE",itemQuantity:1,chance:1}]},stepAudio:{preffix:"fs_cave_0",variations:6},dropAudio:{preffix:"drop_cave_0",variations:2},faintAudio:"faint_cave"},COLD_ROCK:{name:"Cold Cave",solid:!0,opaque:!0,isUnderMountain:!0,previewColor:"#928FB8",mapColor:9278640,breakable:{sfx:{prefix:"rock_break"},hp:7,toTile:"ROCK_FLOOR",toItem:[{itemId:"STONE",itemQuantity:3,chance:20},{itemId:"FLINTSTONE",itemQuantity:1,chance:5},{itemId:"CARBON",itemQuantity:1,chance:5},{itemId:"IRON_ORE",itemQuantity:1,chance:5}]},stepAudio:{preffix:"fs_cave_0",variations:6},dropAudio:{preffix:"drop_cave_0",variations:2},faintAudio:"faint_cave"},FOREST_FLOOR:{name:"Forest ground",solid:!1,opaque:!1,isGround:!0,tillable:{toTileId:"TILLED_GRASS"},digTransform:{toTileId:"DUG_GROUND",digRewardId:"CLAY",rewardChance:50},previewColor:"#F5A15D",mapColor:2380347,stepAudio:{preffix:"fs_dirt_0",variations:6},dropAudio:{preffix:"drop_dirt_0",variations:2},faintAudio:"faint_dirt"}},a={init:function(){Object.keys(s).forEach((function(t){s[t].id=t,s[t].appearanceId?s[t].app=r.default.get(s[t].appearanceId):s[t].app=r.default.get(t)}))},validate:function(){var t=this;Object.keys(s).forEach((function(e){var i=s[e];if(i.digTransform){if(i.digTransform.toTileId&&!t.get(i.digTransform.toTileId))throw new Error("Invalid digTransform toTileId [".concat(i.digTransform.toTileId,"] for tile [").concat(e,"]"));if(i.digTransform.digRewardId&&!n.default.get(i.digTransform.digRewardId))throw new Error("Invalid digTransform digRewardId [".concat(i.digTransform.digRewardId,"] for tile [").concat(e,"]"))}if(i.dropTransform){if(!t.get(i.dropTransform.targetTileId))throw new Error("Invalid targetTileId [".concat(i.dropTransform.targetTileId,"] for tile [").concat(e,"] dropTransform"));if(!n.default.get(i.dropTransform.acceptedItemId))throw new Error("Invalid acceptedItemId [".concat(i.dropTransform.acceptedItemId,"] for tile [").concat(e,"] dropTransform"))}}))},get:function(t){return s[t]}};e.default=a},705:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(9284),s=i(9273),a=i(9969),o=function(){function t(t,e,i,n,s,o,l,h){this.renderer=t,this.game=n,this.stationTexture=s,this.forestTexture=o,this.smallForestTexture=l,this.mountainTexture=h,this.mapTexturesCache={},this.mainContainer=new r.Container,this.mainContainer.visible=!1,e.addChild(this.mainContainer);var u=i.panelConfig.map,c=i.createFrame(u.x,u.y,u.w,u.h);this.mainContainer.addChild(c.container),this.mapSprite=new r.Sprite,this.mapSprite.x=u.x+4,this.mapSprite.y=u.y+20,this.mainContainer.addChild(this.mapSprite),this.mapSprite.scale.x=u.scale,this.mapSprite.scale.y=u.scale,this.mapLabel=a.createTextBox(u.x+Math.floor(u.w/2)-60,u.y+6,"Genco Fields - Sector 3"),this.mainContainer.addChild(this.mapLabel)}return t.prototype.loadMap=function(t){var e=n.default.renderMap(this.renderer,1,this.game.world.level,t.map.x,t.map.y,t.map.w,t.map.h,0,this.stationTexture,this.forestTexture,this.smallForestTexture,this.mountainTexture);return this.mapTexturesCache[t.id]=e,e},t.prototype.show=function(t){var e=this.mapTexturesCache[t.def.id];e||(e=this.loadMap(t.def)),this.mapSprite.texture=e,this.mainContainer.visible=!0,this.game.input.setMode(s.InputMode.MAP)},t.prototype.hide=function(){this.mainContainer.visible=!1},t.prototype.locate=function(t,e){this.mainContainer.x=t,this.mainContainer.y=e},t}();e.default=o},9284:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(4738),s=i(8866),a=new(function(){function t(){}return t.prototype.renderMap=function(t,e,i,a,o,l,h,u,c,d,p,f){var m=new r.Graphics;m.width=e*l,m.height=e*h,m.beginFill(14996138),m.drawRect(0,0,e*l,e*l);for(var g=0;g<l;g++)for(var _=0;_<h;_++){var y=this.getColor(i,a+g,o+_,u);y<0||(m.beginFill(y),m.drawRect(g*e,_*e,e,e))}var v=r.RenderTexture.create({width:e*l,height:e*h});for(t.render(m,{renderTexture:v}),_=0;_<h;_+=3)for(g=0;g<l;g+=3)if(i.getTile(a+g,o+_,u).solid||i.isUnderMountain(a+g,o+_,u)){if(n.default.chance(90))continue;var x=new r.Sprite(f),b=g+(n.default.chance(50)?0:n.default.n(-2,2)),E=_+(n.default.chance(50)?0:n.default.n(-2,2));x.position.x=b*e,x.position.y=E*e,x.anchor.x=.5,x.anchor.y=.5,t.render(x,{renderTexture:v,clear:!1})}else if(i.getPlantAt(a+g,o+_,u)&&!n.default.chance(0)){var T=p;n.default.chance(25)&&(T=d);var S=new r.Sprite(T),w=g+(n.default.chance(50)?0:n.default.n(-2,2)),A=_+(n.default.chance(50)?0:n.default.n(-2,2));S.position.x=w*e,S.position.y=A*e,S.anchor.x=.5,S.anchor.y=.5,t.render(S,{renderTexture:v,clear:!1})}return i.getBuildings().forEach((function(e){if(!(e.x<a||e.x>a+l||e.y<o||e.y>o+h)&&e.type===s.BuildingType.STATION){var i=new r.Sprite(c);i.position.x=e.x-a,i.position.y=e.y-o,i.anchor.x=.5,i.anchor.y=.5,t.render(i,{renderTexture:v,clear:!1})}})),v},t.prototype.getColor=function(t,e,i,r){return t.getTile(e,i,r).isWater&&!t.isUnderMountain(e,i,r)?7173517:-1},t}());e.default=a},1989:function(t,e,i){"use strict";var r=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function a(t){try{l(r.next(t))}catch(t){s(t)}}function o(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}l((r=r.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var i,r,n,s,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(a=0)),a;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.PIXIDisplay=void 0;var s,a=i(8687),o=i(6217),l=i(5382),h=i(4068),u=i(9333),c=i(9273),d=i(7028),p=i(4923),f=i(705),m=i(9242),g=i(9107),_=i(3155),y=i(2746),v=i(8727),x=i(9293),b=i(212),E=i(4699),T=i(6751),S=i(9998),w=i(9242),A=i(8779),I=i(6432),R=i(6166),C=i(9320),M=i(3474),O=i(9969),P=i(234),k=i(5002),D=i(8250),N={r:40,g:192,b:116};function L(){if(s){var t=document.getElementById("game"),e=s.height/s.width;innerWidth*e<=innerHeight?(s.style.width=innerWidth-0+"px",s.style.height=innerWidth*e-0+"px"):(s.style.width=1*innerHeight/e-0+"px",s.style.height=innerHeight-0+"px"),t.style.width=s.style.width,t.style.height=s.style.height}}window.addEventListener("resize",L),requestAnimationFrame((function t(e){requestAnimationFrame(t),D.update(e)}));var F=function(){function t(){var t=this;this.directionalCursorOffsetX=0,this.directionalCursorOffsetY=0,this.transferToToolbox=function(e,i){if(!e)return!1;var r=t.currentContainer;return!!t.game.player.tryGrabFromContainer(r,e,i)&&(t.game.display.updateInventory(),!0)},this.transferToContainer=function(e,i){return t.game.input.executeAction(new A.ExecutableAction(A.PlayerAction.DROP,0,void 0,void 0,{itemToDrop:e,single:i,targetContainer:t.currentContainer})),!0},this.onRecipeSelected=function(e){e&&(t.currentRecipe=e,t.updateBuildingCursor())}}return t.prototype.preinit=function(t){return r(this,void 0,void 0,(function(){var e,i,r;return n(this,(function(n){switch(n.label){case 0:return k.seed(666),this.game=t,[4,C.default.loadData("displayConfig.json")];case 1:return e=n.sent(),this.config=e,this.viewportConfig=b.default.isMobile()?e.viewports.mobile:e.viewports.desktop,this.panelConfig=b.default.isMobile()?e.panels.mobile:e.panels.desktop,i=new a.Application({width:this.viewportConfig.windowWidth,height:this.viewportConfig.windowHeight}),this.renderer=i.renderer,document.getElementById("game").appendChild(i.view),s=i.view,this.stage=i.stage,O.defaultFontSize=this.viewportConfig.textboxFontSize,this.tipsDisabled=!!localStorage.getItem("ew_tipsDisabled2"),r=new a.Container,i.stage.addChild(r),this.loadingScreen=new I.default(this.game,r),this.loadingScreen.show(),L(),[2]}}))}))},t.prototype.init=function(){return r(this,void 0,void 0,(function(){var t,e,i,r,s,o,l,h,u,c,d,y,w,A,I,C,M,O,P,k,D,L,F,B,U,G;return n(this,(function(n){switch(n.label){case 0:return t=this.config,e=this,[4,a.Assets.load(b.default.isMobile()?"gfx/title-mobile.png":"gfx/title.png")];case 1:return e.titleTexture=n.sent(),this.loadProgress(),i=this,[4,a.Assets.load(b.default.isMobile()?"gfx/mobileOverlay.png":"gfx/overlay.png")];case 2:return i.overlayTexture=n.sent(),this.loadProgress(),r=this,[4,a.Assets.load("gfx/fullOverlay.png")];case 3:r.fullOverlayTexture=n.sent(),this.loadProgress(),this.tilesets={},I=0,n.label=4;case 4:return I<t.tilesets.length?(s=t.tilesets[I],o={textureMap:{},offsetX:s.offsetX,offsetY:s.offsetY},[4,a.Assets.load(s.file)]):[3,7];case 5:for(l=n.sent(),this.loadProgress(),h=s.tileSizeX,u=s.tileSizeY,F=0;F<s.tilesetCountX;F++)for(D=0;D<s.tilesetCountY;D++)c=new a.Texture(l,new a.Rectangle(F*h,D*u,h,u)),o.textureMap[F+"-"+D]=c;this.tilesets[s.id]=o,n.label=6;case 6:return I++,[3,4];case 7:return d=this,G={tabCursor:this.tilesets[t.tabCursor.tileset].textureMap[t.tabCursor.index],squareCursor:this.tilesets[t.squareCursor.tileset].textureMap[t.squareCursor.index],disabledTabCursor:this.tilesets[t.disabledTabCursor.tileset].textureMap[t.disabledTabCursor.index],disabledSquareCursor:this.tilesets[t.disabledSquareCursor.tileset].textureMap[t.disabledSquareCursor.index],gridSlot:this.tilesets[t.squareCursor.tileset].textureMap[t.gridSlot.index],pointyCursor:this.tilesets[t.pointyCursor.tileset].textureMap[t.pointyCursor.index],invalidCursor:this.tilesets[t.invalidCursor.tileset].textureMap[t.invalidCursor.index],gencoStationIcon:this.tilesets[t.gencoStationIcon.tileset].textureMap[t.gencoStationIcon.index],forestIcon:this.tilesets[t.forestIcon.tileset].textureMap[t.forestIcon.index],smallForestIcon:this.tilesets[t.smallForestIcon.tileset].textureMap[t.smallForestIcon.index],mountainIcon:this.tilesets[t.mountainIcon.tileset].textureMap[t.mountainIcon.index]},[4,a.Assets.load("gfx/softButton.png")];case 8:for(d.uiTextures=(G.softButton=n.sent(),G),this.loadProgress(),this.components={},y=new a.Container,b.default.isMobile()&&(this.touchControls=new v.default(this.game,y,this.uiTextures.softButton,this.viewportConfig)),w=new a.Container,this.stage.addChild(w),this.titleScreen=new S.default(this.game,this,w,this.viewportConfig,this.titleTexture,this.uiTextures.pointyCursor,N),this.initIntroScreen(),A=new a.Container,this.mainGameContainer=A,this.stage.addChild(A),A.visible=!1,this.tileLayers=[],I=0;I<t.layers.length;I++)this.tileLayers.push([]);for(C=this.viewportConfig.viewportCountX*t.baseTileSize,M=(this.viewportConfig.windowWidth-C)/2,this.viewportX=M,O=this.viewportConfig.viewportCountY*t.baseTileSize,P=(this.viewportConfig.windowHeight-O)/2,this.viewportY=P,k=m.default.get("NONE"),this.metrics={viewportWidth:C,viewportX:M,viewportHeight:O,viewportY:P},D=0;D<this.viewportConfig.viewportCountY;D++)for(L=0;L<this.tileLayers.length;L++)for(F=0;F<this.viewportConfig.viewportCountX;F++)B=new a.Sprite(this.tilesets[k.tileset].textureMap[k.coord]),A.addChild(B),this.tileLayers[L][F+"-"+D]=B,B.position.x=M+F*t.baseTileSize,B.position.y=P+D*t.baseTileSize;return this.semiViewportCountX=Math.floor(this.viewportConfig.viewportCountX/2),this.semiViewportCountY=Math.floor(this.viewportConfig.viewportCountY/2),this.initHUD(),this.actionsList=new T.default(this.mainGameContainer,this,this.uiTextures.pointyCursor,this.game),this.journalPanel=new x.default(this.game,this,this.mainGameContainer),this.activitiesPanel=new R.default(this.game,this,this.mainGameContainer),this.mapPanel=new f.default(this.renderer,this.mainGameContainer,this,this.game,this.uiTextures.gencoStationIcon,this.uiTextures.forestIcon,this.uiTextures.smallForestIcon,this.uiTextures.mountainIcon),this.recipesPanel=new _.default(this.game,this.mainGameContainer,this.onRecipeSelected),this.containerContentsGrid=new g.default(this,this.mainGameContainer,this.transferToToolbox,this.transferToContainer),this.onboardingTips=new E.default(this.game,this.mainGameContainer,this),this.initAlert(),U=new a.Container,this.stage.addChild(U),this.settingsPanel=new p.default(this.game,this,U),this.stage.addChild(y),[2]}}))}))},t.prototype.updateBuildingCursor=function(){var t=this.currentRecipe,e=this.game.world.level,i=e.player.x+e.player.dx,r=e.player.y+e.player.dy,n=this.components.hud.playerDirectionCursor;if(e.player.canBuildSimple(t)){var s=this.getRenderDataFromApp(o.default.getWorldAppearance(t),i,r,t.flooringId?1:3);this.directionalCursorOffsetX=s.offsetX,this.directionalCursorOffsetY=s.offsetY;var a=e.getItem(i,r,e.player.z);a&&(this.directionalCursorOffsetY+=this.config.layers[4].offsetY,a.def.addedTableHeight&&(this.directionalCursorOffsetY+=a.def.addedTableHeight)),n.texture=s.texture,n.tint=15632520}else n.texture=this.uiTextures.invalidCursor,n.tint=16777215,this.directionalCursorOffsetX=0,this.directionalCursorOffsetY=0;n.position.x=this.metrics.viewportX+this.semiViewportCountX*this.config.baseTileSize+e.player.dx*this.config.baseTileSize+this.directionalCursorOffsetX,n.position.y=this.metrics.viewportY+this.semiViewportCountY*this.config.baseTileSize+e.player.dy*this.config.baseTileSize+this.directionalCursorOffsetY},t.prototype.initAlert=function(){var t=new a.Container;this.mainGameContainer.addChild(t),t.visible=!1,this.components.alert={},this.components.alert.panel=t;var e=this.metrics.viewportX+this.metrics.viewportWidth/2-128,i=this.metrics.viewportY+16,r=new d.PIXIFrame(e,i,256,256,16,this.tilesets[this.config.windowTiles.tileset].textureMap,this.config.windowTiles.tiles);t.addChild(r.container),this.components.alert.frame=r;var n=O.createTextBox(e+8,i+8,"",240);t.addChild(n),this.components.alert.text=new M(n)},t.prototype.initHUD=function(){var t=new a.Container;this.mainGameContainer.addChild(t),this.components.hud={},this.components.hud.overlay=new a.Sprite(this.overlayTexture),t.addChild(this.components.hud.overlay),t.addChild(O.createTextBox(8,this.viewportConfig.windowHeight-16,"v".concat(this.game.version)));var e=O.createTextBox(8,8,"",this.viewportConfig.windowWidth-128-8);t.addChild(e),this.components.hud.messageBox=new M(e),this.components.hud.modeTitle=O.createTextBox(this.viewportConfig.windowWidth/2,8,""),this.components.hud.modeTitle.anchor.set(.5,0),t.addChild(this.components.hud.modeTitle),this.components.hud.promptText=O.createTextBox(this.viewportConfig.windowWidth/2-100,24,""),t.addChild(this.components.hud.promptText),this.components.hud.shortMessageBox=O.createTextBox(0,0,""),t.addChild(this.components.hud.shortMessageBox),this.components.hud.achievementsTxt=t.addChild(O.createTextBox(8,this.metrics.viewportY+this.metrics.viewportHeight-90,""));var i=this.panelConfig.hud;this.components.hud.timeOfDay=t.addChild(O.createTextBox(i.day.x,i.day.y,"")),this.components.hud.waypoint=t.addChild(O.createTextBox(i.waypoint.x,i.waypoint.y,""));var r=this.panelConfig.stats;this.components.hud.status=t.addChild(O.createTextBox(r.x,r.y,"")),this.components.hud.healthBar=t.addChild(O.createTextBox(r.x,r.y+11,"",void 0,{fill:11804714})),this.components.hud.fatigueBar=t.addChild(O.createTextBox(r.x,r.y+33,"",void 0,{fill:1351726})),this.components.hud.hungerBar=t.addChild(O.createTextBox(r.x,r.y+55,"",void 0,{fill:16766273})),this.components.hud.burdenBar=t.addChild(O.createTextBox(r.x,r.y+77,"",void 0,{fill:2400222})),this.components.hud.oxygenBar=t.addChild(O.createTextBox(r.x,r.y+110,"",void 0,{fill:16777215})),this.components.hud.leftCommands=t.addChild(O.createTextBox(8,240,"")),this.components.hud.toolboxCursor=new a.Sprite(this.uiTextures.squareCursor),t.addChild(this.components.hud.toolboxCursor);var n=new l.default(this.viewportConfig.windowWidth-this.panelConfig.toolbox.horizontalOffset,8,20,16,128,b.default.isMobile()?0:4);this.toolboxList=n,t.addChild(n.container),this.components.hud.rightCommands=t.addChild(O.createTextBox(this.panelConfig.hud.leftContextualAction.x,this.panelConfig.hud.leftContextualAction.y,"",void 0,{align:this.panelConfig.hud.leftContextualAction.align}));var s=new a.Sprite(this.uiTextures.squareCursor);this.components.hud.playerDirectionCursor=s,t.addChild(s)},t.prototype.initIntroScreen=function(){var t=new a.Container;this.introScreenContainer=t,this.stage.addChild(t),t.visible=!1,t.addChild(new a.Sprite(this.titleTexture));var e=t.addChild(O.createTextBox(10,10,"",300));P.intro.forEach((function(t){return e.text=e.text+c.default.replaceActions(t)+"\n\n"}))},t.prototype.watchPlantAt=function(t,e){var i=this.game.world.level,r=i.getPlantAt(t,e,i.player.z);return r?(i.player.remember(t,e,i.player.z),r.getApp()):null},t.prototype.watchFlooringAt=function(t,e){var i=this.game.world.level,r=i.getFlooringAt(t,e,i.player.z);return r?(i.player.remember(t,e,i.player.z),r.app):null},t.prototype.watchTerrainAt=function(t,e){var i=this.game.world.level,r=i.getTile(t,e,i.player.z);if(r){i.player.remember(t,e,i.player.z);var n=i.getPaintColor(t,e,i.player.z);return n?w.default.painted(r.app,n):r.app}return null},t.prototype.watchItemAt=function(t,e){var i,r=this.game.world.level,n=this.game.world.level.getItem(t,e,r.player.z);return n?(this.game.world.level.player.remember(t,e,r.player.z),{app:n.getWorldAppearance(),stackedItemOffset:null!==(i=n.def.addedTableHeight)&&void 0!==i?i:0}):null},t.prototype.getStackedItem=function(t,e){var i=this.game.world.level,r=i.getStackedItem(t,e,i.player.z);return r?(i.player.remember(t,e,i.player.z),{app:r.getWorldAppearance(),paintColor:r.paintColor}):null},t.prototype.watchBeingAt=function(t,e){var i=this.game.world.level;if(t===i.player.x&&e===i.player.y)return i.player.getAppearance();var r=i.getBeing(t,e,i.player.z);return r?(r.onSeen(),r.getAppearance()):null},t.prototype.renderTile=function(t,e,i,r,n){var s=this.tileLayers[t][r];if(n){s.visible=!0,s.texture=n.texture;var a=this.viewportX+e*this.config.baseTileSize,o=this.viewportY+i*this.config.baseTileSize;s.position.x=a+(n.offsetX+this.config.layers[t].offsetX)*(n.doFlip?-1:1),s.position.y=o+n.offsetY+this.config.layers[t].offsetY,n.doFlip?(s.scale.x=-1,s.anchor.x=1):(s.scale.x=1,s.anchor.x=0),n.rotate?(s.angle=90*n.rotate,s.pivot.x=8,s.pivot.y=8,s.position.x+=8,s.position.y+=8):(s.angle=0,s.pivot.x=0,s.pivot.y=0)}else s.visible=!1},t.prototype.refresh=function(){var t,e,i=this,r=this.game.world.level.player,n=this.game.world.level;this.playerFlipped=n.player.dx>0;for(var s=-this.semiViewportCountX;s<this.semiViewportCountX;s++)for(var a,o,l=function(){var i=r.x+s,l=r.y+u;a=i-r.x,o=l-r.y;var c=s+h.semiViewportCountX,d=u+h.semiViewportCountY,p=c+"-"+d,f=!1;if(!n.player.canSee(a,o)){if(h.tileLayers.forEach((function(t){return t[p].visible=!1})),!r.remembers(i,l,r.z))return"continue";f=!0}var m=f?null:h.watchBeingAt(i,l),g=f?null:h.getStackedItem(i,l),_=f?null:h.watchItemAt(i,l),y=h.watchPlantAt(i,l),v=h.watchFlooringAt(i,l),x=h.watchTerrainAt(i,l),b=m?h.getRenderDataFromApp(m):null,E=y?h.getRenderDataFromApp(y,i,l,2):null,T=v?h.getRenderDataFromApp(v,i,l,1):null,S=_?h.getRenderDataFromApp(_.app,i,l,3):null,w=g?h.getRenderDataFromApp(g.app,i,l,3):null,A=x?h.getRenderDataFromApp(x,i,l,0):null;if(null===(t=null==v?void 0:v.rules)||void 0===t?void 0:t.find((function(t){return"TELESCOPIC"===t.type}))){var I=h.watchFlooringAt(i,l-1);I&&(A=h.getRenderDataFromApp(I,i,l-1,1))}var R,C=h.game.world.level.getLightColor(i,l,n.player.z);0===C&&(b=null,E=null,T=null,S=null,w=null,A=null),null!=C&&(R=C),f&&(R=1391690),h.renderTile(0,c,d,p,A),h.renderTile(1,c,d,p,T),h.renderTile(2,c,d,p,E),h.renderTile(3,c,d,p,S),w&&(w.offsetY-=null!==(e=null==_?void 0:_.stackedItemOffset)&&void 0!==e?e:0),h.renderTile(4,c,d,p,w),h.renderTile(5,c,d,p,b),R?h.tileLayers.forEach((function(t){return t[p].tint=R})):h.tileLayers.forEach((function(t){return t[p].tint=16777215}))},h=this,u=-this.semiViewportCountY;u<this.semiViewportCountY;u++)l();this.components.hud.timeOfDay.text="Day "+this.game.player.dayCounter+", "+this.formatTimeOfDay(this.game.world.currentTime),this.components.hud.waypoint.text=this.game.player.orient(),this.components.hud.playerDirectionCursor.position.x=this.metrics.viewportX+this.semiViewportCountX*this.config.baseTileSize+n.player.dx*this.config.baseTileSize+this.directionalCursorOffsetX,this.components.hud.playerDirectionCursor.position.y=this.metrics.viewportY+this.semiViewportCountY*this.config.baseTileSize+n.player.dy*this.config.baseTileSize+this.directionalCursorOffsetY,this.game.input.peekMode()===c.InputMode.BUILDING&&this.updateBuildingCursor();var d=this.game.player.items.map((function(t){return{text:t.getInventoryDescription(),renderData:i.getMenuRenderDataFromApp(t.getMenuAppearance())}}));this.toolboxList.setData(d),this.toolboxList.update(),this.components.hud.toolboxCursor.position.x=this.toolboxList.x,this.components.hud.toolboxCursor.position.y=this.toolboxList.y+16*this.game.player.currentToolIndex,this.containerContentsGrid.isVisible()&&this.updateInventory(),this.updateStatus(),this.updateHelp()},t.prototype.getMenuRenderDataFromApp=function(t){var e=this.tilesets[t.tileset];return{texture:e.textureMap[t.coord],offsetX:e.offsetX-t.horizontalOffset,offsetY:e.offsetY-t.verticalOffset}},t.prototype.checkAboveOrBelow=function(t,e,i,r,n){var s=this.game.world.level;if(3===n){var a=this.game.world.level.getFlooringAt(i,r+e,s.player.z);return a&&a.renderGroup===t.param}return!1},t.prototype.getRenderDataFromApp=function(t,e,i,r){var n=this,s=t.rules;if(!s){var a=this.tilesets[t.tileset];return{texture:a.textureMap[t.coord],offsetX:a.offsetX-t.horizontalOffset,offsetY:a.offsetY-t.verticalOffset}}var o=t.coord,l=this.game.world.level,h=!1,u=!1;s.forEach((function(s){var a,c;if("FLIP"===s.type)h=n.playerFlipped;else if("NOT_ABOVE"===s.type){var d=!1;switch(r){case 0:var p=n.game.world.level.getTile(e,i-1,l.player.z),f=n.game.world.level.getTile(e,i,l.player.z);d=(null!==(a=null==p?void 0:p.app.renderGroup)&&void 0!==a?a:null==p?void 0:p.id)!==(null!==(c=f.app.renderGroup)&&void 0!==c?c:f.id);break;case 1:var m=n.game.world.level.getFlooringAt(e,i-1,l.player.z),g=n.game.world.level.getFlooringAt(e,i,l.player.z);(d=(null==m?void 0:m.renderGroup)!==(null==g?void 0:g.renderGroup))&&s.param&&(d=(null==m?void 0:m.renderGroup)!==s.param)}d&&(o=s.transform)}else if("BELOW"===s.type)n.checkAboveOrBelow(s,1,e,i,r)&&(o=s.transform);else if("RANDOM"===s.type){var _=(k.simplex2(e,i)+1)/2,y=s.transform?s.transform.split(","):o.split(","),v=Math.floor(_*y.length);o=y[v]}else if("ANCHOR"===s.type){var x=l.isSolidChain(e-1,i,l.player.z),b=l.isSolidChain(e+1,i,l.player.z);y=s.transform.split(","),o=x&&b?y[0]:y[1]}else if("CROSS"===s.type){var E=[l.sticksToFence(e,i-1,l.player.z),l.sticksToFence(e-1,i,l.player.z),l.sticksToFence(e+1,i,l.player.z),l.sticksToFence(e,i+1,l.player.z)],T=[];E[0]&&T.push(1),E[1]&&T.push(2),E[2]&&T.push(3),E[3]&&T.push(4);var S=JSON.stringify(T);-1===(v=[[3,4],[2,3,4],[2,4],[1,3,4],[1,2,3,4],[1,2,4],[1,3],[1,2,3],[1,2],[3],[2,3],[2],[4],[1,4],[1]].findIndex((function(t){return JSON.stringify(t)===S})))&&(v=10),o=s.transform.split(",")[v]}else if("ROTABLE"===s.type){if(t.rotation>0){var w=s.transform.split(",");1===w.length?1!==t.rotation&&3!==t.rotation||(o=w[0]):o=w[t.rotation%4-1]}u=!0}}));var c=this.tilesets[t.tileset];return{texture:c.textureMap[o],offsetX:c.offsetX-t.horizontalOffset,offsetY:c.offsetY-t.verticalOffset,doFlip:h,rotate:u?void 0:t.rotation}},t.prototype.getTextureFromApp=function(t){return this.tilesets[t.tileset].textureMap[t.coord]},t.prototype.updateHelp=function(){var t=this.game.input.getContextualAction().shortDescription;if(this.game.player.currentTool,b.default.isMobile())this.components.hud.rightCommands.text=t;else{var e="";e+="Enter: "+t+"\n",e+="Space: Action Menu\n",e+="B: Build\n\n",this.game.input.peekMode()===c.InputMode.MOVEMENT&&(this.game.player.farmMode?e+="F: Instant Turn\n":(e+="F: Slow Turn\n",e+="Shift+Dir: Turn\n")),e+="\nESC: Settings\n",this.components.hud.leftCommands.text=e,this.components.hud.rightCommands.text=""}var i=this.game.input.peekMode();if(this.recipesPanel.isVisible())this.components.hud.rightCommands.text+="",i===c.InputMode.SELECT_CRAFT?(this.setPrompt(c.default.replaceActions("Select what you want to build and press $ACTION.\nPress $CLOSE to return.")),this.components.hud.modeTitle.text="Building Mode "):(this.setPrompt("Select a recipe to cook"),this.components.hud.modeTitle.text="Cooking Mode");else if(i===c.InputMode.BUILDING){this.components.hud.rightCommands.text+="",this.components.hud.modeTitle.text="Building Mode ";var r=o.default.getItem(this.getSelectedRecipe()).name;this.setPrompt(c.default.replaceActions("Press $ACTION to place a ".concat(r," in the world.\nPress $CLOSE to return.")))}else this.components.hud.modeTitle.text="Exploration Mode",this.setPrompt(""),b.default.isMobile()||(this.components.hud.rightCommands.text+="\nTab: Change Item")},t.prototype.updateStatus=function(){var t="";t+=" Health     \n\n",t+=" Fatigue    \n\n",t+=" Hunger     \n\n",t+=" Carrying   \n\n";var e=this.game.player.getCurrentWeight(),i=this.game.player.getCarryCapacity();t+=Math.round(e)+"g\n",this.game.player.isSwimming?(t+=" Oxygen   \n\n",this.components.hud.oxygenBar.visible=!0):(t+="\n\n",this.components.hud.oxygenBar.visible=!1),t+="Temperature: "+this.game.player.getTemperature()+"ºC\n",this.game.player.isStarving()&&(t+="STARVING\n"),this.game.player.isSick()&&(t+="SICK\n"),this.components.hud.status.text=t,this.components.hud.healthBar.text=this.formatBar(this.game.player.health,10),this.components.hud.fatigueBar.text=this.formatBar(this.game.player.stamina,10,!0),this.components.hud.hungerBar.text=this.formatBar(this.game.player.hunger,10),this.components.hud.burdenBar.text=this.formatBarDirect(e/i,10),this.components.hud.oxygenBar.text=this.formatBar(this.game.player.oxygen,10)},t.prototype.examine=function(t){if("map"===t.def.effect)return this.game.audio.playSfx("read_note"),y.default.reportAction("showMap"),void this.game.display.mapPanel.show(t);t.isContainer()?this.showContainerContents(t):this.errorMessage(t.getExamineDescription(),!0)},t.prototype.formatTimeOfDay=function(t){var e=Math.floor(t),i=Math.floor(60*(t-e));return(0==e?"12":e>12?e-12:e)+":"+(i<10?"0"+i:i)+(e>=12?"PM":"AM")},t.prototype.formatBarDirect=function(t,e,i){var r=Math.floor(t*e);i&&(r=e-r);for(var n="",s=0;s<r;s++)n+="█";return(n+"▄▄▄▄▄▄▄▄▄▄").substring(0,10)},t.prototype.formatBar=function(t,e,i){return this.formatBarDirect(t.current/t.max,e,i)},t.prototype.getSelectedRecipe=function(){return this.recipesPanel.getSelected()},t.prototype.getSelectedItem=function(){return this.containerContentsGrid.getSelected()},t.prototype.showContainerContents=function(t){this.containerContentsGrid.setToolboxData(this.game.player.items,!0),this.containerContentsGrid.setContainer(t,!0),this.currentContainer=t,this.containerContentsGrid.show(),this.switchOverlay(!0),this.game.input.setMode(c.InputMode.CONTAINER)},t.prototype.showRecipes=function(t){this.recipesPanel.setRecipes(t),this.recipesPanel.show(),this.switchOverlay(!0),this.updateHelp()},t.prototype.updateInventory=function(){this.containerContentsGrid.setToolboxData(this.game.player.items,!1),this.containerContentsGrid.setContainer(this.currentContainer,!1),this.containerContentsGrid.show(),this.switchOverlay(!0)},t.prototype.hideInventory=function(){var t=this.game.input.peekMode();if(t===c.InputMode.SELECT_RECIPE||t===c.InputMode.SELECT_CRAFT){this.recipesPanel.hide(),t===c.InputMode.SELECT_RECIPE&&this.game.player.selectRecipe(null),this.directionalCursorOffsetX=0,this.directionalCursorOffsetY=0;var e=this.game.world.level,i=this.components.hud.playerDirectionCursor;i.texture=this.uiTextures.squareCursor,i.tint=16777215,i.position.x=this.metrics.viewportX+this.semiViewportCountX*this.config.baseTileSize+e.player.dx*this.config.baseTileSize+this.directionalCursorOffsetX,i.position.y=this.metrics.viewportY+this.semiViewportCountY*this.config.baseTileSize+e.player.dy*this.config.baseTileSize+this.directionalCursorOffsetY,this.updateHelp()}else this.containerContentsGrid.hide();this.switchOverlay(!1)},t.prototype.message=function(t,e,i,r,n){e&&this.showFloatingText(i,r,e)},t.prototype.showFloatingText=function(t,e,i){var r=this.game.world.level.player,n=t-r.x,s=e-r.y-.5,a=this.metrics.viewportX+this.semiViewportCountX*this.config.baseTileSize+n*this.config.baseTileSize,o=this.metrics.viewportY+this.semiViewportCountY*this.config.baseTileSize+s*this.config.baseTileSize,l=this.mainGameContainer.addChild(O.createTextBox(a,o,i));new D.Tween(l.position).to({y:o-8},250).easing(D.Easing.Quadratic.Out).start(),setTimeout((function(){return new D.Tween(l).to({alpha:0},500).start()}),250),setTimeout((function(){return l.destroy()}),800)},t.prototype.errorMessage=function(t,e){this.alert(t,!1),this.game.audio.playSfx("ui_neg_fbk")},t.prototype.intro=function(){this.titleScreen.hide(),this.introScreenContainer.visible=!0},t.prototype.hideIntro=function(){this.introScreenContainer.visible=!1,this.activateMainMode(),this.game.afterIntro()},t.prototype.activateMainMode=function(){this.titleScreen.hide(),this.mainGameContainer.visible=!0},t.prototype.displayTitleScreen=function(){this.loadingScreen.hide(),this.titleScreen.show()},t.prototype.debugBuffer=function(t){t:for(var e=0;e<t.length;e++){for(var i="",r=0;r<t[0].length;r++){if(!t[e][r]){i+="!",console.log(i);break t}i+=t[e][r].ch}console.log(i)}},t.prototype.alert=function(t,e,i){e?this.game.input.setMode(c.InputMode.BLOCKED):this.game.input.setMode(c.InputMode.ALERT),e||(t+=c.default.replaceActions("\n\n>> Press $ACTION to continue")),this.components.alert.text.setText(t),this.components.alert.frame.resize(11*(O.lines(t,this.components.alert.text.PIXIText).length+1)+4),this.components.alert.panel.visible=!0,this.alertCb=i},t.prototype.closeAlert=function(){this.components.alert.panel.visible=!1,this.alertCb&&this.alertCb()},t.prototype.showFloatingOnboarding=function(t){var e;this.alert(b.default.isMobile()&&null!==(e=t.mobileText)&&void 0!==e?e:t.text)},t.prototype.toggleTips=function(){this.tipsDisabled=!this.tipsDisabled,localStorage.setItem("ew_tipsDisabled2",this.tipsDisabled.toString()),this.tipsDisabled?this.onboardingTips.hideOnboarding():this.onboardingTips.showOnboarding()},t.prototype.resetSelectedRecipe=function(){this.recipesPanel.resetSelection()},t.prototype.moveInventory=function(t){var e=this.game.input.peekMode();e===c.InputMode.SELECT_RECIPE||e===c.InputMode.SELECT_CRAFT?this.recipesPanel.moveCursor(t):this.containerContentsGrid.moveCursor(t),this.game.audio.playSfx("ui_selection")},t.prototype.createFrame=function(t,e,i,r){return new d.PIXIFrame(t,e,i,r,8,this.tilesets[this.config.windowTiles.tileset].textureMap,this.config.windowTiles.tiles)},t.prototype.createSelectableList=function(t,e,i,r){return new u.default(t,e,i,r,this.uiTextures.pointyCursor)},t.prototype.createGrid=function(t,e,i,r,n,s,a){var o=Object.assign({x:t,y:e,columns:i,rows:r,columnWidth:n,rowHeight:s,slotTexture:this.uiTextures.gridSlot,cursorTexture:"tab"===(null==a?void 0:a.cursor)?this.uiTextures.tabCursor:this.uiTextures.squareCursor,cursorDisabledTexture:(null==a?void 0:a.hideCursorOnDisable)?void 0:"tab"===(null==a?void 0:a.cursor)?this.uiTextures.disabledTabCursor:this.uiTextures.disabledSquareCursor},a);return new h.default(o)},t.prototype.setPrompt=function(t){this.components.hud.promptText.text=t},t.prototype.showClue=function(t){if("TAPE"!==t.def.noteType){var e="This is a ".concat(t.def.noteType.toLowerCase(),"; it says:\n\n");this.alert(e+t.def.noteContents),this.game.audio.playSfx("read_note")}else this.alert("You put the reel in the machine:\n\n"+t.def.noteContents)},t.prototype.switchOverlay=function(t){this.components.hud.overlay.texture=t?this.fullOverlayTexture:this.overlayTexture},t.prototype.tickOnce=function(t){a.Ticker.shared.addOnce((function(){setTimeout((function(){t()}),10)}))},t.prototype.onInputModeChanged=function(){var t,e=this.game.input.peekMode();this.touchControls&&(e===c.InputMode.MOVEMENT?this.updateHelp():this.components.hud.rightCommands.text=""),null===(t=this.touchControls)||void 0===t||t.setMode()},t.prototype.openFullscreen=function(){var t=document.documentElement;t.requestFullscreen&&t.requestFullscreen()},t.prototype.toggleFullscreen=function(){var t=document.documentElement;t.requestFullscreen&&(document.fullscreenElement?document.exitFullscreen():t.requestFullscreen())},t.prototype.onFishingStop=function(){this.components.hud.playerDirectionCursor.visible=!0},t.prototype.onFishingStart=function(){this.components.hud.playerDirectionCursor.visible=!1},t.prototype.navigateToTitle=function(){this.closeAlert(),this.introScreenContainer.visible=!1,this.mainGameContainer.visible=!1,this.titleScreen.show(),this.game.audio.stopMelodies(),this.game.audio.stopSfx("forest_night"),this.game.audio.stopSfx("forest_day"),this.game.audio.stopSfx("snow_night"),this.game.audio.stopSfx("snow_day")},t.prototype.loadProgress=function(){var t;null===(t=this.loadingScreen)||void 0===t||t.loadProgress()},t}();e.PIXIDisplay=F,e.default=new F},7028:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PIXIFrame=void 0;var r=i(8687),n=function(){function t(t,e,i,n,s,a,o){this.container=new r.Container,this.a=new r.Sprite(a[o.a]),this.b=new r.Sprite(a[o.b]),this.c=new r.Sprite(a[o.c]),this.d=new r.Sprite(a[o.d]),this.e=new r.Sprite(a[o.e]),this.f=new r.Sprite(a[o.f]),this.g=new r.Sprite(a[o.g]),this.h=new r.Sprite(a[o.h]),this.i=new r.Sprite(a[o.i]),this.container.addChild(this.a),this.container.addChild(this.b),this.container.addChild(this.c),this.container.addChild(this.d),this.container.addChild(this.e),this.container.addChild(this.f),this.container.addChild(this.g),this.container.addChild(this.h),this.container.addChild(this.i),this.x=t,this.y=e,this.w=i,this.hh=n,this.tileSize=s,this.relocate()}return t.prototype.relocate=function(){var t=this,e=t.x,i=t.y,r=t.w,n=t.tileSize,s=this.hh;this.a.position.x=e,this.a.position.y=i,this.b.position.x=e+n,this.b.position.y=i,this.c.position.x=e+r-n,this.c.position.y=i,this.d.position.x=e,this.d.position.y=i+n,this.e.position.x=e+n,this.e.position.y=i+n,this.f.position.x=e+r-n,this.f.position.y=i+n,this.g.position.x=e,this.g.position.y=i+s-n,this.h.position.x=e+n,this.h.position.y=i+s-n,this.i.position.x=e+r-n,this.i.position.y=i+s-n,this.b.width=r-2*n,this.e.width=r-2*n,this.h.width=r-2*n,this.d.height=s-2*n,this.e.height=s-2*n,this.f.height=s-2*n},t.prototype.resize=function(t){t<48&&(t=48),this.hh=t,this.relocate()},t}();e.PIXIFrame=n},4068:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(9969),s=function(){function t(t){var e=t.x,i=t.y,s=t.columns,a=t.rows,o=t.columnWidth,l=t.rowHeight,h=t.cursorTexture,u=t.addSlots,c=t.slotTexture,d=t.textGrid,p=t.cursorDisabledTexture;this.x=e,this.y=i,this.rowHeight=l,this.columnWidth=o,this.rows=a,this.columns=s,this.container=new r.Container,this.icons=[],this.labels=[],this.slotIcons=[];for(var f=0;f<this.columns;f++)this.icons.push([]),this.labels.push([]),u&&this.slotIcons.push([]);for(var m=0;m<this.rows;m++)for(f=0;f<this.columns;f++){if(u){var g=new r.Sprite(c);g.position.x=e+f*o,g.position.y=i+m*l,this.container.addChild(g),this.slotIcons[f].push(g)}var _=new r.Sprite;_.position.x=e+f*o,_.position.y=i+m*l,this.container.addChild(_),this.icons[f].push(_);var y=n.createTextBox(e+f*o+(d?6:0),i+m*l+(d?0:14),"");this.container.addChild(y),this.labels[f].push(y)}this.cursorEnabledTexture=h,this.cursorDisabledTexture=p,this.cursor=new r.Sprite(h),this.container.addChild(this.cursor)}return t.prototype.setData=function(t){this.data=t},t.prototype.setSlots=function(t){for(var e=0,i=0;i<this.rows;i++)for(var r=0;r<this.columns;r++)this.slotIcons[r][i].visible=e<t,e++},t.prototype.update=function(){for(var t,e,i,r,n=0;n<this.rows;n++)for(var s=0;s<this.columns;s++){var a=this.data[n*this.columns+s],o=this.icons[s][n];a?(o.texture=null===(t=a.renderData)||void 0===t?void 0:t.texture,o.tint=a.tint,o.position.x=this.x+s*this.columnWidth+(null===(e=a.renderData)||void 0===e?void 0:e.offsetX),o.position.y=this.y+n*this.rowHeight+(null===(i=a.renderData)||void 0===i?void 0:i.offsetY),this.labels[s][n].text=null!==(r=a.label)&&void 0!==r?r:"",this.maxUsedRow=n):(this.icons[s][n].texture=null,this.labels[s][n].text="")}this.cursorY*this.columns+this.cursorX>=this.data.length&&this.resetSelection()},t.prototype.resetSelection=function(){this.cursorX=0,this.cursorY=0,this.landCursor()},t.prototype.emitSelection=function(){this.onBrowse(this.getSelected())},t.prototype.getSelected=function(){return 0===this.data.length?null:this.data[this.cursorY*this.columns+this.cursorX].dataItem},t.prototype.moveCursor=function(t){this.onOverflow&&(-1===t.y&&0===this.cursorY?this.onOverflow({x:0,y:-1}):1===t.y&&this.cursorY===this.maxUsedRow&&this.onOverflow({x:0,y:1})),this.data[(this.cursorY+t.y)*this.columns+this.cursorX+t.x]&&(this.cursorX+=t.x,this.cursorY+=t.y,this.landCursor())},t.prototype.landCursor=function(){this.cursorX>=this.columns-1&&(this.cursorX=this.columns-1),this.cursorY>=this.rows-1&&(this.cursorY=this.rows-1),this.cursorX<0&&(this.cursorX=0),this.cursorY<0&&(this.cursorY=0),this.cursor.x=this.x+this.cursorX*this.columnWidth,this.cursor.y=this.y+this.cursorY*this.rowHeight,this.data&&this.emitSelection()},t.prototype.disable=function(){var t;this.cursor.texture=null!==(t=this.cursorDisabledTexture)&&void 0!==t?t:null},t.prototype.enable=function(){this.cursor.texture=this.cursorEnabledTexture},t}();e.default=s},5382:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(9969),s=function(){function t(t,e,i,s,a,o){void 0===o&&(o=4),this.x=t,this.y=e,this.rowHeight=s,this.rows=i,this.container=new r.Container,this.icons=[],this.texts=[];for(var l=0;l<i;l++){var h=new r.Sprite;h.position.x=t+0,h.position.y=e+l*s,this.container.addChild(h),this.icons.push(h);var u=n.createTextBox(t+16+o,e+l*s,"",a-20);this.container.addChild(u),this.texts.push(u)}this.scrollingIndex=0}return t.prototype.setData=function(t){this.data=t},t.prototype.update=function(){for(var t,e,i,r,n=0;n<this.rows;n++){var s=this.data[this.scrollingIndex+n],a=this.icons[n];s?(this.texts[n].text=s.text,a.texture=null===(t=s.renderData)||void 0===t?void 0:t.texture,a.tint=null!==(e=s.tint)&&void 0!==e?e:16777215,a.position.x=this.x+0+(null===(i=s.renderData)||void 0===i?void 0:i.offsetX),a.position.y=this.y+n*this.rowHeight+(null===(r=s.renderData)||void 0===r?void 0:r.offsetY)):(this.texts[n].text="",this.icons[n].texture=null)}},t.prototype.scrollUp=function(){0!==this.scrollingIndex&&(this.scrollingIndex--,this.update())},t.prototype.scrollDown=function(){this.scrollingIndex+this.rows>=this.data.length||(this.scrollingIndex++,this.update())},t}();e.default=s},9333:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(9969),s=function(){function t(t,e,i,n,s){this.x=t,this.y=e,this.width=n,this.rowHeight=i,this.container=new r.Container,this.optionsContainer=new r.Container,this.scrollingIndex=0,this.cursor=new r.Sprite(s),this.container.addChild(this.cursor),this.container.addChild(this.optionsContainer)}return t.prototype.setData=function(t){this.data=t,this.container,this.rows=t.length,this.icons=[],this.texts=[];for(var e=0;e<this.optionsContainer.children.length;e++)this.optionsContainer.children[e].destroy();for(this.optionsContainer.removeChildren(),e=0;e<this.rows;e++){var i=new r.Sprite;i.position.x=this.x+0,i.position.y=this.y+e*this.rowHeight,this.optionsContainer.addChild(i),this.icons.push(i);var s=n.createTextBox(this.x+20,this.y+e*this.rowHeight,"",this.width-20);this.optionsContainer.addChild(s),this.texts.push(s)}},t.prototype.update=function(){for(var t,e,i,r=0;r<this.rows;r++){var n=this.data[this.scrollingIndex+r],s=this.icons[r];n?(this.texts[r].text=n.text,s.texture=null===(t=n.renderData)||void 0===t?void 0:t.texture,s.position.x=this.x+0+(null===(e=n.renderData)||void 0===e?void 0:e.offsetX),s.position.y=this.y+r*this.rowHeight+(null===(i=n.renderData)||void 0===i?void 0:i.offsetY)):(this.texts[r].text="",this.icons[r].texture=null)}this.selectedOption>=this.data.length&&this.resetSelection()},t.prototype.resetSelection=function(){this.selectedOption=0,this.landCursor()},t.prototype.getSelected=function(){return this.data[this.selectedOption].dataItem},t.prototype.moveCursor=function(t){this.selectedOption+=t,this.selectedOption>=this.data.length&&(this.selectedOption=0),this.selectedOption<0&&(this.selectedOption=this.data.length-1),this.landCursor()},t.prototype.landCursor=function(){this.selectedOption>=this.data.length&&(this.selectedOption=this.data.length),this.selectedOption<0&&(this.selectedOption=0),this.cursor.x=this.x,this.cursor.y=this.y+this.selectedOption*this.rowHeight},t.prototype.scrollUp=function(){0!==this.scrollingIndex&&(this.scrollingIndex--,this.update())},t.prototype.scrollDown=function(){this.scrollingIndex+this.rows>=this.data.length||(this.scrollingIndex++,this.update())},t}();e.default=s},4923:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(9969),s=i(5382),a=i(8696),o=i(1623),l=i(212),h=function(){function t(t,e,i){this.game=t,this.rootContainer=new r.Container,this.rootContainer.visible=!1,this.displayObject=e;var a=e.panelConfig.settings.x,o=e.panelConfig.settings.y,l=e.panelConfig.settings.width;this.frame=e.createFrame(a,o,l,16),this.rootContainer.addChild(this.frame.container),this.rootContainer.addChild(n.createTextBox(a+20,o+12,"Settings")),this.optionsList=e.createSelectableList(a+20,o+28,16,l),this.rootContainer.addChild(this.optionsList.container),this.valuesList=new s.default(a+105,o+28,3,16,l),this.rootContainer.addChild(this.valuesList.container),i.addChild(this.rootContainer)}return t.prototype.display=function(t){var e=[];e.push({text:"Volume",dataItem:"vol"}),this.volumeIndex=e.length-1,t&&e.push({text:"Save Game",dataItem:"save"}),e.push({text:"Show Tips",dataItem:"toggleTips"}),this.tipsDisabledIndex=e.length-1,o.default.isElectron()?e.push({text:"Toggle Windowed Mode",dataItem:"toggleWindowed"}):l.default.isCordova()||e.push({text:"Toggle FullScreen",dataItem:"toggleFullScreen"}),t&&e.push({text:"Exit to Title",dataItem:"exit"}),this.optionsList.setData(e),this.frame.resize(16*(e.length+2)),this.rootContainer.visible=!0,this.optionsList.container.visible=!0,this.optionsList.resetSelection(),this.optionsList.update(),this.updateValues()},t.prototype.hide=function(){this.rootContainer.visible=!1},t.prototype.moveAction=function(t){if(this.optionsList.moveCursor(t.y),"vol"===this.optionsList.getSelected()){var e=this.game.audio.getMasterVolume();(e+=.1*t.x)<0&&(e=0),e>1&&(e=1),this.game.audio.changeMasterVolume(e),this.updateValues(),a.default.set("masterVolume",e),a.default.save()}this.game.audio.playSfx("ui_selection")},t.prototype.updateValues=function(){for(var t=[],e=0;e<this.tipsDisabledIndex;e++)t.push({text:""});t[this.volumeIndex]={text:Math.round(100*this.game.audio.getMasterVolume())+"%"},t[this.tipsDisabledIndex]={text:this.game.display.tipsDisabled?"No":"Yes"},this.valuesList.setData(t),this.valuesList.update()},t.prototype.executeAction=function(){var t=this;switch(this.optionsList.getSelected()){case"save":this.game.display.alert("Saving game, this may take a while.",!0),this.game.display.tickOnce((function(){t.game.persistence.saveGame(t.game),t.game.input.popMode(),t.game.display.alert("Game saved.")}));break;case"exit":this.displayObject.navigateToTitle();break;case"toggleWindowed":o.default.toggleWindowed();break;case"toggleFullScreen":this.displayObject.toggleFullscreen();break;case"toggleTips":this.game.display.toggleTips(),this.updateValues()}},t}();e.default=h},6751:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(9333),s=function(){function t(t,e,i,s){this.game=s,this.display=e,this.rootContainer=new r.Container,this.rootContainer.visible=!1,t.addChild(this.rootContainer);var a=e.panelConfig.actions,o=a.width,l=0,h=0;a.centered?(l=e.metrics.viewportX+e.metrics.viewportWidth/2-o/2+a.x,h=e.metrics.viewportY+e.metrics.viewportHeight/2+a.y):(l=a.x,h=a.y),this.frame=e.createFrame(l,h,o,128),this.rootContainer.addChild(this.frame.container),this.selectableList=new n.default(l+8,h+8,16,o-16,i),this.rootContainer.addChild(this.selectableList.container)}return t.prototype.moveCursor=function(t){this.selectableList.moveCursor(t),this.game.audio.playSfx("ui_selection")},t.prototype.hide=function(){this.rootContainer.visible=!1,this.display.onboardingTips.relocate()},t.prototype.getSelectedAction=function(){return this.selectableList.getSelected()},t.prototype.promptForAction=function(t){this.rootContainer.visible=!0,this.selectableList.setData(t.map((function(t){return{text:t.actionDescription,dataItem:t}}))),this.frame.resize(16*t.length+16),this.selectableList.resetSelection(),this.selectableList.update(),this.display.onboardingTips.relocate()},t.prototype.isVisible=function(){return this.rootContainer.visible},t}();e.default=s},6166:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(6786),s=i(6028),a=i(265),o=i(6247),l=i(9969),h=window.ut,u=function(){function t(t,e,i){this.game=t;var n=new r.Container;this.rootContainer=n,n.visible=!1,i.addChild(n);var s=e.panelConfig.activities,a=s.x,o=s.y,h=s.rows,u=s.rowHeight,c=s.width,d=e.createFrame(a,o,c,(h+1)*u+24);n.addChild(d.container),n.addChild(l.createTextBox(a+c/2-30,o+4,"Activities")),this.activitiesList=e.createSelectableList(a+20,o+28,16,c),n.addChild(this.activitiesList.container)}return t.prototype.show=function(){var t=this,e=this.game.world.level.player.progression,i=e.animals,r=e.crops,l="["+i.length+"/"+(s.default.all().length-1)+"]",h="["+r.length+"/"+n.default.cropsCount+"]",u=a.default.all(),c=[];u.forEach((function(e){if(e.active){switch(e.hook){case o.AchievementHook.CROPS:if(r.length===n.default.cropsCount)return;case o.AchievementHook.OFFICE:if(t.game.world.level.player.flags.foundOffice)return;break;case o.AchievementHook.ANIMALS:if(i.length===s.default.all().length-1)return;break;case o.AchievementHook.BUILD:if(t.game.world.level.player.placedBlocks>=e.goal)return;break;case o.AchievementHook.COOK:if(t.game.world.level.player.flags["HAS_COOKED_".concat(e.param)])return;break;case o.AchievementHook.GET:if(t.game.world.level.player.flags["GOT_ITEM_".concat(e.param)])return}var a=e.description;switch(e.hook){case o.AchievementHook.CROPS:a+=" "+h;break;case o.AchievementHook.ANIMALS:a+=" "+l;break;case o.AchievementHook.BUILD:a+=" ["+t.game.world.level.player.placedBlocks+"/"+e.goal+"]"}c.push({text:a})}})),this.activitiesList.setData(c),this.activitiesList.resetSelection(),this.activitiesList.update(),this.rootContainer.visible=!0,this.game.input.setInputHandler(this)},t.prototype.hide=function(){this.rootContainer.visible=!1,this.game.input.popMode()},t.prototype.onKeyUp=function(t){if(t!==h.KEY_ESCAPE)if(t!==h.KEY_SPACE&&t!==h.KEY_ENTER){if(t===h.KEY_UP||t===h.KEY_DOWN||t===h.KEY_TAB||t===h.KEY_PAGE_DOWN||t===h.KEY_PAGE_UP){this.game.audio.playSfx("ui_selection");var e;e=t===h.KEY_PAGE_DOWN||t===h.KEY_PAGE_UP?t===h.KEY_PAGE_UP?-1:1:t===h.KEY_UP?-1:1,this.activitiesList.moveCursor(e)}}else this.hide();else this.hide()},t.prototype.getTouchControls=function(){return["ESC","enter","pageUp","pageDown"]},t}();e.default=u},9107:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(9969),s=i(9273),a=function(){function t(t,e,i,a){var o=this;this.display=t,this.transferToContainer=a,this.transferToToolbox=i,this.rootContainer=new r.Container,this.rootContainer.visible=!1;var l=t.panelConfig.container,h=l.x,u=l.y,c=l.w,d=l.h,p=t.createFrame(h,u,c,d);this.rootContainer.addChild(p.container);var f=t.createGrid(h+8,u+24,13,1,24,24,{addSlots:!0});f.onBrowse=function(t){return o.showItemInfo(t)},f.onOverflow=function(t){return o.activateContentsGrid(t)},this.toolboxGrid=f,this.rootContainer.addChild(f.container);var m=t.createGrid(h+8,u+28+48,l.columns,l.rows,24,24,{addSlots:!0});m.onBrowse=function(t){return o.showItemInfo(t)},m.onOverflow=function(t){return o.activateToolboxGrid(t)},this.grid=m,this.rootContainer.addChild(m.container),this.activeGrid=this.toolboxGrid,this.grid.disable(),this.title=this.rootContainer.addChild(n.createTextBox(h+8,u+8+48,"")),this.rootContainer.addChild(n.createTextBox(h+8,u+8,"Toolbox")),this.selectedItemName=this.rootContainer.addChild(n.createTextBox(l.selectedX,l.selectedY,"")),this.selectedItemDescription=this.rootContainer.addChild(n.createTextBox(l.selectedX,l.selectedY+16,"",l.selectedWidth)),this.rootContainer.addChild(n.createTextBox(h+8,u+d-24,s.default.replaceActions("$CONTAINER_TRANSFER_ONE: Transfer One - $CONTAINER_TRANSFER_ALL: Transfer All"),c-16)),e.addChild(this.rootContainer)}return t.prototype.showItemInfo=function(t){if(!t)return this.selectedItemName.text="",void(this.selectedItemDescription.text="");this.selectedItemName.text=t.def.name,this.selectedItemDescription.text=t.def.description},t.prototype.show=function(){this.rootContainer.visible=!0,this.display.onboardingTips.relocate(),this.activeGrid.emitSelection()},t.prototype.hide=function(){this.rootContainer.visible=!1,this.display.onboardingTips.relocate()},t.prototype.isVisible=function(){return this.rootContainer.visible},t.prototype.moveCursor=function(t){this.activeGrid.moveCursor(t)},t.prototype.activateToolboxGrid=function(t){-1===t.y&&(this.activeGrid=this.toolboxGrid,this.toolboxGrid.enable(),this.grid.disable(),this.toolboxGrid.emitSelection())},t.prototype.activateContentsGrid=function(t){1===t.y&&(this.activeGrid=this.grid,this.toolboxGrid.disable(),this.grid.enable(),this.grid.emitSelection())},t.prototype.setContainer=function(t,e){var i=this;this.title.text=t.def.name;var r=t.containedItems.map((function(t){return{dataItem:t,label:t.quantity>1?"x".concat(t.quantity):"",renderData:i.display.getMenuRenderDataFromApp(t.getMenuAppearance()),tint:16777215}}));this.grid.setData(r),this.grid.setSlots(t.def.containerCapacity),e&&this.grid.resetSelection(),this.grid.update(),this.activeGrid===this.grid&&this.grid.emitSelection()},t.prototype.setToolboxData=function(t,e){var i=this,r=t.map((function(t){return{dataItem:t,label:t.quantity>1?"x".concat(t.quantity):"",renderData:i.display.getMenuRenderDataFromApp(t.getMenuAppearance()),tint:16777215}}));this.toolboxGrid.setData(r),this.toolboxGrid.setSlots(13),e&&this.toolboxGrid.resetSelection(),this.toolboxGrid.update(),this.activeGrid===this.toolboxGrid&&this.toolboxGrid.emitSelection()},t.prototype.getSelected=function(){return this.grid.getSelected()},t.prototype.performTransfer=function(t){this.activeGrid===this.toolboxGrid?this.transferToContainer(this.toolboxGrid.getSelected(),t):this.transferToToolbox(this.grid.getSelected(),t)},t}();e.default=a},9293:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(6786),s=i(5382),a=i(6028),o=i(9242),l=i(4775),h=i(9969),u=function(){function t(t,e,i){this.game=t,this.display=e;var n=new r.Container;this.mainContainer=n,n.visible=!1,i.addChild(n);var a=e.panelConfig.journal,o=a.x,l=a.y,u=a.rows,c=a.rowHeight,d=a.width,p=e.createFrame(o,l,d,u*c+24);n.addChild(p.container),n.addChild(h.createTextBox(o+d/2-30,l+4,"Field Notes")),this.discoveriesList=new s.default(o+8,l+14,u,c,d-16),n.addChild(this.discoveriesList.container)}return t.prototype.showJournal=function(){var t=this,e=this.game.world.level.player.progression,i=e.animals,r=e.crops,s=e.plants,h=[{text:"\nCurious Fauna [ "+i.length+"/"+(a.default.all().length-1)+"]\nStrange animal species roaming the land."}];h.push.apply(h,i.map((function(e){var i=a.default.get(e),r=o.default.get(e);return{text:i.name+": \n"+i.description,renderData:t.display.getMenuRenderDataFromApp(r)}}))),h.push({text:"\nCrops [ "+r.length+"/"+n.default.cropsCount+"]\nVegetal produce grown on this unusual soil."}),h.push.apply(h,r.map((function(e){var i,r=l.default.get(e),n=null!==(i=r.menuAppearance)&&void 0!==i?i:r.app;return{text:r.name+": \n"+r.description,renderData:t.display.getMenuRenderDataFromApp(n)}}))),h.push({text:"\nFlora and Fungi [ "+s.length+"/"+l.default.plantsCount+"]\nWeird plants and mushrooms laying around."}),h.push.apply(h,s.map((function(e){var i,r=l.default.get(e),n=null!==(i=r.menuAppearance)&&void 0!==i?i:r.app;return{text:r.name+": \n"+r.description,renderData:t.display.getMenuRenderDataFromApp(n)}}))),this.discoveriesList.setData(h),this.discoveriesList.update(),this.mainContainer.visible=!0},t.prototype.hideJournal=function(){this.mainContainer.visible=!1},t.prototype.journalUp=function(){this.discoveriesList.scrollUp()},t.prototype.journalDown=function(){this.discoveriesList.scrollDown()},t}();e.default=u},6432:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(9969),s=function(){function t(t,e){this.display=t.display,this.rootContainer=new r.Container,e.addChild(this.rootContainer),this.rootContainer.addChild(n.createTextBox(20,20,"Loading")),this.loadingStatus=n.createTextBox(20,40,""),this.rootContainer.addChild(this.loadingStatus)}return t.prototype.show=function(){this.rootContainer.visible=!0,this.loadingStatus.text=""},t.prototype.hide=function(){this.rootContainer.visible=!1},t.prototype.loadProgress=function(){var t=this;this.display.tickOnce((function(){return t.loadingStatus.text+="/"}))},t}();e.default=s},6377:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(9969),s=i(212),a=window.ut,o=function(){function t(t,e,i){this.selectedSeason=0,this.game=t,this.display=e,this.rootContainer=new r.Container,this.rootContainer.visible=!1,i.addChild(this.rootContainer);var s=e.panelConfig.settings.x,a=e.panelConfig.settings.y,o=e.panelConfig.settings.width;this.frame=e.createFrame(s,a,o,16),this.rootContainer.addChild(this.frame.container),this.rootContainer.addChild(n.createTextBox(s+20,a+12,"New Game")),this.optionsList=e.createSelectableList(s+20,a+28,16,o),this.rootContainer.addChild(this.optionsList.container),this.txtSeason=n.createTextBox(s+120,a+28,""),this.rootContainer.addChild(this.txtSeason),this.loadingStatus=n.createTextBox(s+120,a+12,""),this.loadingStatus.visible=!1,this.rootContainer.addChild(this.loadingStatus)}return t.prototype.hide=function(){this.rootContainer.visible=!1,this.display.displayTitleScreen()},t.prototype.show=function(){this.loadingStatus.text="",this.selectedSeason=0,this.gabyCounter=0;var t=[];t.push({text:"Season",dataItem:"season"}),t.push({text:"Start Game",dataItem:"start"}),this.optionsList.setData(t),this.frame.resize(16*(t.length+2)),this.rootContainer.visible=!0,this.optionsList.container.visible=!0,this.optionsList.resetSelection(),this.optionsList.update(),this.updateValues(),this.game.input.setInputHandler(this)},t.prototype.updateValues=function(){this.txtSeason.text=0===this.selectedSeason?"Spring":"Winter"},t.prototype.startGame=function(t){var e=this;s.default.isMobile()&&this.display.openFullscreen(),this.loadingStatus.text="Creating World...",this.loadingStatus.visible=!0,this.display.tickOnce((function(){e.game.newGame(t),e.rootContainer.visible=!1}))},t.prototype.onKeyUp=function(t){if(t===a.KEY_G&&0===this.gabyCounter)this.gabyCounter++;else if(t===a.KEY_A&&1===this.gabyCounter)this.gabyCounter++;else if(t===a.KEY_B&&2===this.gabyCounter)this.gabyCounter++;else if(t===a.KEY_Y&&3===this.gabyCounter)this.startGame({playerSuffix:"_G",isWinter:1===this.selectedSeason});else if(t===a.KEY_UP||t===a.KEY_DOWN||t===a.KEY_TAB||t===a.KEY_PAGE_DOWN||t===a.KEY_PAGE_UP){this.game.audio.playSfx("ui_selection");var e=0;e=t===a.KEY_PAGE_DOWN||t===a.KEY_PAGE_UP?t===a.KEY_PAGE_UP?-1:1:t===a.KEY_UP?-1:1,this.optionsList.moveCursor(e)}else t===a.KEY_LEFT||t===a.KEY_RIGHT?"season"===this.optionsList.getSelected()&&(e=t===a.KEY_LEFT?-1:1,this.selectedSeason+=e,this.selectedSeason<0&&(this.selectedSeason=1),this.selectedSeason>1&&(this.selectedSeason=0),this.updateValues()):t===a.KEY_SPACE||t===a.KEY_ENTER?this.confirmSelection():t===a.KEY_ESCAPE&&this.hide()},t.prototype.confirmSelection=function(){switch(this.optionsList.getSelected()){case"start":this.startGame({isWinter:1===this.selectedSeason});break;case"season":this.selectedSeason++,this.selectedSeason>1&&(this.selectedSeason=0),this.updateValues()}},t.prototype.getTouchControls=function(){return["enter","pageUp","pageDown","ESC","left","right"]},t}();e.default=o},4699:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(2746),s=i(9273),a=i(212),o=i(9969),l=function(){function t(t,e,i){this.game=t,this.display=i,this.rootContainer=new r.Container,this.rootContainer.visible=!1,e.addChild(this.rootContainer);var n=i.panelConfig.onboarding,s=n.width,a=i.metrics.viewportX+i.metrics.viewportWidth/2-s/2,l=i.metrics.viewportY+i.metrics.viewportHeight/2+n.verticalOffset;this.onboardingFrame=i.createFrame(a-8,l-8,s+16,64),this.rootContainer.addChild(this.onboardingFrame.container),this.onboardingTxt=this.rootContainer.addChild(o.createTextBox(a,l,"",s))}return t.prototype.showOnboarding=function(){if(n.default.onboardingFinished())this.hideOnboarding();else{var t=n.default.currentStep(),e=null==t?void 0:t.mobileText,i=null==t?void 0:t.text;a.default.isMobile()&&e&&(i=e),this.rootContainer.visible=!!i,"prompt"===(null==t?void 0:t.trigger.type)&&(this.display.switchOverlay(!0),i+="\n\nPress $ACTION",this.game.input.setMode(s.InputMode.PROMPT_OB)),i&&(i=s.default.replaceActions(i),this.onboardingTxt.text=i),this.onboardingFrame.resize(11*(o.lines(this.onboardingTxt.text,this.onboardingTxt).length+1)+4),this.relocate()}},t.prototype.relocate=function(){var t=!1,e=n.default.currentStep();(this.display.recipesPanel.isVisible()||this.display.containerContentsGrid.isVisible())&&"prompt"!==(null==e?void 0:e.trigger.type)?t=!0:this.display.actionsList.isVisible()&&(t=!!a.default.isMobile()),this.rootContainer.y=t?this.display.panelConfig.onboarding.bottomAnchorOffset:0},t.prototype.hideOnboarding=function(){this.rootContainer.visible=!1},t}();e.default=l},3155:(t,e,i)=>{"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0});var n,s=i(8687),a=i(9969),o=i(5382),l=i(6217),h=i(1668),u=i(4775),c=i(9273);!function(t){t[t.CATEGORIES=0]="CATEGORIES",t[t.RECIPES=1]="RECIPES"}(n||(n={}));var d=((r={})[c.InputMode.SELECT_CRAFT]=[h.default.WALLS,h.default.FLOORING,h.default.TOOLS,h.default.FURNITURE,h.default.PAINT],r[c.InputMode.SELECT_RECIPE]=[h.default.GRILL,h.default.BOIL,h.default.FRY,h.default.MIX,h.default.BAKE],r),p=function(){function t(t,e,i){var r=this;this.game=t,this.rootContainer=new s.Container,this.rootContainer.visible=!1;var l=t.display;this.display=l;var h=l.panelConfig.crafting.x,u=l.panelConfig.crafting.y,c=l.panelConfig.crafting.w,d=l.panelConfig.crafting.h,p=l.createFrame(h,u,c-8,d);this.rootContainer.addChild(p.container);var f=l.createGrid(h+8,u+28,10,8,24,24,{hideCursorOnDisable:!1});f.onBrowse=function(t){r.showRecipeInfo(t),i&&i(t)},f.onOverflow=function(t){return r.activateCategoriesGrid(t)},this.grid=f,this.rootContainer.addChild(f.container);var m=l.panelConfig.crafting.selectedX,g=l.panelConfig.crafting.selectedY;this.selectedRecipeName=this.rootContainer.addChild(a.createTextBox(m,g,"")),this.ingredientsList=new o.default(m,g+16,5,16,150),this.rootContainer.addChild(this.ingredientsList.container);var _=l.createGrid(h+8,u+8,10,8,64,24,{textGrid:!0,cursor:"tab",hideCursorOnDisable:!1});_.onBrowse=function(t){r.currentCategory=t,r.updateGrid()},_.onOverflow=function(t){return r.activateRecipesGrid(t)},this.categoriesGrid=_,this.rootContainer.addChild(_.container),e.addChild(this.rootContainer),this.activeGrid=n.RECIPES,this.categoriesGrid.disable(),this.grid.enable()}return t.prototype.activateCategoriesGrid=function(t){-1===t.y&&(this.activeGrid=n.CATEGORIES,this.categoriesGrid.enable(),this.grid.disable())},t.prototype.activateRecipesGrid=function(t){1===t.y&&(this.activeGrid=n.RECIPES,this.categoriesGrid.disable(),this.grid.enable())},t.prototype.showRecipeInfo=function(t){var e;if(!t)return this.selectedRecipeName.text="",void(this.ingredientsList.container.visible=!1);this.ingredientsList.container.visible=!0;var i=this.game.display;this.game.player.selectRecipe(t),this.selectedRecipeName.text=l.default.getItem(t).name;var r=t.materials.map((function(t){var e,r;return t.isAspect?{text:(r=l.default.getAspect(t.id)).name+" x"+t.quantity,renderData:i.getMenuRenderDataFromApp(r.app),tint:16777215}:{text:(r=u.default.get(t.id)).name+" x"+t.quantity,renderData:i.getMenuRenderDataFromApp(null!==(e=r.menuAppearance)&&void 0!==e?e:r.app),tint:16777215}}));if(t.requiredContainer){var n=u.default.get(t.requiredContainer);r.unshift({text:n.name,renderData:i.getMenuRenderDataFromApp(null!==(e=n.menuAppearance)&&void 0!==e?e:n.app),tint:16777215})}this.ingredientsList.setData(r),this.ingredientsList.update()},t.prototype.setCategories=function(){this.craftingCategories=d[this.game.input.peekMode()]},t.prototype.show=function(){this.rootContainer.visible=!0,this.display.onboardingTips.relocate()},t.prototype.hide=function(){this.rootContainer.visible=!1,this.display.onboardingTips.relocate()},t.prototype.isVisible=function(){return this.rootContainer.visible},t.prototype.moveCursor=function(t){this.activeGrid===n.RECIPES?this.grid.moveCursor(t):this.categoriesGrid.moveCursor(t)},t.prototype.setRecipes=function(t){var e=this.craftingCategories.map((function(t){return{dataItem:t,label:h.CraftingCategoryDescriptionsMap[t]}}));this.categoriesGrid.setData(e),this.categoriesGrid.update(),this.categoriesGrid.resetSelection(),this.recipes=t,this.currentCategory=this.craftingCategories[0],this.updateGrid()},t.prototype.updateGrid=function(){var t=this;if(this.recipes){var e=this.recipes.filter((function(e){return e.craftCategory===t.currentCategory})).map((function(e){return{dataItem:e,label:"",renderData:t.game.display.getMenuRenderDataFromApp(l.default.getMenuAppearance(e)),tint:16777215}}));this.grid.setData(e),this.grid.update(),this.grid.emitSelection()}},t.prototype.getSelected=function(){return this.grid.getSelected()},t.prototype.resetSelection=function(){this.grid.resetSelection()},t}();e.default=p},9998:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8687),n=i(9969),s=i(3945),a=i(1623),o=i(212),l=i(9333),h=i(9273),u=i(6377),c=window.ut,d=i(234),p=function(){function t(t,e,i,a,o,h,c){this.game=t,this.display=e;var p=this.rootContainer=new r.Container;p.visible=!1,i.addChild(p),p.addChild(new r.Sprite(o)),p.addChild(n.createTextBox(20,20,"Emerald Woods",void 0,{fill:s.default.rgbToByte(c.r,c.g,c.b)})),this.optionsList=new l.default(44,40,10,120,h),p.addChild(this.optionsList.container);var f=[];f.push({text:"New Game",dataItem:"newGame"}),f.push({text:"Continue",dataItem:"continue"}),f.push({text:"Settings",dataItem:"settings"}),this.canQuit()&&f.push({text:"Exit",dataItem:"exit"}),this.optionsList.setData(f),this.optionsList.update(),this.loadingStatus=n.createTextBox(200,40,""),this.loadingStatus.visible=!1,p.addChild(this.loadingStatus),this.versionInfo=n.createTextBox(24,a.windowHeight-24-32,"",800),this.versionInfo.visible=!1,p.addChild(this.versionInfo),p.addChild(n.createTextBox(24,a.windowHeight-36,"v"+this.game.version)),p.addChild(n.createTextBox(24,a.windowHeight-24,"Copyright (c) 2020-2024 - Slashware S.A.S. Audio by QuietGecko")),p.addChild(n.createTextBox(24,a.windowHeight-24-80,d.earlyDevelopment,300)),this.newGamePanel=new u.default(t,e,p)}return t.prototype.show=function(){this.rootContainer.visible=!0,this.loadingStatus.text="",this.optionsList.resetSelection(),this.game.input.setInputHandler(this)},t.prototype.hide=function(){this.rootContainer.visible=!1},t.prototype.changeTitleOption=function(t){this.optionsList.moveCursor(t)},t.prototype.canQuit=function(){return a.default.isElectron()},t.prototype.confirmTitleSelection=function(){var t=this;switch(this.optionsList.getSelected()){case"newGame":this.newGamePanel.show();break;case"continue":o.default.isMobile()&&this.display.openFullscreen(),this.loadingStatus.text="Loading game...",this.loadingStatus.visible=!0,this.display.tickOnce((function(){return t.game.loadGame(!1,(function(e){t.display.titleScreen.showLoadErrorMessage(e)}))}));break;case"exit":a.default.electronClose();break;case"settings":this.game.input.setMode(h.InputMode.SETTINGS_MENU),this.display.settingsPanel.display(!1)}},t.prototype.showLoadErrorMessage=function(t){this.loadingStatus.text=t,this.loadingStatus.visible=!0},t.prototype.showNewVersion=function(t){this.versionInfo.text="A newer version (v"+t.version+") is available!\nVisit "+t.updateSite+" to download it!",this.versionInfo.visible=!0},t.prototype.showCurrentVersion=function(t){this.versionInfo.text="You are using the latest available version from "+t.releaseDate+".",this.versionInfo.visible=!0},t.prototype.showFutureVersion=function(t){this.versionInfo.text="You are using an unreleased, test version!",this.versionInfo.visible=!0},t.prototype.showVersionError=function(t){this.versionInfo.text="Up to date check failed.",this.versionInfo.visible=!0},t.prototype.onKeyUp=function(t){if(t!==c.KEY_SPACE&&t!==c.KEY_ENTER){if(t===c.KEY_UP||t===c.KEY_DOWN||t===c.KEY_TAB||t===c.KEY_PAGE_DOWN||t===c.KEY_PAGE_UP){this.game.audio.playSfx("ui_selection");var e;return e=t===c.KEY_PAGE_DOWN||t===c.KEY_PAGE_UP?t===c.KEY_PAGE_UP?-1:1:t===c.KEY_UP?-1:1,void this.changeTitleOption(e)}}else this.confirmTitleSelection()},t.prototype.getTouchControls=function(){return["enter","pageUp","pageDown"]},t}();e.default=p},8727:function(t,e,i){"use strict";var r=this&&this.__spreadArray||function(t,e,i){if(i||2===arguments.length)for(var r,n=0,s=e.length;n<s;n++)!r&&n in e||(r||(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0});var n=i(8687),s=i(9969),a=i(9273),o=window.ut,l=40,h=20,u=15,c=[a.InputMode.BUILDING,a.InputMode.MOVEMENT,a.InputMode.SELECT_CRAFT,a.InputMode.SELECT_RECIPE,a.InputMode.CONTAINER],d=function(){function t(t,e,i,r){var a=this;this.pressedKey=-1,this.game=t,this.rootContainer=new n.Container,this.configureButtons(r),this.touchButtons.forEach((function(e){var r=new n.Sprite(i);r.interactive=!0,r.on("pointerdown",(function(t){e.continuous&&(a.pressedKey=e.utKey,a.startFiring())})),r.on("pointerup",(function(i){e.utKey===o.KEY_SHIFT?(a.shiftPressed=!a.shiftPressed,h.text=a.shiftPressed?"Shift Lock":"Shift Off"):e.continuous?(a.pressedKey=-1,clearTimeout(a.currentTimeout)):t.input.onKeyUp(e.utKey)})),r.x=e.x-e.r,r.y=e.y-e.r,r.width=2*e.r,r.height=2*e.r;var l=new n.Container;l.addChild(r);var h=s.createTextBox(0,0,e.label);h.x=e.x-Math.floor(h.width/2),h.y=e.y-Math.floor(h.height/2),l.addChild(h),a.rootContainer.addChild(l),e.container=l,e.labelTxt=h})),e.addChild(this.rootContainer)}return t.prototype.startFiring=function(){var t=this;-1!==this.pressedKey&&(this.game.input.onKeyDown(this.pressedKey),this.currentTimeout=setTimeout((function(){return t.startFiring()}),100))},t.prototype.configureButtons=function(t){var e,i,n=t.windowWidth,s=t.windowHeight,d=s-65,p=n-h-5,f=s-h-5;this.touchButtons=[{id:"s",x:65,y:d,r:u,utKey:o.KEY_X,continuous:!0,label:"",inputModes:[a.InputMode.MOVEMENT],container:null},{id:"up",x:65,y:d-l,r:h,utKey:o.KEY_UP,continuous:!0,label:"",inputModes:c},{id:"down",x:65,y:d+l,r:h,utKey:o.KEY_DOWN,continuous:!0,label:"",inputModes:c},{id:"left",x:25,y:d,r:h,utKey:o.KEY_LEFT,continuous:!0,label:"",inputModes:r(r([],c,!0),[a.InputMode.SETTINGS_MENU],!1)},{id:"right",x:105,y:d,r:h,utKey:o.KEY_RIGHT,continuous:!0,label:"",inputModes:r(r([],c,!0),[a.InputMode.SETTINGS_MENU],!1)},{id:"7",x:25,y:d-l,r:u,utKey:o.KEY_NUMPAD7,continuous:!0,label:"",inputModes:c},{id:"9",x:105,y:d-l,r:u,utKey:o.KEY_NUMPAD9,continuous:!0,label:"",inputModes:c},{id:"1",x:25,y:d+l,r:u,utKey:o.KEY_NUMPAD1,continuous:!0,label:"",inputModes:c},{id:"3",x:105,y:d+l,r:u,utKey:o.KEY_NUMPAD3,continuous:!0,label:"",inputModes:c},{id:"enter",x:p,y:f,r:h,utKey:o.KEY_ENTER,continuous:!1,label:"A",specialLabels:(e={},e[a.InputMode.CONTAINER]="One",e),inputModes:[a.InputMode.ALERT,a.InputMode.BUILDING,a.InputMode.INTRO,a.InputMode.SELECT_CRAFT,a.InputMode.SELECT_RECIPE,a.InputMode.CONTAINER,a.InputMode.JOURNAL,a.InputMode.MAP,a.InputMode.MOVEMENT,a.InputMode.PROMPT,a.InputMode.PROMPT_ACTION,a.InputMode.SETTINGS_MENU,a.InputMode.PROMPT_OB]},{id:"use",x:n-5-u,y:160,r:u,utKey:o.KEY_U,continuous:!1,label:"Use",inputModes:[a.InputMode.MOVEMENT]},{id:"ESC",x:n-5-u,y:160,r:u,utKey:o.KEY_ESCAPE,continuous:!1,label:"Back",inputModes:[a.InputMode.BUILDING,a.InputMode.SELECT_CRAFT,a.InputMode.SELECT_RECIPE,a.InputMode.CONTAINER,a.InputMode.JOURNAL,a.InputMode.MAP,a.InputMode.PROMPT,a.InputMode.PROMPT_ACTION,a.InputMode.PROMPT_OB,a.InputMode.SETTINGS_MENU]},{id:"sys",x:20,y:20,r:u,utKey:o.KEY_ESCAPE,continuous:!1,label:"Sys",inputModes:[a.InputMode.MOVEMENT]},{id:"build",x:20,y:55,r:u,utKey:o.KEY_B,continuous:!1,label:"Build",inputModes:[a.InputMode.MOVEMENT]},{id:"pageUp",x:n-5-u,y:20,r:u,utKey:o.KEY_PAGE_UP,continuous:!1,label:"↑",inputModes:[a.InputMode.JOURNAL,a.InputMode.MOVEMENT,a.InputMode.PROMPT_ACTION,a.InputMode.SETTINGS_MENU]},{id:"pageDown",x:n-5-u,y:55,r:u,utKey:o.KEY_PAGE_DOWN,continuous:!1,label:"↓",inputModes:[a.InputMode.JOURNAL,a.InputMode.MOVEMENT,a.InputMode.PROMPT_ACTION,a.InputMode.SETTINGS_MENU]},{id:"space",x:n-5-u,y:90,r:u,utKey:o.KEY_SPACE,continuous:!1,label:"Act",specialLabels:(i={},i[a.InputMode.CONTAINER]="All",i),inputModes:[a.InputMode.CONTAINER,a.InputMode.MOVEMENT]},{id:"drop",x:n-5-u,y:125,r:u,utKey:o.KEY_R,continuous:!1,label:"Drop",inputModes:[a.InputMode.MOVEMENT]}]},t.prototype.setDelegateButtons=function(){var t=this;this.touchButtons.forEach((function(e){e.container.visible=t.game.input.inputHandlerDelegate.getTouchControls().indexOf(e.id)>-1}))},t.prototype.setMode=function(){var t=this.game.input.peekMode();this.pressedKey=-1,this.touchButtons.forEach((function(e){if(e.container.visible=e.inputModes.indexOf(t)>-1,e.container.visible){var i=e.specialLabels&&e.specialLabels[t];e.labelTxt.text=i||e.label}}))},t}();e.default=d},6247:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.AchievementHook=void 0,(i=e.AchievementHook||(e.AchievementHook={})).ANIMALS="ANIMALS",i.OFFICE="OFFICE",i.CROPS="CROPS",i.BUILD="BUILD",i.COOK="COOK",i.GET="GET"},1668:(t,e)=>{"use strict";var i,r;Object.defineProperty(e,"__esModule",{value:!0}),e.CraftingCategoryDescriptionsMap=void 0,function(t){t.FLOORING="FLOORING",t.WALLS="WALLS",t.TOOLS="TOOLS",t.PAINT="PAINT",t.FURNITURE="FURNITURE",t.GRILL="GRILL",t.BOIL="BOIL",t.FRY="FRY",t.MIX="MIX",t.BAKE="BAKE"}(r||(r={})),e.CraftingCategoryDescriptionsMap=((i={})[r.FLOORING]="Flooring",i[r.WALLS]="Walls",i[r.TOOLS]="Tools",i[r.PAINT]="Paint",i[r.FURNITURE]="Furniture",i[r.GRILL]="Grill",i[r.BOIL]="Boil",i[r.FRY]="Fry",i[r.MIX]="Mix",i[r.BAKE]="Bake",i),e.default=r},2460:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.NORTH=0]="NORTH",t[t.SOUTH=1]="SOUTH",t[t.WEST=2]="WEST",t[t.EAST=3]="EAST",t[t.NORTHEAST=4]="NORTHEAST",t[t.NORTHWEST=5]="NORTHWEST",t[t.SOUTHEAST=6]="SOUTHEAST",t[t.SOUTHWEST=7]="SOUTHWEST"}(i||(i={})),e.default=i},3085:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=[["x"],[" x ","xxx"," x "],[" xxx ","xxxxx","xxxxx","xxxxx"," xxx "],["  xxx  "," xxxxx ","xxxxxxx","xxxxxxx","xxxxxxx"," xxxxx ","  xxx  "],["  xxxxx  "," xxxxxxx ","xxxxxxxxx","xxxxxxxxx","xxxxxxxxx","xxxxxxxxx","xxxxxxxxx"," xxxxxxx ","  xxxxx  "],["   xxxxx   ","  xxxxxxx  "," xxxxxxxxx ","xxxxxxxxxxx","xxxxxxxxxxx","xxxxxxxxxxx","xxxxxxxxxxx","xxxxxxxxxxx"," xxxxxxxxx ","  xxxxxxx  ","   xxxxx   "],["   xxxxxxx   ","  xxxxxxxxx  "," xxxxxxxxxxx ","xxxxxxxxxxxxx","xxxxxxxxxxxxx","xxxxxxxxxxxxx","xxxxxxxxxxxxx","xxxxxxxxxxxxx","xxxxxxxxxxxxx","xxxxxxxxxxxxx"," xxxxxxxxxxx ","  xxxxxxxxx  ","   xxxxxxx   "],["    xxxxxxx    ","  xxxxxxxxxxx  "," xxxxxxxxxxxxx "," xxxxxxxxxxxxx ","xxxxxxxxxxxxxxx","xxxxxxxxxxxxxxx","xxxxxxxxxxxxxxx","xxxxxxxxxxxxxxx","xxxxxxxxxxxxxxx","xxxxxxxxxxxxxxx","xxxxxxxxxxxxxxx"," xxxxxxxxxxxxx "," xxxxxxxxxxxxx ","  xxxxxxxxxxx  ","    xxxxxxx    "],["     xxxxxxx     ","   xxxxxxxxxxx   ","  xxxxxxxxxxxxx  "," xxxxxxxxxxxxxxx ","xxxxxxxxxxxxxxxxx","xxxxxxxxxxxxxxxxx","xxxxxxxxxxxxxxxxx","xxxxxxxxxxxxxxxxx","xxxxxxxxxxxxxxxxx","xxxxxxxxxxxxxxxxx","xxxxxxxxxxxxxxxxx","xxxxxxxxxxxxxxxxx","xxxxxxxxxxxxxxxxx"," xxxxxxxxxxxxxxx ","  xxxxxxxxxxxxx  ","   xxxxxxxxxxx   ","     xxxxxxx     "]]},9334:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var i=new Array,r=t.x,n=t.y,s=e.x,a=e.y,o=Math.abs(s-r),l=Math.abs(a-n),h=r<s?1:-1,u=n<a?1:-1,c=o-l;for(i.push({x:r,y:n});r!=s||n!=a;){var d=c<<1;d>-l&&(c-=l,r+=h),d<o&&(c+=o,n+=u),i.push({x:r,y:n})}return i}},4095:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8018),n=i(4369),s=i(6028),a=i(4738),o=i(4775),l=i(9242),h=i(7409),u=function(){function t(t,e,i){if(0!=arguments.length){this.game=t,this.level=e;var n=s.default.get(i);if(!n)throw new Error("Invalid race: "+i);this.race=n,this.x=null,this.y=null,this.intent="RANDOM",this.produceCounterMinutes=0,this.producePowerCounterMinutes=0,this.frustrationCounter=0,this.love=0,this.restoreDoom(),this.resetProduce(),this.hitPoints=this.race.hitPoints,this._c=r.register("Being")}}return t.prototype.act=function(){if(!this.inactive)if(this.leashed)this.actFollowPlayer();else switch(this.intent){case"RANDOM":this.actRandom();break;case"CHASE":this.actChase();break;case"FLEE":this.actFlee()}},t.prototype.update=function(){this.inactive||(this.produceCounterMinutes>0&&this.producePowerCounterMinutes>0&&(this.produceCounterMinutes-=60*this.game.player.getLastTurnTime(),this.producePowerCounterMinutes-=60*this.game.player.getLastTurnTime(),this.produceCounterMinutes<=0&&this.produce()),this.eternal||(this.doomCounter-=100*this.game.player.getLastTurnTime(),this.doomCounter<=0&&(this.prepopulated?this.inactive=!0:this.killBeing(!0))))},t.prototype.damage=function(t){this.hitPoints-=t,this.intent="FLEE"},t.prototype.killBeing=function(t){if(void 0===t&&(t=!1),this.leashed&&(this.leashed=!1,this.game.player.leashedAnimal=void 0),this.level.removeBeing(this),!t){if(this.level.getItem(this.x,this.y,this.z))return;var e=o.default.getSacrificeForRace(this.race);e&&this.level.addItem(new n.default(this.game,e.itemId,e.quantity),this.x,this.y,this.z)}},t.prototype.onSeen=function(){this.inactive&&(this.inactive=!1),this.eternal||this.restoreDoom()},t.prototype.revive=function(){this.race=s.default.get(this.__serialData.raceId),h.fillBeingToRevive(this)},t.prototype.eat=function(t){this.level.removePlant(t)},t.prototype.actRandom=function(){var t=this.level.getCropPlantAt(this.x,this.y,this.z);if(t)this.eat(t);else{var e,i,r=!1;if(this.frustrationCounter<=0)t:for(var n=-5;n<=5;n++)for(var s=-5;s<=5;s++){var o=this.x+n,l=this.y+s;if(this.level.getCropPlantAt(o,l,this.z)){e=Math.sign(o-this.x),i=Math.sign(l-this.y),r=!0;break t}}else this.frustrationCounter--;r||(e=a.default.n(-1,1),i=a.default.n(-1,1)),this.canWalkTo(e,i)?this.moveTo(e,i):r&&(this.frustrationCounter=20)}},t.prototype.canWalkTo=function(t,e){return this.level.isFlooded(this.x+t,this.y+e,this.z)?"Fish"===this.race.type&&this.level.canWalkTo(this.x+t,this.y+e,this.z):"Fish"===this.race.type?this.level.isWater(this.x+t,this.y+e,this.z):this.level.canWalkTo(this.x+t,this.y+e,this.z)},t.prototype.actFollowBeing=function(t){var e=Math.sign(t.x-this.x),i=Math.sign(t.y-this.y);this.canWalkTo(e,i)&&this.moveTo(e,i)},t.prototype.actFlee=function(){var t=Math.sign(this.game.player.x-this.x),e=Math.sign(this.game.player.y-this.y);this.canWalkTo(-t,-e)&&this.moveTo(-t,-e)},t.prototype.actChase=function(){var t=this.getNearestEnemy();t&&this.actFollowBeing(t)},t.prototype.actFollowPlayer=function(){this.actFollowBeing(this.game.player)},t.prototype.getNearestEnemy=function(){return this.game.player},t.prototype.moveTo=function(t,e){this.level.moveBeing(this.x,this.y,this.z,t,e),this.x=this.x+t,this.y=this.y+e},t.prototype.resetProduce=function(){this.race.produce&&(this.produceCounterMinutes=12*this.race.produce.days*60+a.default.n(0,60))},t.prototype.tryEat=function(t){return t.def.id===this.race.preferredFood?(this.game.display.message("The "+this.race.name+" seems happy!","Happy!",this.x,this.y),this.race.produce&&(this.producePowerCounterMinutes=720,this.produceCounterMinutes<=0&&this.resetProduce()),this.love++,!0):(this.game.display.message("The "+this.race.name+" refuses to eat!","No",this.x,this.y),!1)},t.prototype.produce=function(){if(this.race.produce)if("item"==this.race.produce.type)this.level.getItem(this.x,this.y,this.z)||this.level.addItem(new n.default(this.game,this.race.produce.id,a.default.n(1,this.race.produce.quantity)),this.x,this.y,this.z),this.resetProduce();else if("animal"==this.race.produce.type){var e=this.level.getFreeSpotAround(this.x,this.y,this.z);if(e){var i=new t(this.game,this.level,this.race.produce.id);i.eternal=!0,this.level.addBeing(i,this.x+e.x,this.y+e.y,this.z)}this.resetProduce()}},t.prototype.restoreDoom=function(){this.doomCounter=50},t.prototype.getExamineDescription=function(){return this.race.description+(this.leashed?" (Leashed)":"")},t.prototype.evadesStab=function(){return this.hitPoints>1},t.prototype.getAppearance=function(){var t=this.race.app;return this.level.isWinter&&l.default.exists(t.id+"_W")?l.default.get(t.id+"_W"):t},t}();e.default=u,r.registerClass("Being",u,{transients:{race:!0},reviver:function(t){t.revive()},prepare:function(t){return{raceId:t.race.id}}})},5850:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Building=void 0;var r=i(8018);e.Building=function(t,e,i){this.type=t,this.x=e,this.y=i,this._c=r.setSafe()}},8866:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.BuildingType=void 0,(i=e.BuildingType||(e.BuildingType={}))[i.STATION=0]="STATION",i[i.OFFICES=1]="OFFICES",i[i.CABIN=2]="CABIN"},3388:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4775),n=new(function(){function t(){}return t.prototype.compileMaterialsForRecipe=function(t,e,i){var n,s={missingMaterials:[],materialWeight:0,usedSlots:0},a=null===(n=e.world.level.getItem(t.x+t.dx,t.y+t.dy,t.z))||void 0===n?void 0:n.stackedItem,o=e.world.level.getLooseItemsAround(t.x,t.y,t.z);return i.materials.forEach((function(e){var i,n,l;if(!e.isAspect&&r.default.get(e.id).isLiquid){var h=r.default.get(e.id),u=0;return t.items.forEach((function(t){t.containedLiquid&&t.containedLiquid.id===e.id&&(u+=t.containedLiquidQuantity)})),(null===(i=null==a?void 0:a.containedLiquid)||void 0===i?void 0:i.id)===e.id&&(u+=a.containedLiquidQuantity),t.getBackpack()&&t.getBackpack().containedItems.forEach((function(t){t.containedLiquid&&t.containedLiquid.id===e.id&&(u+=t.containedLiquidQuantity)})),void(u<e.quantity?s.missingMaterials.push(e):s.materialWeight+=u*h.weight)}if(!(l=e.isAspect?t.findItemByAspectIncludingBackpack(e.id):t.findItemIncludingBackpack(e.id))||l.quantity<e.quantity){var c=e.quantity-(null!==(n=null==l?void 0:l.quantity)&&void 0!==n?n:0);o.reduce((function(t,i){return i.item.def.id===e.id?t+i.item.quantity:t}),0)<c?s.missingMaterials.push(e):(null==l?void 0:l.quantity)&&(s.materialWeight+=r.default.get(e.id).weight*l.quantity,s.usedSlots++)}else s.materialWeight+=l.def.weight*e.quantity,(l.def.noStack||l.quantity===e.quantity)&&s.usedSlots++})),s},t}());e.default=n},4369:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9242),n=i(7926),s=i(8779),a=i(6041),o=i(6786),l=i(6373),h=i(4775),u=i(2746),c=i(4738),d=i(212),p=i(4775),f=i(8018),m={x:0,y:0},g=function(){function t(t,e,i,r){if(0!=arguments.length){this.id=e;var n=h.default.get(e);if(this.game=t,!n)throw new Error("Invalid item definition: ["+e+"]");this.def=n,this.quantity=i,this._c=f.register("Item"),r&&(this.paintColor=r,this.paintColor._c=f.setSafe()),this.containedItems=[]}}return t.prototype.clone=function(){var e=new t(this.game,this.id,this.quantity,this.paintColor);return e.containedLiquid=this.containedLiquid,e.containedLiquidQuantity=this.containedLiquidQuantity,e.isUnharvestedCrop=this.isUnharvestedCrop,e},t.prototype.paint=function(t,e,i){this.paintColor=t.def.paintColor,this.paintColor._c=f.setSafe(),this.game.display.message("You paint the "+this.def.name+" "+t.def.colorName+".","Paint",e,i)},t.prototype.tryKill=function(t){var e=this,i=this.game.player,r=i.x+t.x,n=i.y+t.y,a=this.game.world.level;if(!i.canPerformAction(s.PlayerAction.KILL))return null;var o=a.getBeing(r,n,i.z);return o?(this.game.input.prompt("Do you want to stab the "+o.race.name+"?",(function(){o.evadesStab()?e.game.display.alert("The "+o.race.name+" avoids the stab, you attack the "+o.race.name+"!",!1,(function(){var t,e;i.endTurn(null!==(e=null===(t=i.tryAttack())||void 0===t?void 0:t.hours)&&void 0!==e?e:1)})):h.default.getSacrificeForRace(o.race)?(e.game.display.message("You stab the "+o.race.name+".","Kill",o.x,o.y),o.killBeing(),i.performAction(s.PlayerAction.KILL),i.endTurn(i.getActionTime(s.PlayerAction.KILL))):e.game.display.message("You can't kill the "+o.race.name+".","Can't",o.x,o.y)})),null):(this.game.display.errorMessage("Nothing there."),null)},t.prototype.tryRotate=function(){var t;return(null===(t=this.def.rotable)||void 0===t?void 0:t.rotable)?(this.def.rotable.rotateSfx&&this.game.audio.playSfx(this.def.rotable.rotateSfx),this.rotation||(this.rotation=0),this.rotation++,this.rotation>3&&(this.rotation=0),{hours:1/60}):(this.game.display.errorMessage("You cannot rotate the ".concat(this.def.name)),null)},t.prototype.tryLeash=function(t){var e=this.game.player,i=e.x+t.x,r=e.y+t.y,n=this.game.world.level;if(!e.canPerformAction(s.PlayerAction.LEASH))return null;var a=n.getBeing(i,r,e.z);if(!a)return this.game.display.errorMessage("Nothing there."),null;if(a.leashed)this.game.display.message("You unleash the "+a.race.name+".","Free!",a.x,a.y),a.leashed=!1,e.leashedAnimal=void 0;else{if(e.leashedAnimal)return this.game.display.errorMessage("You already have a "+e.leashedAnimal.race.name+" leashed."),null;var o=20+20*a.love;c.default.chance(o)?(this.game.display.message("You leash the "+a.race.name+".","Leashed!",a.x,a.y),a.leashed=!0,a.eternal=!0,e.leashedAnimal=a,e.onAnimalCaptured(a)):this.game.display.message("You fail to leash the "+a.race.name+"!","Fail",a.x,a.y)}return e.performAction(s.PlayerAction.LEASH),{hours:e.getActionTime(s.PlayerAction.LEASH)}},t.prototype.interactsWithBeing=function(){switch(this.def.effect){case"kill":case"leash":case"chop":case"cut":return!0;default:return!1}},t.prototype.use=function(e){var i,r,o,l=this,d=e.direction||m,p=this.game.player,f=this.game.world.level,g=p.x+d.x,_=p.y+d.y,y=f.getTile(g,_,p.z),v=f.getFlooringAt(g,_,p.z),x=f.getItem(g,_,p.z),b=f.getPlantAt(g,_,p.z),E=f.getBeing(g,_,p.z);switch(this.def.effect){case"till":if(!p.canPerformAction(s.PlayerAction.TILL))return null;if(v)this.game.display.errorMessage("The "+v.name+" blocks you.");else if(x)this.game.display.errorMessage("The "+x.def.name+" blocks you.");else if(b)this.game.display.errorMessage("The "+b.plantDef.name+" blocks you.");else if(y.tallGrass)this.game.display.errorMessage("You need to cut down the tall grass before tilling.");else{if(y.tillable)return this.game.display.message("You till the ground.",null,0,0),this.game.audio.playSfx("till_01,till_02,till_03"),p.performAction(s.PlayerAction.TILL),this.game.world.level.changeTile(g,_,p.z,a.default.get(y.tillable.toTileId)),u.default.reportAction("groundTilled"),{hours:p.getActionTime(s.PlayerAction.TILL)};if(y.fragile)return p.tryAttackTile(g,_,y.breakable.hp);y.tilled?this.game.display.errorMessage("The ground is already tilled."):this.game.display.errorMessage("You cannot till the ground here.")}return null;case n.ItemEffect.DIG:if(!p.canPerformAction(s.PlayerAction.DIG))return null;if(v)this.game.display.errorMessage("The "+v.name+" blocks you.");else if(x)this.game.display.errorMessage("The "+x.def.name+" blocks you.");else if(b)this.game.display.errorMessage("The "+b.plantDef.name+" blocks you.");else{if(y.digTransform||y.digDestroyable)return this.game.display.message("You dig into the ground.",null,0,0),p.performAction(s.PlayerAction.DIG),(null===(i=y.digTransform)||void 0===i?void 0:i.sfx)&&this.game.audio.playSfxWithVariation(y.digTransform.sfx.preffix,y.digTransform.sfx.variations),y.digDestroyable?this.game.world.level.destroyTile(g,_,p.z):(y.digTransform.toTileId&&this.game.world.level.changeTile(g,_,p.z,a.default.get(y.digTransform.toTileId)),y.digTransform.digRewardId&&(y.digTransform.rewardChance&&!c.default.chance(y.digTransform.rewardChance)||this.game.world.level.popDigReward(g,_,p.z,y.digTransform.digRewardId))),u.default.reportAction("groundDug"),{hours:p.getActionTime(s.PlayerAction.DIG)};if(y.fragile)return p.tryAttackTile(g,_,y.breakable.hp);this.game.display.errorMessage("You cannot dig the ground here.")}return null;case"sleep":return p.triggerSleep(d,!0),null;case"paint":if(!p.canPerformAction(s.PlayerAction.PAINT))break;var T=!1;if(b)b.paint(this),T=!0;else if(x){if("paint"===x.def.effect)return this.game.display.errorMessage("You cannot paint paint."),null;x.paint(this,g,_),T=!0}else(v||y)&&(f.paintOver(g,_,p.z,this),T=!0);return T?(p.reduceFromItem(this,1),p.performAction(s.PlayerAction.PAINT),this.game.audio.playSfx("paint_01,paint_02,paint_03"),{hours:p.getActionTime(s.PlayerAction.PAINT)}):(this.game.display.errorMessage("Nothing to paint."),null);case"kill":return this.tryKill(d);case"leash":return this.tryLeash(d);case"chop":case"cut":if(!p.canPerformAction(s.PlayerAction.CHOP))return null;if(E)return p.tryAttack();if(b){if((null===(r=b.plantDef.cutableBranches)||void 0===r?void 0:r.itemId)&&"cut"===this.def.effect)return p.canPickOf(b.plantDef.cutableBranches.itemId,1,!0,!0)?(this.game.display.message("You cut a branch off the "+b.plantDef.name+".","Cut",g,_),b.plantDef.cutableBranches.cutSFX&&this.game.audio.playSfxWithVariation(b.plantDef.cutableBranches.cutSFX.preffix,b.plantDef.cutableBranches.cutSFX.variations),p.performAction(s.PlayerAction.CHOP),p.addNewItem(b.plantDef.cutableBranches.itemId,1),{hours:p.getActionTime(s.PlayerAction.CUT)}):null;if(b.plantDef.isTimber){if(b.axe(),b.hp.current<=0){var S=!1;b.plantDef.stumpAfterChop?b.isStump?(f.removePlant(b),S=!1):(f.stumpPlant(b),S=!0):(f.removePlant(b),S=!0),this.game.display.message("You chop down the "+b.plantDef.name+".",null,0,0),b.playFellSFX(),S&&f.addItem(new t(this.game,b.plantDef.chopInto.itemId,c.default.n(1,b.plantDef.chopInto.quantity)),g,_,p.z),u.default.reportEvent("treeFell")}else this.game.display.message("You hit the "+b.plantDef.name+".","Hit",g,_),b.playChopSFX();return p.performAction(s.PlayerAction.CHOP),{hours:p.getActionTime(s.PlayerAction.CHOP)}}return this.game.input.prompt("Do you want to destroy the "+b.plantDef.name+"?",(function(){l.game.display.message("You axe the "+b.plantDef.name+".",null,0,0),b.playFellSFX(),f.removePlant(b),p.performAction(s.PlayerAction.CHOP),p.endTurn(p.getActionTime(s.PlayerAction.CHOP))})),null}return x?x.def.chopable?x.stackedItem?(this.game.display.errorMessage("Can't axe the ".concat(x.def.name," while the ").concat(x.stackedItem.def.name," is on top")),null):this.chopItem(x,f,p,g,_):(this.game.display.errorMessage("Can't axe the ".concat(x.def.name,".")),null):v?v.chopable?this.chopFlooring(v,f,p,g,_):(this.game.display.errorMessage("Can't axe the ".concat(v.name,".")),null):(null==y?void 0:y.tallGrass)?(this.game.display.message("You cut the grass.",null,0,0),y.cutSFX&&this.game.audio.playSfxWithVariation(y.cutSFX.prefix,y.cutSFX.variations),p.performAction(s.PlayerAction.CUT),this.game.world.level.changeTile(g,_,p.z,a.default.get("GRASS")),{hours:p.getActionTime(s.PlayerAction.CUT)}):y.fragile?p.tryAttackTile(g,_,y.breakable.hp):(this.game.display.message("Swooosh!!.","Swooosh!",p.x,p.y),{hours:p.getActionTime(s.PlayerAction.CUT)});case"break":return p.canPerformAction(s.PlayerAction.BREAK)?x?x.def.breakable?x.stackedItem?(this.game.display.errorMessage("Can't break the ".concat(x.def.name," while the ").concat(x.stackedItem.def.name," is on top")),null):this.breakItem(x,f,p,g,_):(this.game.display.errorMessage("Can't break the ".concat(x.def.name,".")),null):v?v.breakable?(f.damageTile(g,_,p.z,v.breakable.hp),f.getTileHP(g,_,p.z).current<=0?(this.game.display.message("You break down the "+v.name+".",null,0,0),this.game.audio.playSfx("rock_break"),f.removeFlooringAt(g,_,p.z),f.removeDamageTile(g,_,p.z),v.breakable.toItem&&(A=c.default.n(1,v.breakable.itemQuantity))&&f.addItem(new t(this.game,v.breakable.toItem,A),g,_,p.z)):(this.game.display.message("You hit the "+v.name+".","Hit",g,_),this.game.audio.playSfx("mine_01,mine_02,mine_03,mine_04")),p.performAction(s.PlayerAction.BREAK),{hours:p.getActionTime(s.PlayerAction.BREAK)}):(this.game.display.errorMessage("Can't break the ".concat(v.name,".")),null):y.breakable?p.tryAttackTile(g,_,y.breakable.hp):(this.game.display.message("Woosh!","Woosh!",p.x,p.y),null):null;case"plant":return this.doPlant(d);case n.ItemEffect.FISH:return this.doFish(d);case"exchange":var w=e.currentItem;if(w)if(w.def.exchange){var A=e.all?w.quantity:1;p.exchange(w.def.exchange,A),p.reduceFromItem(w,A),this.game.display.message("You drop the "+w.def.name+" into the machine.","Drop",g,_),this.game.audio.playSfx("exchange_insert")}else this.game.display.errorMessage("The "+w.def.name+" is rejected by the machine."),this.game.audio.playSfx("exchange_reject");else this.game.display.errorMessage("Nothing to exchange.");return{hours:5/60};case"cook":return this.game.player.tryCook(),null;case"read":return"TAPE"===this.def.noteType?x&&(x.def.effect===n.ItemEffect.VIEW_TAPE||x.stackedItem&&x.stackedItem.def.effect===n.ItemEffect.VIEW_TAPE)?this.game.display.showClue(this):this.game.display.examine(this):this.game.display.showClue(this),null;case n.ItemEffect.CLIMB:return p.climb()?{hours:p.getActionTime(s.PlayerAction.WALK)}:null;case"map":return u.default.reportAction("showMap"),this.game.display.mapPanel.show(this),null;case"row":if(!p.canPerformAction(s.PlayerAction.ROW))return null;var I=f.getItem(p.x,p.y,p.z);return(null==I?void 0:I.def.floating)?!f.isWater(g,_,p.z)||x?(this.game.display.errorMessage("Cannot row there."),null):f.moveItem(p.x,p.y,g,_,p.z)?(this.game.audio.playSfx("raft_01,raft_02,raft_03"),this.game.display.message("You row.",null,0,0),p.forceMoveTo(d,!1,s.PlayerAction.ROW),{hours:p.getActionTime(s.PlayerAction.ROW)}):(this.game.display.errorMessage("Cannot row there."),null):(this.game.display.errorMessage("You need to be on a floating vehicle."),null);case"tryUnlock":return this.def.unlock?p.findItem(this.def.unlock.itemId)?(f.unlock(g,_,p.z),{hours:1/60}):(this.game.display.errorMessage("It's locked."),null):(this.game.display.errorMessage("Nothing to unlock"),null);case"unlock":return x&&x.def.unlock?x.def.unlock.itemId===this.def.id?(f.unlock(g,_,p.z),{hours:1/60}):(this.game.display.errorMessage("The key doesn't match."),null):(this.game.display.errorMessage("Nothing to unlock"),null);case"transform":return this.game.display.message(this.def.transform.message,null,0,0),this.def.transform.sfx&&this.game.audio.playSfx(this.def.transform.sfx),this.id=this.def.transform.itemId,this.def=h.default.get(this.id),f.onItemTransformed(g,_,p.z),f.__updateWalkable(g,_,p.z),{hours:1/60};case n.ItemEffect.ROTATE:return this.tryRotate();case"store":if(this.containedLiquid)return this.containedLiquid.edible?p.isSwimming&&this.game.world.level.isFlooded(p.x,p.y,p.z)?(this.game.display.errorMessage("Cannot ".concat(this.containedLiquid.edible.verb," while submerged.")),null):(this.game.input.prompt("Do you want to ".concat(this.containedLiquid.edible.verb," the ").concat(this.containedLiquid.name,"?"),(function(){p.doDrinkFrom(l),p.endTurn(p.getActionTime(s.PlayerAction.DRINK))})),null):(this.game.display.errorMessage("The ".concat(this.def.name," is already filled with ").concat(this.containedLiquid.name)),null);if((null==y?void 0:y.isWater)||this.game.world.level.isFlooded(p.x,p.y,p.z)){var R=h.default.get("WATER");return A=this.def.containerCapacity,this.containedLiquid===R&&0==(A-=this.containedLiquidQuantity)?(this.game.display.errorMessage("The ".concat(this.def.name," is already filled with ").concat(R.name)),null):this.tryFillWith(R,A)}if(x){var C=(null===(o=x.stackedItem)||void 0===o?void 0:o.containedLiquid)?x.stackedItem:x;return C.containedLiquid?(this.tryFillWith(C.containedLiquid,1)&&C.spendLiquid(1),{hours:1/60}):(this.game.display.errorMessage("Cannot store that."),null)}return this.game.display.errorMessage("Cannot store that."),null;case"storeItem":return this.game.display.examine(this),null}},t.prototype.tryFillWith=function(t,e){if(e=this.def.containerCapacity,this.containedLiquid){if(this.containedLiquid!==t)return this.game.display.errorMessage("There is ".concat(this.containedLiquid.name," already in the ").concat(this.def.name)),null;if(this.containedLiquidQuantity+e>this.def.containerCapacity)return this.game.display.errorMessage("The ".concat(this.def.name," is filled already.")),null}return this.game.player.canPickLiquid(this,t,e)?(this.game.display.message("You fill the ".concat(this.def.name," with ").concat(t.name,"."),"Fill",this.game.player.x,this.game.player.y),u.default.reportItemAcquired(t.id,e),this.containedLiquid=t,this.containedLiquidQuantity=this.def.containerCapacity,{hours:1/60}):(this.game.display.errorMessage("Cannot carry the ".concat(this.def.name," filled with ").concat(t.name)),null)},t.prototype.setLiquid=function(t,e){this.containedLiquid=h.default.get(t),this.containedLiquidQuantity=e,this.containedLiquidQuantity>this.def.containerCapacity&&(this.containedLiquidQuantity=this.def.containerCapacity)},t.prototype.isContainer=function(){return"storeItem"===this.def.effect},t.prototype.containsRecursive=function(t){var e=this.containedItems.find((function(e){return e===t}));if(e)return!0;for(var i=this.containedItems.filter((function(t){return t.isContainer})),r=0;r<i.length;r++)if(i[r].containsRecursive(t))return!0;return!1},t.prototype.canStoreOf=function(t){var e=this.containedItems.find((function(e){return e.def.id===t})),i=p.default.get(t);return!(!e||i.noStack)||this.containedItems.length<=this.def.containerCapacity-1},t.prototype.canStore=function(t){return this.canStoreOf(t.def.id)},t.prototype.addItem=function(t,e){var i=this.containedItems.find((function(e){return e.def.id===t.def.id}));if(i&&!i.def.noStack)i.quantity+=e?1:t.quantity;else if(e&&t.quantity>1){var r=t.clone();r.quantity=1,this.containedItems.push(r)}else this.containedItems.push(t)},t.prototype.removeItem=function(t){var e=this.containedItems.indexOf(t);this.containedItems.splice(e,1)},t.prototype.addLiquid=function(t){!this.containedLiquid||this.containedLiquidQuantity>=this.def.containerCapacity||(this.containedLiquidQuantity+=t,this.containedLiquidQuantity>this.def.containerCapacity&&(this.containedLiquidQuantity=this.def.containerCapacity))},t.prototype.spendLiquid=function(t){!this.containedLiquid||this.containedLiquidQuantity<=0||(this.containedLiquidQuantity-=t,this.containedLiquidQuantity<=0&&(this.containedLiquid=null))},t.prototype.doFeed=function(t){t=t||m;var e=this.game.player,i=this.game.world.level,r=e.x+t.x,n=e.y+t.y;if(0===t.x&&0===t.y)return e.tryEat(this);var a=i.getBeing(r,n,e.z);return e.canPerformAction(s.PlayerAction.FEED)?a?(this.game.display.message("You try to feed the "+a.race.name+" with a "+this.def.name+".",null,0,0),a.tryEat(this)&&(u.default.reportItemAction("foodFed",this.def.id),e.reduceFromItem(this,1)),e.performAction(s.PlayerAction.FEED),{hours:e.getActionTime(s.PlayerAction.FEED)}):(this.game.display.errorMessage("Nothing to feed there."),null):null},t.prototype.doFish=function(t){var e=this.game.player,i=this.game.world.level;if(i.isWater(e.x,e.y,e.z))return this.game.display.errorMessage("Cannot fish from here."),null;var r=e.x+t.x,n=e.y+t.y;return i.getTile(r,n,e.z).isWater?(e.startFishing(),{hours:e.getActionTime(s.PlayerAction.FISH)}):(this.game.display.errorMessage("Cannot fish here."),null)},t.prototype.doPlant=function(t){if(!this.def.plantId)return this.game.display.errorMessage("You can't plant the "+this.def.name+"."),null;t=t||m;var e=this.game.player,i=this.game.world.level,r=e.x+t.x,n=e.y+t.y,a=i.getTile(r,n,e.z),c=i.getPlantAt(r,n,e.z);if(!e.canPerformAction(s.PlayerAction.PLANT))return null;if(c)return this.game.display.errorMessage("There is a "+c.plantDef.name+" planted here already."),null;if(!a.tilled)return this.game.display.errorMessage("You need to till the ground before planting the "+this.def.name+"."),null;if(!i.canWalkTo(r,n,e.z))return this.game.display.errorMessage("You can't plant the ".concat(this.def.name," here.")),null;this.game.display.message("You plant a "+this.def.name+".",null,0,0),u.default.reportItemAction("seedPlanted",this.def.id);var d=o.default.get(this.def.plantId).produce;if(!e.flags.plantedPlant&&d){var p;p=d.isTree?o.default.get(d.id).name:h.default.get(d.id).name,this.game.display.errorMessage("It will take some time for the "+this.def.name+" to become a "+p+".",!0),e.flags.plantedPlant=!0}this.game.audio.playSfx("plant_01,plant_02");var f=new l.default(this.game,o.default.get(this.def.plantId),0);return f.isGrownByPlayer=!0,i.addPlant(r,n,e.z,f),e.reduceFromItem(this,1),e.performAction(s.PlayerAction.PLANT),{hours:e.getActionTime(s.PlayerAction.PLANT)}},t.prototype.getInventoryDescription=function(){return d.default.isMobile()?this.containedLiquid?"x".concat(this.containedLiquidQuantity):this.quantity>1?"x"+this.quantity:"":this.containedLiquid?"".concat(this.containedLiquid.name," x").concat(this.containedLiquidQuantity):this.def.name+(this.quantity>1?" x"+this.quantity:"")},t.prototype.getExamineDescription=function(){var t="";return this.quantity>1?t+="".concat(this.quantity," ").concat(this.def.name):t+="A "+this.def.name,this.containedLiquid?t+=" containing ".concat(this.containedLiquidQuantity," ").concat(this.containedLiquid.name,". ")+"".concat(this.containedLiquid.description):this.def.description&&(t+=". ".concat(this.def.description)),t+"."},t.prototype.chopFlooring=function(e,i,r,n,a){if(i.damageTile(n,a,r.z,e.chopable.hp),i.getTileHP(n,a,r.z).current<=0){if(this.game.display.message("You axe down the "+e.name+".",null,0,0),e.chopable.chopSfx&&this.game.audio.playSfx(e.chopable.chopSfx),i.removeFlooringAt(n,a,r.z),i.removeDamageTile(n,a,r.z),e.chopable.toItem){var o=c.default.n(1,e.chopable.itemQuantity);o&&i.addItem(new t(this.game,e.chopable.toItem,o),n,a,r.z)}}else this.game.display.message("You hit the "+e.name+".","Hit!",n,a),this.game.audio.playSfx("chop_01,chop_02,chop_03,chop_04");return r.performAction(s.PlayerAction.CHOP),{hours:r.getActionTime(s.PlayerAction.CHOP)}},t.prototype.chopItem=function(e,i,r,n,a){if(i.damageTile(n,a,r.z,e.def.chopable.hp),i.getTileHP(n,a,r.z).current<=0){if(this.game.display.message("You axe down the ".concat(e.def.name,"."),null,0,0),e.def.chopable.chopSfx&&this.game.audio.playSfx(e.def.chopable.chopSfx),u.default.reportItemAction("chop",e.def.id),i.removeItem(n,a,r.z),i.removeDamageTile(n,a,r.z),e.def.isWaypoint){var o=i.getWaypoint(n,a,r.z);o.destroyable&&(i.removeWaypoint(n,a,r.z),r.removeWaypoint(o))}if(e.def.chopable.toItem){var l=c.default.n(1,e.def.chopable.itemQuantity);l&&i.addItem(new t(this.game,e.def.chopable.toItem,l),n,a,r.z)}}else this.game.display.message("You hit the "+e.def.name+".","Hit!",n,a),this.game.audio.playSfx("chop_01,chop_02,chop_03,chop_04");return r.performAction(s.PlayerAction.CHOP),{hours:r.getActionTime(s.PlayerAction.CHOP)}},t.prototype.breakItem=function(e,i,r,n,a){if(i.damageTile(n,a,r.z,e.def.breakable.hp),i.getTileHP(n,a,r.z).current<=0){if(this.game.display.message("You break down the "+e.def.name+".",null,0,0),e.def.breakable.breakSfx&&this.game.audio.playSfx(e.def.breakable.breakSfx),u.default.reportItemAction("break",e.def.id),i.removeItem(n,a,r.z),i.removeDamageTile(n,a,r.z),e.def.breakable.toItem){var o=c.default.n(1,e.def.breakable.itemQuantity);o&&i.addItem(new t(this.game,e.def.breakable.toItem,o),n,a,r.z)}}else this.game.display.message("You hit the "+e.def.name+".","Hit!",n,a),this.game.audio.playSfx("mine_01,mine_02,mine_03,mine_04");return r.performAction(s.PlayerAction.BREAK),{hours:r.getActionTime(s.PlayerAction.BREAK)}},t.prototype.canContainLiquid=function(t,e){var i;return this.def.containerCapacity&&(!this.containedLiquid||this.containedLiquid===t)&&(null!==(i=this.containedLiquidQuantity)&&void 0!==i?i:0)+e<=this.def.containerCapacity},t.prototype.getWeight=function(){var t=this.def.weight*this.quantity;return this.containedLiquid?t+this.containedLiquid.weight*this.containedLiquidQuantity:this.isContainer()?t+this.containedItems.reduce((function(t,e){return t+e.getWeight()}),0):t},t.prototype.getMenuAppearance=function(){var t,e;return this.containedLiquid?r.default.exists("".concat(this.def.id,"+").concat(this.containedLiquid.id))?r.default.get("".concat(this.def.id,"+").concat(this.containedLiquid.id)):null!==(t=this.def.menuAppearance)&&void 0!==t?t:this.def.app:null!==(e=this.def.menuAppearance)&&void 0!==e?e:this.def.app},t.prototype.getWorldAppearance=function(){return this.isUnharvestedCrop?this.def.cropApp:this.containedLiquid?r.default.exists("".concat(this.def.id,"+").concat(this.containedLiquid.id))?r.default.get("".concat(this.def.id,"+").concat(this.containedLiquid.id)):this.def.app:this.rotation?r.default.rotated(this.def.app,this.rotation):this.def.app},t}();e.default=g,f.registerClass("Item",g,{transients:{def:!0,iconAppearance:!0,containedLiquid:!0},reviver:function(t){t.def=h.default.get(t.id),t.__serialData.containedLiquidId&&(t.containedLiquid=h.default.get(t.__serialData.containedLiquidId))},prepare:function(t){var e;return{containedLiquidId:null===(e=t.containedLiquid)||void 0===e?void 0:e.id}}})},7926:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.ItemEffect=void 0,(i=e.ItemEffect||(e.ItemEffect={})).MAP="map",i.TILL="till",i.DIG="dig",i.SLEEP="sleep",i.PAINT="paint",i.KILL="kill",i.LEASH="leash",i.CHOP="chop",i.CUT="cut",i.BREAK="break",i.PLANT="plant",i.EXCHANGE="exchange",i.COOK="cook",i.READ="read",i.ROW="row",i.TRY_UNLOCK="tryUnlock",i.UNLOCK="unlock",i.TRANSFORM="transform",i.STORE="store",i.STORE_ITEM="storeItem",i.VIEW_TAPE="viewTape",i.FISH="fish",i.CLIMB="climb",i.ROTATE="rotate"},8059:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WorldObjectType=void 0;var r,n=i(4369),s=i(3174),a=i(6041),o=i(6373),l=i(4095),h=i(2062),u=i(5850),c=i(771),d=i(3451),p=i(6028),f=i(4775),m=i(3085),g=i(5946),_=i(771),y=i(4738),v=i(6786),x=i(1518),b=i(8359),E=i(7409),T=i(8018),S=i(9657),w=i(8134);(r=e.WorldObjectType||(e.WorldObjectType={}))[r.BEING=0]="BEING",r[r.TILE=1]="TILE",r[r.FLOORING=2]="FLOORING",r[r.PLANT=3]="PLANT",r[r.ITEM=4]="ITEM";var A={FOREST_FLOOR:"SNOW",TALL_GRASS:"SNOW",GRASS:"SNOW",WATER:"FROZEN_WATER",DEEP_WATER:"FROZEN_DEEP_WATER",PUDDLE:"FROZEN_PUDDLE",CHANNEL:"FROZEN_CHANNEL"},I=function(){function t(t,e){this.coldCaveChannels=[],0!=arguments.length&&(this.init(t,e),this._c=T.register("Level"))}return t.prototype.init=function(t,e){this.pfGrids=new Array(1),this.skylightMap=new Array(1),this.lightsMap=new Map,this.lightsIntensityMap=new Map,this.map=new Array(0),this.sectorsMap=new Array(0),this.beings=new Map,this.beingsList=[],this.waypoints=new Map,this.buildingsList=[],this.exits=[],this.items=new Map,this.paintMask=new Map,this.miningMask=new Map,this.currentsMask=new Map,this.dryMap=new Map,this.flooring=new Map,this.plants=new Map,this.plantsList=[],this.damagedTiles=new Map,this.game=t,this.id=e,this.player=t.player},t.prototype.key=function(t,e,i){return"".concat(t,"-").concat(e,"-").concat(i)},t.prototype.isLitByLight=function(t,e,i){return!!this.lightsIntensityMap.get(this.key(t,e,i))},t.prototype.setFlooring=function(t,e,i,r){var n=r.opaque&&this.isLitByLight(t,e,i);this.flooring.set(this.key(t,e,i),r),this.__updateWalkable(t,e,i),n&&this.updateLightingAt(t,e,i,!0)},t.prototype.getFlooringAt=function(t,e,i){return this.flooring.get(this.key(t,e,i))},t.prototype.mustRecalcLight=function(t,e,i){return this.isOpaque(t,e,i)&&!!this.lightsIntensityMap.get(this.key(t,e,i))},t.prototype.removeFlooringAt=function(t,e,i){var r=this.mustRecalcLight(t,e,i);this.flooring.delete(this.key(t,e,i)),this.__updateWalkable(t,e,i),r&&this.updateLightingAt(t,e,i,!1)},t.prototype.paintOver=function(t,e,i,r){this.paintMask.set(this.key(t,e,i),r.def.paintColor);var n=this.getTile(t,e,i),s=this.getFlooringAt(t,e,i);s?this.game.display.message("You paint the "+s.name+" "+r.def.colorName+".","Paint",t,e):this.game.display.message("You paint the "+n.name+" "+r.def.colorName+".","Paint",t,e)},t.prototype.getPaintColor=function(t,e,i){return this.paintMask.get(this.key(t,e,i))},t.prototype.addPlant=function(t,e,i,r){r.x=t,r.y=e,r.z=i;var n=this.plants.get(this.key(t,e,i));n&&this.removePlant(n);var s=r.plantDef.opaque&&this.isLitByLight(t,e,i);this.plantsList.push(r),this.plants.set(this.key(t,e,i),r),r.onAfterPlaced(),this.__updateWalkable(t,e,i),s&&this.updateLightingAt(t,e,i,!0)},t.prototype.getPlantAt=function(t,e,i){return this.plants.get(this.key(t,e,i))},t.prototype.removePlant=function(t){var e=this.mustRecalcLight(t.x,t.y,t.z);this.plantsList.splice(this.plantsList.indexOf(t),1),this.plants.delete(this.key(t.x,t.y,t.z)),this.__updateWalkable(t.x,t.y,t.z),e&&this.updateLightingAt(t.x,t.y,t.z,!1)},t.prototype.stumpPlant=function(t){var e=this.mustRecalcLight(t.x,t.y,t.z);t.hp.setMax(50),t.hp.recoverAll(),t.isStump=!0,e&&this.updateLightingAt(t.x,t.y,t.z,!1)},t.prototype.changeTileQuick=function(t,e,i,r){this.map[i][t][e]=r},t.prototype.connectedToWater=function(t,e,i){return this.isValidPosition(t-1,e,i)&&this.map[i][t-1][e].isWater||this.isValidPosition(t+1,e,i)&&this.map[i][t+1][e].isWater||this.isValidPosition(t,e-1,i)&&this.map[i][t][e-1].isWater||this.isValidPosition(t,e+1,i)&&this.map[i][t][e+1].isWater},t.prototype.destroyTile=function(t,e,i){this.connectedToWater(t,e,i)?this.floodShallow(t,e,i):this.changeTile(t,e,i,a.default.get("HOLE"))},t.prototype.floodShallow=function(t,e,i){var r,n,s,o;this.changeTile(t,e,i,a.default.get("CHANNEL")),"HOLE"===(null===(r=this.getTile(t-1,e,i))||void 0===r?void 0:r.id)&&this.floodShallow(t-1,e,i),"HOLE"===(null===(n=this.getTile(t+1,e,i))||void 0===n?void 0:n.id)&&this.floodShallow(t+1,e,i),"HOLE"===(null===(s=this.getTile(t,e+1,i))||void 0===s?void 0:s.id)&&this.floodShallow(t,e+1,i),"HOLE"===(null===(o=this.getTile(t,e-1,i))||void 0===o?void 0:o.id)&&this.floodShallow(t,e-1,i)},t.prototype.drain=function(t,e,i){this.dryMap.set(this.key(t,e,i),!0)},t.prototype.changeTile=function(t,e,i,r){var n=this.isLitByLight(t,e,i);this.map[i][t][e]=r,this.__updateWalkable(t,e,i),n&&this.updateLightingAt(t,e,i,!0)},t.prototype.beingsTurn=function(){for(var t=0;t<this.beingsList.length;t++)this.beingsList[t].act(),this.beingsList[t].update();this.player.updateFOV(),this.game.display.refresh()},t.prototype.addBuildingInfo=function(t,e,i){this.buildingsList.push(new u.Building(t,e,i))},t.prototype.getBuildings=function(){return this.buildingsList},t.prototype.getWaypoint=function(t,e,i){return this.waypoints.get(this.key(t,e,i))},t.prototype.addWaypoint=function(t,e,i,r,n){this.waypoints.set(this.key(e,i,r),{_c:T.setSafe(),description:t,destroyable:n,discovered:!1,x:e,y:i})},t.prototype.removeWaypoint=function(t,e,i){this.waypoints.delete(this.key(t,e,i))},t.prototype.checkWaypoint=function(t,e,i){var r=this.waypoints.get(this.key(t,e,i));r&&!r.discovered&&(r.discovered=!0,this.player.addWaypoint(r))},t.prototype.getStackedItem=function(t,e,i){var r=this.getItem(t,e,i);return r?r.stackedItem:null},t.prototype.getBeing=function(t,e,i){return this.beings.get(this.key(t,e,i))},t.prototype.moveBeing=function(t,e,i,r,n){var s=this.key(t,e,i),a=this.beings.get(s);this.beings.delete(s),this.beings.set(this.key(t+r,e+n,i),a),this.__updateWalkable(t,e,i),this.__updateWalkable(t+r,e+n,i)},t.prototype.addBeing=function(t,e,i,r){this.beingsList.push(t),t.x=e,t.y=i,t.z=r,this.beings.set(this.key(e,i,r),t),this.__updateWalkable(e,i,r)},t.prototype.removeBeing=function(t){this.beingsList.splice(this.beingsList.indexOf(t),1),this.beings.delete(this.key(t.x,t.y,t.z)),this.__updateWalkable(t.x,t.y,t.z)},t.prototype.isSolidChain=function(t,e,i){try{if(this.map[i][t][e].solid)return!0}catch(t){return!0}var r=this.getFlooringAt(t,e,i);if(r&&(r.solid||r.solidChain))return!0;var n=this.getItem(t,e,i);return!(!n||!n.def.solid&&!n.def.solidChain||!n.def.fixed)},t.prototype.sticksToFence=function(t,e,i){try{if(this.map[i][t][e].solid)return!0}catch(t){return!0}var r=this.getFlooringAt(t,e,i);if(r&&(r.solid||r.solidChain))return!0;var n=this.getItem(t,e,i);return!(!n||!n.def.sticksToFence)},t.prototype.canHoistItemOn=function(t,e,i,r,n){if(e<r)return!1;if(!this.isValidPosition(i,r,n)||this.beings.has(this.key(i,r,n))||this.player&&this.player.x===i&&this.player.y===r&&this.player.z===n||this.getItem(i,r,n)||this.map[n][i][r].isWater)return!1;var s=this.getFlooringAt(i,r,n),a=this.getPlantAt(i,r,n);if(!this.map[n][i][r].solid&&!(null==s?void 0:s.solid)&&!(null==a?void 0:a.isSolid()))return!1;var o=this.getFlooringAt(i,r+1,n),l=this.getTile(i,r+1,n);return!((l&&l.solid||o&&o.solid)&&(!s||-1===s.id.indexOf("WINDOW")))},t.prototype.canWalkTo=function(t,e,i,r){try{if(this.map[i][t][e].solid)return!1}catch(t){return!1}var n=this.getFlooringAt(t,e,i);if(n&&n.solid)return!1;if(this.beings.has(this.key(t,e,i)))return!1;if(this.player&&this.player.x===t&&this.player.y===e&&this.player.z===i)return!1;var s=this.getItem(t,e,i);if(s&&s.def.solid&&this.player.grabbedObject!==s)return!1;if(this.map[i][t][e].isWater&&!r)if(s){if(!s.def.floating)return!1}else if(!n||!n.bridge)return!1;var a=this.getPlantAt(t,e,i);return!(null==a?void 0:a.isSolid())},t.prototype.enclosesSpace=function(t,e,i,r){if(this.map[i][t][e].solid)return!0;var n=this.getFlooringAt(t,e,i);if(n&&(r?n.enclosesSpace:n.solid))return!0;var s=this.getItem(t,e,i);return!(!s||!(r?s.def.enclosesSpace:s.def.solid))},t.prototype.addExit=function(t,e,i,r){this.map[t]||(this.map[t]=[]),this.map[t][e]=r,this.exits[t]||(this.exits[t]=[]),this.exits[t][e]=i},t.prototype.stackItem=function(t,e,i,r,n){var s=this.getItem(i,r,n);if(s){if(s.def!==t.def||t.def.noStack)return!1;s.quantity+=e}else{var a=t.clone();a.quantity=e,this.addItem(a,i,r,n)}return!0},t.prototype.addItemProcgen=function(t,e,i,r){this.items.set(this.key(e,i,r),t),this.__updateWalkable(e,i,r)},t.prototype.addItem=function(t,e,i,r){var n=t.def.opaque&&this.isLitByLight(e,i,r);this.items.set(this.key(e,i,r),t),t.def.lightSource&&this.raycastLightRangeAt(e,i,r,t.def.lightSource.color,t.def.lightSource.range,t.def.lightSource.intensity),this.__updateWalkable(e,i,r),n&&this.updateLightingAt(e,i,r,!0)},t.prototype.getItem=function(t,e,i){return this.items.get(this.key(t,e,i))},t.prototype.moveItem=function(t,e,i,r,n){var s=this.getItem(t,e,n),a=this.getItem(i,r,n);return!(!s||a||(this.removeItem(t,e,n),this.addItem(s,i,r,n),0))},t.prototype.removeItem=function(t,e,i){var r=this.mustRecalcLight(t,e,i),n=this.getItem(t,e,i);this.items.delete(this.key(t,e,i)),(null==n?void 0:n.def.lightSource)?(this.setLightRangeAt(t,e,i,0,n.def.lightSource.range,0),this.updateLightingAt(t,e,i,!0)):r&&this.updateLightingAt(t,e,i,!1),this.__updateWalkable(t,e,i)},t.prototype.getLooseItemAt=function(t,e,i){var r=this.getItem(t,e,i);return r&&!r.def.fixed?{item:r,x:t,y:e}:null},t.prototype.getLooseItemsAround=function(t,e,i){var r=[],n=null;return(n=this.getLooseItemAt(t-1,e-1,i))&&r.push(n),(n=this.getLooseItemAt(t-0,e-1,i))&&r.push(n),(n=this.getLooseItemAt(t+1,e-1,i))&&r.push(n),(n=this.getLooseItemAt(t-1,e-0,i))&&r.push(n),(n=this.getLooseItemAt(t+1,e-0,i))&&r.push(n),(n=this.getLooseItemAt(t-1,e+1,i))&&r.push(n),(n=this.getLooseItemAt(t-0,e+1,i))&&r.push(n),(n=this.getLooseItemAt(t+1,e+1,i))&&r.push(n),r},t.prototype.growPlants=function(t){this.plantsList.forEach((function(e){return e.grow(t)}))},t.prototype.damageTile=function(t,e,i,r){var n=this.damagedTiles.get(this.key(t,e,i));n||(n={hp:new s.default(y.default.n(Math.max(1,r-2),r))},this.damagedTiles.set(this.key(t,e,i),n)),n.hp.spend(1)},t.prototype.isValidPosition=function(t,e,i){return t>=0&&t<512&&e>=0&&e<512&&i>=0&&i<this.map.length},t.prototype.getTile=function(t,e,i){if(this.isValidPosition(t,e,i))return this.map[i][t][e]},t.prototype.getTileDescription=function(t,e,i){var r,n=this.getCurrent(t,e,i);return(null===(r=this.getTile(t,e,i))||void 0===r?void 0:r.name)+(n?" flowing ".concat(_.default.getCardinalDirectionName(n)):"")},t.prototype.getTileDebugDescription=function(t,e,i){return"Sector Type: "+this.getSector(t,e,i).type+" Skylight "+this.skylightMap[0][t][e]+" Mountain "+this.mountainMap[t][e]},t.prototype.getTileHP=function(t,e,i){return this.damagedTiles.get(this.key(t,e,i)).hp},t.prototype.removeDamageTile=function(t,e,i){this.damagedTiles.delete(this.key(t,e,i))},t.prototype.getARace=function(t,e,i){var r=Math.floor(t/64),n=Math.floor(e/64),s=this.habitats[r][n],a=s.filter((function(t){return i?"Fish"==t.type:"Fish"!=t.type}));return h.default.log("Eligible races for sector ".concat(r,",").concat(n," are ").concat(s.map((function(t){return t.id})))),y.default.from(a)},t.prototype.canPlaceAnimalAt=function(t,e,i){return!(!this.isValidPosition(t,e,i)||this.isWater(t,e,i)||!this.canWalkTo(t,e,i)||this.getPlantAt(t,e,i)||this.isUnderMountain(t,e,i)||this.isClosedPlace(t,e,i,!1))},t.prototype.tryAddAnimalAt=function(t,e,i,r){if(r&&!this.canPlaceAnimalAt(t,e,i))return!1;var n=this.isFlooded(t,e,i),s=this.getARace(t,e,n);return!!s&&(this.addBeing(new l.default(this.game,this,s.id),t,e,i),h.default.log("I added a ".concat(s.id," at (").concat(t-this.player.x,",").concat(e-this.player.y,")")),!0)},t.prototype.isLake=function(t,e,i){return this.sectorsMap[i][t][e].type===g.SectorType.lake||this.sectorsMap[i][t][e].type===g.SectorType.caveLake},t.prototype.getSector=function(t,e,i){return this.sectorsMap[i][t][e]},t.prototype.isColdSector=function(t,e,i){switch(this.sectorsMap[i][t][e].type){case g.SectorType.coldCave:case g.SectorType.caveLake:case g.SectorType.caveRiver:case g.SectorType.coldMountainBorder:return!0}return!1},t.prototype.isCaveSector=function(t,e,i){switch(this.sectorsMap[i][t][e].type){case g.SectorType.cavern:case g.SectorType.coldCave:case g.SectorType.caveLake:case g.SectorType.caveRiver:case g.SectorType.mountainFrame:case g.SectorType.mountainBorder:case g.SectorType.coldMountainBorder:return!0}return!1},t.prototype.isGroundTile=function(t,e,i){return this.map[i][t][e].isGround},t.prototype.scatterRaces=function(){var t=new w(13312);this.habitats=[];for(var e=0;e<8;e++){this.habitats[e]=[];for(var i=0;i<8;i++)this.habitats[e][i]=[]}var r=function(e){var i=t.range(0,8),r=t.range(0,8);this.habitats[i][r].push(e)}.bind(this);function n(t,e,i){for(var n=t.filter((function(t){return t.rarity===e})),s=0;s<i;s++)n.forEach((function(t){return r(t)}))}var s=p.default.all();n(s,"rarest",1),n(s,"rare",10),n(s,"common",32),n(s,"vermin",64)},t.prototype.printHabitatsMap=function(){h.default.log("Habitats");for(var t=0;t<this.habitats[0].length;t++)for(var e=0;e<this.habitats.length;e++)h.default.log(this.habitats[t][e].map((function(t){return t.id})))},t.prototype.getCropPlantAt=function(t,e,i){var r=this.getPlantAt(t,e,i);return!(!r||r.plantDef.isTimber)&&r},t.prototype.isClosedPlace=function(t,e,i,r){var n=this,s=d.default.getAreaSize(t,e,(function(t,e){return n.isValidPosition(t,e,i)&&n.enclosesSpace(t,e,i,r)}),999);return s<999},t.prototype.pathExists=function(t,e,i,r,n){return!!this.findNextStep(t,e,i,r,n)},t.prototype.findNextStep=function(t,e,i,r,n){var s=this.pfGrids[n].clone(),a=new S.AStarFinder({allowDiagonal:!0,dontCrossCorners:!1}).findPath(t,e,i,r,s);return 0!=a.length&&{dx:Math.sign(a[1][0]-t),dy:Math.sign(a[1][1]-e)}},t.prototype.onItemTransformed=function(t,e,i){this.isLitByLight(t,e,i)&&this.updateLightingAt(t,e,i,!0)},t.prototype.__updateWalkable=function(t,e,i){var r=this.canWalkTo(t,e,i);this.pfGrids[i].setWalkableAt(t,e,r)},t.prototype.initPathfindingGrid=function(t){this.pfGrids[t]=new S.Grid(512,512)},t.prototype.updatePathfindingGrids=function(){for(var t=0;t<this.map.length;t++){this.pfGrids[t]=new S.Grid(512,512);for(var e=0;e<512;e++)for(var i=0;i<512;i++)this.__updateWalkable(e,i,t)}},t.prototype.__isPFWalkable=function(t,e,i){return this.pfGrids[i].isWalkableAt(t,e)},t.prototype.isFullWater=function(t,e,i){var r;return this.isWater(t,e,i)&&!(null===(r=this.getTile(t,e,i))||void 0===r?void 0:r.isHalfWater)},t.prototype.isWater=function(t,e,i){var r,n;return!!this.isValidPosition(t,e,i)&&!(null===(r=this.getFlooringAt(t,e,i))||void 0===r?void 0:r.bridge)&&!(null===(n=this.getItem(t,e,i))||void 0===n?void 0:n.def.floating)&&this.map[i][t][e].isWater},t.prototype.getFreeSpotAround=function(t,e,i){var r=this;return c.DIRECTIONS.find((function(n){return r.canWalkTo(t+n.x,e+n.y,i)}))},t.prototype.getCurrent=function(t,e,i){return this.currentsMask.get(this.key(t,e,i))},t.prototype.setCurrents=function(t,e){for(var i=0;i<512;i++)for(var r=0;r<512;r++)t[i][r]&&this.getTile(i,r,e).isWater&&this.setCurrent(i,r,e,t[i][r])},t.prototype.setCurrent=function(t,e,i,r){this.currentsMask.set(this.key(t,e,i),r),this.changeTileQuick(t,e,i,a.default.get("RAPID_WATER"))},t.prototype.popDigReward=function(t,e,i,r){if(!this.miningMask.get(this.key(t,e,i))){if(this.canWalkTo(t,e,i)){var s=f.default.get(r);this.addItem(new n.default(this.game,r,y.default.n(3,6)),t,e,i),this.game.display.message("You dig up some ".concat(s.name,"."),"Dig",t,e)}else this.game.display.message("You dig nothing.","Nothing",t,e);this.miningMask.set(this.key(t,e,i),!0)}},t.prototype.hasTallGrass=function(t,e,i){return this.getTile(t,e,i).tallGrass},t.prototype.chopTallGrass=function(t,e,i){this.hasTallGrass(t,e,i)&&this.changeTile(t,e,i,a.default.get("GRASS"))},t.prototype.getWidth=function(){return this.map[0].length},t.prototype.getHeight=function(){return this.map[0][0].length},t.prototype.setSectorsMap=function(t,e){this.sectorsMap[e]=t},t.prototype.setTileMap=function(t,e){this.map[e]=t},t.prototype.unlock=function(t,e,i){var r=this.getItem(t,e,i);this.game.display.message(r.def.unlock.message,null,0,0),r.id=r.def.unlock.transform,r.def=f.default.get(r.id),this.__updateWalkable(t,e,i)},t.prototype.getLightColor=function(t,e,i){var r,n;if(!this.isValidPosition(t,e,i))return 0;var s=this.game.world.sky.getSkylightPower()/10*this.skylightMap[0][t][e];if(this.isFlooded(t,e,i))return this.isFullWater(t,e,i-1)?2662340:2645188;var a=!1;1==i&&(s=0,a=!0);var o=null!==(r=this.lightsIntensityMap.get(this.key(t,e,i)))&&void 0!==r?r:0,l=this.player.lightsIntensityMap[t-this.player.x]&&null!==(n=this.player.lightsIntensityMap[t-this.player.x][e-this.player.y])&&void 0!==n?n:0;return s+o+l===0?a?2631720:0:s>=o&&s>=l?this.game.world.sky.getSkyColor():o>=l?this.lightsMap.get(this.key(t,e,i)):this.player.lightsMap[t-this.player.x][e-this.player.y]},t.prototype.isOpaque=function(t,e,i){if(this.getTile(t,e,i).opaque)return!0;var r=this.getFlooringAt(t,e,i);if(r&&r.opaque)return!0;var n=this.getItem(t,e,i);if(n&&n.def.opaque)return!0;var s=this.getPlantAt(t,e,i);return!(!(s&&s.finalStage&&s.plantDef.opaque)||s.isStump)},t.prototype.getDistanceToNearestDaylightSource=function(t,e,i,r){var n=2*Math.PI/8,s=r;t:for(var a=0;a<2*Math.PI;a+=n){var o=Math.cos(a)*n,l=-Math.sin(a)*n,h=t,u=e,c=1;h+=o,u+=l;e:for(var d=1;d<s;++d){var p=Math.round(h),f=Math.round(u);try{if(this.isOpaque(p,f,i))continue t;if(!this.isUnderMountain(p,f,i))break e}catch(t){break e}c++,h+=o,u+=l}if(c<s&&(s=c),1==s)break}return s},t.prototype.isUnderMountain=function(t,e,i){return 0===i&&this.mountainMap[t][e]},t.prototype.isFlooded=function(t,e,i){return 1===i&&!this.dryMap.get(this.key(t,e,i))},t.prototype.calculateMountainMaps=function(){this.mountainMap=[];for(var t=0;t<this.getWidth();t++){this.mountainMap[t]=[];for(var e=0;e<this.getHeight();e++){var i=this.getTile(t,e,0);this.mountainMap[t][e]=i.isUnderMountain||this.isCaveSector(t,e,0)}}},t.prototype.recalculateSkylightMap=function(){this.skylightMap[0]=new Array(512);for(var t=0;t<this.getWidth();t++){this.skylightMap[0][t]=new Array(512);for(var e=0;e<this.getHeight();e++)if(this.isUnderMountain(t,e,0)){var i=this.getDistanceToNearestDaylightSource(t,e,0,10);this.skylightMap[0][t][e]=i>=5?0:1-i/5}else this.skylightMap[0][t][e]=1}},t.prototype.recalculateLightMaps=function(){this.lightsMap.clear(),this.lightsIntensityMap.clear(),this.recalculateSkylightMap();for(var t=0;t<this.map.length;t++)for(var e=0;e<this.getWidth();e++)for(var i=0;i<this.getHeight();i++){var r=this.getItem(e,i,t);r&&r.def.lightSource&&this.raycastLightRangeAt(e,i,t,r.def.lightSource.color,r.def.lightSource.range,r.def.lightSource.intensity)}},t.prototype.setLightRangeAt=function(t,e,i,r,n,s){var a=this;m.default[n].forEach((function(o,l){for(var h=0;h<o.length;h++)"x"===o.charAt(h)&&a.setLightAt(t+h-n,e+l-n,i,r,s)}))},t.prototype.raycastLightRangeAt=function(t,e,i,r,n,s){for(var a=2*Math.PI/1080,o=0;o<2*Math.PI;o+=a)this.shootRay(t,e,i,o,r,n,s)},t.prototype.shootRay=function(t,e,i,r,n,s,a){var o=.3333,l=s;l/=o;for(var h=Math.cos(r)*o,u=-Math.sin(r)*o,c=t,d=e,p=0;p<l;++p){var f=Math.round(c),m=Math.round(d);if(!this.isValidPosition(f,m,i))return;if(this.setLightAt(f,m,i,n,a),this.isOpaque(f,m,i))return;c+=h,d+=u}},t.prototype.updateLightingAt=function(t,e,i,r){for(var n=-10;n<=10;n++)for(var s=-10;s<=10;s++){var a=this.getItem(t+n,e+s,i);a&&a.def.lightSource&&(r&&this.setLightRangeAt(t+n,e+s,i,0,a.def.lightSource.range,0),this.raycastLightRangeAt(t+n,e+s,i,a.def.lightSource.color,a.def.lightSource.range,a.def.lightSource.intensity))}},t.prototype.setLightAt=function(t,e,i,r,n){this.lightsMap.set(this.key(t,e,i),r),this.lightsIntensityMap.set(this.key(t,e,i),n)},t.prototype.revive=function(){var t=this;E.fillLevelToRevive(this);var e=this.__serialData.cellIds,i=this.__serialData.habitatRaceIds,r=this.__serialData.flooring,n=this.__serialData.waypoints,o=this.__serialData.paintMask,l=this.__serialData.damagedTiles,h=this.__serialData.miningMask,u=this.__serialData.currentsMask,c=this.__serialData.dryMap,d=this.serializedItemsDictionary;delete this.serializedItemsDictionary,this.map=[];for(var m=0;m<e.length;m++){this.map[m]=[];for(var g=0;g<e[m].length;g++)this.map[m][g]=e[m][g].map((function(t){return a.default.get(t)}))}for(this.habitats=[],g=0;g<i.length;g++)this.habitats[g]=i[g].map((function(t){if(t)return t.map((function(t){return p.default.get(t)}))}));this.beings=new Map,this.beingsList.forEach((function(e){t.beings.set(t.key(e.x,e.y,e.z),e)})),this.plants=new Map,this.plantsList.forEach((function(e){return t.plants.set(t.key(e.x,e.y,e.z),e)})),this.flooring=new Map,Object.keys(r).forEach((function(e){return t.flooring.set(e,f.default.get(r[e]))})),this.waypoints=new Map,Object.keys(n).forEach((function(e){return t.waypoints.set(e,n[e])})),this.paintMask=new Map,Object.keys(o).forEach((function(e){return t.paintMask.set(e,o[e])})),this.damagedTiles=new Map,Object.keys(l).forEach((function(e){var i=l[e].hp,r=new s.default(i.max);r.current=i.current,r.penalty=i.penalty,t.damagedTiles.set(e,{hp:r})})),this.miningMask=new Map,Object.keys(h).forEach((function(e){return t.miningMask.set(e,h[e])})),this.items=this.fromDictionary(d),this.currentsMask=this.fromDictionary(u),this.dryMap=this.fromDictionary(c),this.pfGrids=new Array(1),this.skylightMap=new Array(1),this.lightsMap=new Map,this.lightsIntensityMap=new Map,this.recalculateLightMaps()},t.prototype.prepareCircularData=function(){this.serializedItemsDictionary=this.toFullDictionary(this.items),this.serializedItemsDictionary._c=T.register("Level.serializedItemsDictionary")},t.prototype.prepare=function(){for(var t=[],e=0;e<this.map.length;e++){t[e]=[];for(var i=0;i<this.map[e].length;i++)t[e][i]=this.map[e][i].map((function(t){return t.id}))}var r=[];for(i=0;i<this.habitats.length;i++)r[i]=this.habitats[i].map((function(t){if(t)return t.map((function(t){return t.id}))}));return{cellIds:t,habitatRaceIds:r,flooring:this.toIdDictionary(this.flooring),waypoints:this.toFullDictionary(this.waypoints),paintMask:this.toFullDictionary(this.paintMask),damagedTiles:this.toFullDictionary(this.damagedTiles),miningMask:this.toFullDictionary(this.miningMask),currentsMask:this.toFullDictionary(this.currentsMask),dryMap:this.toFullDictionary(this.dryMap)}},t.prototype.toIdDictionary=function(t){for(var e={},i=0,r=Array.from(t.keys());i<r.length;i++){var n=r[i];e[n]=t.get(n).id}return e},t.prototype.toFullDictionary=function(t){for(var e={},i=0,r=Array.from(t.keys());i<r.length;i++){var n=r[i];e[n]=t.get(n)}return e},t.prototype.fromDictionary=function(t){var e=new Map;return Object.keys(t).forEach((function(i){return e.set(i,t[i])})),e},t.prototype.placeFlowersByDay=function(t){for(var e=0;e<this.map.length;e++)for(var i=0;i<this.getWidth();i++)for(var r=0;r<this.getHeight();r++)if((!t||!this.player.canSee(i-this.player.x,r-this.player.y))&&this.sectorsMap[e][i][r].type===g.SectorType.grassland&&"TALL_GRASS"===this.getTile(i,r,e).id&&this.canWalkTo(i,r,e)&&!this.getFlooringAt(i,r,e)&&!this.getPlantAt(i,r,e)&&y.default.chance(this.getChanceOfFlower(i,r,e))){var n=v.default.getAFlower(this.game.world.season);if(!n)continue;this.addPlant(i,r,e,new o.default(this.game,n,-1))}},t.prototype.getChanceOfFlower=function(t,e,i){switch(this.game.world.season){case x.Season.FALL:return.5;case x.Season.MUTALITE:return 0;case x.Season.SPRING:return 3;case x.Season.SUMMER:return 1;case x.Season.WINTER:return 0}},t.prototype.winterNight=function(){this.map[0]=(0,b.default)(this.map[0])},t.prototype.winterize=function(){for(var t=0;t<this.map.length;t++)for(var e=0;e<512;e++)for(var i=0;i<512;i++){var r=A[this.getTile(e,i,t).id];r&&this.changeTileQuick(e,i,t,a.default.get(r))}},t.prototype.markPlayerWalked=function(t,e,i){var r=this.getTile(t,e,i);r.snowWalkTransform&&this.changeTileQuick(t,e,i,a.default.get(r.snowWalkTransform))},t.prototype.getTemperature=function(t,e,i){var r=0,n=this.isColdSector(t,e,i);return 0===i&&this.isClosedPlace(t,e,i,!0)&&!n?r=this.isWinter?10:20:(r=this.isWinter?0:15,n?r-=5:this.game.world.sky.isNight()&&(r-=this.isWinter?10:5)),this.isLitByLight(t,e,i)&&(r+=5),r},t.prototype.getUnderwaterAmbience=function(){return"underwater"},t.prototype.getDayAmbience=function(){return this.isWinter?"snow_day":"forest_day"},t.prototype.getNightAmbience=function(){return this.isWinter?"snow_night":"forest_night"},t.prototype.playAmbience=function(){this.game.audio.playSfx(this.getDayAmbience())},t.prototype.addColdCaveChannel=function(t){this.coldCaveChannels.push(t)},t.prototype.getColdCaveChannels=function(){return this.coldCaveChannels},t}();e.default=I,T.registerClass("Level",I,{transients:{map:!0,habitats:!0,plants:!0,beings:!0,flooring:!0,pfGrids:!0,skylightMap:!0,lightsMap:!0,lightsIntensityMap:!0,coldCaveChannels:!0,waypoints:!0,paintMask:!0,damagedTiles:!0,miningMask:!0,currentsMask:!0,dryMap:!0,items:!0},reviver:function(t){t.revive()},prepare:function(t){return t.prepareCircularData(),t.prepare()}})},6373:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8018),n=i(4369),s=i(6786),a=i(3174),o=i(4738),l=function(){function t(t,e,i){0!=arguments.length&&(this.game=t,this.stage=i||0,this.plantDef=e,this.nextStage=e.phaseMinutes||1440,this.nextStage=this.nextStage*(1+.1*Math.random()),this.growCounter=0,this.hp=new a.default(Math.max(1,o.default.n(e.hp-2,e.hp))),this._c=r.register("Plant"))}return t.prototype.onAfterPlaced=function(){-1==this.stage&&(this.stage=this.plantDef.stages.length-1,this.hitFinalStage())},t.prototype.paint=function(t){this.paintColor=t.def.paintColor,this.paintColor._c=r.setSafe(),this.game.display.message("You paint the "+this.plantDef.name+" "+t.def.colorName+".","Paint",this.x,this.y)},t.prototype.axe=function(){this.hp.spend(2)},t.prototype.getApp=function(){if(this.isStump)return this.plantDef.stumpAppearance;var t=this.plantDef.stages;return this.game.world.level.isWinter&&(t=this.plantDef.winterStages),t[this.stage]},t.prototype.reverseStage=function(){this.stage--,this.finalStage=!1},t.prototype.hitFinalStage=function(){if(this.finalStage=!0,this.plantDef.produce)if(this.plantDef.persistAfterProduce?this.reverseStage():this.game.world.level.removePlant(this),this.plantDef.produce.isTree){var e=new t(this.game,s.default.get(this.plantDef.produce.id),0);e.isGrownByPlayer=this.isGrownByPlayer,this.game.world.level.addPlant(this.x,this.y,this.z,e)}else if(!this.game.world.level.getItem(this.x,this.y,this.z)){var i=o.default.n(1,this.plantDef.produce.quantity),r=new n.default(this.game,this.plantDef.produce.id,i);r.isUnharvestedCrop=!0,r.isGrownByPlayer=this.isGrownByPlayer,this.game.world.level.addItem(r,this.x,this.y,this.z)}this.game.world.level.__updateWalkable(this.x,this.y,this.z)},t.prototype.grow=function(t){this.game.world.isWinter||this.stage!=this.plantDef.stages.length-1&&(this.growCounter+=t,this.growCounter>=this.nextStage&&(this.growCounter=0,this.stage++,this.stage==this.plantDef.stages.length-1&&this.hitFinalStage()))},t.prototype.isSolid=function(){return this.plantDef.solid&&(!this.plantDef.solidStage||this.stage>=this.plantDef.solidStage)},t.prototype.getExamineDescription=function(){return this.plantDef.name+(this.isStump?" Stump":"")},t.prototype.playChopSFX=function(){this.plantDef.chopInto.chopSFX&&this.game.audio.playSfxWithVariation(this.plantDef.chopInto.chopSFX.preffix,this.plantDef.chopInto.chopSFX.variations)},t.prototype.playFellSFX=function(){this.plantDef.chopInto.fellSFX?this.game.audio.playSfxWithVariation(this.plantDef.chopInto.fellSFX.preffix,this.plantDef.chopInto.fellSFX.variations):this.playChopSFX()},t}();e.default=l,r.registerClass("Plant",l,{transients:{plantDef:!0},reviver:function(t){var e=s.default.get(t.__serialData.plantDefId);if(!e)throw new Error("Error restoring plant, invalid plantDefId [".concat(t.__serialData.plantDefId,"]"));t.plantDef=e},prepare:function(t){return{plantDefId:t.plantDef.id}}})},8779:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerAction=e.ExecutableAction=void 0;var r=i(6217),n=i(9273),s=i(4369),a=i(7926),o=i(8059),l=i(449),h=i(3174),u=i(4095),c=i(2062),d=i(771),p=i(9328),f=i(9242),m=i(771),g=i(2746),_=i(4775),y=i(3388),v=i(3085),x=i(4738),b=i(212),E=i(6041),T=i(7409),S=i(8018),w=500,A=function(){function t(){}return t.prototype.init=function(t){this.game=t,this.MAX_SIGHT_RANGE=b.default.isMobile()?16:26,this.FAINT_HOURS=8,this.FAINT_TURN_TIME=.2,this.FISHING_TURN_TIME=.2,this.HUNGER_INCREASE_PER_HOUR=4,this.HUNGER_DAMAGE_PER_HOUR=10,this.SICK_DAMAGE_PER_HOUR=15,this.REGEN_PER_HOUR=4,this.STAMINA_REGEN_PER_HOUR=100,this.x=256,this.y=256,this.z=0,this.visible={_c:S.setSafe()},this.memory={_c:S.register("Player.memory")},this.items=[],this.progression=new l.default,this.recipes=[],this.waypoints=[],this.faintTurns=0,this.sickMinutes=0,this.stamina=null,this.health=null,this.hunger=null,this.vitality=null,this.credits=0,this.pendingCredits=0,this.placedBlocks=0,this.dx=0,this.dy=0,this.currentToolIndex=0,this.dayCounter=1,this.flags={_c:S.setSafe()},this._c=S.register("Player"),this.stamina=new h.default(1e3),this.health=new h.default(100),this.hunger=new h.default(100),this.vitality=new h.default(18),this.oxygen=new h.default(100),this.hunger.current=0,this.recoverableStamina=w,this.farmMode=!1,this.lastTurnTime=.01,this.appearanceSuffix="",this.nextWaypointConsecutive=0,this.recalculateLightMaps()},t.prototype.getAppearance=function(){return this.currentAppearanceId?f.default.get(this.currentAppearanceId+this.appearanceSuffix):f.default.get("PLAYER"+this.appearanceSuffix)},t.prototype.changeFacing=function(t,e){this.dx=t,this.dy=e,this.endTurn(this.getActionTime(I.TURN_AROUND))},t.prototype.canPerformAction=function(t,e){return void 0===e&&(e=!0),this.canPerformWork(this.getActionCost(t),e)},t.prototype.canPerformWork=function(t,e){t||(t=1);var i=this.stamina.current>=t;return!i&&e&&(this.game.display.errorMessage("You feel too tired to do that."),this.isSwimming||(this.currentAppearanceId="PLAYER_RESTING")),i},t.prototype.tryMove=function(t){return t.z||(t.z=0),this.stamina.current<=0&&x.default.chance(10)?(this.game.display.message("You struggle to walk.","Struggle...",this.x,this.y),this.currentAppearanceId="PLAYER_RESTING",this.endTurn(this.getActionTime(I.WALK)),!1):(this.grabbedObject&&this.game.world.level.getItem(this.x,this.y,this.z)&&(this.game.display.message("You release the ".concat(this.grabbedObject.def.name),"Let Go",this.x,this.y),this.grabbedObject=void 0),this.game.world.level.canWalkTo(this.x+t.x,this.y+t.y,this.z+t.z)?!this.farmMode&&this.game.input.peekMode()!==n.InputMode.BUILDING&&!b.default.isMobile()||0!==t.z||t.x==this.dx&&t.y==this.dy?(this.grabbedObject&&(this.game.world.level.moveItem(this.grabbedObjectX,this.grabbedObjectY,this.x,this.y,this.z),this.grabbedObjectX=this.x,this.grabbedObjectY=this.y),g.default.reportStep(),this.stamina.current>0&&this.performAction(I.WALK),this.currentAppearanceId=null,this.__updatePosition(t,this.getActionTime(I.WALK)),!0):(g.default.reportAction("changeFacing"),this.changeFacing(t.x,t.y),!1):(this.changeFacing(t.x,t.y),this.autoEquip(),!1))},t.prototype.tryCook=function(){var t=this.game.player.getPossibleCookRecipes();0!==t.length?(this.game.input.setMode(n.InputMode.SELECT_RECIPE),this.game.display.resetSelectedRecipe(),this.game.display.recipesPanel.setCategories(),this.game.display.showRecipes(t),this.game.audio.playSfx("ui_inv_close"),g.default.reportAction("cook")):this.game.display.errorMessage("You lack the ingredients to cook anything.")},t.prototype.canGrab=function(t){var e=this.x+this.dx,i=this.y+this.dy,r=this.game.world.level;if(!this.canPerformAction(I.GRAB,t))return!1;var n=r.getItem(e,i,this.z);return!(null==n?void 0:n.def.fixed)&&(this.grabbedObject?this.grabbedObject===n:!!n)},t.prototype.tryGrabObject=function(){var t=this.x+this.dx,e=this.y+this.dy,i=this.game.world.level;if(!this.canPerformAction(I.GRAB,!0))return null;var r=i.getItem(t,e,this.z);this.grabbedObject?this.grabbedObject===r?(this.grabbedObject=void 0,this.performAction(I.GRAB),this.endTurn(this.getActionTime(I.GRAB)),this.game.display.message("You release the "+r.def.name+".","Let Go",t,e)):this.game.display.errorMessage("You already have a "+this.grabbedObject.def.name+" grabbed."):r.def.fixed?this.game.display.errorMessage("You cannot grab the ".concat(r.def.name,".")):(this.game.display.message("You grab the "+r.def.name+".","Grab",t,e),this.grabbedObject=r,this.grabbedObjectX=t,this.grabbedObjectY=e,this.performAction(I.GRAB),this.endTurn(this.getActionTime(I.GRAB)))},t.prototype.trySwim=function(t){t.z||(t.z=0);var e=this.game.world.level;if(this.stamina.current<=0&&x.default.chance(10))return this.game.display.message("You struggle to swim.","Struggle...",this.x,this.y),void this.endTurn(this.getActionTime(I.SWIM));if(e.canWalkTo(this.x+t.x,this.y+t.y,this.z,!0))if(t.x==this.dx&&t.y==this.dy){this.performAction(I.SWIM),e.getItem(this.x+t.x,this.y+t.y,this.z+t.z);(e.isFlooded(this.x,this.y,this.z)?!e.isFlooded(this.x+t.x,this.y+t.y,this.z+t.z):!e.isWater(this.x+t.x,this.y+t.y,this.z+t.z))&&(this.isSwimming=!1,this.game.audio.playSfxWithVariation("water_jump_out_0",3),this.currentAppearanceId=null),this.__updatePosition(t,this.getActionTime(I.SWIM))}else this.changeFacing(t.x,t.y);else this.changeFacing(t.x,t.y)},t.prototype.forceMoveTo=function(t,e,i){e||(this.performAction(i),this.currentAppearanceId=null),this.__updatePosition(t,this.getActionTime(i))},t.prototype.__updatePosition=function(t,e){t.z||(t.z=0),this.dx=t.x,this.dy=t.y,this.x+=t.x,this.y+=t.y,this.z+=t.z,this.game.world.level.__updateWalkable(this.x,this.y,this.z),this.game.world.level.__updateWalkable(this.x-t.x,this.y-t.y,this.z-t.z),this.land(e)},t.prototype.push=function(t){this.game.world.level.canWalkTo(this.x+t.x,this.y+t.y,this.z+t.z,!0)&&(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.game.world.level.__updateWalkable(this.x,this.y,this.z),this.game.world.level.__updateWalkable(this.x-t.x,this.y-t.y,this.z-t.z))},t.prototype.land=function(t){this.playFS(),this.game.world.level.exits[this.x]&&this.game.world.level.exits[this.x][this.y]&&this.game.world.loadLevel(this.game.world.level.exits[this.x][this.y]);var e=this.game.world.level.getItem(this.x,this.y,this.z);e&&"WOODEN_CHAIR"===e.def.id&&(this.currentAppearanceId="PLAYER_SIT_CHAIR"),this.game.world.level.isWinter&&this.game.world.level.markPlayerWalked(this.x,this.y,this.z),this.endTurn(t)},t.prototype.isDead=function(){return this.health.current<=0},t.prototype.checkCampfireSFX=function(){var t=this.getNearbySound(5);t?this.game.audio.currentNearAmbience||(this.game.audio.currentNearAmbience=t,this.game.audio.playSfx(t)):this.game.audio.currentNearAmbience&&(this.game.audio.stopSfx(this.game.audio.currentNearAmbience),this.game.audio.currentNearAmbience=void 0)},t.prototype.endTurn=function(t){var e=this;if(this.lastTurnTime=t,this.game.world.passTime(t),this.checkHunger(t),this.checkCampfireSFX(),this.game.world.checkAmbienceCrossfade(),this.isFainted()||(this.updateFOV(),this.stamina.current<=0&&x.default.chance(10)&&this.faint()),this.isSick()&&(this.sickMinutes-=60*t,this.health.spend(this.SICK_DAMAGE_PER_HOUR*t),this.isSick()||this.isDead()||this.game.display.errorMessage("You feel better now.")),this.isDead())return this.game.display.errorMessage("You die."),this.game.display.refresh(),void this.game.input.gameOver();if(this.isSick()||this.isStarving()||this.health.recover(this.REGEN_PER_HOUR*t),this.isSwimming){var i=this.game.world.level.isFlooded(this.x,this.y,this.z);i?(this.oxygen.spend(this.getOxygenSpentPerHour()*t),this.oxygen.current<=0&&this.health.spend(this.getDrownedDamagePerHour()*t)):this.oxygen.recoverAll(),this.currentAppearanceId=i?"PLAYER_DIVING":"PLAYER_SWIMMING"}var r=this.game.world.level.getCurrent(this.x,this.y,this.z);if(r){var n=m.default.getVarFromCardinalDirection(r),s=this.game.world.level.isWater(this.x+n.x,this.y+n.y,this.z),a=this.game.world.level.getItem(this.x,this.y,this.z);if(s&&(this.isSwimming||a)){var o=this.isFainted()?100:a?20:80;x.default.chance(o)&&(this.game.display.message("You are pushed by the current.","Drift",this.x,this.y),(null==a?void 0:a.def.floating)&&this.game.world.level.moveItem(this.x,this.y,this.x+n.x,this.y+n.y,this.z),this.push(n))}}this.game.display.refresh(),this.game.world.level.beingsTurn(),this.game.world.level.growPlants(60*t),this.hunger.recover(t*this.HUNGER_INCREASE_PER_HOUR),this.isFainted()?(this.recoverMovement(),setTimeout((function(){return e.endTurn(e.FAINT_TURN_TIME)}),"nap"===this.sleepType?300:50)):this.isFishing()?(this.fishingProgress(),setTimeout((function(){return e.endTurn(e.FISHING_TURN_TIME)}),500)):this.game.input.enableInput()},t.prototype.remember=function(t,e,i){var r=this.memory[this.game.world.level.id];if(r||(r=[],this.memory[this.game.world.level.id]=r),!r[i]){r[i]=new Array(512);for(var n=0;n<512;n++)r[i][n]=new Array(512)}r[i][t][e]=!0,this.game.world.level.checkWaypoint(t,e,i)},t.prototype.remembers=function(t,e,i){try{return this.memory[this.game.world.level.id][i][t][e]}catch(t){return!1}},t.prototype.canSee=function(t,e){try{return!0===this.visible[t+"-"+e]}catch(t){return!1}},t.prototype.getNearbySound=function(t){for(var e,i,r=-t;r<=t;r++)for(var n=-t;n<=t;n++)try{if(this.canSee(r,n)&&(null===(e=this.game.world.level.getItem(this.x+r,this.y+n,this.z))||void 0===e?void 0:e.def.soundSource))return null===(i=this.game.world.level.getItem(this.x+r,this.y+n,this.z))||void 0===i?void 0:i.def.soundSource.sound}catch(t){break}},t.prototype.getSightRange=function(){return this.MAX_SIGHT_RANGE},t.prototype.updateFOV=function(){for(var t=-this.MAX_SIGHT_RANGE;t<=this.MAX_SIGHT_RANGE;t++)for(var e=-this.MAX_SIGHT_RANGE;e<=this.MAX_SIGHT_RANGE;e++)this.visible[e+"-"+t]=!1;for(var i=2*Math.PI/1080,r=this.getSightRange(),n=0;n<2*Math.PI;n+=i)this.shootRay(n,r)},t.prototype.shootRay=function(t,e){var i=.3333,r=e<this.MAX_SIGHT_RANGE?e:this.MAX_SIGHT_RANGE;r/=i;for(var n=Math.cos(t)*i,s=-Math.sin(t)*i,a=this.x,o=this.y,l=0;l<r;++l){var h=Math.round(a),u=Math.round(o);if(!this.game.world.level.isValidPosition(h+n,u+s,this.z))return;if(this.visible[h-this.x+"-"+(u-this.y)]=!0,this.game.world.level.isOpaque(h,u,this.z))return;a+=n,o+=s}},t.prototype.hasItemRecursively=function(t){if(this.items.includes(t))return!0;for(var e=0;e<this.items.length;e++){var i=this.items[e];if(i.isContainer()&&i.containsRecursive(i))return!0}return!1},t.prototype.findItem=function(t){return this.items.find((function(e){return e.def.id===t}))},t.prototype.findItemIncludingBackpack=function(t){var e=this.items.find((function(e){return e.def.id===t}));if(e)return e;var i=this.getBackpack();return i?i.containedItems.find((function(e){return e.def.id===t})):void 0},t.prototype.findLiquid=function(t){var e;return null===(e=this.items.find((function(e){var i;return(null===(i=e.containedLiquid)||void 0===i?void 0:i.id)===t})))||void 0===e?void 0:e.containedLiquidQuantity},t.prototype.findItemByAspect=function(t){return this.items.find((function(e){var i;return(null===(i=e.def.aspects)||void 0===i?void 0:i.indexOf(t))>=0}))},t.prototype.findItemByAspectIncludingBackpack=function(t){var e=this.findItemByAspect(t);return e||this.getBackpack()?e:this.getBackpack().containedItems.find((function(e){var i;return(null===(i=e.def.aspects)||void 0===i?void 0:i.indexOf(t))>=0}))},t.prototype.getToolbarCapacity=function(){return 13},t.prototype.getBackpack=function(){return this.items.find((function(t){return"BACKPACK"===t.def.id}))},t.prototype.getCarryCapacity=function(){return 3e4},t.prototype.canPickLiquid=function(t,e,i){return!(!t.canContainLiquid(e,i)||this.getCurrentWeight()-t.getWeight()+e.weight*i>this.getCarryCapacity())},t.prototype.canPickItem=function(t,e,i){return!(this.items.length<20)&&e&&(i?this.game.display.errorMessage("You wouldn't be able to carry up the ".concat(t.def.name,", your inventory is full.")):this.game.display.errorMessage("You can't pick up the ".concat(t.def.name,", your inventory is full."))),!(this.getCurrentWeight()+t.getWeight()>this.getCarryCapacity()&&(e&&(i?this.game.display.errorMessage("You wouldn't be able to carry the ".concat(t.def.name,", it's too heavy!")):this.game.display.errorMessage("You can't pick up the ".concat(t.def.name,", it's too heavy!"))),1))},t.prototype.canPickOf=function(t,e,i,r,n,s,a){var o=_.default.get(t),l=n?" No space in front either.":"";if(this.getCurrentWeight()+o.weight*e-(null!=s?s:0)>this.getCarryCapacity())return i&&(r?this.game.display.errorMessage("You wouldn't be able to carry the ".concat(o.name,", it's too heavy!").concat(l)):this.game.display.errorMessage("You can't pick up the ".concat(o.name,", it's too heavy!").concat(l))),!1;if(!o.noStack&&this.findItem(t))return!0;var h=this.items.length-(null!=a?a:0)<this.getToolbarCapacity();if(!h){var u=this.getBackpack();if(null==u?void 0:u.canStoreOf(t))return!0;if(i){var c=u?"backpack":"toolbox";r?this.game.display.errorMessage("You wouldn't be able to carry up the ".concat(o.name,", your ").concat(c," is full.").concat(l)):this.game.display.errorMessage("You can't pick up the ".concat(o.name,", your ").concat(c," is full.").concat(l))}}return h},t.prototype.getCurrentWeight=function(){return this.items.reduce((function(t,e){return t+e.getWeight()}),0)},t.prototype.getAvailableLiquidContainers=function(t,e){return this.items.filter((function(i){return(!e||i.def.id===e)&&i.def.containerCapacity>0&&(!i.containedLiquidQuantity||i.containedLiquidQuantity<i.def.containerCapacity)&&(!i.containedLiquid||i.containedLiquid.id===t)}))},t.prototype.addItemNoStack=function(t){this.canPickOf(t.def.id,1,!1,!1)&&this.addItemToInventoryNoStack(t)},t.prototype.addNewItem=function(t,e){this.addItem(new s.default(this.game,t,e))},t.prototype.addItemToInventoryNoStack=function(t){if(this.items.length<this.getToolbarCapacity())this.items.push(t),1===this.items.length&&(this.currentToolIndex=0,this.currentTool=this.items[this.currentToolIndex]);else{var e=this.getBackpack();if(!e)return;this.onItemAddedToBackpack(),e.addItem(t,!1)}this.itemAcquiredHook(t,t.quantity)},t.prototype.onItemAddedToBackpack=function(){this.game.display.message("Added to backpack.","Backpack",this.x,this.y)},t.prototype.itemAcquiredHook=function(t,e){var i=t.def,r=i.id;g.default.reportItemAcquired(r,e),t.isUnharvestedCrop&&(t.isUnharvestedCrop=!1,t.isGrownByPlayer&&!this.progression.hasCrop(t.id)&&(this.progression.addCrop(t.id),this.game.display.message("Entry added to your notes.",null,0,0),this.game.input.setMode(n.InputMode.JOURNAL),this.game.display.journalPanel.showJournal()),g.default.reportAction("harvestCrop")),i.isForagedPlant&&(this.progression.hasPlant(t.id)||(this.progression.addPlant(t.id),this.game.display.message("Entry added to your notes.",null,0,0),this.game.input.setMode(n.InputMode.JOURNAL),this.game.display.journalPanel.showJournal())),this.flags["GOT_ITEM_".concat(i.id)]=!0,t.def.lightSource&&this.selectLight()},t.prototype.addItem=function(t){if(this.canPickItem(t,!1,!1))if(t.def.noStack)for(var e=0;e<t.quantity;e++)this.addItemNoStack(t);else this.addQuantityOf(t,t.quantity)},t.prototype.addQuantityOf=function(t,e){if(this.canPickOf(t.def.id,e,!1,!1)){var i=this.findItem(t.def.id);if(i||this.items.length!==this.getToolbarCapacity()||(i=this.findItemIncludingBackpack(t.def.id)),i)i.quantity+=e,this.findItem(t.def.id)||this.onItemAddedToBackpack(),this.itemAcquiredHook(t,i.quantity);else{var r=t.clone();if(r.quantity=e,this.items.length<this.getToolbarCapacity())this.items.push(r),1===this.items.length&&(this.currentToolIndex=0,this.currentTool=this.items[this.currentToolIndex]);else{var n=this.getBackpack();if(!n)return;this.onItemAddedToBackpack(),n.addItem(r,!1)}this.itemAcquiredHook(r,e)}}},t.prototype.removeLiquid=function(t,e){var i=this.items.filter((function(e){var i;return(null===(i=e.containedLiquid)||void 0===i?void 0:i.id)===t}));this.getBackpack()&&(i=i.concat(this.getBackpack().containedItems.filter((function(e){var i;return(null===(i=e.containedLiquid)||void 0===i?void 0:i.id)===t}))));for(var r=e,n=0;n<i.length;n++){var s=i[n];if(s.containedLiquidQuantity>=r){s.spendLiquid(r);break}r-=s.containedLiquidQuantity,s.spendLiquid(s.containedLiquidQuantity)}},t.prototype.reduceFromItemIncludingBackpack=function(t,e){e=e||1,this.items.includes(t)||!this.getBackpack()?this.reduceFromItem(t,e):(t.quantity-=e,t.quantity<=0&&this.getBackpack().removeItem(t))},t.prototype.reduceFromItem=function(t,e){e=e||1,t.quantity-=e,t.quantity<=0&&this.removeItem(t)},t.prototype.removeItem=function(t){var e=this.items.indexOf(t);this.items.splice(e,1),this.currentToolIndex>=this.items.length&&(this.currentToolIndex=0),this.currentTool=this.items[this.currentToolIndex],this.currentLight===t&&this.selectLight()},t.prototype.removeItemIncludingBackpack=function(t){this.items.indexOf(t)>-1||!this.getBackpack()?this.removeItem(t):this.getBackpack().removeItem(t)},t.prototype.selectLight=function(){var t=this.items.filter((function(t){return t.def.lightSource}));if(0===t.length)return delete this.currentLight,void this.recalculateLightMaps();this.currentLight=t.sort((function(t,e){return t.def.lightSource.range===e.def.lightSource.range?e.def.lightSource.intensity-t.def.lightSource.intensity:e.def.lightSource.range-t.def.lightSource.range}))[0],this.recalculateLightMaps()},t.prototype.tryFeed=function(){if(!this.currentTool)return this.game.display.errorMessage("Nothing to feed."),!1;var t=this.currentTool.doFeed({x:this.dx,y:this.dy});t&&this.endTurn(t.hours)},t.prototype.tryPlant=function(){if(!this.currentTool)return this.game.display.errorMessage("Nothing to plant."),!1;var t=this.currentTool.doPlant({x:this.dx,y:this.dy});t&&this.endTurn(t.hours)},t.prototype.somethingToPickUp=function(){var t=this.getThingInFront();return t&&t.type!==o.WorldObjectType.FLOORING||(t=this.getThingUnder()),t&&(t.type===o.WorldObjectType.ITEM||t.type===o.WorldObjectType.PLANT||t.type===o.WorldObjectType.BEING)},t.prototype.tryGrabFromContainer=function(t,e,i){return!!this.tryPickupItem(e,i,null,t)},t.prototype.tryPickupItem=function(t,e,i,r,n){var s=r&&this.hasItemRecursively(r);if(t.def.fixed)return this.game.display.errorMessage("You can't pick up the "+t.def.name+"."),!1;if(!s){if((t.isContainer()||t.containedLiquid)&&!this.canPickItem(t,!0,!1))return!1;if(!this.canPickOf(t.id,1,!0,!1))return!1}var a=e?1:t.quantity;if(!s&&!this.canPickOf(t.id,a,!1,!1)){if(t.def.noStack)return this.canPickOf(t.id,a,!0,!1),!1;a=1}return this.game.display.message("You pick up the "+t.def.name+".",null,0,0),this.grabbedObject===t&&(this.grabbedObject=void 0),t.def.grabSound&&this.game.audio.playSfx(t.def.grabSound),a===t.quantity?(i?i.stackedItem=null:r?r.removeItem(t):n?this.game.world.level.removeItem(this.x,this.y,this.z):this.game.world.level.removeItem(this.x+this.dx,this.y+this.dy,this.z),this.addItem(t)):(t.quantity-=a,this.addQuantityOf(t,a)),this.endTurn(this.getActionTime(I.PICK_UP)),!0},t.prototype.tryPickup=function(t){var e=this.getThingInFront(),i=!1;if(e&&e.type!==o.WorldObjectType.FLOORING||(e=this.getThingUnder(),i=!0),e){if(e.type===o.WorldObjectType.ITEM)return this.tryPickupItem(e.thing,t,e.table,null,i);if(e.type===o.WorldObjectType.PLANT){var r=e.thing;if(r.plantDef.produce)this.game.display.errorMessage("The "+r.plantDef.name+" is not ready to harvest.");else if(r.plantDef.pullable){var n=_.default.get(r.plantDef.pullable.itemId);return n?!!this.canPickOf(r.plantDef.pullable.itemId,1,!0,!1)&&(this.game.display.message("You pick up the "+n.name+".",null,0,0),r.plantDef.grabSound&&this.game.audio.playSfx(r.plantDef.grabSound),this.game.world.level.removePlant(r),this.addNewItem(r.plantDef.pullable.itemId,x.default.n(1,r.plantDef.pullable.quantity)),this.endTurn(this.getActionTime(I.HARVEST)),!0):(this.game.display.errorMessage("Error pulling items from the "+r.plantDef.name+"."),!1)}}else if(e.type===o.WorldObjectType.BEING)return!!this.canPickOf("$RACE_"+e.thing.race.id,1,!0,!1)&&(this.tryCatch(e.thing),this.endTurn(this.getActionTime(I.CATCH_MONSTER)),!0)}return!1},t.prototype.tryPour=function(){return this.currentTool?this.currentTool.containedLiquid?(this.game.display.message("You spill the ".concat(this.currentTool.containedLiquid.name," into the ground."),"Spill",this.x,this.y),this.currentTool.containedLiquid=null,this.currentTool.containedLiquidQuantity=0,this.endTurn(this.getActionTime(I.POUR)),!0):(this.game.display.errorMessage("Cannot pour the ".concat(this.currentTool.def.name," into the ground.")),!1):(this.game.display.errorMessage("Nothing to pour"),!1)},t.prototype.tryDrop=function(t,e,i){var n,s,o;if(this.leashedAnimal&&t.def.effect===a.ItemEffect.LEASH)return this.game.display.errorMessage("Cannot drop the ".concat(this.currentTool.def.name," while the ").concat(this.leashedAnimal.race.name," is leashed.")),!1;var l=e?1:t.quantity;if(i)return this.tryPutInContainer(i,t,e);var h=this.game.world.level,c=this.x+this.dx,d=this.y+this.dy,f=h.getItem(c,d,this.z);if(f){if(f.def.isTable&&t.def.type!==p.default.BEING){if(f.stackedItem){if(f.stackedItem.def!==t.def||t.def.noStack)return this.game.display.errorMessage("Cannot drop the ".concat(t.def.name," here.")),!1;f.stackedItem.quantity+=l}else e&&t.quantity>1?(f.stackedItem=t.clone(),f.stackedItem.quantity=1):f.stackedItem=t,f.stackedItem;return e&&t.quantity>1?this.reduceFromItem(t,1):this.removeItem(t),this.game.display.message("You put the ".concat(t.def.name," on the ").concat(f.def.name,"."),null,0,0),this.endTurn(this.getActionTime(I.DROP)),"WATER"===(null===(n=t.containedLiquid)||void 0===n?void 0:n.id)&&t.containedLiquidQuantity>=(null===(s=r.default.get("TINTO").materials.find((function(t){return"WATER"===t.id})))||void 0===s?void 0:s.quantity)&&this.canCook()&&g.default.reportAction("setupTinto"),!0}return f.isContainer()&&t.def.type!==p.default.BEING?this.tryPutInContainer(f,t,e):f.def!==t.def||t.def.noStack?(this.game.display.errorMessage("Cannot drop the ".concat(t.def.name," here.")),!1):(f.quantity+=l,e&&t.quantity>1?this.reduceFromItem(t,1):this.removeItem(t),this.game.display.message("You stack ".concat(l," ").concat(t.def.name,"."),null,0,0),this.endTurn(this.getActionTime(I.DROP)),!0)}var m=h.getTile(c,d,this.z);if((null===(o=m.dropTransform)||void 0===o?void 0:o.acceptedItemId)===t.id){if(m.dropTransform.requiredQuantity>l)return this.game.display.errorMessage("You need at least ".concat(m.dropTransform.requiredQuantity," ").concat(t.def.name,".")),!1;var _=m.dropTransform.requiredQuantity;return _<t.quantity?this.reduceFromItem(t,_):this.removeItem(t),this.game.display.message("You drop some ".concat(t.def.name," into the ").concat(m.name),"Fill",c,d),h.changeTileQuick(c,d,this.z,E.default.get(m.dropTransform.targetTileId)),this.playDrop(c,d,this.z),this.endTurn(this.getActionTime(I.DROP)),!0}var y=t.def.floating;if(!h.canWalkTo(c,d,this.z,y)){if(!t.def.wallAttachable)return this.game.display.errorMessage("Cannot drop the ".concat(t.def.name," here.")),!1;if(!this.game.world.level.canHoistItemOn(this.x,this.y,c,d,this.z))return this.game.display.errorMessage("Cannot place the ".concat(t.def.name," here.")),!1}if(t.def.type==p.default.BEING){var v=new u.default(this.game,this.game.world.level,t.def.raceId);v.eternal=!0,this.game.world.level.addBeing(v,c,d,this.z)}else e&&t.quantity>1?this.game.world.level.stackItem(t,1,c,d,this.z):this.game.world.level.addItem(t,c,d,this.z);return e&&t.quantity>1?this.reduceFromItem(t,1):this.removeItem(t),this.game.display.message("You drop the "+t.def.name+".",null,0,0),this.playDrop(c,d,this.z),this.endTurn(this.getActionTime(I.DROP)),!0},t.prototype.tryPutInContainer=function(t,e,i){return t!==e&&!e.containsRecursive(t)&&(t.canStore(e)?(i&&e.quantity>1?this.reduceFromItem(e,1):this.removeItem(e),t.addItem(e,i),this.game.display.message("You put the ".concat(e.def.name," into the ").concat(t.def.name,"."),"Put",this.x,this.y),this.game.audio.playSfx("drop_wood_0"+x.default.n(1,2)),this.endTurn(this.getActionTime(I.DROP)),!0):(this.game.display.errorMessage("The ".concat(t.def.name," is full.")),!1))},t.prototype.setCurrentTool=function(t){this.currentTool=this.findItem(t),this.currentToolIndex=this.items.indexOf(this.currentTool),this.game.display.refresh()},t.prototype.tryCatch=function(t){t.leashed&&(t.leashed=!1,this.leashedAnimal=void 0),this.game.world.level.removeBeing(t),this.game.display.message("You capture a "+t.race.name+".",null,0,0),this.game.audio.playSfx("grab_animal"),t.eternal=!0,this.addBeingToInventory(t.race.id),this.onAnimalCaptured(t)},t.prototype.addBeingToInventory=function(t){this.addNewItem("$RACE_"+t,1)},t.prototype.onAnimalCaptured=function(t){this.progression.hasAnimal(t.race.id)||(this.progression.addAnimal(t.race.id),this.game.display.message("Entry added to your notes.",null,0,0),this.game.input.setMode(n.InputMode.JOURNAL),this.game.display.journalPanel.showJournal())},t.prototype.autoEquip=function(){var t,e=this.getThingInFront();if(!e)return!1;if(this.isBreakable(e))t="PICKAXE";else{if(!this.isAxeable(e))return!1;t="AXE"}if(this.findItem(t)&&g.default.reportItemAction("autoEquip",t),this.currentTool&&this.currentTool.id===t||!this.findItem(t))return!1;this.setCurrentTool(t),this.game.display.message("You ready your "+this.currentTool.def.name+".",null,0,0)},t.prototype.tryRotateInFront=function(){var t=this.getThingInFront();if(!t||t.type!==o.WorldObjectType.ITEM)return!1;var e=t.thing.tryRotate();return e?(this.endTurn(e.hours),!0):void 0},t.prototype.useInFront=function(){var t=this.getThingInFront();if(!t||t.type!==o.WorldObjectType.ITEM||!t.thing.def.nearAction)return!1;var e=t.thing.use({currentItem:this.currentTool,direction:{x:this.dx,y:this.dy}});return e?(this.endTurn(e.hours),!0):void 0},t.prototype.useCurrentTool=function(t){return this.currentTool?this.useTool(this.currentTool,t):(this.game.display.errorMessage("Nothing readied."),!1)},t.prototype.useTool=function(t,e){var i=null;return t.def.effect?i=t.use({all:e,direction:{x:this.dx,y:this.dy}}):t.def.edible?i=this.tryEat(t):this.game.display.errorMessage("Nothing to do."),!!i&&(this.endTurn(i.hours),!0)},t.prototype.switchCurrentTool=function(t){0!==this.items.length&&(t?(this.currentToolIndex--,this.currentToolIndex<0&&(this.currentToolIndex=this.items.length-1)):(this.currentToolIndex++,this.currentToolIndex>=this.items.length&&(this.currentToolIndex=0)),this.currentTool=this.items[this.currentToolIndex],g.default.reportItemAction("selectTool",this.currentTool.def.id))},t.prototype.faint=function(){this.game.display.message("You faint...","Faint",this.x,this.y),this.fishingTurns=0,this.currentAppearanceId="PLAYER_SLEEP_FLOOR",this.sleepType="faint",this.faintTurns=Math.ceil(this.FAINT_HOURS/this.FAINT_TURN_TIME);var t=this.game.world.level.getTile(this.x,this.y,this.z);t&&t.faintAudio&&this.game.audio.playSfx(t.faintAudio)},t.prototype.isFainted=function(){return this.faintTurns>0},t.prototype.recoverMovement=function(){if(this.faintTurns--,this.faintTurns<=0){this.game.display.message("You wake up...","Wake up",this.x,this.y),"comfortable"!==this.sleepType&&"uncomfortable"!=this.sleepType||this.game.display.errorMessage("You slept "+("comfortable"===this.sleepType?" comfortably":" uncomfortably")+".",!0),this.isSafeToSleep()&&"faint"!==this.sleepType&&g.default.reportAction("nap"),this.currentAppearanceId=null;var t="comfortable"==this.sleepType?1e3:"uncomfortable"==this.sleepType?400:"faint"==this.sleepType?200:"nap"==this.sleepType?400:0;switch((this.isStarving()||this.isSick())&&(t=Math.floor(t/2),this.game.display.errorMessage("Your sleep was uneasy.")),this.isSafeToSleep()||(x.default.chance(20)&&this.getSick("faint"===this.sleepType?8:4),"nap"===this.sleepType?this.health.addPenalty(5):this.health.addPenalty(20),"comfortable"!==this.sleepType&&"uncomfortable"!==this.sleepType||this.flags.alertedAboutBadSleep||(this.game.display.alert("Your health has taken a big hit because you slept in the cold. Next time do it by a campfire or your body will not stand for long!"),this.flags.alertedAboutBadSleep=!0)),this.stamina.recover(t),this.sleepType){case"comfortable":this.recoverableStamina=w,this.isSafeToSleep()&&this.health.reducePenalty(10);break;case"uncomfortable":this.recoverableStamina=w;break;case"faint":this.recoverableStamina=w,this.health.addPenalty(20),this.flags.alertedAboutFaint||(this.game.display.alert('You overworked yourself and fainted, take care of yourself and sleep adequately (Using a bed, or the "Sleep" action) when you are feeling tired!'),this.flags.alertedAboutFaint=!0)}}},t.prototype.isFishing=function(){return this.fishingTurns>0},t.prototype.fishingProgress=function(){if(this.fishingTurns--,this.performAction(I.FISH),this.fishingTurns<=0)this.game.display.onFishingStop(),this.game.display.message("You caught nothing.","Nothing",this.x,this.y),this.currentAppearanceId=null;else{var t=this.game.world.level.getTile(this.x+this.dx,this.y+this.dy,this.z),e=t.isHalfWater?3:6;if(t.isRapidWater&&(e+=3),t.isDeepWater&&(e+=3),x.default.chance(e)){var i=this.game.world.level.getARace(this.x,this.y,!0);if(i){this.game.display.message("You got a fish.","Bite",this.x,this.y);var r=new s.default(this.game,"$RACE_"+i.id,1);if(this.fishingTurns=0,this.currentAppearanceId=null,this.game.display.onFishingStop(),this.tryPickupItem(r,!0)){var n=new u.default(this.game,this.game.world.level,i.id);this.onAnimalCaptured(n)}}}}},t.prototype.getSick=function(t){this.vitality.spend(1),this.sickMinutes=60*Math.floor(t*(1-this.vitality.getPercentage())),this.sickMinutes<=0&&(this.sickMinutes=60),this.game.display.errorMessage("You are not feeling well.")},t.prototype.performAction=function(t){this.spendStamina(this.getActionCost(t))},t.prototype.spendStamina=function(t){var e=this.stamina.getPercentage(),i=1,r=this.game.world.currentTime,n=!0;r>22?i=2:r>19?i=1.5:r<5?i=3:n=!1,n&&x.default.chance(5)&&(this.game.display.message("You feel sleepy.","Sleepy...",this.x,this.y),this.currentAppearanceId="PLAYER_RESTING");var s=!0;this.hunger.getPercentage()>.8?i*=2:this.hunger.getPercentage()>.5?i*=1.5:s=!1,s&&x.default.chance(5)&&(this.game.display.message("You feel hungry.","Hungry...",this.x,this.y),this.currentAppearanceId="PLAYER_RESTING"),t*=i,this.stamina.spend(t),this.stamina.current<=0?(this.game.display.message("You are too tired.","Too tired",this.x,this.y),this.currentAppearanceId="PLAYER_RESTING"):e>=.3&&this.stamina.getPercentage()<.3&&(this.game.display.message("You are starting to feel tired...","Tired...",this.x,this.y),this.currentAppearanceId="PLAYER_RESTING",this.flags.alertedAboutGettingTired||(this.game.display.alert("You are getting tired, when the fatigue bar fills you will faint and your health will take a big hit. Now it may be a good time to plan your sleep near a campfire or in a closed location (and optimally using a bed or similar!)"),this.flags.alertedAboutGettingTired=!0))},t.prototype.addRecipe=function(t){this.recipes.push(t)},t.prototype.knowsRecipe=function(t){return this.recipes.findIndex((function(e){return e.id===t}))>-1},t.prototype.getRecipes=function(){return this.recipes},t.prototype.canCraft=function(){return!0},t.prototype.tryCraftSelected=function(){return this.tryCraft(this.selectedRecipe)},t.prototype.canBuildSimple=function(t){var e=this.x+this.dx,i=this.y+this.dy,r=this.game.world.level.getItem(e,i,this.z),n=this.game.world.level.canWalkTo(e,i,this.z)&&!r;if(t.buildOnWater){if(!this.game.world.level.isWater(e,i,this.z)||r)return!1}else if(t.placeInWorld)if(t.flooringId){if(!this.game.world.level.canWalkTo(e,i,this.z)||this.game.world.level.getFlooringAt(e,i,this.z))return!1}else if(!n)return!1;return!0},t.prototype.tryCraft=function(t){var e=this;if(!t)return this.game.display.errorMessage("Select something to build first."),!1;var i=this.x+this.dx,r=this.y+this.dy,n=t.verb||"build";if(this.isSwimming&&this.game.world.level.isFlooded(this.x,this.y,this.z)&&!t.buildUnderwater)return this.game.display.errorMessage("Can only "+n+" it on dry ground."),!1;var a=this.game.world.level.getItem(i,r,this.z),o=this.game.world.level.canWalkTo(i,r,this.z)&&!a;if(t.buildOnWater){if(!this.game.world.level.isWater(i,r,this.z)||a)return this.game.display.errorMessage("Can only "+n+" in water."),!1}else if(t.placeInWorld)if(t.flooringId){if(!this.game.world.level.canWalkTo(i,r,this.z)||this.game.world.level.getFlooringAt(i,r,this.z))return this.game.display.errorMessage("Cannot "+n+" here."),!1}else if(!o)return this.game.display.errorMessage("Cannot "+n+" here."),!1;var l=null;l="cook"===t.type?null==a?void 0:a.stackedItem:a;var h=!1;if(t.requiredContainer){var u=_.default.get(t.requiredContainer);if(!l||t.requiredContainer!=l.def.id)return"cook"===t.type?this.game.display.errorMessage("The recipe requires a ".concat(u.name," placed on top of the cooking place.")):this.game.display.errorMessage("You need a ".concat(u.name," placed in front of you.")),!1}if(t.isLiquid){if(l.def.containerCapacity<t.produceQuantity)return this.game.display.errorMessage("The ".concat(l.def.name," isn't big enough for the recipe, needs to fit ").concat(t.produceQuantity," ").concat(_.default.get(t.itemId).name,".")),!1;if(l.containedLiquid&&l.containedLiquid!==_.default.get(t.itemId)&&!t.materials.find((function(t){return t.id===l.containedLiquid.id})))return this.game.display.errorMessage("The ".concat(l.def.name," contains ").concat(l.containedLiquid.name,", which is not part of the recipe.")),!1}var d=y.default.compileMaterialsForRecipe(this,this.game,t),p=d.missingMaterials,f=d.materialWeight,v=d.usedSlots;if(p.length>0&&!c.default.cheatsEnabled()){var x="";return p.forEach((function(t,e){if(t.isAspect){var i=_.default.getAspect(t.id);x+=t.quantity+" "+i.name}else{var r=_.default.get(t.id);x+=t.quantity+" "+r.name}e===p.length-1?x+=".":p.length>1&&e===p.length-2?x+=" and ":x+=", "})),this.game.display.errorMessage("You need "+x+"."),!1}if(!(t.placeInWorld||t.isLiquid||t.flooringId||this.canPickOf(t.itemId,t.produceQuantity?t.produceQuantity:1,!1,!1,!1,f,v))){if(!o)return this.canPickOf(t.itemId,t.produceQuantity?t.produceQuantity:1,!0,!0,"cook"!==t.type,f,v),!1;h=!0}if("cook"!==t.type&&!this.canPerformWork(t.staminaCost,!0))return!1;g.default.reportItemAction("craft",t.id),this.flags["HAS_COOKED_".concat(t.id)]=!0;var b=this.game.world.level.getLooseItemsAround(this.x,this.y,this.z);if(t.materials.forEach((function(t){var i,r,n=null;if(t.isAspect)n=e.findItemByAspectIncludingBackpack(t.id);else{if(_.default.get(t.id).isLiquid){var s=t.quantity;return(null===(i=null==l?void 0:l.containedLiquid)||void 0===i?void 0:i.id)===t.id&&(s-=l.containedLiquidQuantity,l.spendLiquid(l.containedLiquidQuantity)),void(s>0&&e.removeLiquid(t.id,s))}n=e.findItemIncludingBackpack(t.id)}if(!n||n.quantity<t.quantity){var a=t.quantity-(null!==(r=null==n?void 0:n.quantity)&&void 0!==r?r:0);n&&e.removeItemIncludingBackpack(n),b.filter((function(e){return t.isAspect?e.item.def.aspects.indexOf(t.id)>-1:e.item.def.id===t.id})).forEach((function(t){if(0!==a){var i=t.item;i.quantity<=a?(a-=i.quantity,e.game.world.level.removeItem(t.x,t.y,e.z)):(i.quantity-=a,a=0)}}))}else e.reduceFromItemIncludingBackpack(n,t.quantity)})),t.isHousing&&this.placedBlocks++,t.craftSFX&&this.game.audio.playSfx(t.craftSFX),t.waypoint&&this.game.world.level.addWaypoint(t.waypoint,i,r,this.z,!0),t.flooringId)this.game.display.message("You "+n+" a "+_.default.get(t.flooringId).name+".",null,0,0),this.game.world.level.hasTallGrass(i,r,this.z)&&this.game.world.level.chopTallGrass(i,r,this.z),this.game.world.level.setFlooring(i,r,this.z,_.default.get(t.flooringId));else{var E=t.produceQuantity?t.produceQuantity:1,T="You ".concat(n," ").concat(1===E?"a":E," ").concat(_.default.get(t.itemId).name);if(t.placeInWorld||h){var S=new s.default(this.game,t.itemId,E);this.game.world.level.addItem(S,i,r,this.z)}else t.isLiquid?(T+=" in the ".concat(l.def.name),l.containedLiquid===_.default.get(t.itemId)?l.addLiquid(E):l.setLiquid(t.itemId,E),l.freshlyCooked=!0):this.addNewItem(t.itemId,E);T+=".",this.game.display.message(T,m.default.upperCaseFirst(n),this.x,this.y)}return"cook"!==t.type&&this.spendStamina(t.staminaCost),{crafted:!0,craftTime:t.timeCost/60}},t.prototype.isSafeToSleep=function(){return this.getTemperature()>=15},t.prototype.canSleep=function(){return!this.isSwimming},t.prototype.startFishing=function(){var t=x.default.floatNum(1.5,2.5);this.fishingTurns=Math.ceil(t/this.FISHING_TURN_TIME),this.game.input.disableInput(),this.currentAppearanceId="PLAYER_FISHING",this.game.display.onFishingStart(),this.endTurn(.01)},t.prototype.triggerSleep=function(t,e){var i=this;if(this.isSwimming)this.game.display.errorMessage("Cannot sleep while swimming.");else{var r=!this.game.world.sky.isNight(),n=this.isSafeToSleep()?r?"Take a nap?":"Go to sleep?":r?"Take a nap?":"Going to sleep in a temperature under 15º is dangerous, sleep anyways?";this.game.input.prompt(n,(function(){var r=i.getMaxSleepTime(e);c.default.log("maxSleepTime"+r);var n=r*i.HUNGER_INCREASE_PER_HOUR;c.default.log("requiredFood"+n),c.default.log("this.hunger.remaining()"+i.hunger.remaining()),i.hunger.remaining()<=n?i.game.input.prompt("You may be hungry when you wake up, are you sure?",(function(){i.sleep(e,t)})):i.sleep(e,t)}))}},t.prototype.getMaxSleepTime=function(t){var e=this.game.world.currentTime;if(e>=7&&e<=17)return 2.5;var i=0;return i=e>17?31-e:7-e,i+=.3,t||(i+=2),i},t.prototype.sleep=function(t,e){e&&this.forceMoveTo(e,!0,I.WALK);var i=this.game.world.level.getItem(this.x,this.y,this.z);i?"SMALL_BED"===i.def.id?this.currentAppearanceId="PLAYER_SLEEP_BED":"BIG_BED"===i.def.id?this.currentAppearanceId="PLAYER_SLEEP_BIG_BED":"BEDROLL"===i.def.id?this.currentAppearanceId="PLAYER_SLEEP_BEDROLL":"WOODEN_CHAIR"===i.def.id?this.currentAppearanceId="PLAYER_SIT_CHAIR":this.currentAppearanceId="PLAYER_SLEEP_FLOOR":this.currentAppearanceId="PLAYER_SLEEP_FLOOR";var r,n=this.game.world.currentTime;this.game.world.sky.isNight()?(this.sleepType=t?"comfortable":"uncomfortable",r=n>17?31-n:7-n,r+=x.default.floatNum(.1,.3),t||(r+=x.default.floatNum(.8,2))):(r=x.default.floatNum(1.5,2.5),this.sleepType="nap"),this.faintTurns=Math.ceil(r/this.FAINT_TURN_TIME),this.game.input.disableInput(),this.endTurn(.01)},t.prototype.exchange=function(t,e){this.pendingCredits+=t.value*e},t.prototype.executeExchange=function(){this.pendingCredits>0&&(this.credits+=this.pendingCredits,this.game.display.errorMessage("Produce exchanged for "+this.pendingCredits+". Your balance is now "+this.credits+" credits."),this.pendingCredits=0)},t.prototype.canMakeSeeds=function(){return this.currentTool&&void 0!==this.currentTool.def.seedProduce},t.prototype.addSeedsFrom=function(t){var e;e=t.def.seedProduce.fixedQuantity?t.def.seedProduce.quantity:x.default.n(0,t.def.seedProduce.quantity);var i=t.def.seedProduce.itemId;return this.canPickOf(i,e,!0,!0,void 0,t.getWeight(),1===t.quantity?1:void 0)?{quantity:e,itemId:i}:null},t.prototype.makeSeeds=function(){var t=this.currentTool,e=this.addSeedsFrom(t);if(e){var i=_.default.get(e.itemId);this.canPickOf("MASHED_".concat(t.def.id),1,!0,!0,void 0,t.getWeight()+i.weight*e.quantity,(1==t.quantity?1:0)-(this.findItem(e.itemId)?0:1))?(this.game.display.message("You extract "+e.quantity+" "+_.default.get(e.itemId).name+".","Extract ".concat(e.quantity),this.x,this.y),this.reduceFromItem(t,1),this.addNewItem("MASHED_".concat(t.def.id),1),this.addNewItem(e.itemId,e.quantity),this.endTurn(this.getActionTime(I.MAKE_SEEDS))):this.game.display.errorMessage("You wouldn't be able to carry the mashed ".concat(t.def.name,"."))}else this.game.display.errorMessage("You wouldn't be able to carry the seeds.")},t.prototype.doEat=function(t){var e=t.def.edible;if(e){var i=void 0;if(!t.def.seedProduce||(i=this.addSeedsFrom(t))){this.game.audio.playSfx("eat"),this.game.display.message("You ".concat(e.verb," the ").concat(t.def.name,"."),m.default.upperCaseFirst(e.verb),this.x,this.y),e.recoverHunger&&this.hunger.spend(e.recoverHunger);var r=[];e.recoverFatigue&&(this.recoverableStamina>0?(r.push("energized"),this.stamina.recover(e.recoverFatigue),this.recoverableStamina-=e.recoverFatigue):this.game.display.errorMessage("It has no effect in your energy.")),e.recoverHealth&&(r.push("stronger"),this.health.recover(e.recoverHealth)),r.length&&this.game.display.errorMessage("You feel "+r.join(" and ")+"."),this.reduceFromItem(t,1),i&&this.addNewItem(i.itemId,i.quantity),e.canGetSick&&x.default.chance(50)&&this.getSick(8)}else this.game.display.errorMessage("You wouldn't be able to carry the seeds.")}else this.game.display.errorMessage("You can't eat the "+t.def.name+".")},t.prototype.doDrinkFrom=function(t){var e=t.containedLiquid,i=e.edible;if(i){this.game.display.message("You ".concat(e.edible.verb," the ").concat(e.name," from the ").concat(t.def.name,"."),m.default.upperCaseFirst(e.edible.verb),this.x,this.y),i.recoverHunger&&this.hunger.spend(i.recoverHunger);var r=[];i.recoverFatigue&&(this.recoverableStamina>0?(r.push("energized"),this.stamina.recover(i.recoverFatigue),this.recoverableStamina-=i.recoverFatigue):this.game.display.errorMessage("It has no effect in your energy.")),i.recoverHealth&&(r.push("stronger"),this.health.recover(i.recoverHealth)),r.length&&this.game.display.errorMessage("You feel "+r.join(" and ")+"."),i.canGetSick&&x.default.chance(50)&&this.getSick(8),t.spendLiquid(1)}else this.game.display.errorMessage("You can't drink the "+e.name+".")},t.prototype.canEat=function(){return!this.isSwimming||!this.game.world.level.isFlooded(this.x,this.y,this.z)},t.prototype.tryEat=function(t){var e=this;return this.isSwimming&&this.game.world.level.isFlooded(this.x,this.y,this.z)?(this.game.display.errorMessage("You cannot eat while submerged."),null):(t.def.edible?this.game.input.prompt("Do you want to ".concat(t.def.edible.verb," the ").concat(t.def.name,"?"),(function(){e.doEat(t),e.endTurn(e.getActionTime(I.EAT))})):this.game.display.errorMessage("You cannot eat the "+t.def.name+"."),null)},t.prototype.isStarving=function(){return 100==this.hunger.current},t.prototype.isSick=function(){return this.sickMinutes>0},t.prototype.checkHunger=function(t){this.isStarving()&&x.default.chance(4)&&this.game.audio.playSfx("starving"),this.isStarving()&&x.default.chance(10)&&this.health.spend(this.HUNGER_DAMAGE_PER_HOUR*t),this.isStarving()&&g.default.reportEvent("starving")},t.prototype.playFS=function(){if(this.isSwimming&&this.z>0)this.game.audio.playSfxWithVariation("swim_underwater_0",5);else{var t,e=this.game.world.level.getFlooringAt(this.x,this.y,this.z);if(e)t=e.stepAudio;else{var i=this.game.world.level.getTile(this.x,this.y,this.z);i&&(t=i.stepAudio)}t?this.game.audio.playSfx(t.preffix+x.default.n(1,t.variations)):this.game.audio.playSfxWithVariation("fs_cave_0",6)}},t.prototype.playDrop=function(t,e,i){var r,n=this.game.world.level.getFlooringAt(t,e,i),s=this.game.world.level.getTile(t,e,i);n&&n.dropAudio?r=n.dropAudio:s&&s.dropAudio&&(r=s.dropAudio),r&&this.game.audio.playSfx(r.preffix+x.default.n(1,r.variations))},t.prototype.getThingInFront=function(){return this.getThingIn(this.x+this.dx,this.y+this.dy,this.z)},t.prototype.getThingUnder=function(){return this.getThingIn(this.x,this.y,this.z)},t.prototype.getThingIn=function(t,e,i){var r=this.game.world.level.getPlantAt(t,e,i),n=this.game.world.level.getTile(t,e,i),s=this.game.world.level.getItem(t,e,i),a=this.game.world.level.getFlooringAt(t,e,i),l=this.game.world.level.getBeing(t,e,i);return l?{type:o.WorldObjectType.BEING,thing:l,name:"A "+l.race.name,description:l.getExamineDescription()}:s?s.stackedItem?{type:o.WorldObjectType.ITEM,table:s,thing:s.stackedItem,name:s.stackedItem.def.name,description:s.stackedItem.getExamineDescription()}:{type:o.WorldObjectType.ITEM,thing:s,name:s.def.name,description:s.getExamineDescription()}:r?{type:o.WorldObjectType.PLANT,thing:r,name:r.getExamineDescription()}:a?{type:o.WorldObjectType.FLOORING,thing:a,name:a.name,description:a.description}:n?{type:o.WorldObjectType.TILE,thing:n,name:this.game.world.level.getTileDescription(t,e,i),debugDescription:this.game.world.level.getTileDebugDescription(t,e,i)}:null},t.prototype.canExamineClue=function(t){return"read"===t.def.effect&&"TAPE"!==t.def.noteType},t.prototype.examineWorldInFront=function(){var t=this.getThingInFront();if(t){var e="You see: "+t.name;c.default.cheatsEnabled()&&t.debugDescription&&(e+="\n"+t.debugDescription),t.type===o.WorldObjectType.ITEM?this.canExamineClue(t.thing)?this.game.display.showClue(t.thing):this.game.display.examine(t.thing):(t.description&&(e+=", "+t.description),"PEX"==t.thing.id&&(e+=". Your balance is $"+this.credits+"."),this.game.display.errorMessage(e,!0))}},t.prototype.isAxeable=function(t){return t.type===o.WorldObjectType.PLANT&&t.thing.plantDef.isTimber},t.prototype.isBreakable=function(t){return t.type===o.WorldObjectType.TILE&&!!t.thing.breakable},t.prototype.switchMovementMode=function(){this.farmMode=!this.farmMode,this.game.display.message(this.farmMode?"Slow Turn - Movement keys change facing.":"Instant Turn - Movement is immediate.",this.farmMode?"Slow":"Instant",this.x,this.y)},t.prototype.getCraftRecipes=function(){return this.recipes.filter((function(t){return"cook"!=t.type}))},t.prototype.getCookRecipes=function(){return this.recipes.filter((function(t){return"cook"==t.type}))},t.prototype.getPossibleCookRecipes=function(){var t=this;return this.getCookRecipes().filter((function(e){return e.inspirational||0==y.default.compileMaterialsForRecipe(t,t.game,e).missingMaterials.length}))},t.prototype.canCook=function(){if(!this.canCraft())return!1;var t=this.game.world.level.getItem(this.x+this.dx,this.y+this.dy,this.z);return"cook"===(null==t?void 0:t.def.effect)},t.prototype.sacrifice=function(t){t.def.sacrifice?this.canPickOf(t.def.sacrifice.itemId,t.def.sacrifice.quantity,!0,!0,void 0,t.getWeight(),1===t.quantity?1:0)&&(this.reduceFromItem(t,1),this.addNewItem(t.def.sacrifice.itemId,t.def.sacrifice.quantity),this.game.display.message("You sacrifice the "+t.def.name+".","Kill",this.x,this.y)):this.game.display.errorMessage("Cannot be sacrificed.")},t.prototype.selectRecipe=function(t){this.selectedRecipe=t,this.selectedRecipeId=null==t?void 0:t.id},t.prototype.orient=function(){if(!this.currentWaypoint)return"";var t="["+this.currentWaypoint.consecutive+"] "+this.currentWaypoint.description;return d.default.distance(this.x,this.y,this.currentWaypoint.x,this.currentWaypoint.y)<10?t:t+" to the "+d.default.generalDirection(this.x,this.y,this.currentWaypoint.x,this.currentWaypoint.y)},t.prototype.changeWaypoint=function(){var t="Orient lets you switch between points of reference to explore.\n\n";if(0!==this.waypoints.length)if(this.currentWaypoint&&1===this.waypoints.length)this.game.display.errorMessage("".concat(t,"You only have that point of reference (").concat(this.currentWaypoint.description,")"));else{var e=0;this.currentWaypoint&&(e=this.waypoints.indexOf(this.currentWaypoint)),++e>=this.waypoints.length&&(e=0),this.currentWaypoint=this.waypoints[e]}else this.game.display.errorMessage("".concat(t,"You have no points of reference. Explore a bit more."))},t.prototype.addWaypoint=function(t){this.waypoints.push(t),t.consecutive=this.nextWaypointConsecutive++,this.currentWaypoint||(this.currentWaypoint=this.waypoints[0]),"Central Station"===t.description&&(this.flags.foundOffice=!0)},t.prototype.removeWaypoint=function(t){var e=this.waypoints.indexOf(t);this.waypoints.splice(e,1),this.currentWaypoint==t&&(this.currentWaypoint=void 0)},t.prototype.rest=function(){var t=10/60,e=this.game.world.level.getItem(this.x,this.y,this.z);this.recoverableStamina>0?(this.stamina.recover(this.STAMINA_REGEN_PER_HOUR*t),this.recoverableStamina-=this.STAMINA_REGEN_PER_HOUR*t,e&&"WOODEN_CHAIR"===e.def.id?(this.game.display.message("You sit down and rest for a bit.","Sit",this.x,this.y),this.recoverableStamina+=this.STAMINA_REGEN_PER_HOUR*(t/2)):this.game.display.message("You lay down and rest for a bit.","Rest",this.x,this.y),e&&"WOODEN_CHAIR"===e.def.id?this.currentAppearanceId="PLAYER_SIT_CHAIR":"campfire_near"===this.getNearbySound(5)?this.currentAppearanceId="PLAYER_RESTING_CAMPFIRE":this.currentAppearanceId="PLAYER_RESTING",this.endTurn(t)):this.game.display.message("You feel restless.","Restless...",this.x,this.y)},t.prototype.getLastTurnTime=function(){return this.lastTurnTime},t.prototype.getActionCost=function(t){switch(t){case I.WALK:return 1;case I.FISH:return 2;case I.SWIM:return 5;case I.PLANT:case I.FEED:case I.ROW:case I.TILL:case I.PAINT:case I.CUT:return 2;case I.BREAK:return this.isSwimming?12:4;case I.DIG:return 4;case I.CHOP:return 3;case I.KILL:return 4;case I.ATTACK:return 10;default:return 0}},t.prototype.getActionTime=function(t){switch(t){case I.WALK:return.01;case I.SWIM:return 1/60;case I.PLANT:return 5/60;case I.ROW:return.5/60;case I.TILL:return 2/60;case I.PAINT:return 10/60;case I.CUT:return 1/60;case I.BREAK:return 5/60;case I.DIG:return 10/60;case I.CHOP:return.05;case I.KILL:case I.ATTACK:case I.LEASH:case I.GRAB:return 10/60;case I.DRINK:return 2/60;case I.TURN_AROUND:case I.PICK_UP:return.01;case I.HARVEST:return 1/60;case I.CATCH_MONSTER:return 5/60;case I.POUR:return.5/60;case I.DROP:return.01;case I.MAKE_SEEDS:return 2/60;case I.EAT:return 25/60;case I.FEED:return 5/60;case I.PLUNGE:case I.FISH:return 1/60}},t.prototype.setLightAt=function(t,e,i,r){this.lightsMap[t]||(this.lightsMap[t]=[]),this.lightsIntensityMap[t]||(this.lightsIntensityMap[t]=[]),this.lightsMap[t][e]=i,this.lightsIntensityMap[t][e]=r},t.prototype.recalculateLightMaps=function(){var t=this;if(this.lightsIntensityMap=[],this.lightsMap=[],this.currentLight){var e=this.currentLight.def.lightSource.range;v.default[e].forEach((function(i,r){for(var n=0;n<i.length;n++)"x"===i.charAt(n)&&t.setLightAt(n-e,r-e,t.currentLight.def.lightSource.color,t.currentLight.def.lightSource.intensity)}))}},t.prototype.getFillableLiquidInFront=function(){var t;if(this.currentTool&&!this.currentTool.containedLiquid){var e=this.game.world.level,i=this.x+this.dx,r=this.y+this.dy,n=e.getTile(i,r,this.z),s=e.getItem(i,r,this.z);return(null==n?void 0:n.isWater)||this.game.world.level.isFlooded(i,r,this.z)?_.default.get("WATER"):s?((null===(t=s.stackedItem)||void 0===t?void 0:t.containedLiquid)?s.stackedItem:s).containedLiquid:void 0}},t.prototype.canPlunge=function(){var t=this.game.world.level,e=this.x+this.dx,i=this.y+this.dy;return t.isFlooded(this.x,this.y,this.z)?t.isFullWater(this.x,this.y,this.z-1):this.game.world.level.isWater(this.x,this.y,this.z)?!!this.game.world.level.isFullWater(this.x,this.y,this.z)&&this.game.world.level.canWalkTo(this.x,this.y,this.z+1,!0):this.game.world.level.isWater(e,i,this.z)},t.prototype.tryPlunge=function(){if(this.canPerformAction(I.PLUNGE))if(this.leashedAnimal)this.game.display.errorMessage("The leashed ".concat(this.leashedAnimal.race.name," prevents you from swimming."));else if(this.grabbedObject)this.game.display.errorMessage("The grabbed ".concat(this.grabbedObject.def.name," prevents you from swimming."));else{var t=this.game.world.level,e=this.x+this.dx,i=this.y+this.dy;if(t.isFlooded(this.x,this.y,this.z))t.isFullWater(this.x,this.y,this.z-1)?(this.game.audio.playSfx("water_dive_out"),g.default.reportAction("rise"),this.performAction(I.PLUNGE),this.currentAppearanceId="PLAYER_SWIMMING",this.__updatePosition({x:0,y:0,z:-1},this.getActionTime(I.PLUNGE))):this.game.display.errorMessage("Cannot rise here");else if(t.isWater(this.x,this.y,this.z)){if(!t.isFullWater(this.x,this.y,this.z))return this.game.display.message("Cannot plunge","Too shallow.",this.x,this.y),null;if(!t.canWalkTo(this.x,this.y,1,!0))return this.game.display.message("Cannot plunge","Too shallow.",this.x,this.y),null;g.default.reportAction("plunge"),this.game.audio.playSfx("water_dive_in"),this.performAction(I.PLUNGE),this.currentAppearanceId="PLAYER_DIVING",this.isSwimming=!0,this.__updatePosition({x:0,y:0,z:1},this.getActionTime(I.PLUNGE))}else t.isWater(e,i,this.z)?(this.isSwimming=!0,this.game.audio.playSfxWithVariation("water_jump_in_0",3),g.default.reportAction("dive"),this.performAction(I.PLUNGE),this.currentAppearanceId="PLAYER_SWIMMING",this.__updatePosition({x:this.dx,y:this.dy,z:0},this.getActionTime(I.PLUNGE))):this.game.display.errorMessage("Can't jump into the water there")}},t.prototype.getOxygenSpentPerHour=function(){return 50},t.prototype.getDrownedDamagePerHour=function(){return 50},t.prototype.climb=function(){return this.leashedAnimal?(this.game.display.errorMessage("The leashed ".concat(this.leashedAnimal.race.name," prevents you from climbing.")),!1):this.grabbedObject?(this.game.display.errorMessage("The grabbed ".concat(this.grabbedObject.def.name," prevents you from climbing.")),!1):(this.tryMove({x:this.dx,y:this.dy,z:0===this.z?1:-1}),!0)},t.prototype.tryAttackTile=function(t,e,i){var r=this.game.world.level,n=r.getTile(t,e,this.z);if(!n)return null;if(r.damageTile(t,e,this.z,i),r.getTileHP(t,e,this.z).current<=0){if(this.game.display.message("You break down the "+n.name+".",null,0,0),n.breakable.sfx&&this.game.audio.playSfxWithVariation(n.breakable.sfx.prefix,n.breakable.sfx.variations),r.changeTile(t,e,this.z,E.default.get(n.breakable.toTile)),r.removeDamageTile(t,e,this.z),n.breakable.toItem)if("string"==typeof n.breakable.toItem)(a=x.default.n(1,n.breakable.itemQuantity))&&r.addItem(new s.default(this.game,n.breakable.toItem,a),t,e,this.z);else{var a,o=x.default.weightedFrom(n.breakable.toItem,(function(t){return t.chance}),(function(t){return t}),100);o&&(a=x.default.n(1,o.itemQuantity))&&r.addItem(new s.default(this.game,o.itemId,a),t,e,this.z)}}else this.game.display.message("You hit the "+n.name+".","Hit!",t,e),this.game.audio.playSfx("mine_01,mine_02,mine_03,mine_04");return this.performAction(I.BREAK),{hours:this.getActionTime(I.BREAK)}},t.prototype.tryAttack=function(){var t,e;if(!this.canPerformAction(I.ATTACK))return null;var i=this.x+this.dx,r=this.y+this.dy,n=this.game.world.level.getBeing(i,r,this.z);if(!n)return this.game.display.errorMessage("Nothing there."),null;var s=null!==(e=null===(t=this.currentTool)||void 0===t?void 0:t.def.damage)&&void 0!==e?e:1;return this.performAction(I.ATTACK),n.damage(s),n.hitPoints<=0&&(this.game.display.message("You kill the "+n.race.name+".","Kill",n.x,n.y),n.killBeing()),{hours:this.getActionTime(I.ATTACK)}},t.prototype.getTemperature=function(){var t=this.game.world.level.getTemperature(this.x,this.y,this.z);return this.isSwimming&&(this.game.world.level.isWinter?t-=10:t-=5),t},t}();e.default=A;var I,R=function(){function t(t,e,i,r,n){this.actionType=t,this.description=i,this.shortDescription=null!=r?r:i,this.params=n,this.priority=e}return Object.defineProperty(t.prototype,"actionDescription",{get:function(){if(this.description)return this.description;switch(this.actionType){case I.BREAK:return"Break";case I.CATCH_MONSTER:return"Catch";case I.CHOP:return"Chop";case I.KILL:return"Stab";case I.ATTACK:return"Attack";case I.LEASH:return"Leash";case I.GRAB:return"Grab";case I.CUT:return"Cut";case I.DIG:return"Dig";case I.DRINK:return"Drink";case I.DROP:return"Drop";case I.EAT:return"Eat";case I.HARVEST:return"Harvest";case I.MAKE_SEEDS:return"Mash";case I.PAINT:return"Paint";case I.PICK_UP:return"Pick Up";case I.PLANT:return"Plant";case I.POUR:return"Pour";case I.ROW:return"Row";case I.FEED:return"Feed";case I.TILL:return"Till";case I.TURN_AROUND:return"Turn Around";case I.WALK:return"Walk";case I.SWIM:return"Swim";case I.SLEEP:return"Sleep";case I.CRAFT:return"Craft";case I.UI_IMAGINE:return"Select";case I.UI_EXAMINE:return"Examine";case I.UI_EXAMINE_WORLD:return"Examine World";case I.UI_SELECT_RECIPE:return"Cook";case I.USE:return"Use";case I.PLUNGE:return"Plunge";case I.ROTATE:return"Rotate"}},enumerable:!1,configurable:!0}),t}();e.ExecutableAction=R,function(t){t[t.WALK=0]="WALK",t[t.SWIM=1]="SWIM",t[t.PLANT=2]="PLANT",t[t.ROW=3]="ROW",t[t.CUT=4]="CUT",t[t.BREAK=5]="BREAK",t[t.TILL=6]="TILL",t[t.DIG=7]="DIG",t[t.CHOP=8]="CHOP",t[t.PAINT=9]="PAINT",t[t.DRINK=10]="DRINK",t[t.TURN_AROUND=11]="TURN_AROUND",t[t.PICK_UP=12]="PICK_UP",t[t.HARVEST=13]="HARVEST",t[t.CATCH_MONSTER=14]="CATCH_MONSTER",t[t.POUR=15]="POUR",t[t.DROP=16]="DROP",t[t.MAKE_SEEDS=17]="MAKE_SEEDS",t[t.EAT=18]="EAT",t[t.FEED=19]="FEED",t[t.FISH=20]="FISH",t[t.SLEEP=21]="SLEEP",t[t.CRAFT=22]="CRAFT",t[t.UI_IMAGINE=23]="UI_IMAGINE",t[t.UI_EXAMINE=24]="UI_EXAMINE",t[t.UI_EXAMINE_WORLD=25]="UI_EXAMINE_WORLD",t[t.UI_SELECT_RECIPE=26]="UI_SELECT_RECIPE",t[t.UI_VIEW_JOURNAL=27]="UI_VIEW_JOURNAL",t[t.UI_VIEW_ACTIVITIES=28]="UI_VIEW_ACTIVITIES",t[t.UI_ORIENT=29]="UI_ORIENT",t[t.USE=30]="USE",t[t.USE_IN_WORLD=31]="USE_IN_WORLD",t[t.KILL=32]="KILL",t[t.ATTACK=33]="ATTACK",t[t.LEASH=34]="LEASH",t[t.GRAB=35]="GRAB",t[t.PLUNGE=36]="PLUNGE",t[t.ROTATE=37]="ROTATE"}(I=e.PlayerAction||(e.PlayerAction={})),S.registerClass("Player",A,{transients:{recipes:!0,selectedRecipe:!0,lightsMap:!0,lightsIntensityMap:!0},reviver:function(t){T.fillPlayerToRevive(t),t.recipes=t.__serialData.recipeIds.map((function(t){return r.default.get(t)})),t.selectedRecipe=r.default.get(t.selectedRecipeId),t.recalculateLightMaps()},prepare:function(t){return{recipeIds:t.recipes.map((function(t){return t.id}))}}})},449:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8018),n=function(){function t(){this.crops=[],this.animals=[],this.plants=[],this._c=r.register("PlayerProgression")}return t.prototype.hasCrop=function(t){return!!this.crops.find((function(e){return e===t}))},t.prototype.addCrop=function(t){this.crops.push(t)},t.prototype.hasPlant=function(t){return!!this.plants.find((function(e){return e===t}))},t.prototype.addPlant=function(t){this.plants.push(t)},t.prototype.hasAnimal=function(t){return!!this.animals.find((function(e){return e===t}))},t.prototype.addAnimal=function(t){this.animals.push(t)},t}();r.registerClass("PlayerProgression",n),e.default=n},933:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8018),n=i(3945),s=4478595,a=6508420,o=14728328,l=11582926,h=16777215,u=16549956,c=12421782,d=5001129,p=5.5,f=5.9,m=6.5,g=17.5,_=18.5,y=19.5,v=function(){function t(t){this.world=t,this._c=r.register("Sky")}return t.prototype.getSkylightPower=function(){var t=this.world.currentTime;return t>_||t<=5?4:this.isTwilight()?7:10},t.prototype.isTwilight=function(){var t=this.world.currentTime;return!this.isNight()&&(t<=7||t>=g)},t.prototype.isNight=function(){var t=this.world.currentTime;return t<=5||t>y},t.prototype.isDawn=function(){var t=this.world.currentTime;return t>=5&&t<=p},t.prototype.isNightfall=function(){var t=this.world.currentTime;return t>=19&&t<=y},t.prototype.getDawnLerp=function(){return(this.world.currentTime-5)/.5},t.prototype.getNightfallLerp=function(){return(this.world.currentTime-19)/.5},t.prototype.getSkyColor=function(){if(this.isNight())return s;if(this.isTwilight()){var t,e,i,r=this.world.currentTime;return r<p?(t=s,e=a,i=this.getDawnLerp()):r<f?(t=a,e=o,i=(r-p)/.40000000000000036):r<m?(t=o,e=l,i=(r-f)/.5999999999999996):r<7?(t=l,e=h,i=(r-m)/.5):r<18?(t=h,e=u,i=(r-g)/.5):r<_?(t=u,e=c,i=(r-18)/.5):r<19?(t=c,e=d,i=(r-_)/.5):(t=d,e=s,i=this.getNightfallLerp()),n.default.interpolate(t,e,i)}},t}();e.default=v,r.registerClass("Sky",v)},3174:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8018),n=function(){function t(t){this.max=t,this.current=t,this.penalty=0,this._c=r.register("Stat")}return t.prototype.recoverAll=function(){this.current=this.currentMax()},t.prototype.spend=function(t){this.current-=t,this.current<0&&(this.current=0)},t.prototype.recover=function(t){this.current+=t,this.current>this.currentMax()&&(this.current=this.currentMax())},t.prototype.replenish=function(){this.current=this.currentMax()},t.prototype.getPercentage=function(){return this.current/this.currentMax()},t.prototype.currentMax=function(){return this.max-this.penalty},t.prototype.addPenalty=function(t){this.penalty+=t,this.penalty>this.max&&(this.penalty=this.max),this.current>this.max-this.penalty&&(this.current=this.max-this.penalty)},t.prototype.reducePenalty=function(t){this.penalty-=t,this.penalty<0&&(this.penalty=0)},t.prototype.remaining=function(){return this.currentMax()-this.current},t.prototype.setMax=function(t){this.max=t},t}();e.default=n,r.registerClass("Stat",n)},1518:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Season=void 0;var r,n=i(3729),s=i(771),a=i(8059),o=i(933),l=i(4738),h=i(8018);!function(t){t[t.SPRING=0]="SPRING",t[t.SUMMER=1]="SUMMER",t[t.FALL=2]="FALL",t[t.WINTER=3]="WINTER",t[t.MUTALITE=4]="MUTALITE"}(r=e.Season||(e.Season={}));var u=function(){function t(){}return t.prototype.init=function(t){this._c=h.register("World"),this.levels={_c:h.register("World.levels")},this.game=t,this.player=t.player,this.season=r.SPRING,this.loadLevel("testLevel"+l.default.n(0,1e3)),this.currentTime=7.34,this.spawnCounter=0,this.timeToPlay=10,this.sky=new o.default(this)},t.prototype.loadLevel=function(t){this.levels[t]?(this.level.exitX=this.player.x,this.level.exitY=this.player.y,this.level=this.levels[t],this.player.x=this.level.exitX,this.player.y=this.level.exitY):(this.level?(this.level.exitX=this.player.x,this.level.exitY=this.player.y,this.level.id,this.level=new a.default(this.game,t),(new n.default).generateLevel(this.level)):(this.level=new a.default(this.game,t),this.level.isWinter=this.isWinter,(new n.default).generateLevel(this.level)),this.levels[t]=this.level),this.level.playAmbience()},t.prototype.passTime=function(t){this.game.audio.kickstartMelodies();var e=Math.floor(this.currentTime);if(this.currentTime+=t,this.currentTime>=24&&(this.currentTime=0),this.spawnCounter-=t,this.spawnCounter<0){this.spawnCounter=l.default.floatNum(.2,2);for(var i=s.default.getRadians(this.game.player.dx,this.game.player.dy),r=this.game.player.getSightRange()+1,n=Math.cos(i),a=Math.sin(i),o=!1,h=0;h<r;++h){var u=Math.round(n*h),c=Math.round(a*h);if(!this.level.player.canSee(u,c)&&this.level.canPlaceAnimalAt(this.level.player.x+u,this.level.player.y+c,this.level.player.z)){o=this.level.tryAddAnimalAt(this.level.player.x+u,this.level.player.y+c,this.level.player.z,!1);break}}o||(o=this.level.tryAddAnimalAt(this.level.player.x+Math.round(n*r),this.level.player.y+Math.round(a*r),this.level.player.z,!0)),o||(this.spawnCounter=.1)}var d=Math.floor(this.currentTime);if(e!=d)switch(d){case 3:this.level.player.executeExchange(),this.isWinter&&this.level.winterNight();break;case 0:this.level.player.isFainted()||this.level.player.isFishing()||this.game.display.errorMessage("It's getting late!"),this.level.player.dayCounter++}},t.prototype.checkAmbienceCrossfade=function(){if(this.player.isSwimming&&this.player.z>0)return this.game.audio.playSfx(this.level.getUnderwaterAmbience(),!0),this.game.audio.setSfxVolume(this.level.getUnderwaterAmbience(),1),this.game.audio.stopSfx(this.level.getDayAmbience()),void this.game.audio.stopSfx(this.level.getNightAmbience());if(this.game.audio.stopSfx(this.level.getUnderwaterAmbience()),this.sky.isDawn()){this.game.audio.playSfx(this.level.getNightAmbience(),!0),this.game.audio.playSfx(this.level.getDayAmbience(),!0);var t=this.sky.getDawnLerp();this.game.audio.setSfxVolume(this.level.getDayAmbience(),t),this.game.audio.setSfxVolume(this.level.getNightAmbience(),1-t)}else if(this.sky.isNightfall()){this.game.audio.playSfx(this.level.getNightAmbience(),!0),this.game.audio.playSfx(this.level.getDayAmbience(),!0);var e=this.sky.getNightfallLerp();this.game.audio.setSfxVolume(this.level.getDayAmbience(),1-e),this.game.audio.setSfxVolume(this.level.getNightAmbience(),e)}else this.sky.isNight()?(this.game.audio.playSfx(this.level.getNightAmbience(),!0),this.game.audio.setSfxVolume(this.level.getNightAmbience(),1),this.game.audio.stopSfx(this.level.getDayAmbience())):(this.game.audio.playSfx(this.level.getDayAmbience(),!0),this.game.audio.setSfxVolume(this.level.getDayAmbience(),1),this.game.audio.stopSfx(this.level.getNightAmbience()))},t}();e.default=u,h.registerClass("World",u)},7168:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4775),n=i(5402),s=i(6041),a=i(4369),o=i(8951),l=i(4095),h=i(7239),u=i(7591),c=["POKEKO_SEED","ISNIUM_SEED","AULNE_SEED","OUVLURIN_SEED","HIBISCUS_SEED","KADINE_SEED","SAPONAIRE_SEED","SAUGE_SEED","GRORN_SEED","FYOLE_SEED"],d=["RED_RICE","GIANT_WHEAT"],p=["GARLIC","ONION","CARROT","AVOCADO","SUGARCANE","COFFEE_GRAIN"],f=["HONEY","OIL","SUGAR","BUTTER","FLOUR"],m=["BEDROLL","KNIFE","LEASH","SHOVEL","PICKAXE","STEEL_POT","OFFICE_KEY"],g=function(){function t(){}return t.prototype.initialize=function(){this.clueRegistry=new o.default,this.clueRegistry.fillWithNumbers(0,52),this.toolRegistry=new o.default,this.toolRegistry.fill(m),this.berrySeedsRegistry=new o.default,this.berrySeedsRegistry.fill(c),this.rareIngredientsRegistry=new o.default,this.rareIngredientsRegistry.fill(d),this.refinedIngredientsRegistry=new o.default,this.refinedIngredientsRegistry.fill(f),this.commonIngredientsRegistry=new o.default,this.commonIngredientsRegistry.fill(p),c.concat(d).concat(p).concat(f).concat(m).forEach((function(t){if(!r.default.get(t))throw new Error("Invalid reward ["+t+"]")}))},t.prototype.placeBuildings=function(t,e,i){var r=this;i.forEach((function(i){r.placeTemplateBuilding(t,e,i),r.snap(t,e)}))},t.prototype.placeTemplateBuilding=function(t,e,i){var r=n.default.templates[i.templateId];0===e&&this.placeTemplateMap(r.map,r,t,e,i),1===e&&r.map2&&this.placeTemplateMap(r.map2,r,t,e,i)},t.prototype.placeTemplateMap=function(t,e,i,o,h){for(var u,c,d=this,p=0;p<t[0].length;p++)for(var f=function(f){var g=t[f].charAt(p);if(" "==g)return"continue";var _=h.x+p,y=h.y+f,v=null!==(c=null===(u=e.charMap)||void 0===u?void 0:u[g])&&void 0!==c?c:n.default.charMap[g];if(!v)throw new Error("Unmapped character ["+g+"] for map "+e.id+" on line ["+e.map[f]+"]");var x=s.default.get(v.id);if(!x)throw new Error("Invalid tile ["+v.id+"]");if(i.changeTile(_,y,o,x),i.drain(_,y,o),v.flooringId){var b=r.default.get(v.flooringId);if(!b)throw new Error("Invalid flooring ["+v.flooringId+"]");i.setFlooring(_,y,o,b)}if(v.itemId){var E=m.resolveItemId(v.itemId),T=new a.default(i.game,E,1);i.addItemProcgen(T,_,y,o)}if(v.beingId){var S=new l.default(i.game,i,v.beingId);S.prepopulated=!0,i.addBeing(S,_,y,o)}if(v.stackedItemId){var w=i.getItem(_,y,o);if(!w)throw new Error("No table for stacked item ["+v.stackedItemId+"]");var A=m.resolveItemId(v.stackedItemId);T=new a.default(i.game,A,1),w.stackedItem=T}if(v.itemContents){var I=i.getItem(_,y,o);if(!I)throw new Error("No container for item contents ["+v.itemContents.join(",")+"]");v.itemContents.forEach((function(t){var e=d.resolveItemId(t),r=new a.default(i.game,e,1);I.addItem(r,!1)}))}v.buildingMarker&&(i.addWaypoint(v.buildingMarker.description,_,y,o,!1),i.addBuildingInfo(v.buildingMarker.type,_,y))},m=this,g=0;g<t.length;g++)f(g)},t.prototype.resolveItemId=function(t){return"$CLUE"==t?"$CLUE_"+this.clueRegistry.next():"$BERRY_SEED"==t?this.berrySeedsRegistry.next():"$RARE_INGREDIENT"==t?this.rareIngredientsRegistry.next():"$COMMON_INGREDIENT"==t?this.commonIngredientsRegistry.next():"$REFINED_INGREDIENT"==t?this.refinedIngredientsRegistry.next():"$TOOL"==t?this.toolRegistry.next():t},t.prototype.snap=function(t,e){u.enabled&&(new h({canvasId:"mapPreview",zoomLevel:1,mapWidth:t.getWidth(),mapHeight:t.getHeight(),colorFunction:function(t,i,r){return t.getFlooringAt(i,r,e)?"#FF0000":t.getTile(i,r,e).previewColor}}).renderMap(t),u.addFrame("mapPreview"))},t}();e.default=g},6953:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8866),n=i(4738),s=function(){function t(){}return t.prototype.generate=function(t){for(var e=[],i=[],s=[],a=1;a<7;a++)i.push([a,1]),i.push([a,7]);for(var o=2;o<6;o++)i.push([1,o]),i.push([7,o]);for(a=2;a<6;a++)s.push([a,2]),s.push([a,6]);for(o=3;o<5;o++)s.push([2,o]),s.push([6,o]);n.default.shuffle(s),n.default.shuffle(i);for(var l=0,h=0,u=0;u<2;u++)e.push(this.addStation(r.BuildingType.STATION,"STATION",s[l][0],s[l][1])),l++;for(u=0;u<3;u++)e.push({type:r.BuildingType.CABIN,x:64*s[l][0]+n.default.n(0,32),y:64*s[l][1]+n.default.n(0,32),templateId:"HOUSE"}),l++;for(u=0;u<5;u++)e.push(this.addStation(r.BuildingType.STATION,"STATION",i[h][0],i[h][1])),h++;return e.push(this.addStation(r.BuildingType.OFFICES,"OFFICE",i[h][0],i[h][1])),h++,e.push({type:r.BuildingType.CABIN,x:254,y:244,templateId:"MY_HOUSE"}),t&&(e.push({type:r.BuildingType.CABIN,x:64*i[h][0]+n.default.n(0,32),y:64*i[h][1]+n.default.n(0,32),templateId:"WORKSHOP"}),h++),e.push({type:r.BuildingType.STATION,x:220,y:254,templateId:"RUINED_STATION"}),e.push({x:254,y:264,templateId:"LAKE"}),e},t.prototype.addStation=function(t,e,i,r){return{type:t,x:64*i+n.default.n(0,32),y:64*r+n.default.n(0,32),templateId:e}},t}();e.default=s},4676:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i,r,n,s){for(var a=0;a<r;a++){for(var o=[],l=0;l<t.length;l++)o[l]=[];for(l=0;l<t.length;l++)for(var h=0;h<t[l].length;h++){for(var u={},c=l-1;c<=l+1;c++)for(var d=h-1;d<=h+1;d++)if((!n||c==l||d==h)&&c>0&&c<t.length&&d>0&&d<t[l].length){var p=i(t[c][d]);u[p]?u[p]++:u[p]=1}var f=e(t[l][h],u);o[l][h]=f||t[l][h]}t=o,s&&s(t)}return t}},3729:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4369),n=i(5946),s=i(6041),a=i(6786),o=i(6373),l=i(6028),h=i(4095),u=i(2062),c=i(6243),d=i(6953),p=i(7168),f=i(2393),m=i(4775),g=i(7837),_=i(702),y=(i(7239),i(1845)),v=(i(7591),512),x=function(){function t(){}return t.prototype.generateLevel=function(t){var e=(new d.default).generate(t.isWinter),i=n.default.getInstance().generate(e),r=f.default.seed(i.sectors,0),s=y.filter(r.map),a=c.default.i().populate(s,i.sectors,0),o=new p.default;o.initialize(),t.setSectorsMap(i.sectors,0),i.coldCaveChannels.forEach((function(e){return t.addColdCaveChannel(e)})),this.placeTiles(t,0,s),t.setCurrents(i.currents,0),t.initPathfindingGrid(0),o.placeBuildings(t,0,e),this.placePlants(t,0,r.plants),this.placeItems(t,0,r.items),this.placeAnimals(t,0,a),t.scatterRaces(),t.calculateMountainMaps();var l=g.default.generate(t);t.setSectorsMap(l,1);var h=f.default.seed(l,1),u=_.default.filter(h.map),v=c.default.i().populate(u,l,1);t.setSectorsMap(l,1),this.placeTiles(t,1,u),t.initPathfindingGrid(1),o.placeBuildings(t,1,e),this.placePlants(t,1,h.plants),this.placeItems(t,1,h.items),this.placeAnimals(t,1,v),this.placeDeepWater(t,0),t.recalculateLightMaps();for(var x=0;x<5;x++);m.default.renderMaps(),t.isWinter&&t.winterize()},t.prototype.placePlants=function(t,e,i){for(var r=0;r<v;r++)for(var n=0;n<v;n++){var s=i[r][n];if(s&&t.isGroundTile(r,n,e)&&t.canWalkTo(r,n,e)&&!t.getFlooringAt(r,n,e)&&!t.getItem(r,n,e)){var l=a.default.get(s);if(!l)throw new Error("Invalid plantType ["+s+"]");t.addPlant(r,n,e,new o.default(t.game,l,-1))}}},t.prototype.placeAnimals=function(t,e,i){for(var r=0;r<v;r++)for(var n=0;n<v;n++){var s=i[r]?i[r][n]:void 0;if(s&&t.isGroundTile(r,n,e)&&t.canWalkTo(r,n,e)&&!t.getFlooringAt(r,n,e)){if(!l.default.get(s))throw new Error("Invalid race ["+s+"]");var a=new h.default(t.game,t,s);a.prepopulated=!0,u.default.log("Added a ".concat(s)),t.addBeing(a,r,n,e)}}},t.prototype.placeItems=function(t,e,i){for(var n=0;n<v;n++)for(var s=0;s<v;s++){var a=i[n][s];if(a){if(!t.isGroundTile(n,s,e)||!t.canWalkTo(n,s,e)||t.getFlooringAt(n,s,e))continue;if(!m.default.get(a))throw new Error("Invalid itemDef ["+a+"]");t.addItemProcgen(new r.default(t.game,a,1),n,s,e)}}},t.prototype.placeTiles=function(t,e,i){for(var r=[],n=0;n<v;n++){r[n]=[];for(var a=0;a<v;a++){var o=s.default.get(i[n][a]);if(!o)throw new Error("Invalid tile ["+i[n][a]+"]");r[n][a]=o}}t.setTileMap(r,e)},t.prototype.placeDeepWater=function(t,e){for(var i=0;i<v;i++)for(var r=0;r<v;r++)"WATER"==t.getTile(i,r,e).id&&t.canWalkTo(i,r,e+1,!0)?t.changeTileQuick(i,r,e,s.default.get("DEEP_WATER")):"RAPID_WATER"==t.getTile(i,r,e).id&&t.canWalkTo(i,r,e+1,!0)&&t.changeTileQuick(i,r,e,s.default.get("RAPID_DEEP_WATER"))},t}();e.default=x},6243:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4738),n=i(5946),s=[{raceId:"TORTUX",weight:1},{raceId:"MEKI",weight:5},{raceId:"FOXFORO",weight:5},{raceId:"LAVILA",weight:50}],a=[{raceId:"FOXFORO",weight:10},{raceId:"LAVILA",weight:50}],o=[{raceId:"PUGSH",weight:10}],l=function(){function t(){this.dryCavernAnimals=this.fill(s,1e4),this.coldCavernAnimals=this.fill(a,1e4),this.underwaterCavernAnimals=this.fill(o,1e4)}return t.i=function(){return this.singleton||(this.singleton=new t),this.singleton},t.prototype.populate=function(t,e,i){for(var r=[],n=0;n<t.length;n++)for(var s=0;s<t[0].length;s++){var a=0===i?this.getDryCavernAnimal(t[n][s],e[n][s]):this.getUnderwaterCavernAnimal(t[n][s],e[n][s]);a&&(r[n]||(r[n]=[]),r[n][s]=a)}return r},t.prototype.getDryCavernAnimal=function(t,e){return"STONE_FLOOR"===t?this.pickAnimal(this.dryCavernAnimals):"ROCK_FLOOR"===t?this.pickAnimal(this.coldCavernAnimals):void 0},t.prototype.getUnderwaterCavernAnimal=function(t,e){if("STONE_FLOOR"===t&&e.type!=n.SectorType.underwaterColdCaveFloor)return this.pickAnimal(this.underwaterCavernAnimals)},t.prototype.pickAnimal=function(t){return r.default.weightedFrom(t,(function(t){return t.weight}),(function(t){return t.raceId}),1e4)},t.prototype.fill=function(t,e){var i=t.reduce((function(t,e){return t+e.weight}),0);return t.push({raceId:void 0,weight:e-i}),t},t}();e.default=l},5946:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sector=e.SectorType=void 0;var r,n=i(8018),s=i(5402),a=i(771),o=i(9334),l=i(771),h=i(4738);!function(t){t.grassland="grassland",t.forest="forest",t.cavern="cavern",t.coldCave="coldCave",t.lake="lake",t.caveLake="caveLake",t.river="river",t.caveRiver="caveRiver",t.underwaterFloor="underwaterFloor",t.underwaterColdCaveFloor="underwaterColdCaveFloor",t.underground="underground",t.mountainFrame="mountainFrame",t.mountainBorder="mountainBorder",t.coldMountainBorder="coldMountainBorder",t.berryForest="berryForest",t.builtArea="builtArea"}(r=e.SectorType||(e.SectorType={}));var u=i(7239),c=i(7591),d=function(t){this._c=n.register("Sector"),this.type=t};e.Sector=d,n.registerClass("Sector",d);var p=function(){function t(){}return t.getInstance=function(){return t.instance=t.instance||new t,t.instance},t.prototype.generate=function(t){for(var e={sectors:[],currents:[],coldCaveChannels:[]},i=new d(r.grassland),a=new d(r.forest),o=new d(r.cavern),l=new d(r.coldCave),u=new d(r.mountainBorder),c=new d(r.coldMountainBorder),p=new d(r.mountainFrame),f=new d(r.lake),m=new d(r.river),g=new d(r.caveLake),_=0;_<512;_++){e.sectors[_]=[],e.currents[_]=[];for(var y=0;y<512;y++)e.sectors[_][y]=i}for(var v=0;v<64;v++)this.place(e.sectors,a,{scale:1,border:0}),v%16==0&&this.snap(e);t.forEach((function(t){var i,n=new d(r.builtArea);n.name=null===(i=t.type)||void 0===i?void 0:i.toString();for(var a=s.default.templates[t.templateId].map,o=t.x;o<t.x+a[0].length;o++)for(var l=t.y;l<t.y+a.length;l++)e.sectors[o][l]=n})),this.snap(e);var x=[],b=h.default.n(2,3);for(v=0;v<b;v++){var E=this.place(e.sectors,o,{scale:2,rim:{width:15,sector:u},abortOnSectorType:[r.builtArea]});E?(x.push(E),this.snap(e)):v--}for(v=x.length;v<24;v++){var T=h.default.from(x),S=h.default.floatNum(0,2*Math.PI),w=T.x+Math.round(Math.cos(S)*T.radius),A=T.y+Math.round(Math.sin(S)*T.radius),I=this.place(e.sectors,o,{location:{x:w,y:A},scale:1.5,rim:{width:15,sector:u},abortOnSectorType:[r.builtArea]});I&&(x.push(I),this.snap(e))}var R=[],C=h.default.n(1,2);for(v=0;v<C;v++){var M=this.place(e.sectors,l,{scale:2,rim:{width:15,sector:c},abortOnSectorType:[r.builtArea,r.cavern]});M?(R.push(M),this.snap(e)):v--}for(v=0;v<C;v++){var O=R[v];S=h.default.floatNum(0,2*Math.PI),w=O.x+Math.round(Math.cos(S)*O.radius),A=O.y+Math.round(Math.sin(S)*O.radius),this.place(e.sectors,f,{radius:10,location:{x:w,y:A},abortOnSectorType:[r.builtArea,r.mountainBorder,r.cavern]})?this.snap(e):v--}for(v=R.length;v<24;v++){T=h.default.from(R),S=h.default.floatNum(0,2*Math.PI),w=T.x+Math.round(Math.cos(S)*T.radius),A=T.y+Math.round(Math.sin(S)*T.radius);var P=this.place(e.sectors,l,{location:{x:w,y:A},scale:1.5,rim:{width:15,sector:c},abortOnSectorType:[r.builtArea,r.lake]});P&&(R.push(P),this.snap(e))}var k=h.default.n(3,4);for(v=0;v<k;v++)this.place(e.sectors,f,{abortOnSectorType:[r.builtArea,r.mountainBorder,r.coldMountainBorder,r.cavern,r.coldCave,r.caveLake]})?this.snap(e):v--;for(v=0;v<1;v++)this.placeRiver(e.sectors,e.currents,m)||v--;var D=["FYOLE_SHRUB","SAUGE_SHRUB","AULNE_SHRUB","ISNIUM_SHRUB"];for(v=0;v<4;v++){var N=new d(r.berryForest);N.params={_c:n.setSafe(),berryShrubId:D[v]},this.place(e.sectors,N,{scale:.3,border:0,abortOnSectorType:[r.cavern,r.coldCave]})?v%16==0&&this.snap(e):v--}for(v=0;v<C;v++){O=R[v],S=h.default.floatNum(0,2*Math.PI);var L=O.x,F=O.y,B={xa:L,ya:F,xb:L+Math.round(Math.cos(S)*O.radius),yb:F+Math.round(Math.sin(S)*O.radius)};e.coldCaveChannels.push(B),this.placeSimpleBlob(e.sectors,g,B.xa,B.ya,4),this.placeSimpleBlob(e.sectors,g,B.xb,B.yb,4,{additive:{over:[r.grassland,r.forest],put:f},ignoreSectorType:r.lake})}for(var U=0;U<512;U++)e.sectors[U][0]=p,e.sectors[U][511]=p,h.default.chance(70)&&(e.sectors[U][1]=p),h.default.chance(70)&&(e.sectors[U][510]=p);for(var G=0;G<512;G++)e.sectors[0][G]=p,e.sectors[511][G]=p,h.default.chance(70)&&(e.sectors[1][G]=p),h.default.chance(70)&&(e.sectors[510][G]=p);return this.snap(e),this.place(e.sectors,i,{location:{x:224,y:224}}),this.snap(e),this.debugPrint(e.sectors),e},t.prototype.placeRiver=function(t,e,i){var n=h.default.n(40,60),s=0,a=0;h.default.chance(50)?(s=h.default.chance(50)?-40:552,a=h.default.n(0,512)):(s=h.default.n(0,512),a=h.default.chance(50)?-40:552);for(var u=h.default.n(0,2*Math.PI),c=[],d=60,p=0;p<n;p++){var f=s+Math.ceil(Math.cos(u)*d),m=a+Math.ceil(Math.sin(u)*d);if(p<20&&!this.isValid(f,m))return!1;u+=h.default.n(0,Math.PI/12)*(h.default.chance(50)?1:-1),c.push({xa:s,ya:a,xb:f,yb:m}),d=h.default.n(15,30),s=f,a=m}for(var g=[],_=0,y=c;_<y.length;_++)for(var v=y[_],x=(0,o.default)({x:v.xa,y:v.ya},{x:v.xb,y:v.yb}),b=h.default.n(5,10),E=l.default.generalCardinalDirection(v.xa,v.ya,v.xb,v.yb),T=0,S=x;T<S.length;T++){var w=S[T];if(!this.placeRiverBlob(g,t,i,E,w.x,w.y,b,{abortOnSectorType:[r.builtArea,r.mountainBorder,r.coldMountainBorder,r.cavern,r.coldCave],ignoreSectorType:r.lake}))return!1}return g.forEach((function(i){t[i.x][i.y]=i.s,e[i.x][i.y]=i.c})),!0},t.prototype.isValid=function(t,e){return t>=0&&t<512&&e>=0&&e<512},t.prototype.placeRiverBlob=function(t,e,i,r,n,s,o,l){for(var h,u,c=n-o;c<n+o+1;c++)for(var d=s-o;d<s+o+1;d++)if(this.isValid(c,d)&&Math.ceil(a.default.distance(n,s,c,d))<=o){if(l.abortOnSectorType&&l.abortOnSectorType.indexOf(null===(h=e[c][d])||void 0===h?void 0:h.type)>-1)return!1;if((null===(u=e[c][d])||void 0===u?void 0:u.type)===l.ignoreSectorType)continue;var p=i;l.additive&&l.additive.over.indexOf(e[c][d].type)>-1&&(p=l.additive.put),t.push({x:c,y:d,s:p,c:r})}return!0},t.prototype.placeSimpleBlob=function(t,e,i,r,n,s){for(var o,l=i-n;l<i+n+1;l++)for(var h=r-n;h<r+n+1;h++)if(this.isValid(l,h)&&Math.ceil(a.default.distance(i,r,l,h))<=n){if((null===(o=t[l][h])||void 0===o?void 0:o.type)===(null==s?void 0:s.ignoreSectorType))continue;var u=e;(null==s?void 0:s.additive)&&s.additive.over.indexOf(t[l][h].type)>-1&&(u=s.additive.put),t[l][h]=u}},t.prototype.place=function(t,e,i){var r,n,s,o=(null==i?void 0:i.scale)||1,l=null!==(r=null==i?void 0:i.border)&&void 0!==r?r:32,u=Math.floor(32*o),c=Math.floor(24*o),d=Math.floor(16*o),p=h.default.n(8,12),f=null!==(n=null==i?void 0:i.location)&&void 0!==n?n:{x:h.default.n(l,511-l-32),y:h.default.n(l,511-l-32),radius:0};f.radius||(f.radius=null!==(s=null==i?void 0:i.radius)&&void 0!==s?s:h.default.n(c,u));for(var m=null==i?void 0:i.rim,g=[],_=0;_<p;_++)for(var y=0==_?f.radius:h.default.n(d,c),v=0==_?f.x:f.x+h.default.n(-d,d),x=0==_?f.y:f.y+h.default.n(-d,d),b=m?y-m.width:0,E=0;E<2*y;E++)for(var T=0;T<2*y;T++){var S=Math.floor(a.default.clamp(v+E,511)),w=Math.floor(a.default.clamp(x+T,511)),A=Math.ceil(a.default.distance(E,T,y,y));if(A<=y){if(i.abortOnSectorType&&i.abortOnSectorType.indexOf(t[S][w].type)>-1)return null;var I=e;i.additive&&i.additive.over.indexOf(t[S][w].type)>-1&&(I=i.additive.put),m&&A>=b&&t[S][w]!=e?g.push({x:S,y:w,sector:m.sector}):g.push({x:S,y:w,sector:I})}}return g.forEach((function(e){return t[e.x][e.y]=e.sector})),f},t.prototype.snap=function(t){if(c.enabled){var e={grassland:"#77B02A",forest:"#F5A15D",mountainFrame:"#928FB8",cavern:"#C7D4E1",coldCave:"#00FF00",lake:"#78D7FF",mountainBorder:"#928FB8",coldMountainBorder:"#0000FF",berryForest:"#FF0000"};new u({canvasId:"mapPreview",zoomLevel:1,mapWidth:t.sectors.length,mapHeight:t.sectors[0].length,colorFunction:function(t,i,r){return e[t.sectors[i][r].type]}}).renderMap(t),c.addFrame("mapPreview")}},t.prototype.debugPrint=function(t){},t}();e.default=p},2393:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(5946),n=i(6041),s=i(4738),a=i(7239),o=i(7591),l=new(function(){function t(){}return t.prototype.seed=function(t,e){for(var i={map:[],plants:[],items:[]},r=0;r<512;r++)i.map[r]=[],i.plants[r]=[],i.items[r]=[];for(r=0;r<t.length;r++)for(var n=0;n<t[0].length;n++)i.map[r][n]=this.seedSector(t[r][n]),i.plants[r][n]=this.getPlant(t[r][n]),i.items[r][n]=this.getItem(t[r][n]),0==e&&r>0&&(r+1)%64==0&&511==n&&this.snap(i.map,t);return i},t.prototype.getItem=function(t){switch(t.type){case r.SectorType.cavern:return this.cavernItem();case r.SectorType.coldCave:return this.coldCavernItem();case r.SectorType.forest:case r.SectorType.berryForest:return this.forestItem();case r.SectorType.grassland:return this.grasslandItem();case r.SectorType.underground:return this.underwaterCavernFloorItem();case r.SectorType.underwaterFloor:return this.underwaterFloorItem()}},t.prototype.getPlant=function(t){switch(t.type){case r.SectorType.cavern:return this.cavernPlant();case r.SectorType.coldCave:return this.coldCavernPlant();case r.SectorType.forest:return this.forestPlant();case r.SectorType.berryForest:return this.berryForestPlant(t);case r.SectorType.grassland:return this.grasslandPlant()}},t.prototype.seedSector=function(t){switch(t.type){case r.SectorType.cavern:return this.seedCavern();case r.SectorType.coldCave:return this.seedColdCavern();case r.SectorType.coldMountainBorder:return this.seedColdMountainBorder();case r.SectorType.mountainBorder:return this.seedMountainBorder();case r.SectorType.forest:case r.SectorType.berryForest:return this.seedForest();case r.SectorType.lake:case r.SectorType.river:case r.SectorType.caveLake:case r.SectorType.caveRiver:return this.seedLake();case r.SectorType.grassland:case r.SectorType.builtArea:return this.seedGrassland();case r.SectorType.mountainFrame:return this.seedMountainFrame();case r.SectorType.underground:return this.seedUnderground();case r.SectorType.underwaterFloor:return this.seedUnderwaterFloor();case r.SectorType.underwaterColdCaveFloor:return this.seedUnderwaterColdCaveFloor()}},t.prototype.seedUnderground=function(){return this.__seed([{tile:"ROCK",weight:99},{tile:"STONE_FLOOR",weight:1}])},t.prototype.seedCavern=function(){return this.__seed([{tile:"ROCK",weight:98},{tile:"STONE_FLOOR",weight:2}])},t.prototype.seedColdCavern=function(){return this.__seed([{tile:"COLD_ROCK",weight:92},{tile:"ROCK_FLOOR",weight:7},{tile:"PUDDLE",weight:1}])},t.prototype.seedMountainBorder=function(){return this.__seed([{tile:"ROCK",weight:99.5},{tile:"STONE_FLOOR",weight:.5}])},t.prototype.seedColdMountainBorder=function(){return this.__seed([{tile:"COLD_ROCK",weight:99.5},{tile:"ROCK_FLOOR",weight:.5}])},t.prototype.seedForest=function(){return this.__seed([{tile:"FOREST_FLOOR",weight:50},{tile:"TALL_GRASS",weight:25},{tile:"GRASS",weight:25}])},t.prototype.seedLake=function(){return this.__seed([{tile:"WATER",weight:80},{tile:"GRASS",weight:20}])},t.prototype.seedGrassland=function(){return this.__seed([{tile:"GRASS",weight:70},{tile:"TALL_GRASS",weight:25},{tile:"FOREST_FLOOR",weight:5}])},t.prototype.seedMountainFrame=function(){return"WORLD_BOUNDARIES"},t.prototype.seedUnderwaterFloor=function(){return"STONE_FLOOR"},t.prototype.seedUnderwaterColdCaveFloor=function(){return this.__seed([{tile:"STONE_FLOOR",weight:70},{tile:"ROCK_FLOOR",weight:30}])},t.prototype.cavernPlant=function(){return this.__seed([{tile:"KADINE_SHRUB",weight:.02},{tile:void 0,weight:99.98}])},t.prototype.coldCavernPlant=function(){},t.prototype.forestPlant=function(){return this.__seed([{tile:"CONIFER",weight:10},{tile:"SPRUCE",weight:5},{tile:"FIR",weight:2},{tile:"PINE",weight:2},{tile:"FYOLE_SHRUB",weight:.01},{tile:"SAUGE_SHRUB",weight:.01},{tile:"AULNE_SHRUB",weight:.01},{tile:void 0,weight:80.97}])},t.prototype.berryForestPlant=function(t){return this.__seed([{tile:t.params.berryShrubId,weight:4},{tile:void 0,weight:96}])},t.prototype.grasslandPlant=function(){return this.__seed([{tile:"PLAINS_TREE",weight:.8},{tile:"SPRUCE",weight:.2},{tile:"HIBISCUS_SHRUB",weight:.02},{tile:void 0,weight:98.98}])},t.prototype.cavernItem=function(){return this.__seed([{tile:"DONGO",weight:.2},{tile:"MUSKARIA",weight:.1},{tile:"FLINTSTONE",weight:.2},{tile:"CARBON",weight:.2},{tile:"SHINY_MUTALITE",weight:.1},{tile:void 0,weight:99.2}])},t.prototype.coldCavernItem=function(){return this.__seed([{tile:"DONGO",weight:.4},{tile:"MUSKARIA",weight:.2},{tile:"FLINTSTONE",weight:.1},{tile:"IRON_ORE",weight:.2},{tile:"SHINY_MUTALITE",weight:.1},{tile:void 0,weight:99}])},t.prototype.underwaterFloorItem=function(){return this.__seed([{tile:"BRINGOL",weight:1},{tile:"STONE",weight:.5},{tile:void 0,weight:98.5}])},t.prototype.underwaterCavernFloorItem=function(){return this.__seed([{tile:"FLINTSTONE",weight:.2},{tile:"BRINGOL",weight:7},{tile:"STONE",weight:.5},{tile:void 0,weight:92.3}])},t.prototype.forestItem=function(){return this.__seed([{tile:"KNOCK_NUT",weight:.3},{tile:"DONGO",weight:.1},{tile:"MUSKARIA",weight:.05},{tile:void 0,weight:99.55}])},t.prototype.grasslandItem=function(){return this.__seed([{tile:"STONE",weight:1},{tile:void 0,weight:99}])},t.prototype.__seed=function(t){return s.default.weightedFrom(t,(function(t){return t.weight}),(function(t){return t.tile}))},t.prototype.snap=function(t,e){if(o.enabled){var i={grassland:"#77B02A",forest:"#F5A15D",mountainFrame:"#928FB8",cavern:"#C7D4E1",lake:"#78D7FF",mountainBorder:"#928FB8"};new a({canvasId:"mapPreview",zoomLevel:1,mapWidth:e.length,mapHeight:e[0].length,colorFunction:function(t,r,s){return t[r][s]?n.default.get(t[r][s]).previewColor:i[e[r][s].type]}}).renderMap(t),o.addFrame("mapPreview")}},t}());e.default=l},8359:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6041),n=i(4738),s=i(4676);e.default=function(t){return t=(0,s.default)(t,(function(t,e){return!("TILLED_FROST"!==t.id&&"PERMAFROST"!==t.id&&"SNOW_WALKED"!==t.id||!n.default.chance(80))&&r.default.get("SNOW")}),(function(t){return t.id}),1,!0),t=(0,s.default)(t,(function(t,e){return!("WATER"!==t.id||!(e.FROZEN_WATER>0||e.FROZEN_DEEP_WATER>0||e.SNOW>0)||!n.default.chance(60))&&r.default.get("FROZEN_WATER")}),(function(t){return t.id}),2,!0),t=(0,s.default)(t,(function(t,e){return!("DEEP_WATER"!==t.id||!(e.FROZEN_WATER>0||e.FROZEN_DEEP_WATER>0||e.SNOW>0)||!n.default.chance(60))&&r.default.get("FROZEN_DEEP_WATER")}),(function(t){return t.id}),2,!0),t=(0,s.default)(t,(function(t,e){return!("PUDDLE"!==t.id||!n.default.chance(90))&&r.default.get("FROZEN_PUDDLE")}),(function(t){return t.id}),1,!0),(0,s.default)(t,(function(t,e){return!("CHANNEL"!==t.id||!n.default.chance(90))&&r.default.get("FROZEN_CHANNEL")}),(function(t){return t.id}),1,!0)}},702:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(6041),n=i(4738),s=i(8368),a=i(7239),o=i(7591),l={filter:function(t){var e=this;return t=s.runCA(t,(function(t,e){return!!("ROCK"==t&&e.STONE_FLOOR>0&&e.STONE_FLOOR<3&&n.default.chance(70))&&"STONE_FLOOR"}),4,!0,(function(t){return e.snap(t)})),t=s.runCA(t,(function(t,e){return"ROCK"==t&&e.ROCK<3&&"STONE_FLOOR"}),1,!0,(function(t){return e.snap(t)})),s.runCA(t,(function(t,e){return!!(e.WORLD_BOUNDARIES>1&&n.default.chance(60))&&"WORLD_BOUNDARIES"}),3,!1,(function(t){return e.snap(t)}))},snap:function(t){o.enabled&&(new a({canvasId:"mapPreview",zoomLevel:1,mapWidth:t.length,mapHeight:t[0].length,colorFunction:function(t,e,i){return r.default.get(t[e][i]).previewColor}}).renderMap(t),o.addFrame("mapPreview"))}};e.default=l},7837:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(9334),n=i(4738),s=i(771),a=i(5946),o=new(function(){function t(){}return t.prototype.generate=function(t){for(var e=this,i=[],s=new a.Sector(a.SectorType.underground),o=new a.Sector(a.SectorType.underwaterFloor),l=new a.Sector(a.SectorType.underwaterColdCaveFloor),h=new a.Sector(a.SectorType.mountainFrame),u=0;u<512;u++){i[u]=[];for(var c=0;c<512;c++)i[u][c]=s,t.isLake(u,c,0)&&(i[u][c]=o)}t.getColdCaveChannels().forEach((function(t){for(var s=(0,r.default)({x:t.xa,y:t.ya},{x:t.xb,y:t.yb}),a=n.default.n(3,5),o=0,h=s;o<h.length;o++){var u=h[o];e.placeBlob(i,l,u.x,u.y,a)}}));for(var d=0;d<512;d++)i[d][0]=h,i[d][511]=h,n.default.chance(70)&&(i[d][1]=h),n.default.chance(70)&&(i[d][510]=h);for(var p=0;p<512;p++)i[0][p]=h,i[511][p]=h,n.default.chance(70)&&(i[1][p]=h),n.default.chance(70)&&(i[510][p]=h);return i},t.prototype.placeBlob=function(t,e,i,r,n){for(var a=i-n;a<i+n+1;a++)for(var o=r-n;o<r+n+1;o++)this.isValid(a,o)&&Math.ceil(s.default.distance(i,r,a,o))<=n&&(t[a][o]=e);return!0},t.prototype.isValid=function(t,e){return t>=0&&t<512&&e>=0&&e<512},t}());e.default=o},8951:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4738),n=function(){function t(){this.list=[],this.nextIndex=0}return t.prototype.fillWithNumbers=function(t,e){for(var i=t;i<=e;i++)this.list.push(i);this.reshuffle()},t.prototype.fill=function(t){var e=this;t.forEach((function(t){return e.list.push(t)})),this.reshuffle()},t.prototype.reshuffle=function(){this.list=r.default.shuffle(this.list)},t.prototype.next=function(){return this.nextIndex>=this.list.length&&(this.nextIndex=0,this.reshuffle()),this.list[this.nextIndex++]},t}();e.default=n},2746:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4775),n=new(function(){function t(){}return t.prototype.init=function(t,e){this.list=e.filter((function(t){return t.chained})),this.floatingTriggers=e.filter((function(t){return!t.chained})),this.stepsCounter=0,this.game=t},t.prototype.reportStep=function(){var t=this.list[this.game.onboardingStep];t&&"steps"===t.trigger.type&&(this.stepsCounter++,this.stepsCounter>=t.trigger.quantity&&(this.stepsCounter=0,this.nextStep()))},t.prototype.reportItemAction=function(t,e){var i=this.list[this.game.onboardingStep];i&&i.trigger.type===t&&e===i.trigger.param&&this.nextStep()},t.prototype.reportItemAcquired=function(t,e){var i=this.list[this.game.onboardingStep];if(i&&"itemAcquired"===i.trigger.type&&t===i.trigger.param&&e>=i.trigger.quantity)this.nextStep();else{var r=this.floatingTriggers.find((function(e){return e.trigger.param===t}));if(r){if(this.game.player.flags["TRIGGER_".concat(r.id)])return void this.floatingTriggers.splice(this.floatingTriggers.indexOf(r),1);this.game.player.flags["TRIGGER_".concat(r.id)]=!0,this.game.display.showFloatingOnboarding(r)}}},t.prototype.reportAction=function(t){var e=this.list[this.game.onboardingStep];e&&"action"===e.trigger.type&&t===e.trigger.param&&this.nextStep()},t.prototype.reportEvent=function(t){var e=this.list[this.game.onboardingStep];e&&"event"===e.trigger.type&&t===e.trigger.param&&this.nextStep()},t.prototype.nextStep=function(){var t,e,i;if(this.game.onboardingStep++,this.onboardingFinished())this.game.display.onboardingTips.hideOnboarding();else{var n=this.list[this.game.onboardingStep];if("itemAcquired"===n.trigger.type&&(r.default.get(n.trigger.param).isLiquid?null!==(t=this.game.player.findLiquid(n.trigger.param))&&void 0!==t?t:0:null!==(i=null===(e=this.game.player.findItem(n.trigger.param))||void 0===e?void 0:e.quantity)&&void 0!==i?i:0)>=n.trigger.quantity)return void this.reportItemAcquired(n.trigger.param,n.trigger.quantity);this.game.display.tipsDisabled||this.game.display.onboardingTips.showOnboarding()}},t.prototype.onboardingFinished=function(){return this.game.onboardingStep>this.list.length-1},t.prototype.currentStep=function(){return this.list[this.game.onboardingStep]},t.prototype.all=function(){return this.list},t.prototype.validate=function(t){this.list.forEach((function(e,i){switch(e.trigger.type){case"prompt":break;case"steps":if(!e.trigger.quantity)throw new Error("Missing quantity for trigger ".concat(i));break;case"selectTool":case"seedPlanted":case"itemAcquired":case"break":case"chop":case"autoEquip":if(!t.items.get(e.trigger.param))throw new Error("Invalid item param for step ".concat(i,": [").concat(e.trigger.param,"]"));break;case"craft":case"selectRecipe":if(!t.recipes.get(e.trigger.param))throw new Error("Invalid recipe param for step ".concat(i,": [").concat(e.trigger.param,"]"));break;case"action":if(-1===["changeFacing","setupTinto","buildingMode","smartAction","groundTilled","cook","craft","harvestCrop","transformSeed","availableActions","nap","showMap"].indexOf(e.trigger.param))throw new Error("Invalid action param for step ".concat(i,": [").concat(e.trigger.param,"]"));break;case"event":if(-1===["treeFell","starving"].indexOf(e.trigger.param))throw new Error("Invalid event param for step ".concat(i,": [").concat(e.trigger.param,"]"));break;default:throw new Error("Invalid event type for step ".concat(i,": [").concat(e.trigger.type,"]"))}}))},t}());e.default=n},2865:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=new(function(){function t(){}return t.prototype.loadAudio=function(t){var e=this;this.audio=t.audio;var i=function(t,i){e.audio.registerMx({key:t,src:i,volume:.8,loop:!1})};i("mx_home_01","MX_Home_01.ogg"),i("mx_home_02","MX_Home_02.ogg"),i("mx_home_03","MX_Home_03.ogg"),i("mx_home_04","MX_Home_04.ogg"),i("mx_wild_01","MX_Wilderness_01.ogg"),i("mx_wild_02","MX_Wilderness_02.ogg"),i("mx_wild_03","MX_Wilderness_03.ogg"),i("mx_wild_04","MX_Wilderness_04.ogg"),this.audio.registerSfx({key:"forest_day",src:"BG_Forest_Day.ogg",loop:!0,stereo:0}),this.audio.registerSfx({key:"forest_night",src:"BG_Forest_Night.ogg",loop:!0,volume:0,stereo:0}),this.audio.registerSfx({key:"snow_day",src:"BG_Snow_Day.ogg",loop:!0,stereo:0}),this.audio.registerSfx({key:"snow_night",src:"BG_Snow_Night.ogg",loop:!0,volume:0,stereo:0}),this.audio.registerSfx({key:"underwater",src:"BG_Underwater.ogg",loop:!0,volume:0,stereo:0}),this.audio.registerSfx({key:"campfire_near",src:"SFX_Campfire_lp.ogg",loop:!0,stereo:0,volume:.5}),this.audio.registerSfx({key:"faint_cave",src:"SFX_Faint_Mine.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"faint_dirt",src:"SFX_Faint_Dirt.ogg",stereo:0}),this.audio.registerSfx({key:"faint_grass",src:"SFX_Faint_Grass.ogg",stereo:0}),this.audio.registerSfx({key:"faint_wood",src:"SFX_Faint_Wood.ogg",stereo:0}),this.audio.registerSfx({key:"starving",src:"SFX_Starving.ogg",stereo:0}),this.audio.registerSfx({key:"rock_break",src:"SFX_Rock_Break.ogg",stereo:0}),this.audio.registerSfx({key:"mine_01",src:"SFX_Mine_01.ogg",stereo:0}),this.audio.registerSfx({key:"mine_02",src:"SFX_Mine_02.ogg",stereo:0}),this.audio.registerSfx({key:"mine_03",src:"SFX_Mine_03.ogg",stereo:0}),this.audio.registerSfx({key:"mine_04",src:"SFX_Mine_04.ogg",stereo:0}),this.audio.registerSfx({key:"paint_01",src:"SFX_Paint_01.ogg",stereo:0}),this.audio.registerSfx({key:"paint_02",src:"SFX_Paint_02.ogg",stereo:0}),this.audio.registerSfx({key:"paint_03",src:"SFX_Paint_03.ogg",stereo:0}),this.audio.registerSfx({key:"craft_swall",src:"SFX_Craft_SWall.ogg",stereo:0}),this.audio.registerSfx({key:"craft_wfence",src:"SFX_Craft_WFence.ogg",stereo:0}),this.audio.registerSfx({key:"craft_wdoor",src:"SFX_Craft_wDoor.ogg",stereo:0}),this.audio.registerSfx({key:"craft_wgate",src:"SFX_Craft_wGate.ogg",stereo:0}),this.audio.registerSfx({key:"craft_wbridge",src:"SFX_Craft_wBridge.ogg",stereo:0}),this.audio.registerSfx({key:"craft_wfloor",src:"SFX_Craft_wFloor.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"craft_campfire",src:"SFX_Craft_Campfire.ogg",stereo:0}),this.audio.registerSfx({key:"craft_paint01",src:"SFX_Craft_Paint_01.ogg",stereo:0}),this.audio.registerSfx({key:"craft_paint02",src:"SFX_Craft_Paint_02.ogg",stereo:0}),this.audio.registerSfx({key:"craft_snowman",src:"SFX_Craft_Snowman.ogg",stereo:0}),this.audio.registerSfx({key:"craft_festive_tree",src:"SFX_Craft_FestiveTree.ogg",stereo:0}),this.audio.registerSfx({key:"break_fence",src:"SFX_Break_Fence.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"break_wfloor",src:"SFX_Break_wFloor.ogg",stereo:0}),this.audio.registerSfx({key:"break_campfire",src:"SFX_Break_Campfire.ogg",stereo:0}),this.audio.registerSfx({key:"break_ice_01",src:"SFX_Break_Ice_01.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"break_ice_02",src:"SFX_Break_Ice_02.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"break_ice_03",src:"SFX_Break_Ice_03.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"break_ice_04",src:"SFX_Break_Ice_04.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"break_ice_05",src:"SFX_Break_Ice_05.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"break_ice_06",src:"SFX_Break_Ice_06.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"dig_snow_01",src:"SFX_Dig_Snow_01.ogg",stereo:0}),this.audio.registerSfx({key:"dig_snow_02",src:"SFX_Dig_Snow_02.ogg",stereo:0}),this.audio.registerSfx({key:"dig_snow_03",src:"SFX_Dig_Snow_03.ogg",stereo:0}),this.audio.registerSfx({key:"dig_snow_04",src:"SFX_Dig_Snow_04.ogg",stereo:0}),this.audio.registerSfx({key:"dig_snow_05",src:"SFX_Dig_Snow_05.ogg",stereo:0}),this.audio.registerSfx({key:"dig_snow_06",src:"SFX_Dig_Snow_06.ogg",stereo:0}),this.audio.registerSfx({key:"extract_seed_01",src:"SFX_ExtractSeed_01.ogg",stereo:0}),this.audio.registerSfx({key:"extract_seed_02",src:"SFX_ExtractSeed_02.ogg",stereo:0}),this.audio.registerSfx({key:"tree_fall",src:"SFX_TreeFall.ogg",stereo:0}),this.audio.registerSfx({key:"chop_01",src:"SFX_Chop_01.ogg",stereo:0}),this.audio.registerSfx({key:"chop_02",src:"SFX_Chop_02.ogg",stereo:0}),this.audio.registerSfx({key:"chop_03",src:"SFX_Chop_03.ogg",stereo:0}),this.audio.registerSfx({key:"chop_04",src:"SFX_Chop_04.ogg",stereo:0}),this.audio.registerSfx({key:"limb_01",src:"SFX_Limb_01.ogg",stereo:0}),this.audio.registerSfx({key:"limb_02",src:"SFX_Limb_02.ogg",stereo:0}),this.audio.registerSfx({key:"limb_03",src:"SFX_Limb_03.ogg",stereo:0}),this.audio.registerSfx({key:"limb_04",src:"SFX_Limb_04.ogg",stereo:0}),this.audio.registerSfx({key:"mow_01",src:"SFX_Mow_01.ogg",stereo:0}),this.audio.registerSfx({key:"mow_02",src:"SFX_Mow_02.ogg",stereo:0}),this.audio.registerSfx({key:"mow_03",src:"SFX_Mow_03.ogg",stereo:0}),this.audio.registerSfx({key:"mow_04",src:"SFX_Mow_04.ogg",stereo:0}),this.audio.registerSfx({key:"mow_05",src:"SFX_Mow_05.ogg",stereo:0}),this.audio.registerSfx({key:"mow_06",src:"SFX_Mow_06.ogg",stereo:0}),this.audio.registerSfx({key:"plant_01",src:"SFX_Plant_01.ogg",stereo:0}),this.audio.registerSfx({key:"plant_02",src:"SFX_Plant_02.ogg",stereo:0}),this.audio.registerSfx({key:"till_01",src:"SFX_Till_01.ogg",stereo:0}),this.audio.registerSfx({key:"till_02",src:"SFX_Till_02.ogg",stereo:0}),this.audio.registerSfx({key:"till_03",src:"SFX_Till_03.ogg",stereo:0}),this.audio.registerSfx({key:"eat",src:"SFX_Eat.ogg",volume:.5,stereo:0}),this.audio.registerSfx({key:"grab_animal",src:"SFX_Grab_Animal.ogg",stereo:0}),this.audio.registerSfx({key:"grab_berry_01",src:"SFX_Grab_Berry_01.ogg",stereo:0}),this.audio.registerSfx({key:"grab_berry_02",src:"SFX_Grab_Berry_02.ogg",stereo:0}),this.audio.registerSfx({key:"grab_berry_03",src:"SFX_Grab_Berry_03.ogg",stereo:0}),this.audio.registerSfx({key:"grab_crop_01",src:"SFX_Grab_Crop_01.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"grab_crop_02",src:"SFX_Grab_Crop_02.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"grab_crop_03",src:"SFX_Grab_Crop_03.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"grab_crop_04",src:"SFX_Grab_Crop_04.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"grab_snow_01",src:"SFX_Grab_Snow_01.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"grab_snow_02",src:"SFX_Grab_Snow_02.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"grab_snow_03",src:"SFX_Grab_Snow_03.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"grab_snow_04",src:"SFX_Grab_Snow_04.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"grab_egg_01",src:"SFX_Grab_Egg_01.ogg",stereo:0}),this.audio.registerSfx({key:"grab_egg_02",src:"SFX_Grab_Egg_02.ogg",stereo:0}),this.audio.registerSfx({key:"grab_note",src:"SFX_Grab_Note.ogg",stereo:0}),this.audio.registerSfx({key:"read_note",src:"SFX_Read_Note.ogg",stereo:0}),this.audio.registerSfx({key:"grab_rock_01",src:"SFX_Grab_Rock_01.ogg",stereo:0}),this.audio.registerSfx({key:"grab_rock_02",src:"SFX_Grab_Rock_02.ogg",stereo:0}),this.audio.registerSfx({key:"grab_wood_01",src:"SFX_Grab_Wood_01.ogg",stereo:0}),this.audio.registerSfx({key:"grab_wood_02",src:"SFX_Grab_Wood_02.ogg",stereo:0}),this.audio.registerSfx({key:"grab_mushroom_01",src:"SFX_Grab_Mushroom_01.ogg",stereo:0}),this.audio.registerSfx({key:"grab_mushroom_02",src:"SFX_Grab_Mushroom_02.ogg",stereo:0}),this.audio.registerSfx({key:"drop_cave_01",src:"SFX_Drop_Mine_01.ogg",stereo:0}),this.audio.registerSfx({key:"drop_cave_02",src:"SFX_Drop_Mine_02.ogg",stereo:0}),this.audio.registerSfx({key:"drop_dirt_01",src:"SFX_Drop_Dirt_01.ogg",stereo:0}),this.audio.registerSfx({key:"drop_dirt_02",src:"SFX_Drop_Dirt_02.ogg",stereo:0}),this.audio.registerSfx({key:"drop_grass_01",src:"SFX_Drop_Grass_01.ogg",stereo:0}),this.audio.registerSfx({key:"drop_grass_02",src:"SFX_Drop_Grass_02.ogg",stereo:0}),this.audio.registerSfx({key:"drop_wood_01",src:"SFX_Drop_Wood_01.ogg",stereo:0}),this.audio.registerSfx({key:"drop_wood_02",src:"SFX_Drop_Wood_02.ogg",stereo:0}),this.audio.registerSfx({key:"exchange_reject",src:"SFX_Exchange_Reject.ogg",stereo:0}),this.audio.registerSfx({key:"exchange_insert",src:"SFX_Exchange_Insert.ogg",stereo:0}),this.audio.registerSfx({key:"fs_grass_01",src:"FS_Grass_01.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_grass_02",src:"FS_Grass_02.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_grass_03",src:"FS_Grass_03.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_grass_04",src:"FS_Grass_04.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_grass_05",src:"FS_Grass_05.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_grass_06",src:"FS_Grass_06.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_dirt_01",src:"FS_Dirt_01.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_dirt_02",src:"FS_Dirt_02.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_dirt_03",src:"FS_Dirt_03.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_dirt_04",src:"FS_Dirt_04.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_dirt_05",src:"FS_Dirt_05.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_dirt_06",src:"FS_Dirt_06.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_wood_01",src:"FS_Wood_01.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"fs_wood_02",src:"FS_Wood_02.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"fs_wood_03",src:"FS_Wood_03.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"fs_wood_04",src:"FS_Wood_04.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"fs_wood_05",src:"FS_Wood_05.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"fs_wood_06",src:"FS_Wood_06.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"fs_cave_01",src:"FS_Cave_01.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_cave_02",src:"FS_Cave_02.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_cave_03",src:"FS_Cave_03.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_cave_04",src:"FS_Cave_04.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_cave_05",src:"FS_Cave_05.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_cave_06",src:"FS_Cave_06.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"fs_wbridge_01",src:"FS_wBridge_01.ogg",stereo:0}),this.audio.registerSfx({key:"fs_wbridge_02",src:"FS_wBridge_02.ogg",stereo:0}),this.audio.registerSfx({key:"fs_wbridge_03",src:"FS_wBridge_03.ogg",stereo:0}),this.audio.registerSfx({key:"fs_wbridge_04",src:"FS_wBridge_04.ogg",stereo:0}),this.audio.registerSfx({key:"fs_wbridge_05",src:"FS_wBridge_05.ogg",stereo:0}),this.audio.registerSfx({key:"fs_ice_01",src:"FS_Ice_01.ogg",volume:.5,stereo:0}),this.audio.registerSfx({key:"fs_ice_02",src:"FS_Ice_02.ogg",volume:.5,stereo:0}),this.audio.registerSfx({key:"fs_ice_03",src:"FS_Ice_03.ogg",volume:.5,stereo:0}),this.audio.registerSfx({key:"fs_ice_04",src:"FS_Ice_04.ogg",volume:.5,stereo:0}),this.audio.registerSfx({key:"fs_ice_05",src:"FS_Ice_05.ogg",volume:.5,stereo:0}),this.audio.registerSfx({key:"fs_ice_06",src:"FS_Ice_06.ogg",volume:.5,stereo:0}),this.audio.registerSfx({key:"fs_snow_01",src:"FS_Snow_01.ogg",volume:.4,stereo:0}),this.audio.registerSfx({key:"fs_snow_02",src:"FS_Snow_02.ogg",volume:.4,stereo:0}),this.audio.registerSfx({key:"fs_snow_03",src:"FS_Snow_03.ogg",volume:.4,stereo:0}),this.audio.registerSfx({key:"fs_snow_04",src:"FS_Snow_04.ogg",volume:.4,stereo:0}),this.audio.registerSfx({key:"fs_snow_05",src:"FS_Snow_05.ogg",volume:.4,stereo:0}),this.audio.registerSfx({key:"fs_snow_06",src:"FS_Snow_06.ogg",volume:.4,stereo:0}),this.audio.registerSfx({key:"fs_snow_07",src:"FS_Snow_07.ogg",volume:.4,stereo:0}),this.audio.registerSfx({key:"fs_snow_08",src:"FS_Snow_08.ogg",volume:.4,stereo:0}),this.audio.registerSfx({key:"fs_snow_09",src:"FS_Snow_09.ogg",volume:.4,stereo:0}),this.audio.registerSfx({key:"ui_selection",src:"UI_Selection.ogg",stereo:0}),this.audio.registerSfx({key:"ui_inv_open",src:"UI_Inventory_Cl.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"ui_inv_close",src:"UI_Inventory_Op.ogg",volume:.7,stereo:0}),this.audio.registerSfx({key:"ui_neg_fbk",src:"UI_NegFbk.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"door_close",src:"SFX_Door_Close.ogg",stereo:0}),this.audio.registerSfx({key:"door_open",src:"SFX_Door_Open.ogg",stereo:0}),this.audio.registerSfx({key:"gate_close",src:"SFX_Gate_Close.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"gate_open",src:"SFX_Gate_Open.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"raft_01",src:"SFX_Raft_01.ogg",stereo:0}),this.audio.registerSfx({key:"raft_02",src:"SFX_Raft_02.ogg",stereo:0}),this.audio.registerSfx({key:"raft_03",src:"SFX_Raft_03.ogg",stereo:0}),this.audio.registerSfx({key:"water_dive_in",src:"SFX_Water_Dive_In.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"water_dive_out",src:"SFX_Water_Dive_Out.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"water_jump_in_01",src:"SFX_Water_Jump_In_01.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"water_jump_in_02",src:"SFX_Water_Jump_In_02.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"water_jump_in_03",src:"SFX_Water_Jump_In_03.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"water_jump_out_01",src:"SFX_Water_Jump_Out_01.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"water_jump_out_02",src:"SFX_Water_Jump_Out_02.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"water_jump_out_03",src:"SFX_Water_Jump_Out_03.ogg",volume:.8,stereo:0}),this.audio.registerSfx({key:"swim_surface_01",src:"SFX_Swim_Surface_01.ogg",volume:.6,stereo:0}),this.audio.registerSfx({key:"swim_surface_02",src:"SFX_Swim_Surface_02.ogg",volume:.6,stereo:0}),this.audio.registerSfx({key:"swim_surface_03",src:"SFX_Swim_Surface_03.ogg",volume:.6,stereo:0}),this.audio.registerSfx({key:"swim_surface_04",src:"SFX_Swim_Surface_04.ogg",volume:.6,stereo:0}),this.audio.registerSfx({key:"swim_surface_05",src:"SFX_Swim_Surface_05.ogg",volume:.6,stereo:0}),this.audio.registerSfx({key:"swim_underwater_01",src:"SFX_Swim_Underwater_01.ogg",stereo:0}),this.audio.registerSfx({key:"swim_underwater_02",src:"SFX_Swim_Underwater_02.ogg",stereo:0}),this.audio.registerSfx({key:"swim_underwater_03",src:"SFX_Swim_Underwater_03.ogg",stereo:0}),this.audio.registerSfx({key:"swim_underwater_04",src:"SFX_Swim_Underwater_04.ogg",stereo:0}),this.audio.registerSfx({key:"swim_underwater_05",src:"SFX_Swim_Underwater_05.ogg",stereo:0})},t}());e.default=i},245:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Audio=void 0;var r=i(8696),n=i(4738),s=i(771),a=window.Howler,o=window.Howl,l=function(){function t(){this.mx={},this.sfx={},this.currentMx=""}return t.prototype.init=function(){var t=r.default.get("masterVolume");t&&this.changeMasterVolume(t)},t.prototype.getMasterVolume=function(){return a.volume()},t.prototype.changeMasterVolume=function(t){a.volume(t)},t.prototype.registerSfx=function(t){t.src="audio/sfx/".concat(t.src),this.sfx[t.key]=this.createSound(t)},t.prototype.registerMx=function(t){t.src="audio/mx/".concat(t.src),this.mx[t.key]=this.createSound(t)},t.prototype.createSound=function(t){var e=new o({src:t.src,volume:t.volume,loop:t.loop,autoplay:t.autoplay});return t.stereo&&e.stereo(t.stereo),e},t.prototype.getKeyFromString=function(t){var e=t.split(",");return 1===e.length?e[0]:e[s.default.getRandomInt(0,e.length)]},t.prototype.playSfxWithVariation=function(t,e){e?this.playSfx(t+n.default.n(1,e)):this.playSfx(t)},t.prototype.playSfx=function(t,e){var i=this.getKeyFromString(t);this.sfx[i]?e&&this.sfx[i].playing()||this.sfx[i].play():console.log("No SFX registered for ".concat(i,"..."))},t.prototype.playMx=function(t){var e=this.getKeyFromString(t);this.currentMx!==e&&(this.currentMx=e,this.mx[e]?this.mx[e].play():console.log("No MX registered for ".concat(e,"...")))},t.prototype.playRandomMx=function(){var t=this;if(this.canPlayMx()){var e=n.default.from(Object.keys(this.mx)),i=this.mx[e];this.playMx(e),this.melodyTimeout=setTimeout((function(){return t.playRandomMx()}),1e3*i.duration()+6e4)}else setTimeout((function(){return t.playRandomMx()}),3e4)},t.prototype.canPlayMx=function(){return!0},t.prototype.stopSfx=function(t){var e=this.getKeyFromString(t);this.sfx[e]&&this.sfx[e].stop()},t.prototype.setSfxPan=function(t,e){this.sfx[t].stereo(e)},t.prototype.setSfxVolume=function(t,e){this.sfx[t].volume(e)},t.prototype.getSfxVolume=function(t){return this.sfx[t].volume()},t.prototype.stopMelodies=function(){this.currentMx&&(this.mx[this.currentMx].stop(),this.currentMx=void 0),this.melodyTimeout&&(clearTimeout(this.melodyTimeout),this.melodyTimeout=void 0)},t.prototype.resetKickstartMelodies=function(){this.timeToPlay=n.default.n(5,15)},t.prototype.kickstartMelodies=function(){this.timeToPlay--,0==this.timeToPlay&&this.playRandomMx()},t}();e.Audio=l;var h=new l;e.default=h},3945:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(8670),n={hslToRgb:function(t,e,i){var r,n,s;if(0==e)r=n=s=i;else{var a=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},o=i<.5?i*(1+e):i+e-i*e,l=2*i-o;r=a(l,o,t+1/3),n=a(l,o,t),s=a(l,o,t-1/3)}return[Math.round(255*r),Math.round(255*n),Math.round(255*s)]},RGBToHSL:function(t,e,i){t/=255,e/=255,i/=255;var r=Math.max(t,e,i),n=r-Math.min(t,e,i),s=n?r===t?(e-i)/n:r===e?2+(i-t)/n:4+(t-e)/n:0;return[60*s<0?60*s+360:60*s,100*(n?r<=.5?n/(2*r-n):n/(2-(2*r-n)):0),100*(2*r-n)/2]},hexToRGB:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null},hexToByte:function(t){return parseInt(t.substring(1),16)},rgbToByte:function(t,e,i){return 256*t*256+256*e+i},scales:{},interpolate:function(t,e,i){var n=this.scales[t.toString()+"-"+e.toString()];return n||(n=(0,r.scale)([t,e]).mode("lab"),this.scales[t.toString()+"-"+e.toString()]=n),n(i).num()},NORMAL_WHITE:"#ffcf8e"};e.default=n},2062:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4369);window.ut,e.default={init:function(t){this.game=t,this.currentTip=-1},inkey:function(t){},cheatsEnabled:function(){return!1},nextTip:function(){this.currentTip++,this.currentTip>52&&(this.currentTip=0);var t=new r.default(this.game,"$CLUE_".concat(this.currentTip),1);this.game.display.showClue(t)},log:function(t){}}},212:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=new(function(){function t(){}return t.prototype.isMobile=function(){return"ontouchstart"in window||navigator.maxTouchPoints>0},t.prototype.isCordova=function(){return!1},t}());e.default=i},1623:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=new(function(){function t(){}return t.prototype.isElectron=function(){return navigator.userAgent.toLowerCase().includes("electron")},t.prototype.electronClose=function(){},t.prototype.toggleWindowed=function(){},t}());e.default=i},3451:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={getAreaSize:function(t,e,i,r){return this.encloseFunction=i,this.maxSize=r,this.areaSize=0,this.visited={},this.fillMatrix(t,e),this.areaSize},fillMatrix:function(t,e){this.visited["".concat(t,"-").concat(e)]||this.areaSize>=this.maxSize||this.encloseFunction(t,e)||(this.areaSize++,this.visited["".concat(t,"-").concat(e)]=!0,this.fillMatrix(t+1,e),this.fillMatrix(t-1,e),this.fillMatrix(t,e+1),this.fillMatrix(t,e-1))}}},9273:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InputMode=void 0;var r,n=i(4775),s=i(7926),a=i(8059),o=i(8779),l=i(2746),h=i(2062),u=i(212),c=i(771),d=i(771),p=window.ut;!function(t){t[t.DELEGATE=0]="DELEGATE",t[t.INTRO=1]="INTRO",t[t.ALERT=2]="ALERT",t[t.MOVEMENT=3]="MOVEMENT",t[t.JOURNAL=4]="JOURNAL",t[t.SELECT_CRAFT=5]="SELECT_CRAFT",t[t.SELECT_RECIPE=6]="SELECT_RECIPE",t[t.CONTAINER=7]="CONTAINER",t[t.SETTINGS_MENU=8]="SETTINGS_MENU",t[t.PROMPT=9]="PROMPT",t[t.PROMPT_ACTION=10]="PROMPT_ACTION",t[t.PROMPT_OB=11]="PROMPT_OB",t[t.GAME_OVER=12]="GAME_OVER",t[t.MAP=13]="MAP",t[t.BLOCKED=14]="BLOCKED",t[t.BUILDING=15]="BUILDING"}(r=e.InputMode||(e.InputMode={}));var f=new(function(){function t(){this.inputEnabled=!0,this.movedir={x:0,y:0},this.modeStack=[]}return t.prototype.init=function(t){this.game=t,p.initInput(this.onKeyDown.bind(this),this.onKeyUp.bind(this))},t.prototype.setMode=function(t){this.peekMode()!==t&&(this.modeStack.push(t),this.game.display.onInputModeChanged())},t.prototype.popMode=function(){this.modeStack.pop(),this.game.display.onInputModeChanged()},t.prototype.peekMode=function(){return this.modeStack[this.modeStack.length-1]},t.prototype.setInputHandler=function(t){var e;this.inputHandlerDelegate=t,this.setMode(r.DELEGATE),null===(e=this.game.display.touchControls)||void 0===e||e.setDelegateButtons()},t.prototype.onKeyUp=function(t){if(this.inputEnabled){var e=this.game.player,i=this.peekMode();if(i===r.DELEGATE)this.inputHandlerDelegate.onKeyUp(t);else if(i===r.INTRO){if(t===p.KEY_SPACE||t===p.KEY_ENTER)return this.game.display.hideIntro(),this.game.player.updateFOV(),void this.game.display.refresh()}else if(i===r.MAP){if(t===p.KEY_SPACE||t===p.KEY_ENTER||t===p.KEY_ESCAPE)return this.game.display.mapPanel.hide(),void this.popMode()}else if(i===r.ALERT){if(t===p.KEY_SPACE||t===p.KEY_ENTER||t===p.KEY_ESCAPE||t===p.KEY_CTRL)return this.popMode(),this.game.display.closeAlert(),void this.game.display.refresh()}else if(i===r.PROMPT_OB){if(t===p.KEY_SPACE||t===p.KEY_ENTER||t===p.KEY_ESCAPE||t===p.KEY_CTRL)return this.popMode(),this.game.display.switchOverlay(!1),void l.default.nextStep()}else if(i===r.PROMPT_ACTION){if(t===p.KEY_ESCAPE)return this.game.display.actionsList.hide(),void this.popMode();if(t===p.KEY_SPACE||t===p.KEY_ENTER)return this.game.display.actionsList.hide(),this.popMode(),void this.executeAction(this.game.display.actionsList.getSelectedAction());t===p.KEY_PAGE_UP?this.game.display.actionsList.moveCursor(-1):t===p.KEY_PAGE_DOWN&&this.game.display.actionsList.moveCursor(1)}else if(i===r.SETTINGS_MENU){if(t===p.KEY_ESCAPE)return this.game.display.settingsPanel.hide(),void this.popMode();if(t===p.KEY_SPACE||t===p.KEY_ENTER)return this.game.display.settingsPanel.hide(),this.popMode(),void this.game.display.settingsPanel.executeAction();t===p.KEY_PAGE_UP?this.game.display.settingsPanel.moveAction({x:0,y:-1}):t===p.KEY_PAGE_DOWN&&this.game.display.settingsPanel.moveAction({x:0,y:1})}else if(i===r.JOURNAL){if(t===p.KEY_SPACE||t===p.KEY_ENTER||t===p.KEY_ESCAPE)return this.game.display.journalPanel.hideJournal(),this.game.display.refresh(),void this.popMode();t===p.KEY_PAGE_UP?this.game.display.journalPanel.journalUp():t===p.KEY_PAGE_DOWN&&this.game.display.journalPanel.journalDown()}else if(i===r.BUILDING){if(t===p.KEY_ESCAPE)return this.popMode(),this.game.audio.playSfx("ui_inv_close"),this.game.display.switchOverlay(!0),this.game.display.recipesPanel.show(),void this.game.display.updateHelp();if(t===p.KEY_ENTER||t===p.KEY_CTRL)return this.executeAction(this.getContextualAction()),void l.default.reportAction("smartAction")}else if(i===r.MOVEMENT){if(h.default.inkey(t),t===p.KEY_SPACE){var n=this.getAvailableActions();return this.setMode(r.PROMPT_ACTION),this.game.display.actionsList.promptForAction(n),void l.default.reportAction("availableActions")}if(t===p.KEY_ENTER||t===p.KEY_CTRL)return this.executeAction(this.getContextualAction()),void l.default.reportAction("smartAction");if(t===p.KEY_TAB||t===p.KEY_PAGE_DOWN||t===p.KEY_PAGE_UP){this.game.audio.playSfx("ui_selection");var s;return s=t===p.KEY_PAGE_DOWN||t===p.KEY_PAGE_UP?t===p.KEY_PAGE_UP:p.isKeyPressed(p.KEY_SHIFT),this.game.player.switchCurrentTool(s),void this.game.display.refresh()}if(t===p.KEY_F)return p.isKeyPressed(p.KEY_SHIFT)?void this.executeAction(new o.ExecutableAction(o.PlayerAction.FEED)):(this.game.player.switchMovementMode(),void this.game.display.refresh());if(t===p.KEY_U)return p.isKeyPressed(p.KEY_SHIFT)?void this.executeAction(new o.ExecutableAction(o.PlayerAction.USE_IN_WORLD)):void this.executeAction(new o.ExecutableAction(o.PlayerAction.USE));if(t===p.KEY_COMMA)return void this.executeAction(new o.ExecutableAction(o.PlayerAction.PICK_UP,0,void 0,void 0,{single:p.isKeyPressed(p.KEY_SHIFT)}));if(t===p.KEY_P)return p.isKeyPressed(p.KEY_SHIFT)?void this.executeAction(new o.ExecutableAction(o.PlayerAction.POUR)):void this.executeAction(new o.ExecutableAction(o.PlayerAction.PLANT));if(t===p.KEY_B)return void this.executeAction(new o.ExecutableAction(o.PlayerAction.UI_IMAGINE));if(t===p.KEY_N)return void this.executeAction(new o.ExecutableAction(o.PlayerAction.SLEEP));if(t===p.KEY_I)return void this.executeAction(new o.ExecutableAction(o.PlayerAction.PLUNGE));if(t===p.KEY_O)return e.changeWaypoint(),void this.game.display.refresh();if(t===p.KEY_J)return this.setMode(r.JOURNAL),void this.game.display.journalPanel.showJournal();if(t===p.KEY_ESCAPE)return this.setMode(r.SETTINGS_MENU),void this.game.display.settingsPanel.display(!0);if(t===p.KEY_T)return p.isKeyPressed(p.KEY_SHIFT)?void this.game.display.toggleTips():void this.executeAction(new o.ExecutableAction(o.PlayerAction.MAKE_SEEDS));if(t===p.KEY_R){if(p.isKeyPressed(p.KEY_SHIFT))return void this.executeAction(new o.ExecutableAction(o.PlayerAction.DROP,0,void 0,void 0,{single:!0}));this.executeAction(new o.ExecutableAction(o.PlayerAction.DROP))}if(t===p.KEY_L)return void(p.isKeyPressed(p.KEY_SHIFT)?this.executeAction(new o.ExecutableAction(o.PlayerAction.UI_EXAMINE_WORLD)):this.game.player.currentTool&&this.executeAction(new o.ExecutableAction(o.PlayerAction.UI_EXAMINE)))}else if(i===r.CONTAINER)if(t===p.KEY_ESCAPE)this.game.display.hideInventory(),this.game.audio.playSfx("ui_inv_open"),this.popMode();else if(t===p.KEY_U){var a=this.game.display.getSelectedItem();if(!a)return;this.inputEnabled=!1,this.game.player.useTool(a,!1)||(this.game.display.updateInventory(),this.inputEnabled=!0)}else t!==p.KEY_ENTER&&t!==p.KEY_SPACE||this.game.display.containerContentsGrid.performTransfer(t===p.KEY_ENTER);else if(i===r.SELECT_CRAFT||i===r.SELECT_RECIPE){if(t===p.KEY_ESCAPE)this.game.display.hideInventory(),this.game.audio.playSfx("ui_inv_open"),this.popMode();else if(t===p.KEY_TAB||t===p.KEY_PAGE_DOWN||t===p.KEY_PAGE_UP);else if(t===p.KEY_ENTER||t===p.KEY_SPACE||t===p.KEY_CTRL){var u=this.game.display.getSelectedRecipe();if(!u)return;if(l.default.reportItemAction("selectRecipe",u.id),u.placeInWorld&&i===r.SELECT_CRAFT)return this.setMode(r.BUILDING),l.default.reportAction("buildingMode"),this.game.display.switchOverlay(!1),this.game.display.recipesPanel.hide(),void this.game.display.updateHelp();var c=this.game.player.tryCraft(u);if("object"==typeof c&&c.crafted&&(this.game.player.endTurn(null==c?void 0:c.craftTime),i===r.SELECT_RECIPE)){var d=this.game.player.getPossibleCookRecipes();if(0===d.length)return this.game.display.errorMessage("You lack the ingredients to cook anything."),this.game.display.hideInventory(),this.game.audio.playSfx("ui_inv_open"),void this.popMode();this.game.display.showRecipes(d)}}}else if(i===r.PROMPT){var f=void 0,m="Yes.";if(t===p.KEY_Y||t===p.KEY_CTRL||t===p.KEY_ENTER?f="yesCb":t!==p.KEY_N&&t!==p.KEY_ESCAPE||(f="noCb",m="No."),f){this.popMode();var g=this.promptCbs[f];delete this.promptCbs,this.game.display.closeAlert(),"No."===m&&this.game.display.message(m,m,this.game.player.x,this.game.player.y),g&&g()}}else i===r.GAME_OVER&&(t!==p.KEY_CTRL&&t!==p.KEY_ENTER||this.game.display.navigateToTitle())}},t.prototype.getMoveDir=function(t){var e={x:0,y:0};return t!==p.KEY_LEFT&&t!==p.KEY_NUMPAD4&&t!==p.KEY_NUMPAD1&&t!==p.KEY_NUMPAD7&&t!==p.KEY_HOME&&t!==p.KEY_END&&t!==p.KEY_Q&&t!==p.KEY_A&&t!==p.KEY_Z||(e.x=-1),t!==p.KEY_RIGHT&&t!==p.KEY_NUMPAD6&&t!==p.KEY_NUMPAD9&&t!==p.KEY_NUMPAD3&&t!==p.KEY_PAGE_UP&&t!==p.KEY_PAGE_DOWN&&t!==p.KEY_E&&t!==p.KEY_D&&t!==p.KEY_C||(e.x=1),t!==p.KEY_UP&&t!==p.KEY_NUMPAD8&&t!==p.KEY_NUMPAD7&&t!==p.KEY_NUMPAD9&&t!==p.KEY_PAGE_UP&&t!==p.KEY_HOME&&t!==p.KEY_Q&&t!==p.KEY_W&&t!==p.KEY_E||(e.y=-1),t!==p.KEY_DOWN&&t!==p.KEY_NUMPAD2&&t!==p.KEY_NUMPAD1&&t!==p.KEY_NUMPAD3&&t!==p.KEY_PAGE_DOWN&&t!==p.KEY_END&&t!==p.KEY_Z&&t!==p.KEY_S&&t!==p.KEY_C||(e.y=1),e},t.prototype.onKeyDown=function(t){if(this.inputEnabled){var e=this.peekMode(),i=this.getMoveDir(t);if(e===r.MOVEMENT||e===r.BUILDING){if(t===p.KEY_PERIOD||t===p.KEY_X||t===p.KEY_NUMPAD5||t===p.KEY_CLEAR)return void this.game.player.rest();if(this.movedir.x=i.x,this.movedir.y=i.y,0===this.movedir.x&&0===this.movedir.y)return;this.inputEnabled=!1,p.isKeyPressed(p.KEY_SHIFT)?(l.default.reportAction("changeFacing"),this.game.player.changeFacing(this.movedir.x,this.movedir.y)):this.game.player.isSwimming?this.game.player.trySwim(this.movedir):this.game.player.tryMove(this.movedir)}else e===r.JOURNAL?(1===i.y&&this.game.display.journalPanel.journalDown(),-1===i.y&&this.game.display.journalPanel.journalUp()):e===r.SELECT_CRAFT||e===r.SELECT_RECIPE||e===r.CONTAINER?0===i.x&&0===i.y||this.game.display.moveInventory(i):e===r.PROMPT_ACTION?0===i.x&&0===i.y||this.game.display.actionsList.moveCursor(i.y):e===r.SETTINGS_MENU&&(0===i.x&&0===i.y||this.game.display.settingsPanel.moveAction(i))}},t.prototype.prompt=function(t,e,i){this.inputEnabled=!0,this.game.display.alert(t+" "+this.yesNoPrompt(),!0),this.popMode(),this.setMode(r.PROMPT),this.promptCbs={yesCb:e,noCb:i}},t.prototype.gameOver=function(){this.inputEnabled=!0,this.setMode(r.GAME_OVER)},t.prototype.getContextualAction=function(){return this.getAvailableActions()[0]},t.prototype.getShortcutForMenu=function(t,e){if(void 0===e&&(e=!1),u.default.isMobile())return"";switch(t){case o.PlayerAction.PICK_UP:return" [,]";case o.PlayerAction.USE_IN_WORLD:return" [Shift+U]";case o.PlayerAction.PLUNGE:return" [I]";case o.PlayerAction.MAKE_SEEDS:return" [T]";case o.PlayerAction.PLANT:return" [P]";case o.PlayerAction.UI_EXAMINE:return" [L]";case o.PlayerAction.UI_EXAMINE_WORLD:return" [Shift+L]";case o.PlayerAction.DROP:return e?" [Shift+R]":" [R]";case o.PlayerAction.FEED:return" [Shift+F]";case o.PlayerAction.USE:return" [U]";case o.PlayerAction.POUR:return" [Shift+P]";case o.PlayerAction.SLEEP:return" [N]";case o.PlayerAction.UI_VIEW_JOURNAL:return" [J]";case o.PlayerAction.UI_ORIENT:return" [O]";default:return""}},t.prototype.getEffectDescription=function(t){if(t===s.ItemEffect.ROTATE)return"Rotate"},t.prototype.getAvailableActions=function(){var t,e,i,l,h=this.game.player,u=[],p=this.game.player.currentTool,f=h.getThingInFront(),m=!1;if(h.canCook()){var g=(null==f?void 0:f.type)===a.WorldObjectType.ITEM&&f.thing.freshlyCooked?9:15;u.push(new o.ExecutableAction(o.PlayerAction.UI_SELECT_RECIPE,g,"Cook".concat(this.getShortcutForMenu(o.PlayerAction.USE_IN_WORLD)),"Cook")),m=!0}else if(h.canCraft()){var _=h.selectedRecipe;if(_&&this.game.input.peekMode()===r.BUILDING){E=(E=_.verb||"Build").charAt(0).toUpperCase()+E.substr(1);var y=_.flooringId?n.default.get(_.flooringId).name:n.default.get(_.itemId).name;u.push(new o.ExecutableAction(o.PlayerAction.CRAFT,15,"".concat(E," ").concat(y),E))}}if(f){var v=!1;if(f.type===a.WorldObjectType.ITEM&&!f.thing.def.nearAction||f.type===a.WorldObjectType.PLANT&&!f.thing.plantDef.isTimber?v=!0:f.type===a.WorldObjectType.BEING?v=!(null===(t=h.currentTool)||void 0===t?void 0:t.interactsWithBeing()):f.type===a.WorldObjectType.TILE&&f.thing.effect&&(v=!1),f.type!==a.WorldObjectType.ITEM&&f.type!==a.WorldObjectType.PLANT&&f.type!==a.WorldObjectType.BEING||u.push(new o.ExecutableAction(o.PlayerAction.PICK_UP,v?10:0,"Pick up ".concat(f.name).concat(this.getShortcutForMenu(o.PlayerAction.PICK_UP)),"Pick up ".concat(f.name),{single:!1})),f.type===a.WorldObjectType.TILE&&f.thing.effect){var x=null!==(e=this.getEffectDescription(f.thing.effect))&&void 0!==e?e:"Use";u.push(new o.ExecutableAction(o.PlayerAction.USE_IN_WORLD,v?0:10,"".concat(x," ").concat(f.name," in front").concat(this.getShortcutForMenu(o.PlayerAction.USE_IN_WORLD)),"".concat(x," ").concat(f.name)))}f.type===a.WorldObjectType.ITEM&&(f.thing.def.nearAction&&!m&&(x=null!==(i=this.getEffectDescription(f.thing.def.effect))&&void 0!==i?i:"Use",u.push(new o.ExecutableAction(o.PlayerAction.USE_IN_WORLD,v?0:10,"".concat(x," ").concat(f.name," in front").concat(this.getShortcutForMenu(o.PlayerAction.USE_IN_WORLD)),"".concat(x," ").concat(f.name)))),f.thing.def.nearAction&&f.thing.def.effect===s.ItemEffect.ROTATE||!(null===(l=f.thing.def.rotable)||void 0===l?void 0:l.rotable)||u.push(new o.ExecutableAction(o.PlayerAction.ROTATE,10,"".concat(this.getEffectDescription(s.ItemEffect.ROTATE)," ").concat(f.name," in front"),"".concat(this.getEffectDescription(s.ItemEffect.ROTATE)," ").concat(f.name))))}if(h.canPlunge()){var b=!p||"row"!==p.def.effect&&"fish"!==p.def.effect?9:7,E=this.game.world.level.isFlooded(h.x,h.y,h.z)?"Rise":"Plunge";u.push(new o.ExecutableAction(o.PlayerAction.PLUNGE,b,"".concat(E).concat(this.getShortcutForMenu(o.PlayerAction.PLUNGE)),E))}if(p){h.canMakeSeeds()&&u.push(new o.ExecutableAction(o.PlayerAction.MAKE_SEEDS,0,"Mash ".concat(p.def.name).concat(this.getShortcutForMenu(o.PlayerAction.MAKE_SEEDS)))),p.def.plantId&&u.push(new o.ExecutableAction(o.PlayerAction.PLANT,0,"Plant ".concat(p.def.name).concat(this.getShortcutForMenu(o.PlayerAction.PLANT)))),u.push(new o.ExecutableAction(o.PlayerAction.UI_EXAMINE,0,"Examine ".concat(p.def.name).concat(this.getShortcutForMenu(o.PlayerAction.UI_EXAMINE)),"Examine"));var T=!1;if(f)if(f.type===a.WorldObjectType.ITEM){var S=f.thing;if(S.def.isTable){var w="store"===p.def.effect?20:0;u.push(new o.ExecutableAction(o.PlayerAction.DROP,w,"Place ".concat(p.def.name," on ").concat(f.name).concat(this.getShortcutForMenu(o.PlayerAction.DROP)),"Place"))}p.def!==S.def||S.def.noStack||(u.push(new o.ExecutableAction(o.PlayerAction.DROP,0,"Stack ".concat(p.quantity," ").concat(p.def.name," in front").concat(this.getShortcutForMenu(o.PlayerAction.DROP)))),p.quantity>1&&u.push(new o.ExecutableAction(o.PlayerAction.DROP,0,"Stack One ".concat(p.def.name," in front").concat(this.getShortcutForMenu(o.PlayerAction.DROP,!0)),void 0,{single:!0})),T=!0)}else if(f.type===a.WorldObjectType.BEING){var A=f.thing,I=p.def.id===A.race.preferredFood?20:0;u.push(new o.ExecutableAction(o.PlayerAction.FEED,I,"Feed ".concat(f.name," with ").concat(p.def.name).concat(this.getShortcutForMenu(o.PlayerAction.FEED)),"Feed"))}if(T||(u.push(new o.ExecutableAction(o.PlayerAction.DROP,0,"Drop ".concat(p.def.name," in front").concat(this.getShortcutForMenu(o.PlayerAction.DROP)))),p.quantity>1&&u.push(new o.ExecutableAction(o.PlayerAction.DROP,0,"Drop One ".concat(p.def.name," in front").concat(this.getShortcutForMenu(o.PlayerAction.DROP,!0)),void 0,{single:!0}))),p.def.effect)if(p.def.effect===s.ItemEffect.STORE){if(p.containedLiquid)p.containedLiquid.edible&&u.push(new o.ExecutableAction(o.PlayerAction.USE,8,"".concat(c.default.upperCaseFirst(p.containedLiquid.edible.verb)," ").concat(p.containedLiquid.name," from ").concat(p.def.name).concat(this.getShortcutForMenu(o.PlayerAction.USE)),c.default.upperCaseFirst(p.containedLiquid.edible.verb)));else if(h.getFillableLiquidInFront()){var R=h.getFillableLiquidInFront(),C="Store ".concat(R.name," in ").concat(p.def.name);u.push(new o.ExecutableAction(o.PlayerAction.USE,10,"".concat(C).concat(this.getShortcutForMenu(o.PlayerAction.USE)),"Store"))}}else{C=void 0;var M=void 0;switch(p.def.effect){case s.ItemEffect.LEASH:(null==f?void 0:f.type)===a.WorldObjectType.BEING&&(f.thing===h.leashedAnimal?(C="Unleash ".concat(f.thing.race.name),M="Unleash"):(C="Leash ".concat(f.thing.race.name),M="Leash"));break;case s.ItemEffect.READ:C="TAPE"===p.def.noteType?"Watch ".concat(p.def.name):"Read ".concat(p.def.name);break;case s.ItemEffect.STORE_ITEM:C="Check ".concat(p.def.name),M=p.def.name;break;default:C="".concat(d.default.upperCaseFirst(p.def.effect)," using ").concat(p.def.name)}C&&u.push(new o.ExecutableAction(o.PlayerAction.USE,8,"".concat(C).concat(this.getShortcutForMenu(o.PlayerAction.USE)),null!=M?M:"".concat(d.default.upperCaseFirst(p.def.effect))))}else p.def.edible&&h.canEat()&&u.push(new o.ExecutableAction(o.PlayerAction.EAT,7,"".concat(c.default.upperCaseFirst(p.def.edible.verb)," ").concat(p.def.name).concat(this.getShortcutForMenu(o.PlayerAction.USE)),c.default.upperCaseFirst(p.def.edible.verb)));p.containedLiquid&&u.push(new o.ExecutableAction(o.PlayerAction.POUR,0,"Pour ".concat(p.def.name).concat(this.getShortcutForMenu(o.PlayerAction.POUR))))}return f?u.push(new o.ExecutableAction(o.PlayerAction.UI_EXAMINE_WORLD,0,"Examine ".concat(f.name," in front").concat(this.getShortcutForMenu(o.PlayerAction.UI_EXAMINE_WORLD)))):u.push(new o.ExecutableAction(o.PlayerAction.UI_EXAMINE_WORLD,0,"Examine world in front".concat(this.getShortcutForMenu(o.PlayerAction.UI_EXAMINE_WORLD)))),h.canSleep()&&u.push(new o.ExecutableAction(o.PlayerAction.SLEEP,-999,"Sleep".concat(this.getShortcutForMenu(o.PlayerAction.SLEEP)))),h.canGrab(!1)&&(h.grabbedObject?u.push(new o.ExecutableAction(o.PlayerAction.GRAB,0,"Release ".concat(h.grabbedObject.def.name).concat(this.getShortcutForMenu(o.PlayerAction.GRAB)))):u.push(new o.ExecutableAction(o.PlayerAction.GRAB,0,"Grab ".concat(f.name).concat(this.getShortcutForMenu(o.PlayerAction.GRAB))))),u.push(new o.ExecutableAction(o.PlayerAction.UI_ORIENT,-997,"Orient".concat(this.getShortcutForMenu(o.PlayerAction.UI_ORIENT)))),u.push(new o.ExecutableAction(o.PlayerAction.UI_VIEW_JOURNAL,-998,"View Discoveries".concat(this.getShortcutForMenu(o.PlayerAction.UI_VIEW_JOURNAL)))),u.push(new o.ExecutableAction(o.PlayerAction.UI_VIEW_ACTIVITIES,-999,"View Activities".concat(this.getShortcutForMenu(o.PlayerAction.UI_VIEW_ACTIVITIES)))),u.sort((function(t,e){return e.priority-t.priority}))},t.prototype.executeAction=function(t){var e,i,n,s,a=this;switch(t.actionType){case o.PlayerAction.ATTACK:this.inputEnabled=!1;var h=this.game.player.tryAttack();h?this.game.player.endTurn(h.hours):this.inputEnabled=!0;break;case o.PlayerAction.USE:case o.PlayerAction.EAT:this.inputEnabled=!1,this.game.player.useCurrentTool(!1)||(this.inputEnabled=!0);break;case o.PlayerAction.USE_IN_WORLD:this.inputEnabled=!1,this.game.player.useInFront()||(this.inputEnabled=!0);break;case o.PlayerAction.ROTATE:this.inputEnabled=!1,this.game.player.tryRotateInFront()||(this.inputEnabled=!0);break;case o.PlayerAction.PICK_UP:this.game.player.tryPickup(!!t.params&&t.params.single);break;case o.PlayerAction.POUR:this.game.player.tryPour();break;case o.PlayerAction.FEED:this.game.player.tryFeed();break;case o.PlayerAction.PLANT:this.game.player.tryPlant();break;case o.PlayerAction.UI_SELECT_RECIPE:this.game.player.tryCook();break;case o.PlayerAction.CRAFT:var u=this.game.player.tryCraftSelected();"object"==typeof u&&u&&this.game.player.endTurn(u.craftTime);break;case o.PlayerAction.UI_IMAGINE:this.setMode(r.SELECT_CRAFT),this.game.display.resetSelectedRecipe(),this.game.display.recipesPanel.setCategories(),this.game.display.showRecipes(this.game.player.getCraftRecipes()),this.game.audio.playSfx("ui_inv_close"),l.default.reportAction("craft");break;case o.PlayerAction.SLEEP:this.game.player.triggerSleep(void 0,!1);break;case o.PlayerAction.GRAB:this.game.player.tryGrabObject();break;case o.PlayerAction.PLUNGE:this.game.player.tryPlunge();break;case o.PlayerAction.MAKE_SEEDS:this.game.player.canMakeSeeds()?this.prompt("Mash ".concat(this.game.player.currentTool.def.name,"?"),(function(){a.game.player.makeSeeds(),a.game.audio.playSfx("extract_seed_01,extract_seed_02"),l.default.reportAction("transformSeed")})):this.game.player.currentTool&&(this.game.player.currentTool.def.plantId?this.game.display.errorMessage("Cannot mash ".concat(this.game.player.currentTool.def.name,". Try planting it as it is.")):this.game.display.errorMessage("Cannot mash ".concat(this.game.player.currentTool.def.name,".")));break;case o.PlayerAction.DROP:if(this.game.player.currentTool||(null===(e=t.params)||void 0===e?void 0:e.itemToDrop))return void this.game.player.tryDrop((null===(i=t.params)||void 0===i?void 0:i.itemToDrop)||this.game.player.currentTool,!!(null===(n=t.params)||void 0===n?void 0:n.single),null===(s=t.params)||void 0===s?void 0:s.targetContainer);break;case o.PlayerAction.UI_EXAMINE_WORLD:this.game.player.examineWorldInFront();break;case o.PlayerAction.UI_EXAMINE:this.game.player.currentTool&&(this.game.player.canExamineClue(this.game.player.currentTool)?this.game.display.showClue(this.game.player.currentTool):this.game.display.examine(this.game.player.currentTool));break;case o.PlayerAction.UI_VIEW_ACTIVITIES:this.game.display.activitiesPanel.show();break;case o.PlayerAction.UI_VIEW_JOURNAL:this.setMode(r.JOURNAL),this.game.display.journalPanel.showJournal();break;case o.PlayerAction.UI_ORIENT:this.game.player.changeWaypoint(),this.game.display.refresh()}},t.prototype.enableInput=function(){this.inputEnabled=!0},t.prototype.disableInput=function(){this.inputEnabled=!1},t.prototype.replaceActions=function(t){var e=u.default.isMobile(),i=e?"[A]":"[Ctrl]",r=e?"[All]":"[Space]",n=e?"[One]":"[Ctrl]",s=e?"[Act]":"[Space]",a=e?"[Back]":"[Escape]",o=e?"[↓]":"[Tab]",l=e?"[↑]":"[Shift+Tab]",h=e?"[Build]":"[B]";return t.replace(/\$ACTIONS/g,s).replace(/\$ACTION/g,i).replace(/\$CLOSE/g,a).replace(/\$CONTAINER_TRANSFER_ONE/g,n).replace(/\$CONTAINER_TRANSFER_ALL/g,r).replace(/\$CHANGE_TOOL_UP/g,l).replace(/\$CHANGE_TOOL/g,o).replace(/\$BUILD/g,h)},t.prototype.yesNoPrompt=function(){return u.default.isMobile()?"\n[A to confirm]":"[Y/N]"},t}());e.default=f},6739:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(858),n=new(function(){function t(){}return t.prototype.init=function(t){this.game=t,this.initSentry()},t.prototype.initSentry=function(){r.init({dsn:"https://697382e4cbee4f3a99d3fb16fb13d2a6@o249954.ingest.sentry.io/4505423831040000",environment:"web",release:"emerald-woods@"+this.game.version,integrations:[],tracesSampleRate:1,replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1})},t}());e.default=n},8696:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=new(function(){function t(){}return t.prototype.load=function(){var t=localStorage.getItem("ew_preferences");if(t)try{this.preferences=JSON.parse(t)}catch(t){this.preferences={}}else this.preferences={}},t.prototype.get=function(t){return this.preferences[t]},t.prototype.set=function(t,e){this.preferences[t]=e},t.prototype.save=function(){localStorage.setItem("ew_preferences",JSON.stringify(this.preferences))},t}());e.default=i},4738:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=new(function(){function t(){}return t.prototype.chance=function(t){return 100*Math.random()<=t},t.prototype.n=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t.prototype.floatNum=function(t,e){return Math.random()*(e-t+1)+t},t.prototype.from=function(t){return t[this.n(0,t.length-1)]},t.prototype.weightedFrom=function(t,e,i,r){void 0===r&&(r=100);var n=0,s=Math.random()*r;for(var a in t)if(s<=(n+=e(t[a])))return i(t[a])},t.prototype.shuffle=function(t){for(var e,i,r=t.length;0!=r;)i=Math.floor(Math.random()*r),r--,e=[t[i],t[r]],t[r]=e[0],t[i]=e[1];return t},t}());e.default=i},771:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DIRECTIONS=void 0;var r=i(2460);e.DIRECTIONS=[{x:-1,y:0},{x:1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1}];var n=["East","Northeast","North","Northwest","West","Southwest","South","Southeast"],s=new Map;s.set(r.default.EAST,{x:1,y:0,z:0}),s.set(r.default.WEST,{x:-1,y:0,z:0}),s.set(r.default.NORTH,{x:0,y:-1,z:0}),s.set(r.default.SOUTH,{x:1,y:1,z:0}),s.set(r.default.NORTHEAST,{x:1,y:-1,z:0}),s.set(r.default.SOUTHEAST,{x:1,y:1,z:0}),s.set(r.default.NORTHWEST,{x:-1,y:-1,z:0}),s.set(r.default.SOUTHWEST,{x:-1,y:1,z:0});var a=new(function(){function t(){}return t.prototype.clamp=function(t,e,i){return i=i||0,t>e?e:t<i?i:t},t.prototype.smaller=function(t,e){return t>e?e:t},t.prototype.distance=function(t,e,i,r){var n=t-i,s=e-r;return Math.sqrt(n*n+s*s)},t.prototype.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t))+t},t.prototype.getRadians=function(t,e){if(0===t){if(1===e)return.5*Math.PI;if(-1===e)return 1.5*Math.PI}else if(1===t){if(0===e)return 0;if(1===e)return.25*Math.PI;if(-1===e)return 1.75*Math.PI}else if(-1===t){if(0===e)return Math.PI;if(1===e)return.75*Math.PI;if(-1===e)return 1.25*Math.PI}},t.prototype.generalDirection=function(t,e,i,r){for(var s=-180*Math.atan2(r-e,i-t)/Math.PI;s<0;)s+=360;var a=Math.floor((s+22)/45);return a>7&&(a=0),n[a]},t.prototype.generalCardinalDirection=function(t,e,i,r){return this.getCardinalDirectionFromString(this.generalDirection(t,e,i,r))},t.prototype.getCardinalDirectionFromString=function(t){switch(t){case"East":return r.default.EAST;case"Northeast":return r.default.NORTHEAST;case"North":return r.default.NORTH;case"Northwest":return r.default.NORTHWEST;case"West":return r.default.WEST;case"Southwest":return r.default.SOUTHWEST;case"South":return r.default.SOUTH;case"Southeast":return r.default.SOUTHEAST}},t.prototype.getCardinalDirectionName=function(t){switch(t){case r.default.EAST:return"East";case r.default.NORTHEAST:return"Northeast";case r.default.NORTH:return"North";case r.default.NORTHWEST:return"Northwest";case r.default.WEST:return"West";case r.default.SOUTHWEST:return"Southwest";case r.default.SOUTH:return"South";case r.default.SOUTHEAST:return"Southeast"}},t.prototype.getVarFromCardinalDirection=function(t){return s.get(t)},t.prototype.upperCaseFirst=function(t){return t.charAt(0).toUpperCase()+t.substring(1)},t}());e.default=a},3773:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7553),n=new(function(){function t(){}return t.prototype.checkVersion=function(t){var e=new XMLHttpRequest;e.onload=function(){var e=JSON.parse(this.responseText);e&&e.versionNumber||t.titleScreen.showVersionError(e),e.versionNumber>r.versionNumber?t.titleScreen.showNewVersion(e):e.versionNumber<r.versionNumber?t.titleScreen.showFutureVersion(e):t.titleScreen.showCurrentVersion(e)},e.open("GET","https://slashware.games/emerald-woods/version.json"),e.send()},t}());e.default=n},2511:function(t,e,i){var r;t=i.nmd(t),function(n){e&&e.nodeType,t&&t.nodeType;var s="object"==typeof i.g&&i.g;s.global!==s&&s.window!==s&&s.self;var a,o=2147483647,l=36,h=/^xn--/,u=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,f=String.fromCharCode;function m(t){throw RangeError(d[t])}function g(t,e){for(var i=t.length,r=[];i--;)r[i]=e(t[i]);return r}function _(t,e){var i=t.split("@"),r="";return i.length>1&&(r=i[0]+"@",t=i[1]),r+g((t=t.replace(c,".")).split("."),e).join(".")}function y(t){for(var e,i,r=[],n=0,s=t.length;n<s;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<s?56320==(64512&(i=t.charCodeAt(n++)))?r.push(((1023&e)<<10)+(1023&i)+65536):(r.push(e),n--):r.push(e);return r}function v(t){return g(t,(function(t){var e="";return t>65535&&(e+=f((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+f(t)})).join("")}function x(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function b(t,e,i){var r=0;for(t=i?p(t/700):t>>1,t+=p(t/e);t>455;r+=l)t=p(t/35);return p(r+36*t/(t+38))}function E(t){var e,i,r,n,s,a,h,u,c,d,f,g=[],_=t.length,y=0,x=128,E=72;for((i=t.lastIndexOf("-"))<0&&(i=0),r=0;r<i;++r)t.charCodeAt(r)>=128&&m("not-basic"),g.push(t.charCodeAt(r));for(n=i>0?i+1:0;n<_;){for(s=y,a=1,h=l;n>=_&&m("invalid-input"),((u=(f=t.charCodeAt(n++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:l)>=l||u>p((o-y)/a))&&m("overflow"),y+=u*a,!(u<(c=h<=E?1:h>=E+26?26:h-E));h+=l)a>p(o/(d=l-c))&&m("overflow"),a*=d;E=b(y-s,e=g.length+1,0==s),p(y/e)>o-x&&m("overflow"),x+=p(y/e),y%=e,g.splice(y++,0,x)}return v(g)}function T(t){var e,i,r,n,s,a,h,u,c,d,g,_,v,E,T,S=[];for(_=(t=y(t)).length,e=128,i=0,s=72,a=0;a<_;++a)(g=t[a])<128&&S.push(f(g));for(r=n=S.length,n&&S.push("-");r<_;){for(h=o,a=0;a<_;++a)(g=t[a])>=e&&g<h&&(h=g);for(h-e>p((o-i)/(v=r+1))&&m("overflow"),i+=(h-e)*v,e=h,a=0;a<_;++a)if((g=t[a])<e&&++i>o&&m("overflow"),g==e){for(u=i,c=l;!(u<(d=c<=s?1:c>=s+26?26:c-s));c+=l)T=u-d,E=l-d,S.push(f(x(d+T%E,0))),u=p(T/E);S.push(f(x(u,0))),s=b(i,v,r==n),i=0,++r}++i,++e}return S.join("")}a={version:"1.3.2",ucs2:{decode:y,encode:v},decode:E,encode:T,toASCII:function(t){return _(t,(function(t){return u.test(t)?"xn--"+T(t):t}))},toUnicode:function(t){return _(t,(function(t){return h.test(t)?E(t.slice(4).toLowerCase()):t}))}},void 0===(r=function(){return a}.call(e,i,e,t))||(t.exports=r)}()},8575:(t,e,i)=>{"use strict";var r=i(2511),n=i(2502);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=v,e.resolve=function(t,e){return v(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?v(t,!1,!0).resolveObject(e):e},e.format=function(t){return n.isString(t)&&(t=v(t)),t instanceof s?t.format():s.prototype.format.call(t)},e.Url=s;var a=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(h),c=["%","/","?",";","#"].concat(u),d=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=i(7673);function v(t,e,i){if(t&&n.isObject(t)&&t instanceof s)return t;var r=new s;return r.parse(t,e,i),r}s.prototype.parse=function(t,e,i){if(!n.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),o=-1!==s&&s<t.indexOf("#")?"?":"#",h=t.split(o);h[0]=h[0].replace(/\\/g,"/");var v=t=h.join(o);if(v=v.trim(),!i&&1===t.split("#").length){var x=l.exec(v);if(x)return this.path=v,this.href=v,this.pathname=x[1],x[2]?(this.search=x[2],this.query=e?y.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var b=a.exec(v);if(b){var E=(b=b[0]).toLowerCase();this.protocol=E,v=v.substr(b.length)}if(i||b||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===v.substr(0,2);!T||b&&g[b]||(v=v.substr(2),this.slashes=!0)}if(!g[b]&&(T||b&&!_[b])){for(var S,w,A=-1,I=0;I<d.length;I++)-1!==(R=v.indexOf(d[I]))&&(-1===A||R<A)&&(A=R);for(-1!==(w=-1===A?v.lastIndexOf("@"):v.lastIndexOf("@",A))&&(S=v.slice(0,w),v=v.slice(w+1),this.auth=decodeURIComponent(S)),A=-1,I=0;I<c.length;I++){var R;-1!==(R=v.indexOf(c[I]))&&(-1===A||R<A)&&(A=R)}-1===A&&(A=v.length),this.host=v.slice(0,A),v=v.slice(A),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var M=this.hostname.split(/\./),O=(I=0,M.length);I<O;I++){var P=M[I];if(P&&!P.match(p)){for(var k="",D=0,N=P.length;D<N;D++)P.charCodeAt(D)>127?k+="x":k+=P[D];if(!k.match(p)){var L=M.slice(0,I),F=M.slice(I+1),B=P.match(f);B&&(L.push(B[1]),F.unshift(B[2])),F.length&&(v="/"+F.join(".")+v),this.hostname=L.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=r.toASCII(this.hostname));var U=this.port?":"+this.port:"",G=this.hostname||"";this.host=G+U,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!m[E])for(I=0,O=u.length;I<O;I++){var W=u[I];if(-1!==v.indexOf(W)){var j=encodeURIComponent(W);j===W&&(j=escape(W)),v=v.split(W).join(j)}}var Y=v.indexOf("#");-1!==Y&&(this.hash=v.substr(Y),v=v.slice(0,Y));var z=v.indexOf("?");if(-1!==z?(this.search=v.substr(z),this.query=v.substr(z+1),e&&(this.query=y.parse(this.query)),v=v.slice(0,z)):e&&(this.search="",this.query={}),v&&(this.pathname=v),_[E]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){U=this.pathname||"";var H=this.search||"";this.path=U+H}return this.href=this.format(),this},s.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",r=this.hash||"",s=!1,a="";this.host?s=t+this.host:this.hostname&&(s=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&n.isObject(this.query)&&Object.keys(this.query).length&&(a=y.stringify(this.query));var o=this.search||a&&"?"+a||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||_[e])&&!1!==s?(s="//"+(s||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):s||(s=""),r&&"#"!==r.charAt(0)&&(r="#"+r),o&&"?"!==o.charAt(0)&&(o="?"+o),e+s+(i=i.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(o=o.replace("#","%23"))+r},s.prototype.resolve=function(t){return this.resolveObject(v(t,!1,!0)).format()},s.prototype.resolveObject=function(t){if(n.isString(t)){var e=new s;e.parse(t,!1,!0),t=e}for(var i=new s,r=Object.keys(this),a=0;a<r.length;a++){var o=r[a];i[o]=this[o]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var l=Object.keys(t),h=0;h<l.length;h++){var u=l[h];"protocol"!==u&&(i[u]=t[u])}return _[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!_[t.protocol]){for(var c=Object.keys(t),d=0;d<c.length;d++){var p=c[d];i[p]=t[p]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||g[t.protocol])i.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),i.pathname=f.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var m=i.pathname||"",y=i.search||"";i.path=m+y}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var v=i.pathname&&"/"===i.pathname.charAt(0),x=t.host||t.pathname&&"/"===t.pathname.charAt(0),b=x||v||i.host&&t.pathname,E=b,T=i.pathname&&i.pathname.split("/")||[],S=(f=t.pathname&&t.pathname.split("/")||[],i.protocol&&!_[i.protocol]);if(S&&(i.hostname="",i.port=null,i.host&&(""===T[0]?T[0]=i.host:T.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),b=b&&(""===f[0]||""===T[0])),x)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,T=f;else if(f.length)T||(T=[]),T.pop(),T=T.concat(f),i.search=t.search,i.query=t.query;else if(!n.isNullOrUndefined(t.search))return S&&(i.hostname=i.host=T.shift(),(C=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=C.shift(),i.host=i.hostname=C.shift())),i.search=t.search,i.query=t.query,n.isNull(i.pathname)&&n.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i;if(!T.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var w=T.slice(-1)[0],A=(i.host||t.host||T.length>1)&&("."===w||".."===w)||""===w,I=0,R=T.length;R>=0;R--)"."===(w=T[R])?T.splice(R,1):".."===w?(T.splice(R,1),I++):I&&(T.splice(R,1),I--);if(!b&&!E)for(;I--;I)T.unshift("..");!b||""===T[0]||T[0]&&"/"===T[0].charAt(0)||T.unshift(""),A&&"/"!==T.join("/").substr(-1)&&T.push("");var C,M=""===T[0]||T[0]&&"/"===T[0].charAt(0);return S&&(i.hostname=i.host=M?"":T.length?T.shift():"",(C=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=C.shift(),i.host=i.hostname=C.shift())),(b=b||i.host&&T.length)&&!M&&T.unshift(""),T.length?i.pathname=T.join("/"):(i.pathname=null,i.path=null),n.isNull(i.pathname)&&n.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},s.prototype.parseHost=function(){var t=this.host,e=o.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},2502:t=>{"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},9345:(t,e,i)=>{"use strict";t.exports=i.p+"a0dbf5218baea7664079.ttf"},8047:(t,e,i)=>{"use strict";t.exports=i.p+"4a25148476560bc951da.ttf"},8670:function(t){t.exports=function(){"use strict";for(var t=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=1),t<e?e:t>i?i:t},e=t,i={},r=0,n=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];r<n.length;r+=1){var s=n[r];i["[object "+s+"]"]=s.toLowerCase()}var a=function(t){return i[Object.prototype.toString.call(t)]||"object"},o=a,l=a,h=Math.PI,u={clip_rgb:function(t){t._clipped=!1,t._unclipped=t.slice(0);for(var i=0;i<=3;i++)i<3?((t[i]<0||t[i]>255)&&(t._clipped=!0),t[i]=e(t[i],0,255)):3===i&&(t[i]=e(t[i],0,1));return t},limit:t,type:a,unpack:function(t,e){return void 0===e&&(e=null),t.length>=3?Array.prototype.slice.call(t):"object"==o(t[0])&&e?e.split("").filter((function(e){return void 0!==t[0][e]})).map((function(e){return t[0][e]})):t[0]},last:function(t){if(t.length<2)return null;var e=t.length-1;return"string"==l(t[e])?t[e].toLowerCase():null},PI:h,TWOPI:2*h,PITHIRD:h/3,DEG2RAD:h/180,RAD2DEG:180/h},c={format:{},autodetect:[]},d=u.last,p=u.clip_rgb,f=u.type,m=c,g=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=this;if("object"===f(t[0])&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];var r=d(t),n=!1;if(!r){n=!0,m.sorted||(m.autodetect=m.autodetect.sort((function(t,e){return e.p-t.p})),m.sorted=!0);for(var s=0,a=m.autodetect;s<a.length;s+=1){var o=a[s];if(r=o.test.apply(o,t))break}}if(!m.format[r])throw new Error("unknown format: "+t);var l=m.format[r].apply(null,n?t:t.slice(0,-1));i._rgb=p(l),3===i._rgb.length&&i._rgb.push(1)};g.prototype.toString=function(){return"function"==f(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var _=g,y=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(y.Color,[null].concat(t)))};y.Color=_,y.version="2.4.2";var v=y,x=u.unpack,b=Math.max,E=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=x(t,"rgb"),r=i[0],n=i[1],s=i[2],a=1-b(r/=255,b(n/=255,s/=255)),o=a<1?1/(1-a):0;return[(1-r-a)*o,(1-n-a)*o,(1-s-a)*o,a]},T=u.unpack,S=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=(t=T(t,"cmyk"))[0],r=t[1],n=t[2],s=t[3],a=t.length>4?t[4]:1;return 1===s?[0,0,0,a]:[i>=1?0:255*(1-i)*(1-s),r>=1?0:255*(1-r)*(1-s),n>=1?0:255*(1-n)*(1-s),a]},w=v,A=_,I=c,R=u.unpack,C=u.type,M=E;A.prototype.cmyk=function(){return M(this._rgb)},w.cmyk=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(A,[null].concat(t,["cmyk"])))},I.format.cmyk=S,I.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=R(t,"cmyk"),"array"===C(t)&&4===t.length)return"cmyk"}});var O=u.unpack,P=u.last,k=function(t){return Math.round(100*t)/100},D=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=O(t,"hsla"),r=P(t)||"lsa";return i[0]=k(i[0]||0),i[1]=k(100*i[1])+"%",i[2]=k(100*i[2])+"%","hsla"===r||i.length>3&&i[3]<1?(i[3]=i.length>3?i[3]:1,r="hsla"):i.length=3,r+"("+i.join(",")+")"},N=u.unpack,L=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=(t=N(t,"rgba"))[0],r=t[1],n=t[2];i/=255,r/=255,n/=255;var s,a,o=Math.min(i,r,n),l=Math.max(i,r,n),h=(l+o)/2;return l===o?(s=0,a=Number.NaN):s=h<.5?(l-o)/(l+o):(l-o)/(2-l-o),i==l?a=(r-n)/(l-o):r==l?a=2+(n-i)/(l-o):n==l&&(a=4+(i-r)/(l-o)),(a*=60)<0&&(a+=360),t.length>3&&void 0!==t[3]?[a,s,h,t[3]]:[a,s,h]},F=u.unpack,B=u.last,U=D,G=L,W=Math.round,j=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=F(t,"rgba"),r=B(t)||"rgb";return"hsl"==r.substr(0,3)?U(G(i),r):(i[0]=W(i[0]),i[1]=W(i[1]),i[2]=W(i[2]),("rgba"===r||i.length>3&&i[3]<1)&&(i[3]=i.length>3?i[3]:1,r="rgba"),r+"("+i.slice(0,"rgb"===r?3:4).join(",")+")")},Y=u.unpack,z=Math.round,H=function(){for(var t,e=[],i=arguments.length;i--;)e[i]=arguments[i];var r,n,s,a=(e=Y(e,"hsl"))[0],o=e[1],l=e[2];if(0===o)r=n=s=255*l;else{var h=[0,0,0],u=[0,0,0],c=l<.5?l*(1+o):l+o-l*o,d=2*l-c,p=a/360;h[0]=p+1/3,h[1]=p,h[2]=p-1/3;for(var f=0;f<3;f++)h[f]<0&&(h[f]+=1),h[f]>1&&(h[f]-=1),6*h[f]<1?u[f]=d+6*(c-d)*h[f]:2*h[f]<1?u[f]=c:3*h[f]<2?u[f]=d+(c-d)*(2/3-h[f])*6:u[f]=d;r=(t=[z(255*u[0]),z(255*u[1]),z(255*u[2])])[0],n=t[1],s=t[2]}return e.length>3?[r,n,s,e[3]]:[r,n,s,1]},X=H,V=c,q=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,K=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,$=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,Z=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Q=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,J=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,tt=Math.round,et=function(t){var e;if(t=t.toLowerCase().trim(),V.format.named)try{return V.format.named(t)}catch(t){}if(e=t.match(q)){for(var i=e.slice(1,4),r=0;r<3;r++)i[r]=+i[r];return i[3]=1,i}if(e=t.match(K)){for(var n=e.slice(1,5),s=0;s<4;s++)n[s]=+n[s];return n}if(e=t.match($)){for(var a=e.slice(1,4),o=0;o<3;o++)a[o]=tt(2.55*a[o]);return a[3]=1,a}if(e=t.match(Z)){for(var l=e.slice(1,5),h=0;h<3;h++)l[h]=tt(2.55*l[h]);return l[3]=+l[3],l}if(e=t.match(Q)){var u=e.slice(1,4);u[1]*=.01,u[2]*=.01;var c=X(u);return c[3]=1,c}if(e=t.match(J)){var d=e.slice(1,4);d[1]*=.01,d[2]*=.01;var p=X(d);return p[3]=+e[4],p}};et.test=function(t){return q.test(t)||K.test(t)||$.test(t)||Z.test(t)||Q.test(t)||J.test(t)};var it=v,rt=_,nt=c,st=u.type,at=j,ot=et;rt.prototype.css=function(t){return at(this._rgb,t)},it.css=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(rt,[null].concat(t,["css"])))},nt.format.css=ot,nt.autodetect.push({p:5,test:function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];if(!e.length&&"string"===st(t)&&ot.test(t))return"css"}});var lt=_,ht=v,ut=u.unpack;c.format.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=ut(t,"rgba");return i[0]*=255,i[1]*=255,i[2]*=255,i},ht.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(lt,[null].concat(t,["gl"])))},lt.prototype.gl=function(){var t=this._rgb;return[t[0]/255,t[1]/255,t[2]/255,t[3]]};var ct=u.unpack,dt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i,r=ct(t,"rgb"),n=r[0],s=r[1],a=r[2],o=Math.min(n,s,a),l=Math.max(n,s,a),h=l-o,u=100*h/255,c=o/(255-h)*100;return 0===h?i=Number.NaN:(n===l&&(i=(s-a)/h),s===l&&(i=2+(a-n)/h),a===l&&(i=4+(n-s)/h),(i*=60)<0&&(i+=360)),[i,u,c]},pt=u.unpack,ft=Math.floor,mt=function(){for(var t,e,i,r,n,s,a=[],o=arguments.length;o--;)a[o]=arguments[o];var l,h,u,c=(a=pt(a,"hcg"))[0],d=a[1],p=a[2];p*=255;var f=255*d;if(0===d)l=h=u=p;else{360===c&&(c=0),c>360&&(c-=360),c<0&&(c+=360);var m=ft(c/=60),g=c-m,_=p*(1-d),y=_+f*(1-g),v=_+f*g,x=_+f;switch(m){case 0:l=(t=[x,v,_])[0],h=t[1],u=t[2];break;case 1:l=(e=[y,x,_])[0],h=e[1],u=e[2];break;case 2:l=(i=[_,x,v])[0],h=i[1],u=i[2];break;case 3:l=(r=[_,y,x])[0],h=r[1],u=r[2];break;case 4:l=(n=[v,_,x])[0],h=n[1],u=n[2];break;case 5:l=(s=[x,_,y])[0],h=s[1],u=s[2]}}return[l,h,u,a.length>3?a[3]:1]},gt=u.unpack,_t=u.type,yt=v,vt=_,xt=c,bt=dt;vt.prototype.hcg=function(){return bt(this._rgb)},yt.hcg=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(vt,[null].concat(t,["hcg"])))},xt.format.hcg=mt,xt.autodetect.push({p:1,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=gt(t,"hcg"),"array"===_t(t)&&3===t.length)return"hcg"}});var Et=u.unpack,Tt=u.last,St=Math.round,wt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=Et(t,"rgba"),r=i[0],n=i[1],s=i[2],a=i[3],o=Tt(t)||"auto";void 0===a&&(a=1),"auto"===o&&(o=a<1?"rgba":"rgb");var l="000000"+((r=St(r))<<16|(n=St(n))<<8|(s=St(s))).toString(16);l=l.substr(l.length-6);var h="0"+St(255*a).toString(16);switch(h=h.substr(h.length-2),o.toLowerCase()){case"rgba":return"#"+l+h;case"argb":return"#"+h+l;default:return"#"+l}},At=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,It=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Rt=function(t){if(t.match(At)){4!==t.length&&7!==t.length||(t=t.substr(1)),3===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var e=parseInt(t,16);return[e>>16,e>>8&255,255&e,1]}if(t.match(It)){5!==t.length&&9!==t.length||(t=t.substr(1)),4===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]);var i=parseInt(t,16);return[i>>24&255,i>>16&255,i>>8&255,Math.round((255&i)/255*100)/100]}throw new Error("unknown hex color: "+t)},Ct=v,Mt=_,Ot=u.type,Pt=c,kt=wt;Mt.prototype.hex=function(t){return kt(this._rgb,t)},Ct.hex=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Mt,[null].concat(t,["hex"])))},Pt.format.hex=Rt,Pt.autodetect.push({p:4,test:function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];if(!e.length&&"string"===Ot(t)&&[3,4,5,6,7,8,9].indexOf(t.length)>=0)return"hex"}});var Dt=u.unpack,Nt=u.TWOPI,Lt=Math.min,Ft=Math.sqrt,Bt=Math.acos,Ut=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i,r=Dt(t,"rgb"),n=r[0],s=r[1],a=r[2],o=Lt(n/=255,s/=255,a/=255),l=(n+s+a)/3,h=l>0?1-o/l:0;return 0===h?i=NaN:(i=(n-s+(n-a))/2,i/=Ft((n-s)*(n-s)+(n-a)*(s-a)),i=Bt(i),a>s&&(i=Nt-i),i/=Nt),[360*i,h,l]},Gt=u.unpack,Wt=u.limit,jt=u.TWOPI,Yt=u.PITHIRD,zt=Math.cos,Ht=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i,r,n,s=(t=Gt(t,"hsi"))[0],a=t[1],o=t[2];return isNaN(s)&&(s=0),isNaN(a)&&(a=0),s>360&&(s-=360),s<0&&(s+=360),(s/=360)<1/3?r=1-((n=(1-a)/3)+(i=(1+a*zt(jt*s)/zt(Yt-jt*s))/3)):s<2/3?n=1-((i=(1-a)/3)+(r=(1+a*zt(jt*(s-=1/3))/zt(Yt-jt*s))/3)):i=1-((r=(1-a)/3)+(n=(1+a*zt(jt*(s-=2/3))/zt(Yt-jt*s))/3)),[255*(i=Wt(o*i*3)),255*(r=Wt(o*r*3)),255*(n=Wt(o*n*3)),t.length>3?t[3]:1]},Xt=u.unpack,Vt=u.type,qt=v,Kt=_,$t=c,Zt=Ut;Kt.prototype.hsi=function(){return Zt(this._rgb)},qt.hsi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Kt,[null].concat(t,["hsi"])))},$t.format.hsi=Ht,$t.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Xt(t,"hsi"),"array"===Vt(t)&&3===t.length)return"hsi"}});var Qt=u.unpack,Jt=u.type,te=v,ee=_,ie=c,re=L;ee.prototype.hsl=function(){return re(this._rgb)},te.hsl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(ee,[null].concat(t,["hsl"])))},ie.format.hsl=H,ie.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Qt(t,"hsl"),"array"===Jt(t)&&3===t.length)return"hsl"}});var ne=u.unpack,se=Math.min,ae=Math.max,oe=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i,r,n,s=(t=ne(t,"rgb"))[0],a=t[1],o=t[2],l=se(s,a,o),h=ae(s,a,o),u=h-l;return n=h/255,0===h?(i=Number.NaN,r=0):(r=u/h,s===h&&(i=(a-o)/u),a===h&&(i=2+(o-s)/u),o===h&&(i=4+(s-a)/u),(i*=60)<0&&(i+=360)),[i,r,n]},le=u.unpack,he=Math.floor,ue=function(){for(var t,e,i,r,n,s,a=[],o=arguments.length;o--;)a[o]=arguments[o];var l,h,u,c=(a=le(a,"hsv"))[0],d=a[1],p=a[2];if(p*=255,0===d)l=h=u=p;else{360===c&&(c=0),c>360&&(c-=360),c<0&&(c+=360);var f=he(c/=60),m=c-f,g=p*(1-d),_=p*(1-d*m),y=p*(1-d*(1-m));switch(f){case 0:l=(t=[p,y,g])[0],h=t[1],u=t[2];break;case 1:l=(e=[_,p,g])[0],h=e[1],u=e[2];break;case 2:l=(i=[g,p,y])[0],h=i[1],u=i[2];break;case 3:l=(r=[g,_,p])[0],h=r[1],u=r[2];break;case 4:l=(n=[y,g,p])[0],h=n[1],u=n[2];break;case 5:l=(s=[p,g,_])[0],h=s[1],u=s[2]}}return[l,h,u,a.length>3?a[3]:1]},ce=u.unpack,de=u.type,pe=v,fe=_,me=c,ge=oe;fe.prototype.hsv=function(){return ge(this._rgb)},pe.hsv=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(fe,[null].concat(t,["hsv"])))},me.format.hsv=ue,me.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=ce(t,"hsv"),"array"===de(t)&&3===t.length)return"hsv"}});var _e={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},ye=_e,ve=u.unpack,xe=Math.pow,be=function(t){return(t/=255)<=.04045?t/12.92:xe((t+.055)/1.055,2.4)},Ee=function(t){return t>ye.t3?xe(t,1/3):t/ye.t2+ye.t0},Te=function(t,e,i){return t=be(t),e=be(e),i=be(i),[Ee((.4124564*t+.3575761*e+.1804375*i)/ye.Xn),Ee((.2126729*t+.7151522*e+.072175*i)/ye.Yn),Ee((.0193339*t+.119192*e+.9503041*i)/ye.Zn)]},Se=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=ve(t,"rgb"),r=i[0],n=i[1],s=i[2],a=Te(r,n,s),o=a[0],l=a[1],h=116*l-16;return[h<0?0:h,500*(o-l),200*(l-a[2])]},we=_e,Ae=u.unpack,Ie=Math.pow,Re=function(t){return 255*(t<=.00304?12.92*t:1.055*Ie(t,1/2.4)-.055)},Ce=function(t){return t>we.t1?t*t*t:we.t2*(t-we.t0)},Me=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i,r,n,s=(t=Ae(t,"lab"))[0],a=t[1],o=t[2];return r=(s+16)/116,i=isNaN(a)?r:r+a/500,n=isNaN(o)?r:r-o/200,r=we.Yn*Ce(r),i=we.Xn*Ce(i),n=we.Zn*Ce(n),[Re(3.2404542*i-1.5371385*r-.4985314*n),Re(-.969266*i+1.8760108*r+.041556*n),Re(.0556434*i-.2040259*r+1.0572252*n),t.length>3?t[3]:1]},Oe=u.unpack,Pe=u.type,ke=v,De=_,Ne=c,Le=Se;De.prototype.lab=function(){return Le(this._rgb)},ke.lab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(De,[null].concat(t,["lab"])))},Ne.format.lab=Me,Ne.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Oe(t,"lab"),"array"===Pe(t)&&3===t.length)return"lab"}});var Fe=u.unpack,Be=u.RAD2DEG,Ue=Math.sqrt,Ge=Math.atan2,We=Math.round,je=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=Fe(t,"lab"),r=i[0],n=i[1],s=i[2],a=Ue(n*n+s*s),o=(Ge(s,n)*Be+360)%360;return 0===We(1e4*a)&&(o=Number.NaN),[r,a,o]},Ye=u.unpack,ze=Se,He=je,Xe=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=Ye(t,"rgb"),r=i[0],n=i[1],s=i[2],a=ze(r,n,s),o=a[0],l=a[1],h=a[2];return He(o,l,h)},Ve=u.unpack,qe=u.DEG2RAD,Ke=Math.sin,$e=Math.cos,Ze=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=Ve(t,"lch"),r=i[0],n=i[1],s=i[2];return isNaN(s)&&(s=0),[r,$e(s*=qe)*n,Ke(s)*n]},Qe=u.unpack,Je=Ze,ti=Me,ei=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=(t=Qe(t,"lch"))[0],r=t[1],n=t[2],s=Je(i,r,n),a=s[0],o=s[1],l=s[2],h=ti(a,o,l);return[h[0],h[1],h[2],t.length>3?t[3]:1]},ii=u.unpack,ri=ei,ni=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=ii(t,"hcl").reverse();return ri.apply(void 0,i)},si=u.unpack,ai=u.type,oi=v,li=_,hi=c,ui=Xe;li.prototype.lch=function(){return ui(this._rgb)},li.prototype.hcl=function(){return ui(this._rgb).reverse()},oi.lch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(li,[null].concat(t,["lch"])))},oi.hcl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(li,[null].concat(t,["hcl"])))},hi.format.lch=ei,hi.format.hcl=ni,["lch","hcl"].forEach((function(t){return hi.autodetect.push({p:2,test:function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];if(e=si(e,t),"array"===ai(e)&&3===e.length)return t}})}));var ci={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},di=c,pi=u.type,fi=ci,mi=Rt,gi=wt;_.prototype.name=function(){for(var t=gi(this._rgb,"rgb"),e=0,i=Object.keys(fi);e<i.length;e+=1){var r=i[e];if(fi[r]===t)return r.toLowerCase()}return t},di.format.named=function(t){if(t=t.toLowerCase(),fi[t])return mi(fi[t]);throw new Error("unknown color name: "+t)},di.autodetect.push({p:5,test:function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];if(!e.length&&"string"===pi(t)&&fi[t.toLowerCase()])return"named"}});var _i=u.unpack,yi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=_i(t,"rgb");return(i[0]<<16)+(i[1]<<8)+i[2]},vi=u.type,xi=function(t){if("number"==vi(t)&&t>=0&&t<=16777215)return[t>>16,t>>8&255,255&t,1];throw new Error("unknown num color: "+t)},bi=v,Ei=_,Ti=c,Si=u.type,wi=yi;Ei.prototype.num=function(){return wi(this._rgb)},bi.num=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Ei,[null].concat(t,["num"])))},Ti.format.num=xi,Ti.autodetect.push({p:5,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(1===t.length&&"number"===Si(t[0])&&t[0]>=0&&t[0]<=16777215)return"num"}});var Ai=v,Ii=_,Ri=c,Ci=u.unpack,Mi=u.type,Oi=Math.round;Ii.prototype.rgb=function(t){return void 0===t&&(t=!0),!1===t?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Oi)},Ii.prototype.rgba=function(t){return void 0===t&&(t=!0),this._rgb.slice(0,4).map((function(e,i){return i<3?!1===t?e:Oi(e):e}))},Ai.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Ii,[null].concat(t,["rgb"])))},Ri.format.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=Ci(t,"rgba");return void 0===i[3]&&(i[3]=1),i},Ri.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Ci(t,"rgba"),"array"===Mi(t)&&(3===t.length||4===t.length&&"number"==Mi(t[3])&&t[3]>=0&&t[3]<=1))return"rgb"}});var Pi=Math.log,ki=function(t){var e,i,r,n=t/100;return n<66?(e=255,i=n<6?0:-155.25485562709179-.44596950469579133*(i=n-2)+104.49216199393888*Pi(i),r=n<20?0:.8274096064007395*(r=n-10)-254.76935184120902+115.67994401066147*Pi(r)):(e=351.97690566805693+.114206453784165*(e=n-55)-40.25366309332127*Pi(e),i=325.4494125711974+.07943456536662342*(i=n-50)-28.0852963507957*Pi(i),r=255),[e,i,r,1]},Di=ki,Ni=u.unpack,Li=Math.round,Fi=v,Bi=_,Ui=c,Gi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var i,r=Ni(t,"rgb"),n=r[0],s=r[2],a=1e3,o=4e4,l=.4;o-a>l;){var h=Di(i=.5*(o+a));h[2]/h[0]>=s/n?o=i:a=i}return Li(i)};Bi.prototype.temp=Bi.prototype.kelvin=Bi.prototype.temperature=function(){return Gi(this._rgb)},Fi.temp=Fi.kelvin=Fi.temperature=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Bi,[null].concat(t,["temp"])))},Ui.format.temp=Ui.format.kelvin=Ui.format.temperature=ki;var Wi=u.unpack,ji=Math.cbrt,Yi=Math.pow,zi=Math.sign,Hi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=Wi(t,"rgb"),r=i[0],n=i[1],s=i[2],a=[Xi(r/255),Xi(n/255),Xi(s/255)],o=a[0],l=a[1],h=a[2],u=ji(.4122214708*o+.5363325363*l+.0514459929*h),c=ji(.2119034982*o+.6806995451*l+.1073969566*h),d=ji(.0883024619*o+.2817188376*l+.6299787005*h);return[.2104542553*u+.793617785*c-.0040720468*d,1.9779984951*u-2.428592205*c+.4505937099*d,.0259040371*u+.7827717662*c-.808675766*d]};function Xi(t){var e=Math.abs(t);return e<.04045?t/12.92:(zi(t)||1)*Yi((e+.055)/1.055,2.4)}var Vi=u.unpack,qi=Math.pow,Ki=Math.sign,$i=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=(t=Vi(t,"lab"))[0],r=t[1],n=t[2],s=qi(i+.3963377774*r+.2158037573*n,3),a=qi(i-.1055613458*r-.0638541728*n,3),o=qi(i-.0894841775*r-1.291485548*n,3);return[255*Zi(4.0767416621*s-3.3077115913*a+.2309699292*o),255*Zi(-1.2684380046*s+2.6097574011*a-.3413193965*o),255*Zi(-.0041960863*s-.7034186147*a+1.707614701*o),t.length>3?t[3]:1]};function Zi(t){var e=Math.abs(t);return e>.0031308?(Ki(t)||1)*(1.055*qi(e,1/2.4)-.055):12.92*t}var Qi=u.unpack,Ji=u.type,tr=v,er=_,ir=c,rr=Hi;er.prototype.oklab=function(){return rr(this._rgb)},tr.oklab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(er,[null].concat(t,["oklab"])))},ir.format.oklab=$i,ir.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Qi(t,"oklab"),"array"===Ji(t)&&3===t.length)return"oklab"}});var nr=u.unpack,sr=Hi,ar=je,or=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=nr(t,"rgb"),r=i[0],n=i[1],s=i[2],a=sr(r,n,s),o=a[0],l=a[1],h=a[2];return ar(o,l,h)},lr=u.unpack,hr=Ze,ur=$i,cr=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var i=(t=lr(t,"lch"))[0],r=t[1],n=t[2],s=hr(i,r,n),a=s[0],o=s[1],l=s[2],h=ur(a,o,l);return[h[0],h[1],h[2],t.length>3?t[3]:1]},dr=u.unpack,pr=u.type,fr=v,mr=_,gr=c,_r=or;mr.prototype.oklch=function(){return _r(this._rgb)},fr.oklch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(mr,[null].concat(t,["oklch"])))},gr.format.oklch=cr,gr.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=dr(t,"oklch"),"array"===pr(t)&&3===t.length)return"oklch"}});var yr=_,vr=u.type;yr.prototype.alpha=function(t,e){return void 0===e&&(e=!1),void 0!==t&&"number"===vr(t)?e?(this._rgb[3]=t,this):new yr([this._rgb[0],this._rgb[1],this._rgb[2],t],"rgb"):this._rgb[3]},_.prototype.clipped=function(){return this._rgb._clipped||!1};var xr=_,br=_e;xr.prototype.darken=function(t){void 0===t&&(t=1);var e=this.lab();return e[0]-=br.Kn*t,new xr(e,"lab").alpha(this.alpha(),!0)},xr.prototype.brighten=function(t){return void 0===t&&(t=1),this.darken(-t)},xr.prototype.darker=xr.prototype.darken,xr.prototype.brighter=xr.prototype.brighten,_.prototype.get=function(t){var e=t.split("."),i=e[0],r=e[1],n=this[i]();if(r){var s=i.indexOf(r)-("ok"===i.substr(0,2)?2:0);if(s>-1)return n[s];throw new Error("unknown channel "+r+" in mode "+i)}return n};var Er=_,Tr=u.type,Sr=Math.pow;Er.prototype.luminance=function(t){if(void 0!==t&&"number"===Tr(t)){if(0===t)return new Er([0,0,0,this._rgb[3]],"rgb");if(1===t)return new Er([255,255,255,this._rgb[3]],"rgb");var e=this.luminance(),i=20,r=function(e,n){var s=e.interpolate(n,.5,"rgb"),a=s.luminance();return Math.abs(t-a)<1e-7||!i--?s:a>t?r(e,s):r(s,n)},n=(e>t?r(new Er([0,0,0]),this):r(this,new Er([255,255,255]))).rgb();return new Er(n.concat([this._rgb[3]]))}return wr.apply(void 0,this._rgb.slice(0,3))};var wr=function(t,e,i){return.2126*(t=Ar(t))+.7152*(e=Ar(e))+.0722*Ar(i)},Ar=function(t){return(t/=255)<=.03928?t/12.92:Sr((t+.055)/1.055,2.4)},Ir={},Rr=_,Cr=u.type,Mr=Ir,Or=function(t,e,i){void 0===i&&(i=.5);for(var r=[],n=arguments.length-3;n-- >0;)r[n]=arguments[n+3];var s=r[0]||"lrgb";if(Mr[s]||r.length||(s=Object.keys(Mr)[0]),!Mr[s])throw new Error("interpolation mode "+s+" is not defined");return"object"!==Cr(t)&&(t=new Rr(t)),"object"!==Cr(e)&&(e=new Rr(e)),Mr[s](t,e,i).alpha(t.alpha()+i*(e.alpha()-t.alpha()))},Pr=_,kr=Or;Pr.prototype.mix=Pr.prototype.interpolate=function(t,e){void 0===e&&(e=.5);for(var i=[],r=arguments.length-2;r-- >0;)i[r]=arguments[r+2];return kr.apply(void 0,[this,t,e].concat(i))};var Dr=_;Dr.prototype.premultiply=function(t){void 0===t&&(t=!1);var e=this._rgb,i=e[3];return t?(this._rgb=[e[0]*i,e[1]*i,e[2]*i,i],this):new Dr([e[0]*i,e[1]*i,e[2]*i,i],"rgb")};var Nr=_,Lr=_e;Nr.prototype.saturate=function(t){void 0===t&&(t=1);var e=this.lch();return e[1]+=Lr.Kn*t,e[1]<0&&(e[1]=0),new Nr(e,"lch").alpha(this.alpha(),!0)},Nr.prototype.desaturate=function(t){return void 0===t&&(t=1),this.saturate(-t)};var Fr=_,Br=u.type;Fr.prototype.set=function(t,e,i){void 0===i&&(i=!1);var r=t.split("."),n=r[0],s=r[1],a=this[n]();if(s){var o=n.indexOf(s)-("ok"===n.substr(0,2)?2:0);if(o>-1){if("string"==Br(e))switch(e.charAt(0)){case"+":case"-":a[o]+=+e;break;case"*":a[o]*=+e.substr(1);break;case"/":a[o]/=+e.substr(1);break;default:a[o]=+e}else{if("number"!==Br(e))throw new Error("unsupported value for Color.set");a[o]=e}var l=new Fr(a,n);return i?(this._rgb=l._rgb,this):l}throw new Error("unknown channel "+s+" in mode "+n)}return a};var Ur=_;Ir.rgb=function(t,e,i){var r=t._rgb,n=e._rgb;return new Ur(r[0]+i*(n[0]-r[0]),r[1]+i*(n[1]-r[1]),r[2]+i*(n[2]-r[2]),"rgb")};var Gr=_,Wr=Math.sqrt,jr=Math.pow;Ir.lrgb=function(t,e,i){var r=t._rgb,n=r[0],s=r[1],a=r[2],o=e._rgb,l=o[0],h=o[1],u=o[2];return new Gr(Wr(jr(n,2)*(1-i)+jr(l,2)*i),Wr(jr(s,2)*(1-i)+jr(h,2)*i),Wr(jr(a,2)*(1-i)+jr(u,2)*i),"rgb")};var Yr=_;Ir.lab=function(t,e,i){var r=t.lab(),n=e.lab();return new Yr(r[0]+i*(n[0]-r[0]),r[1]+i*(n[1]-r[1]),r[2]+i*(n[2]-r[2]),"lab")};var zr=_,Hr=function(t,e,i,r){var n,s,a,o,l,h,u,c,d,p,f,m,g;return"hsl"===r?(a=t.hsl(),o=e.hsl()):"hsv"===r?(a=t.hsv(),o=e.hsv()):"hcg"===r?(a=t.hcg(),o=e.hcg()):"hsi"===r?(a=t.hsi(),o=e.hsi()):"lch"===r||"hcl"===r?(r="hcl",a=t.hcl(),o=e.hcl()):"oklch"===r&&(a=t.oklch().reverse(),o=e.oklch().reverse()),"h"!==r.substr(0,1)&&"oklch"!==r||(l=(n=a)[0],u=n[1],d=n[2],h=(s=o)[0],c=s[1],p=s[2]),isNaN(l)||isNaN(h)?isNaN(l)?isNaN(h)?m=Number.NaN:(m=h,1!=d&&0!=d||"hsv"==r||(f=c)):(m=l,1!=p&&0!=p||"hsv"==r||(f=u)):m=l+i*(h>l&&h-l>180?h-(l+360):h<l&&l-h>180?h+360-l:h-l),void 0===f&&(f=u+i*(c-u)),g=d+i*(p-d),new zr("oklch"===r?[g,f,m]:[m,f,g],r)},Xr=Hr,Vr=function(t,e,i){return Xr(t,e,i,"lch")};Ir.lch=Vr,Ir.hcl=Vr;var qr=_;Ir.num=function(t,e,i){var r=t.num(),n=e.num();return new qr(r+i*(n-r),"num")};var Kr=Hr;Ir.hcg=function(t,e,i){return Kr(t,e,i,"hcg")};var $r=Hr;Ir.hsi=function(t,e,i){return $r(t,e,i,"hsi")};var Zr=Hr;Ir.hsl=function(t,e,i){return Zr(t,e,i,"hsl")};var Qr=Hr;Ir.hsv=function(t,e,i){return Qr(t,e,i,"hsv")};var Jr=_;Ir.oklab=function(t,e,i){var r=t.oklab(),n=e.oklab();return new Jr(r[0]+i*(n[0]-r[0]),r[1]+i*(n[1]-r[1]),r[2]+i*(n[2]-r[2]),"oklab")};var tn=Hr;Ir.oklch=function(t,e,i){return tn(t,e,i,"oklch")};var en=_,rn=u.clip_rgb,nn=Math.pow,sn=Math.sqrt,an=Math.PI,on=Math.cos,ln=Math.sin,hn=Math.atan2,un=function(t,e){for(var i=t.length,r=[0,0,0,0],n=0;n<t.length;n++){var s=t[n],a=e[n]/i,o=s._rgb;r[0]+=nn(o[0],2)*a,r[1]+=nn(o[1],2)*a,r[2]+=nn(o[2],2)*a,r[3]+=o[3]*a}return r[0]=sn(r[0]),r[1]=sn(r[1]),r[2]=sn(r[2]),r[3]>.9999999&&(r[3]=1),new en(rn(r))},cn=v,dn=u.type,pn=Math.pow,fn=function(t){var e="rgb",i=cn("#ccc"),r=0,n=[0,1],s=[],a=[0,0],o=!1,l=[],h=!1,u=0,c=1,d=!1,p={},f=!0,m=1,g=function(t){if((t=t||["#fff","#000"])&&"string"===dn(t)&&cn.brewer&&cn.brewer[t.toLowerCase()]&&(t=cn.brewer[t.toLowerCase()]),"array"===dn(t)){1===t.length&&(t=[t[0],t[0]]),t=t.slice(0);for(var e=0;e<t.length;e++)t[e]=cn(t[e]);s.length=0;for(var i=0;i<t.length;i++)s.push(i/(t.length-1))}return x(),l=t},_=function(t){return t},y=function(t){return t},v=function(t,r){var n,h;if(null==r&&(r=!1),isNaN(t)||null===t)return i;h=r?t:o&&o.length>2?function(t){if(null!=o){for(var e=o.length-1,i=0;i<e&&t>=o[i];)i++;return i-1}return 0}(t)/(o.length-2):c!==u?(t-u)/(c-u):1,h=y(h),r||(h=_(h)),1!==m&&(h=pn(h,m)),h=a[0]+h*(1-a[0]-a[1]),h=Math.min(1,Math.max(0,h));var d=Math.floor(1e4*h);if(f&&p[d])n=p[d];else{if("array"===dn(l))for(var g=0;g<s.length;g++){var v=s[g];if(h<=v){n=l[g];break}if(h>=v&&g===s.length-1){n=l[g];break}if(h>v&&h<s[g+1]){h=(h-v)/(s[g+1]-v),n=cn.interpolate(l[g],l[g+1],h,e);break}}else"function"===dn(l)&&(n=l(h));f&&(p[d]=n)}return n},x=function(){return p={}};g(t);var b=function(t){var e=cn(v(t));return h&&e[h]?e[h]():e};return b.classes=function(t){if(null!=t){if("array"===dn(t))o=t,n=[t[0],t[t.length-1]];else{var e=cn.analyze(n);o=0===t?[e.min,e.max]:cn.limits(e,"e",t)}return b}return o},b.domain=function(t){if(!arguments.length)return n;u=t[0],c=t[t.length-1],s=[];var e=l.length;if(t.length===e&&u!==c)for(var i=0,r=Array.from(t);i<r.length;i+=1){var a=r[i];s.push((a-u)/(c-u))}else{for(var o=0;o<e;o++)s.push(o/(e-1));if(t.length>2){var h=t.map((function(e,i){return i/(t.length-1)})),d=t.map((function(t){return(t-u)/(c-u)}));d.every((function(t,e){return h[e]===t}))||(y=function(t){if(t<=0||t>=1)return t;for(var e=0;t>=d[e+1];)e++;var i=(t-d[e])/(d[e+1]-d[e]);return h[e]+i*(h[e+1]-h[e])})}}return n=[u,c],b},b.mode=function(t){return arguments.length?(e=t,x(),b):e},b.range=function(t,e){return g(t),b},b.out=function(t){return h=t,b},b.spread=function(t){return arguments.length?(r=t,b):r},b.correctLightness=function(t){return null==t&&(t=!0),d=t,x(),_=d?function(t){for(var e=v(0,!0).lab()[0],i=v(1,!0).lab()[0],r=e>i,n=v(t,!0).lab()[0],s=e+(i-e)*t,a=n-s,o=0,l=1,h=20;Math.abs(a)>.01&&h-- >0;)r&&(a*=-1),a<0?(o=t,t+=.5*(l-t)):(l=t,t+=.5*(o-t)),a=(n=v(t,!0).lab()[0])-s;return t}:function(t){return t},b},b.padding=function(t){return null!=t?("number"===dn(t)&&(t=[t,t]),a=t,b):a},b.colors=function(e,i){arguments.length<2&&(i="hex");var r=[];if(0===arguments.length)r=l.slice(0);else if(1===e)r=[b(.5)];else if(e>1){var s=n[0],a=n[1]-s;r=mn(0,e,!1).map((function(t){return b(s+t/(e-1)*a)}))}else{t=[];var h=[];if(o&&o.length>2)for(var u=1,c=o.length,d=1<=c;d?u<c:u>c;d?u++:u--)h.push(.5*(o[u-1]+o[u]));else h=n;r=h.map((function(t){return b(t)}))}return cn[i]&&(r=r.map((function(t){return t[i]()}))),r},b.cache=function(t){return null!=t?(f=t,b):f},b.gamma=function(t){return null!=t?(m=t,b):m},b.nodata=function(t){return null!=t?(i=cn(t),b):i},b};function mn(t,e,i){for(var r=[],n=t<e,s=i?n?e+1:e-1:e,a=t;n?a<s:a>s;n?a++:a--)r.push(a);return r}var gn=_,_n=fn,yn=v,vn=function(t,e,i){if(!vn[i])throw new Error("unknown blend mode "+i);return vn[i](t,e)},xn=function(t){return function(e,i){var r=yn(i).rgb(),n=yn(e).rgb();return yn.rgb(t(r,n))}},bn=function(t){return function(e,i){var r=[];return r[0]=t(e[0],i[0]),r[1]=t(e[1],i[1]),r[2]=t(e[2],i[2]),r}};vn.normal=xn(bn((function(t){return t}))),vn.multiply=xn(bn((function(t,e){return t*e/255}))),vn.screen=xn(bn((function(t,e){return 255*(1-(1-t/255)*(1-e/255))}))),vn.overlay=xn(bn((function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))}))),vn.darken=xn(bn((function(t,e){return t>e?e:t}))),vn.lighten=xn(bn((function(t,e){return t>e?t:e}))),vn.dodge=xn(bn((function(t,e){return 255===t||(t=e/255*255/(1-t/255))>255?255:t}))),vn.burn=xn(bn((function(t,e){return 255*(1-(1-e/255)/(t/255))})));for(var En=vn,Tn=u.type,Sn=u.clip_rgb,wn=u.TWOPI,An=Math.pow,In=Math.sin,Rn=Math.cos,Cn=v,Mn=_,On=Math.floor,Pn=Math.random,kn=a,Dn=Math.log,Nn=Math.pow,Ln=Math.floor,Fn=Math.abs,Bn=function(t,e){void 0===e&&(e=null);var i={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===kn(t)&&(t=Object.values(t)),t.forEach((function(t){e&&"object"===kn(t)&&(t=t[e]),null==t||isNaN(t)||(i.values.push(t),i.sum+=t,t<i.min&&(i.min=t),t>i.max&&(i.max=t),i.count+=1)})),i.domain=[i.min,i.max],i.limits=function(t,e){return Un(i,t,e)},i},Un=function(t,e,i){void 0===e&&(e="equal"),void 0===i&&(i=7),"array"==kn(t)&&(t=Bn(t));var r=t.min,n=t.max,s=t.values.sort((function(t,e){return t-e}));if(1===i)return[r,n];var a=[];if("c"===e.substr(0,1)&&(a.push(r),a.push(n)),"e"===e.substr(0,1)){a.push(r);for(var o=1;o<i;o++)a.push(r+o/i*(n-r));a.push(n)}else if("l"===e.substr(0,1)){if(r<=0)throw new Error("Logarithmic scales are only possible for values > 0");var l=Math.LOG10E*Dn(r),h=Math.LOG10E*Dn(n);a.push(r);for(var u=1;u<i;u++)a.push(Nn(10,l+u/i*(h-l)));a.push(n)}else if("q"===e.substr(0,1)){a.push(r);for(var c=1;c<i;c++){var d=(s.length-1)*c/i,p=Ln(d);if(p===d)a.push(s[p]);else{var f=d-p;a.push(s[p]*(1-f)+s[p+1]*f)}}a.push(n)}else if("k"===e.substr(0,1)){var m,g=s.length,_=new Array(g),y=new Array(i),v=!0,x=0,b=null;(b=[]).push(r);for(var E=1;E<i;E++)b.push(r+E/i*(n-r));for(b.push(n);v;){for(var T=0;T<i;T++)y[T]=0;for(var S=0;S<g;S++)for(var w=s[S],A=Number.MAX_VALUE,I=void 0,R=0;R<i;R++){var C=Fn(b[R]-w);C<A&&(A=C,I=R),y[I]++,_[S]=I}for(var M=new Array(i),O=0;O<i;O++)M[O]=null;for(var P=0;P<g;P++)null===M[m=_[P]]?M[m]=s[P]:M[m]+=s[P];for(var k=0;k<i;k++)M[k]*=1/y[k];v=!1;for(var D=0;D<i;D++)if(M[D]!==b[D]){v=!0;break}b=M,++x>200&&(v=!1)}for(var N={},L=0;L<i;L++)N[L]=[];for(var F=0;F<g;F++)N[m=_[F]].push(s[F]);for(var B=[],U=0;U<i;U++)B.push(N[U][0]),B.push(N[U][N[U].length-1]);B=B.sort((function(t,e){return t-e})),a.push(B[0]);for(var G=1;G<B.length;G+=2){var W=B[G];isNaN(W)||-1!==a.indexOf(W)||a.push(W)}}return a},Gn={analyze:Bn,limits:Un},Wn=_,jn=_,Yn=Math.sqrt,zn=Math.pow,Hn=Math.min,Xn=Math.max,Vn=Math.atan2,qn=Math.abs,Kn=Math.cos,$n=Math.sin,Zn=Math.exp,Qn=Math.PI,Jn=_,ts=_,es=v,is=fn,rs={cool:function(){return is([es.hsl(180,1,.9),es.hsl(250,.7,.4)])},hot:function(){return is(["#000","#f00","#ff0","#fff"]).mode("rgb")}},ns={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},ss=0,as=Object.keys(ns);ss<as.length;ss+=1){var os=as[ss];ns[os.toLowerCase()]=ns[os]}var ls=ns,hs=v;return hs.average=function(t,e,i){void 0===e&&(e="lrgb"),void 0===i&&(i=null);var r=t.length;i||(i=Array.from(new Array(r)).map((function(){return 1})));var n=r/i.reduce((function(t,e){return t+e}));if(i.forEach((function(t,e){i[e]*=n})),t=t.map((function(t){return new en(t)})),"lrgb"===e)return un(t,i);for(var s=t.shift(),a=s.get(e),o=[],l=0,h=0,u=0;u<a.length;u++)if(a[u]=(a[u]||0)*i[0],o.push(isNaN(a[u])?0:i[0]),"h"===e.charAt(u)&&!isNaN(a[u])){var c=a[u]/180*an;l+=on(c)*i[0],h+=ln(c)*i[0]}var d=s.alpha()*i[0];t.forEach((function(t,r){var n=t.get(e);d+=t.alpha()*i[r+1];for(var s=0;s<a.length;s++)if(!isNaN(n[s]))if(o[s]+=i[r+1],"h"===e.charAt(s)){var u=n[s]/180*an;l+=on(u)*i[r+1],h+=ln(u)*i[r+1]}else a[s]+=n[s]*i[r+1]}));for(var p=0;p<a.length;p++)if("h"===e.charAt(p)){for(var f=hn(h/o[p],l/o[p])/an*180;f<0;)f+=360;for(;f>=360;)f-=360;a[p]=f}else a[p]=a[p]/o[p];return d/=r,new en(a,e).alpha(d>.99999?1:d,!0)},hs.bezier=function(t){var e=function(t){var e,i,r,n,s,a,o;if(2===(t=t.map((function(t){return new gn(t)}))).length)e=t.map((function(t){return t.lab()})),s=e[0],a=e[1],n=function(t){var e=[0,1,2].map((function(e){return s[e]+t*(a[e]-s[e])}));return new gn(e,"lab")};else if(3===t.length)i=t.map((function(t){return t.lab()})),s=i[0],a=i[1],o=i[2],n=function(t){var e=[0,1,2].map((function(e){return(1-t)*(1-t)*s[e]+2*(1-t)*t*a[e]+t*t*o[e]}));return new gn(e,"lab")};else if(4===t.length){var l;r=t.map((function(t){return t.lab()})),s=r[0],a=r[1],o=r[2],l=r[3],n=function(t){var e=[0,1,2].map((function(e){return(1-t)*(1-t)*(1-t)*s[e]+3*(1-t)*(1-t)*t*a[e]+3*(1-t)*t*t*o[e]+t*t*t*l[e]}));return new gn(e,"lab")}}else{if(!(t.length>=5))throw new RangeError("No point in running bezier with only one color.");var h,u,c;h=t.map((function(t){return t.lab()})),c=t.length-1,u=function(t){for(var e=[1,1],i=1;i<t;i++){for(var r=[1],n=1;n<=e.length;n++)r[n]=(e[n]||0)+e[n-1];e=r}return e}(c),n=function(t){var e=1-t,i=[0,1,2].map((function(i){return h.reduce((function(r,n,s){return r+u[s]*Math.pow(e,c-s)*Math.pow(t,s)*n[i]}),0)}));return new gn(i,"lab")}}return n}(t);return e.scale=function(){return _n(e)},e},hs.blend=En,hs.cubehelix=function(t,e,i,r,n){void 0===t&&(t=300),void 0===e&&(e=-1.5),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=[0,1]);var s,a=0;"array"===Tn(n)?s=n[1]-n[0]:(s=0,n=[n,n]);var o=function(o){var l=wn*((t+120)/360+e*o),h=An(n[0]+s*o,r),u=(0!==a?i[0]+o*a:i)*h*(1-h)/2,c=Rn(l),d=In(l);return Cn(Sn([255*(h+u*(-.14861*c+1.78277*d)),255*(h+u*(-.29227*c-.90649*d)),255*(h+u*(1.97294*c)),1]))};return o.start=function(e){return null==e?t:(t=e,o)},o.rotations=function(t){return null==t?e:(e=t,o)},o.gamma=function(t){return null==t?r:(r=t,o)},o.hue=function(t){return null==t?i:("array"===Tn(i=t)?0==(a=i[1]-i[0])&&(i=i[1]):a=0,o)},o.lightness=function(t){return null==t?n:("array"===Tn(t)?(n=t,s=t[1]-t[0]):(n=[t,t],s=0),o)},o.scale=function(){return Cn.scale(o)},o.hue(i),o},hs.mix=hs.interpolate=Or,hs.random=function(){for(var t="#",e=0;e<6;e++)t+="0123456789abcdef".charAt(On(16*Pn()));return new Mn(t,"hex")},hs.scale=fn,hs.analyze=Gn.analyze,hs.contrast=function(t,e){t=new Wn(t),e=new Wn(e);var i=t.luminance(),r=e.luminance();return i>r?(i+.05)/(r+.05):(r+.05)/(i+.05)},hs.deltaE=function(t,e,i,r,n){void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=1);var s=function(t){return 360*t/(2*Qn)},a=function(t){return 2*Qn*t/360};t=new jn(t),e=new jn(e);var o=Array.from(t.lab()),l=o[0],h=o[1],u=o[2],c=Array.from(e.lab()),d=c[0],p=c[1],f=c[2],m=(l+d)/2,g=(Yn(zn(h,2)+zn(u,2))+Yn(zn(p,2)+zn(f,2)))/2,_=.5*(1-Yn(zn(g,7)/(zn(g,7)+zn(25,7)))),y=h*(1+_),v=p*(1+_),x=Yn(zn(y,2)+zn(u,2)),b=Yn(zn(v,2)+zn(f,2)),E=(x+b)/2,T=s(Vn(u,y)),S=s(Vn(f,v)),w=T>=0?T:T+360,A=S>=0?S:S+360,I=qn(w-A)>180?(w+A+360)/2:(w+A)/2,R=1-.17*Kn(a(I-30))+.24*Kn(a(2*I))+.32*Kn(a(3*I+6))-.2*Kn(a(4*I-63)),C=A-w;C=qn(C)<=180?C:A<=w?C+360:C-360,C=2*Yn(x*b)*$n(a(C)/2);var M=d-l,O=b-x,P=1+.015*zn(m-50,2)/Yn(20+zn(m-50,2)),k=1+.045*E,D=1+.015*E*R,N=30*Zn(-zn((I-275)/25,2)),L=-2*Yn(zn(E,7)/(zn(E,7)+zn(25,7)))*$n(2*a(N)),F=Yn(zn(M/(i*P),2)+zn(O/(r*k),2)+zn(C/(n*D),2)+L*(O/(r*k))*(C/(n*D)));return Xn(0,Hn(100,F))},hs.distance=function(t,e,i){void 0===i&&(i="lab"),t=new Jn(t),e=new Jn(e);var r=t.get(i),n=e.get(i),s=0;for(var a in r){var o=(r[a]||0)-(n[a]||0);s+=o*o}return Math.sqrt(s)},hs.limits=Gn.limits,hs.valid=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];try{return new(Function.prototype.bind.apply(ts,[null].concat(t))),!0}catch(t){return!1}},hs.scales=rs,hs.colors=ci,hs.brewer=ls,hs}()},8250:(t,e,i)=>{"use strict";i.r(e),i.d(e,{Easing:()=>n,Group:()=>a,Interpolation:()=>o,Sequence:()=>l,Tween:()=>u,VERSION:()=>c,add:()=>g,default:()=>v,getAll:()=>f,nextId:()=>d,now:()=>s,remove:()=>_,removeAll:()=>m,update:()=>y});var r,n=Object.freeze({Linear:Object.freeze({None:function(t){return t},In:function(t){return this.None(t)},Out:function(t){return this.None(t)},InOut:function(t){return this.None(t)}}),Quadratic:Object.freeze({In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}}),Cubic:Object.freeze({In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}}),Quartic:Object.freeze({In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}}),Quintic:Object.freeze({In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}}),Sinusoidal:Object.freeze({In:function(t){return 1-Math.sin((1-t)*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.sin(Math.PI*(.5-t)))}}),Exponential:Object.freeze({In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}}),Circular:Object.freeze({In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}}),Elastic:Object.freeze({In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(t){var e=1.70158;return 1===t?1:t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return 0===t?0:--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}}),Bounce:Object.freeze({In:function(t){return 1-n.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*n.Bounce.In(2*t):.5*n.Bounce.Out(2*t-1)+.5}}),generatePow:function(t){return void 0===t&&(t=4),t=(t=t<Number.EPSILON?Number.EPSILON:t)>1e4?1e4:t,{In:function(e){return Math.pow(e,t)},Out:function(e){return 1-Math.pow(1-e,t)},InOut:function(e){return e<.5?Math.pow(2*e,t)/2:(1-Math.pow(2-2*e,t))/2+.5}}}}),s=function(){return performance.now()},a=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map((function(e){return t._tweens[e]}))},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},t.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},t.prototype.update=function(t,e){void 0===t&&(t=s()),void 0===e&&(e=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var n=this._tweens[i[r]],a=!e;n&&!1===n.update(t,a)&&!e&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),o={Linear:function(t,e){var i=t.length-1,r=i*e,n=Math.floor(r),s=o.Utils.Linear;return e<0?s(t[0],t[1],r):e>1?s(t[i],t[i-1],i-r):s(t[n],t[n+1>i?i:n+1],r-n)},Bezier:function(t,e){for(var i=0,r=t.length-1,n=Math.pow,s=o.Utils.Bernstein,a=0;a<=r;a++)i+=n(1-e,r-a)*n(e,a)*t[a]*s(r,a);return i},CatmullRom:function(t,e){var i=t.length-1,r=i*e,n=Math.floor(r),s=o.Utils.CatmullRom;return t[0]===t[i]?(e<0&&(n=Math.floor(r=i*(1+e))),s(t[(n-1+i)%i],t[n],t[(n+1)%i],t[(n+2)%i],r-n)):e<0?t[0]-(s(t[0],t[0],t[1],t[1],-r)-t[0]):e>1?t[i]-(s(t[i],t[i],t[i-1],t[i-1],r-i)-t[i]):s(t[n?n-1:0],t[n],t[i<n+1?i:n+1],t[i<n+2?i:n+2],r-n)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=o.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:(r=[1],function(t){var e=1;if(r[t])return r[t];for(var i=t;i>1;i--)e*=i;return r[t]=e,e}),CatmullRom:function(t,e,i,r,n){var s=.5*(i-t),a=.5*(r-e),o=n*n;return(2*e-2*i+s+a)*(n*o)+(-3*e+3*i-2*s-a)*o+s*n+e}}},l=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),h=new a,u=function(){function t(t,e){void 0===e&&(e=h),this._object=t,this._group=e,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=n.Linear.None,this._interpolationFunction=o.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=l.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.to=function(t,e){if(void 0===e&&(e=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=t,this._propertiesAreSetUp=!1,this._duration=e,this},t.prototype.duration=function(t){return void 0===t&&(t=1e3),this._duration=t,this},t.prototype.dynamic=function(t){return void 0===t&&(t=!1),this._isDynamic=t,this},t.prototype.start=function(t,e){if(void 0===t&&(t=s()),void 0===e&&(e=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var i in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=t,this._startTime+=this._delayTime,!this._propertiesAreSetUp||e){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var n in this._valuesEnd)r[n]=this._valuesEnd[n];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,e)}return this},t.prototype.startFromCurrentValues=function(t){return this.start(t,!0)},t.prototype._setupProperties=function(t,e,i,r,n){for(var s in i){var a=t[s],o=Array.isArray(a),l=o?"array":typeof a,h=!o&&Array.isArray(i[s]);if("undefined"!==l&&"function"!==l){if(h){if(0===(g=i[s]).length)continue;for(var u=[a],c=0,d=g.length;c<d;c+=1){var p=this._handleRelativeValue(a,g[c]);if(isNaN(p)){h=!1,console.warn("Found invalid interpolation list. Skipping.");break}u.push(p)}h&&(i[s]=u)}if("object"!==l&&!o||!a||h)(void 0===e[s]||n)&&(e[s]=a),o||(e[s]*=1),r[s]=h?i[s].slice().reverse():e[s]||0;else{e[s]=o?[]:{};var f=a;for(var m in f)e[s][m]=f[m];r[s]=o?[]:{};var g=i[s];if(!this._isDynamic){var _={};for(var m in g)_[m]=g[m];i[s]=g=_}this._setupProperties(f,e[s],g,r[s],n)}}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(t){return void 0===t&&(t=s()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this},t.prototype.resume=function(t){return void 0===t&&(t=s()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},t.prototype.stopChainedTweens=function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this},t.prototype.group=function(t){return void 0===t&&(t=h),this._group=t,this},t.prototype.delay=function(t){return void 0===t&&(t=0),this._delayTime=t,this},t.prototype.repeat=function(t){return void 0===t&&(t=0),this._initialRepeat=t,this._repeat=t,this},t.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},t.prototype.yoyo=function(t){return void 0===t&&(t=!1),this._yoyo=t,this},t.prototype.easing=function(t){return void 0===t&&(t=n.Linear.None),this._easingFunction=t,this},t.prototype.interpolation=function(t){return void 0===t&&(t=o.Linear),this._interpolationFunction=t,this},t.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._chainedTweens=t,this},t.prototype.onStart=function(t){return this._onStartCallback=t,this},t.prototype.onEveryStart=function(t){return this._onEveryStartCallback=t,this},t.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},t.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},t.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},t.prototype.onStop=function(t){return this._onStopCallback=t,this},t.prototype.update=function(t,e){if(void 0===t&&(t=s()),void 0===e&&(e=!0),this._isPaused)return!0;var i,r,n=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>n)return!1;e&&this.start(t,!0)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0),r=(t-this._startTime)/this._duration,r=0===this._duration||r>1?1:r;var a=this._easingFunction(r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,a),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),1===r){if(this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[i]||(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var o=0,l=this._chainedTweens.length;o<l;o++)this._chainedTweens[o].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(t,e,i,r){for(var n in i)if(void 0!==e[n]){var s=e[n]||0,a=i[n],o=Array.isArray(t[n]),l=Array.isArray(a);!o&&l?t[n]=this._interpolationFunction(a,r):"object"==typeof a&&a?this._updateProperties(t[n],s,a,r):"number"==typeof(a=this._handleRelativeValue(s,a))&&(t[n]=s+(a-s)*r)}},t.prototype._handleRelativeValue=function(t,e){return"string"!=typeof e?e:"+"===e.charAt(0)||"-"===e.charAt(0)?t+parseFloat(e):parseFloat(e)},t.prototype._swapEndStartRepeatValues=function(t){var e=this._valuesStartRepeat[t],i=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof i?this._valuesStartRepeat[t]+parseFloat(i):this._valuesEnd[t],this._valuesEnd[t]=e},t}(),c="20.0.3",d=l.nextId,p=h,f=p.getAll.bind(p),m=p.removeAll.bind(p),g=p.add.bind(p),_=p.remove.bind(p),y=p.update.bind(p),v={Easing:n,Group:a,Interpolation:o,now:s,Sequence:l,nextId:d,Tween:u,VERSION:c,getAll:f,removeAll:m,add:g,remove:_,update:y}}},e={};function i(r){var n=e[r];if(void 0!==n)return n.exports;var s=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}i.m=t,i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),i.b=document.baseURI||self.location.href,i.nc=void 0,(()=>{"use strict";var t=i(3379),e=i.n(t),r=i(7795),n=i.n(r),s=i(569),a=i.n(s),o=i(3565),l=i.n(o),h=i(9216),u=i.n(h),c=i(4589),d=i.n(c),p=i(5740),f={};f.styleTagTransform=d(),f.setAttributes=l(),f.insert=a().bind(null,"head"),f.domAPI=n(),f.insertStyleElement=u(),e()(p.Z,f),p.Z&&p.Z.locals&&p.Z.locals;var m=i(1181),g=i.n(m);window.onload=()=>{g().start({display:"pixi",appearanceFile:"appearances.json"})}})()})();